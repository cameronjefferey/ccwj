[0m09:33:21.264986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113604a90>]}


============================== 09:33:21.272943 | e5eaae50-27e4-4e2f-b99d-f876cb35f2d4 ==============================
[0m09:33:21.272943 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:33:21.274388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:33:22.132928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5eaae50-27e4-4e2f-b99d-f876cb35f2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114416af0>]}
[0m09:33:22.299640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5eaae50-27e4-4e2f-b99d-f876cb35f2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143aae50>]}
[0m09:33:22.301518 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:33:22.334073 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:33:22.410471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:22.411166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:22.421885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5eaae50-27e4-4e2f-b99d-f876cb35f2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147780d0>]}
[0m09:33:22.442747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5eaae50-27e4-4e2f-b99d-f876cb35f2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114749970>]}
[0m09:33:22.443604 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:33:22.444804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5eaae50-27e4-4e2f-b99d-f876cb35f2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147498e0>]}
[0m09:33:22.448024 [info ] [MainThread]: 
[0m09:33:22.449462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:22.451302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:33:22.452052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:25.312232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now create_ccwj-dbt_analytics)
[0m09:33:25.314432 [debug] [ThreadPool]: Creating schema "database: "ccwj-dbt"
schema: "analytics"
"
[0m09:33:25.334168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:25.334934 [debug] [ThreadPool]: On create_ccwj-dbt_analytics: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "connection_name": "create_ccwj-dbt_analytics"} */
create schema if not exists `ccwj-dbt`.`analytics`
  
[0m09:33:25.758381 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c7668549-e615-48c9-9909-ae11a4f6a5f0&page=queryresults
[0m09:33:25.759485 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m09:33:25.760382 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:33:25.763001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:25.763752 [debug] [MainThread]: Connection 'create_ccwj-dbt_analytics' was properly closed.
[0m09:33:25.764646 [info ] [MainThread]: 
[0m09:33:25.765662 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m09:33:25.766918 [error] [MainThread]: Encountered an error:
Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:33:25.770085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6250734, "process_user_time": 4.571802, "process_kernel_time": 0.532087, "process_mem_max_rss": "125489152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:25.770990 [debug] [MainThread]: Command `cli run` failed at 09:33:25.770788 after 4.63 seconds
[0m09:33:25.771824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114749ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147ebe50>]}
[0m09:33:25.772650 [debug] [MainThread]: Flushing usage events
[0m09:35:46.792145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9ba90>]}


============================== 09:35:46.799582 | 561dfe03-2594-4d07-ae4f-31d019e0df02 ==============================
[0m09:35:46.799582 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:35:46.800474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:35:47.634146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '561dfe03-2594-4d07-ae4f-31d019e0df02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb7730>]}
[0m09:35:47.769753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '561dfe03-2594-4d07-ae4f-31d019e0df02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cec700>]}
[0m09:35:47.771238 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:35:47.798844 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:35:47.880818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:35:47.881646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:35:47.890463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '561dfe03-2594-4d07-ae4f-31d019e0df02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600e0d0>]}
[0m09:35:47.909756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '561dfe03-2594-4d07-ae4f-31d019e0df02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdf7c0>]}
[0m09:35:47.910580 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:35:47.911633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561dfe03-2594-4d07-ae4f-31d019e0df02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb7bb0>]}
[0m09:35:47.913852 [info ] [MainThread]: 
[0m09:35:47.915266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:35:47.917386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:35:47.918323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:49.808524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now create_ccwj-dbt_analytics)
[0m09:35:49.810448 [debug] [ThreadPool]: Creating schema "database: "ccwj-dbt"
schema: "analytics"
"
[0m09:35:49.827226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:49.828094 [debug] [ThreadPool]: On create_ccwj-dbt_analytics: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "connection_name": "create_ccwj-dbt_analytics"} */
create schema if not exists `ccwj-dbt`.`analytics`
  
[0m09:35:50.138582 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cd7b63ba-a5a4-4f0b-9f44-5f67528a389a&page=queryresults
[0m09:35:50.139649 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m09:35:50.140339 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:35:50.142668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:50.143267 [debug] [MainThread]: Connection 'create_ccwj-dbt_analytics' was properly closed.
[0m09:35:50.144038 [info ] [MainThread]: 
[0m09:35:50.144819 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m09:35:50.145915 [error] [MainThread]: Encountered an error:
Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:35:50.150181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4576728, "process_user_time": 4.252842, "process_kernel_time": 0.527433, "process_mem_max_rss": "124764160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:35:50.152004 [debug] [MainThread]: Command `cli run` failed at 09:35:50.151663 after 3.46 seconds
[0m09:35:50.152764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600e550>]}
[0m09:35:50.153608 [debug] [MainThread]: Flushing usage events
[0m09:43:29.160079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b3fa0>]}


============================== 09:43:29.168170 | 6a82b998-7aa0-4c10-83b4-eab3b12cd1c1 ==============================
[0m09:43:29.168170 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:43:29.169196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:43:30.242160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516ad30>]}
[0m09:43:30.386569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f47310>]}
[0m09:43:30.388136 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:43:30.415556 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:43:30.507365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:30.508092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:30.517599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063140d0>]}
[0m09:43:30.541144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5670>]}
[0m09:43:30.541980 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:43:30.542583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5af0>]}
[0m09:43:30.544806 [info ] [MainThread]: 
[0m09:43:30.546201 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:43:30.547960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:43:30.548851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:32.365843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now create_ccwj-dbt_analytics)
[0m09:43:32.368381 [debug] [ThreadPool]: Creating schema "database: "ccwj-dbt"
schema: "analytics"
"
[0m09:43:32.384420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:32.385151 [debug] [ThreadPool]: On create_ccwj-dbt_analytics: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "connection_name": "create_ccwj-dbt_analytics"} */
create schema if not exists `ccwj-dbt`.`analytics`
  
[0m09:43:32.951000 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0c2bfbb9-c2ff-40d6-8dab-5a6b3ca2b6a2&page=queryresults
[0m09:43:33.864826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ccwj-dbt_analytics, now list_ccwj-dbt_analytics)
[0m09:43:33.865687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:34.281511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060972e0>]}
[0m09:43:34.283230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:43:34.284081 [info ] [MainThread]: 
[0m09:43:34.288860 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:43:34.289650 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m09:43:34.291099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m09:43:34.291707 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:43:34.305091 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:43:34.306915 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:43:34.292211 => 09:43:34.306504
[0m09:43:34.307531 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:43:34.371304 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:43:34.373032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:43:34.373716 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:43:34.899967 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:66bfe75f-15a9-46b5-a96a-a88492348fc5&page=queryresults
[0m09:43:36.702349 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:43:34.307920 => 09:43:36.701988
[0m09:43:36.703576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a82b998-7aa0-4c10-83b4-eab3b12cd1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106372850>]}
[0m09:43:36.704595 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.41s]
[0m09:43:36.706089 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:43:36.709279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:36.709937 [debug] [MainThread]: Connection 'model.ccwj.my_first_dbt_model' was properly closed.
[0m09:43:36.710690 [info ] [MainThread]: 
[0m09:43:36.711380 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m09:43:36.712743 [debug] [MainThread]: Command end result
[0m09:43:36.734302 [info ] [MainThread]: 
[0m09:43:36.735435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:36.736484 [info ] [MainThread]: 
[0m09:43:36.737651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:43:36.741722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.678851, "process_user_time": 4.476522, "process_kernel_time": 0.575262, "process_mem_max_rss": "128823296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:43:36.742877 [debug] [MainThread]: Command `cli run` succeeded at 09:43:36.742611 after 7.68 seconds
[0m09:43:36.743696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f47310>]}
[0m09:43:36.744327 [debug] [MainThread]: Flushing usage events
[0m09:53:38.431656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e2c40>]}


============================== 09:53:38.438328 | d60b9cdf-239d-4fa0-8bef-3fb92cf846ae ==============================
[0m09:53:38.438328 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:53:38.439143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m09:53:39.248159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106895880>]}
[0m09:53:39.370300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077085b0>]}
[0m09:53:39.371846 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:53:39.402716 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:53:39.495706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:53:39.496513 [debug] [MainThread]: Partial parsing: added file: ccwj://seeds/0417_history.csv
[0m09:53:39.497032 [debug] [MainThread]: Partial parsing: added file: ccwj://seeds/0417_current.csv
[0m09:53:39.680872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4c0d0>]}
[0m09:53:39.698401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1dca0>]}
[0m09:53:39.699140 [info ] [MainThread]: Found 2 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:53:39.699773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1dfd0>]}
[0m09:53:39.702255 [info ] [MainThread]: 
[0m09:53:39.703393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:39.704821 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:53:39.705485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:41.525586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:53:41.526766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:41.828697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077415b0>]}
[0m09:53:41.830871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:41.831735 [info ] [MainThread]: 
[0m09:53:41.836701 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m09:53:41.838343 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m09:53:41.837698 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m09:53:41.839347 [info ] [Thread-2  ]: 2 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m09:53:41.840519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m09:53:41.841589 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:53:41.842161 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m09:53:41.842766 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m09:53:41.843497 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 09:53:41.843135 => 09:53:41.843139
[0m09:53:41.844303 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 09:53:41.843870 => 09:53:41.843873
[0m09:53:41.844947 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m09:53:41.845501 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m09:53:41.932830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:42.022072 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:53:42.232768 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 09:53:41.846039 => 09:53:42.232045
[0m09:53:42.234865 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/ccwj-dbt/jobs?uploadType=resumable: Invalid field name "Positions for CUSTACCS as of 12:51 PM ET, 04/17/2024". Fields must contain the allowed characters, and be at most 300 characters long. For allowed characters, please refer to https://cloud.google.com/bigquery/docs/schemas#column_names
[0m09:53:42.250954 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 2580, in load_table_from_file
    response = self._do_resumable_upload(
  File "/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 3000, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
  File "/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 3069, in _initiate_resumable_upload
    upload.initiate(
  File "/usr/local/lib/python3.9/site-packages/google/resumable_media/requests/upload.py", line 420, in initiate
    return _request_helpers.wait_and_retry(
  File "/usr/local/lib/python3.9/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
  File "/usr/local/lib/python3.9/site-packages/google/resumable_media/requests/upload.py", line 416, in retriable_request
    self._process_initiate_response(result)
  File "/usr/local/lib/python3.9/site-packages/google/resumable_media/_upload.py", line 518, in _process_initiate_response
    _helpers.require_status_code(
  File "/usr/local/lib/python3.9/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>, <HTTPStatus.CREATED: 201>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 427, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 109, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/bigquery/impl.py", line 648, in load_dataframe
    job = client.load_table_from_file(f, table_ref, rewind=True, job_config=load_config)
  File "/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/client.py", line 2588, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/ccwj-dbt/jobs?uploadType=resumable: Invalid field name "Positions for CUSTACCS as of 12:51 PM ET, 04/17/2024". Fields must contain the allowed characters, and be at most 300 characters long. For allowed characters, please refer to https://cloud.google.com/bigquery/docs/schemas#column_names

[0m09:53:42.252287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e04760>]}
[0m09:53:42.253290 [error] [Thread-1  ]: 1 of 2 ERROR loading seed file analytics.0417_current .......................... [[31mERROR[0m in 0.41s]
[0m09:53:42.254705 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m09:53:45.644107 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:53:45.932079 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2cfd6fe3-a7b9-4cf0-9a44-f8d3ce4a1e39&page=queryresults
[0m09:53:46.351148 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:53:46.378973 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 09:53:41.864479 => 09:53:46.378693
[0m09:53:46.379865 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60b9cdf-239d-4fa0-8bef-3fb92cf846ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1cbe0>]}
[0m09:53:46.380478 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 4.54s]
[0m09:53:46.381453 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m09:53:46.384291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:46.384841 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m09:53:46.385304 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m09:53:46.385709 [info ] [MainThread]: 
[0m09:53:46.386329 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m09:53:46.388152 [debug] [MainThread]: Command end result
[0m09:53:46.402971 [info ] [MainThread]: 
[0m09:53:46.403766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:53:46.404440 [info ] [MainThread]: 
[0m09:53:46.405038 [error] [MainThread]:   400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/ccwj-dbt/jobs?uploadType=resumable: Invalid field name "Positions for CUSTACCS as of 12:51 PM ET, 04/17/2024". Fields must contain the allowed characters, and be at most 300 characters long. For allowed characters, please refer to https://cloud.google.com/bigquery/docs/schemas#column_names
[0m09:53:46.405640 [info ] [MainThread]: 
[0m09:53:46.406292 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m09:53:46.410272 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 8.061767, "process_user_time": 4.119993, "process_kernel_time": 0.519146, "process_mem_max_rss": "134455296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:53:46.411657 [debug] [MainThread]: Command `dbt seed` failed at 09:53:46.411390 after 8.06 seconds
[0m09:53:46.412562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078327f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1dca0>]}
[0m09:53:46.413711 [debug] [MainThread]: Flushing usage events
[0m09:55:46.453043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f9b50>]}


============================== 09:55:46.460018 | 1fe2f271-943a-436e-baef-de03dbaf0cf8 ==============================
[0m09:55:46.460018 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:55:46.461008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed -s 0417_current', 'send_anonymous_usage_stats': 'True'}
[0m09:55:47.288964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11451c160>]}
[0m09:55:47.415325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146841c0>]}
[0m09:55:47.416810 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:55:47.441053 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:55:47.527625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:55:47.528335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:55:47.536927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148739a0>]}
[0m09:55:47.557122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147940d0>]}
[0m09:55:47.558347 [info ] [MainThread]: Found 2 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:55:47.559340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147944c0>]}
[0m09:55:47.562383 [info ] [MainThread]: 
[0m09:55:47.563991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:55:47.565903 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:55:47.566635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:50.083360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:55:50.084647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:50.410600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114549550>]}
[0m09:55:50.412575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:55:50.413442 [info ] [MainThread]: 
[0m09:55:50.418996 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m09:55:50.420471 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.0417_current .................................. [RUN]
[0m09:55:50.421890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m09:55:50.422575 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m09:55:50.423487 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 09:55:50.423093 => 09:55:50.423098
[0m09:55:50.424115 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m09:55:50.473847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:55:53.950380 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:55:54.319428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:76731c66-4be5-4408-b31b-7e3fe95d34d1&page=queryresults
[0m09:55:54.716368 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:55:54.744148 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 09:55:50.424449 => 09:55:54.743768
[0m09:55:54.745190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe2f271-943a-436e-baef-de03dbaf0cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114549550>]}
[0m09:55:54.745890 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 6[0m in 4.32s]
[0m09:55:54.746801 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m09:55:54.749521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:54.749973 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m09:55:54.750409 [info ] [MainThread]: 
[0m09:55:54.750912 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m09:55:54.752107 [debug] [MainThread]: Command end result
[0m09:55:54.776837 [info ] [MainThread]: 
[0m09:55:54.778060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:54.779113 [info ] [MainThread]: 
[0m09:55:54.780219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:55:54.784720 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.422431, "process_user_time": 3.92566, "process_kernel_time": 0.49443, "process_mem_max_rss": "127922176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:55:54.785810 [debug] [MainThread]: Command `dbt seed` succeeded at 09:55:54.785618 after 8.42 seconds
[0m09:55:54.786442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114794250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114646040>]}
[0m09:55:54.786974 [debug] [MainThread]: Flushing usage events
[0m10:52:09.125825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b537400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d002250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d024460>]}


============================== 10:52:09.133839 | 7768084a-549a-4b52-8831-50bc386dcf25 ==============================
[0m10:52:09.133839 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:52:09.134883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:10.017428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfe3970>]}
[0m10:52:10.148387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de6d850>]}
[0m10:52:10.149765 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:52:10.174641 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:52:10.238829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:10.239304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:10.246589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1ae0d0>]}
[0m10:52:10.262087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a6040>]}
[0m10:52:10.263087 [info ] [MainThread]: Found 2 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:52:10.263907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a6370>]}
[0m10:52:10.267735 [info ] [MainThread]: 
[0m10:52:10.269302 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:52:10.271195 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:52:10.271985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:12.094747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:52:12.097620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:12.480438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e175550>]}
[0m10:52:12.481965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:52:12.482612 [info ] [MainThread]: 
[0m10:52:12.487604 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m10:52:12.488350 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m10:52:12.489214 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m10:52:12.490054 [info ] [Thread-2  ]: 2 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m10:52:12.491265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m10:52:12.492394 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:52:12.493053 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m10:52:12.493612 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m10:52:12.494580 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 10:52:12.494169 => 10:52:12.494174
[0m10:52:12.495627 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 10:52:12.495128 => 10:52:12.495135
[0m10:52:12.496412 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m10:52:12.497381 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m10:52:12.618257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:52:12.697376 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:52:16.564324 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:52:16.976603 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:eb653813-4564-487e-94a9-e0a6c2e9e569&page=queryresults
[0m10:52:17.287909 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:52:17.358766 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:52:17.379882 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 10:52:12.497911 => 10:52:17.379622
[0m10:52:17.380987 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcfc760>]}
[0m10:52:17.382348 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 6[0m in 4.89s]
[0m10:52:17.383635 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m10:52:17.681312 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2324c79c-97eb-475c-b624-5f591a37cb85&page=queryresults
[0m10:52:18.006947 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:52:18.013739 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 10:52:12.505047 => 10:52:18.013280
[0m10:52:18.015162 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7768084a-549a-4b52-8831-50bc386dcf25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdb460>]}
[0m10:52:18.016141 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 5.52s]
[0m10:52:18.017150 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m10:52:18.019785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:18.020340 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m10:52:18.020833 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m10:52:18.021354 [info ] [MainThread]: 
[0m10:52:18.021871 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m10:52:18.023139 [debug] [MainThread]: Command end result
[0m10:52:18.036242 [info ] [MainThread]: 
[0m10:52:18.037070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:18.037691 [info ] [MainThread]: 
[0m10:52:18.038595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:52:18.042243 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 9.009448, "process_user_time": 3.88809, "process_kernel_time": 0.523928, "process_mem_max_rss": "132014080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:52:18.043774 [debug] [MainThread]: Command `dbt seed` succeeded at 10:52:18.043471 after 9.01 seconds
[0m10:52:18.044495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b537400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcfc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd2760>]}
[0m10:52:18.045148 [debug] [MainThread]: Flushing usage events
[0m11:24:00.630729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a4f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055224c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105552e20>]}


============================== 11:24:00.638856 | 118d69fe-fd21-4786-a451-25e96be4bbf3 ==============================
[0m11:24:00.638856 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:24:00.639818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:24:01.506708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105510190>]}
[0m11:24:01.635966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c9400>]}
[0m11:24:01.637520 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:24:01.665498 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:24:01.737179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:01.737687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:01.746041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c20d0>]}
[0m11:24:01.764690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d21f0>]}
[0m11:24:01.765582 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:24:01.766292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d2940>]}
[0m11:24:01.769112 [info ] [MainThread]: 
[0m11:24:01.770835 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:24:01.772983 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:24:01.773935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:04.344452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:24:04.345501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:04.715363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c9880>]}
[0m11:24:04.717150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:04.717717 [info ] [MainThread]: 
[0m11:24:04.723438 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m11:24:04.724497 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m11:24:04.725877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m11:24:04.726693 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m11:24:04.740473 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:24:04.742720 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 11:24:04.727141 => 11:24:04.742159
[0m11:24:04.743534 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m11:24:04.793745 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:24:04.795755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:04.796622 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as select 
    *

from `ccwj-dbt`.`analytics`.`0417_history`;


[0m11:24:05.366020 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f08ed2dd-fc8e-41f8-85db-f5af119460f6&page=queryresults
[0m11:24:05.788867 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 11:24:04.743880 => 11:24:05.788263
[0m11:24:05.790266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118d69fe-fd21-4786-a451-25e96be4bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b0580>]}
[0m11:24:05.791268 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m11:24:05.792432 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m11:24:05.795543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:05.796116 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m11:24:05.796724 [info ] [MainThread]: 
[0m11:24:05.797464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m11:24:05.798941 [debug] [MainThread]: Command end result
[0m11:24:05.829775 [info ] [MainThread]: 
[0m11:24:05.830431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:05.831449 [info ] [MainThread]: 
[0m11:24:05.832338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:24:05.836766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3037596, "process_user_time": 4.11813, "process_kernel_time": 0.581126, "process_mem_max_rss": "127148032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:24:05.837888 [debug] [MainThread]: Command `cli run` succeeded at 11:24:05.837706 after 5.31 seconds
[0m11:24:05.838431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a4f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10230e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063056a0>]}
[0m11:24:05.838911 [debug] [MainThread]: Flushing usage events
[0m13:05:38.854275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba0fd60>]}


============================== 13:05:38.862651 | f625966d-7d75-4185-891b-5505c93f6a35 ==============================
[0m13:05:38.862651 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:05:38.863621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:05:39.826597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c796400>]}
[0m13:05:39.981055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c987bb0>]}
[0m13:05:39.982551 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:05:40.011681 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:05:40.114288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:40.114948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:40.125273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb85d60>]}
[0m13:05:40.147830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca964f0>]}
[0m13:05:40.149179 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:05:40.150989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca96c40>]}
[0m13:05:40.154911 [info ] [MainThread]: 
[0m13:05:40.156992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:05:40.158958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:05:40.159846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:42.215064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:05:42.216659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:42.648998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c800df0>]}
[0m13:05:42.650464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:42.651097 [info ] [MainThread]: 
[0m13:05:42.658596 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m13:05:42.660404 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m13:05:42.662090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m13:05:42.662914 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m13:05:42.678985 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:05:42.681205 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 13:05:42.663448 => 13:05:42.680710
[0m13:05:42.681906 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m13:05:42.737561 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:05:42.739013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:42.740118 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 

limit 100;


[0m13:05:43.428037 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1c52c206-b560-4ec3-9a05-3757baa0f2e6&page=queryresults
[0m13:05:43.978327 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 13:05:42.682635 => 13:05:43.977851
[0m13:05:43.979879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f625966d-7d75-4185-891b-5505c93f6a35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c920cd0>]}
[0m13:05:43.980891 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m13:05:43.981930 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m13:05:43.984437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:43.985008 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:05:43.985554 [info ] [MainThread]: 
[0m13:05:43.986277 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m13:05:43.988057 [debug] [MainThread]: Command end result
[0m13:05:44.006662 [info ] [MainThread]: 
[0m13:05:44.008036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:44.008670 [info ] [MainThread]: 
[0m13:05:44.009402 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:44.013936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.267092, "process_user_time": 4.650988, "process_kernel_time": 0.626079, "process_mem_max_rss": "127791104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:05:44.015459 [debug] [MainThread]: Command `cli run` succeeded at 13:05:44.015026 after 5.27 seconds
[0m13:05:44.016844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb66fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c964df0>]}
[0m13:05:44.019026 [debug] [MainThread]: Flushing usage events
[0m13:05:49.053191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b96c10>]}


============================== 13:05:49.059969 | 6dcc827f-d628-45dd-a5e0-3850cf550993 ==============================
[0m13:05:49.059969 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:05:49.060856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:49.807575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb0f10>]}
[0m13:05:49.955169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f9d0>]}
[0m13:05:49.956336 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:05:49.982490 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:05:50.053184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:50.053841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:50.064174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d200d0>]}
[0m13:05:50.083926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c31430>]}
[0m13:05:50.084801 [info ] [MainThread]: Found 3 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:05:50.085688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c31b80>]}
[0m13:05:50.088234 [info ] [MainThread]: 
[0m13:05:50.089582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:05:50.091298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:05:50.091984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:51.661430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:05:51.662459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:52.044087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52fa0>]}
[0m13:05:52.046238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:52.047203 [info ] [MainThread]: 
[0m13:05:52.051051 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m13:05:52.052007 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m13:05:52.053355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m13:05:52.054108 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m13:05:52.071414 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:05:52.072884 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 13:05:52.054816 => 13:05:52.072368
[0m13:05:52.073634 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m13:05:52.124847 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:05:52.126085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:52.126857 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m13:05:52.713838 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3fb8206f-49da-4dcf-8020-c2f3f4dd137a&page=queryresults
[0m13:05:53.333198 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 13:05:52.074240 => 13:05:53.332869
[0m13:05:53.334593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcc827f-d628-45dd-a5e0-3850cf550993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6e610>]}
[0m13:05:53.335548 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m13:05:53.336834 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m13:05:53.339370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:53.339881 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:05:53.340368 [info ] [MainThread]: 
[0m13:05:53.340889 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m13:05:53.342204 [debug] [MainThread]: Command end result
[0m13:05:53.356725 [info ] [MainThread]: 
[0m13:05:53.357380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:53.358088 [info ] [MainThread]: 
[0m13:05:53.358783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:53.361163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4021645, "process_user_time": 4.333026, "process_kernel_time": 0.425163, "process_mem_max_rss": "128208896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:05:53.362372 [debug] [MainThread]: Command `cli run` succeeded at 13:05:53.362103 after 4.40 seconds
[0m13:05:53.363126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dad00>]}
[0m13:05:53.363760 [debug] [MainThread]: Flushing usage events
[0m08:51:54.208064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c22c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c51e20>]}


============================== 08:51:54.216522 | 7d814370-f88d-4fe3-9cd0-a5c8b6f00e76 ==============================
[0m08:51:54.216522 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:51:54.218420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:51:55.270441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a66730>]}
[0m08:51:55.432873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129dfb50>]}
[0m08:51:55.434575 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:51:55.467728 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m08:51:55.551115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:51:55.552100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:51:55.565559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dcce20>]}
[0m08:51:55.588227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd84c0>]}
[0m08:51:55.589331 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:51:55.590195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8c10>]}
[0m08:51:55.593028 [info ] [MainThread]: 
[0m08:51:55.594627 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:51:55.596777 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:51:55.597656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:59.014022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:51:59.015173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:59.343414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3d610>]}
[0m08:51:59.344957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:59.345594 [info ] [MainThread]: 
[0m08:51:59.351130 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m08:51:59.352144 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m08:51:59.353625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m08:51:59.354386 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m08:51:59.369703 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m08:51:59.371811 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 08:51:59.354853 => 08:51:59.371301
[0m08:51:59.372488 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m08:51:59.420609 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m08:51:59.422107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:51:59.422967 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    Symbol,
    Description,
    Quantity,
    Price,
    price_change_percent,
    price_change_dollar,
    market_value,
    day_change_percent,
    day_change_dollar,
    cost_bases,
    gain_or_loss_percent,
    gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix;


[0m08:52:00.011715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c5679971-cf9b-47de-8a58-596148e0bf78&page=queryresults
[0m08:52:00.399812 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 08:51:59.372892 => 08:52:00.399468
[0m08:52:00.401198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d814370-f88d-4fe3-9cd0-a5c8b6f00e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af3e80>]}
[0m08:52:00.402274 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m08:52:00.404261 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m08:52:00.408350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:00.408925 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m08:52:00.409457 [info ] [MainThread]: 
[0m08:52:00.410215 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m08:52:00.411590 [debug] [MainThread]: Command end result
[0m08:52:00.437717 [info ] [MainThread]: 
[0m08:52:00.438381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:00.438910 [info ] [MainThread]: 
[0m08:52:00.439487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:00.442809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.361001, "process_user_time": 4.820044, "process_kernel_time": 0.655141, "process_mem_max_rss": "127803392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:00.444272 [debug] [MainThread]: Command `cli run` succeeded at 08:52:00.443968 after 6.36 seconds
[0m08:52:00.445268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c106d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbd040>]}
[0m08:52:00.446412 [debug] [MainThread]: Flushing usage events
[0m09:03:51.301678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3aa3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b389c10>]}


============================== 09:03:51.313482 | b2c28278-c6a0-44c0-9b6e-0b818c61fef5 ==============================
[0m09:03:51.313482 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:03:51.314994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:03:52.210090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3731f0>]}
[0m09:03:52.358496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c130100>]}
[0m09:03:52.359837 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:03:52.384702 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:03:52.454199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:03:52.454886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:03:52.470566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5170d0>]}
[0m09:03:52.490607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c423370>]}
[0m09:03:52.491379 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:03:52.491968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c423ac0>]}
[0m09:03:52.494232 [info ] [MainThread]: 
[0m09:03:52.495702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:03:52.497945 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:03:52.498948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:54.372860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:03:54.374042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:03:54.691028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e0ee0>]}
[0m09:03:54.692536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:03:54.693167 [info ] [MainThread]: 
[0m09:03:54.698764 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:03:54.699703 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m09:03:54.700904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m09:03:54.701527 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:03:54.714247 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:03:54.716480 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:03:54.701893 => 09:03:54.716049
[0m09:03:54.717131 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:03:54.761252 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:03:54.762563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:03:54.763596 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    Symbol,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix;


[0m09:03:55.432808 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:820ccc39-f969-4bf3-a9d3-00e51e82d8d7&page=queryresults
[0m09:03:55.876711 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:03:54.717747 => 09:03:55.876385
[0m09:03:55.877972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c28278-c6a0-44c0-9b6e-0b818c61fef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d1a90>]}
[0m09:03:55.878922 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m09:03:55.880030 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:03:55.883207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:55.884262 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:03:55.885088 [info ] [MainThread]: 
[0m09:03:55.886279 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m09:03:55.887832 [debug] [MainThread]: Command end result
[0m09:03:55.904132 [info ] [MainThread]: 
[0m09:03:55.905206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:03:55.906013 [info ] [MainThread]: 
[0m09:03:55.906784 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:03:55.910121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.711324, "process_user_time": 4.330071, "process_kernel_time": 0.558999, "process_mem_max_rss": "127643648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:03:55.911778 [debug] [MainThread]: Command `cli run` succeeded at 09:03:55.911393 after 4.71 seconds
[0m09:03:55.912719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4fdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3734c0>]}
[0m09:03:55.913834 [debug] [MainThread]: Flushing usage events
[0m09:05:31.483814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10280c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430ed60>]}


============================== 09:05:31.492238 | 1e1f334d-1382-46cb-afd9-637e2f5cff2f ==============================
[0m09:05:31.492238 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:05:31.493462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:05:32.606783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123730>]}
[0m09:05:32.778807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509cb50>]}
[0m09:05:32.780922 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:05:32.816963 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:05:32.900275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:05:32.901047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:05:32.912130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105489e20>]}
[0m09:05:32.934992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053954c0>]}
[0m09:05:32.936070 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:05:32.936842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105395c10>]}
[0m09:05:32.939227 [info ] [MainThread]: 
[0m09:05:32.941192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:05:32.944062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:05:32.945023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:35.436121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:05:35.437340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:35.789385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fa610>]}
[0m09:05:35.791042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:35.791752 [info ] [MainThread]: 
[0m09:05:35.799447 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:05:35.801528 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m09:05:35.803478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m09:05:35.804484 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:05:35.826205 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:05:35.828368 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:05:35.805304 => 09:05:35.827879
[0m09:05:35.829286 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:05:35.904725 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:05:35.907030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:05:35.909418 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    Symbol,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:05:36.863659 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1d459e02-3e37-4ce3-ad94-3e2710927dc0&page=queryresults
[0m09:05:37.388528 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:05:35.830107 => 09:05:37.388097
[0m09:05:37.389943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1f334d-1382-46cb-afd9-637e2f5cff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105395370>]}
[0m09:05:37.390974 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m09:05:37.392223 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:05:37.395923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:37.396899 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:05:37.397674 [info ] [MainThread]: 
[0m09:05:37.398839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m09:05:37.401719 [debug] [MainThread]: Command end result
[0m09:05:37.425919 [info ] [MainThread]: 
[0m09:05:37.426958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:37.429202 [info ] [MainThread]: 
[0m09:05:37.430826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:05:37.436011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.061634, "process_user_time": 4.936225, "process_kernel_time": 0.652584, "process_mem_max_rss": "127750144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:05:37.437773 [debug] [MainThread]: Command `cli run` succeeded at 09:05:37.437428 after 6.06 seconds
[0m09:05:37.438586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10280c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e610>]}
[0m09:05:37.439351 [debug] [MainThread]: Flushing usage events
[0m09:12:58.495339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a495c10>]}


============================== 09:12:58.503646 | 20d47154-6573-4d74-b396-041174855a07 ==============================
[0m09:12:58.503646 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:12:58.505148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:12:59.505101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4aff10>]}
[0m09:12:59.657652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2396a0>]}
[0m09:12:59.659234 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:12:59.687755 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:12:59.758060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:59.758711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:59.768356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6250d0>]}
[0m09:12:59.787440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5302e0>]}
[0m09:12:59.788820 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:12:59.789734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b530a30>]}
[0m09:12:59.792677 [info ] [MainThread]: 
[0m09:12:59.794114 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:12:59.795751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:12:59.796502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:01.842919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:13:01.844180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:02.207837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b394460>]}
[0m09:13:02.209763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:02.210477 [info ] [MainThread]: 
[0m09:13:02.214995 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:13:02.216123 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m09:13:02.217690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m09:13:02.218495 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:13:02.234046 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:13:02.235800 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:13:02.218995 => 09:13:02.235332
[0m09:13:02.236450 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:13:02.288175 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:13:02.289477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:13:02.290473 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:13:02.821609 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8f80ec9c-3394-4004-8915-d9ee20d66a1b&page=queryresults
[0m09:13:03.281360 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:13:02.236831 => 09:13:03.280941
[0m09:13:03.282719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d47154-6573-4d74-b396-041174855a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2a15b0>]}
[0m09:13:03.283944 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:13:03.285005 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:13:03.288209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:03.288782 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:13:03.289474 [info ] [MainThread]: 
[0m09:13:03.290131 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m09:13:03.291345 [debug] [MainThread]: Command end result
[0m09:13:03.308171 [info ] [MainThread]: 
[0m09:13:03.308975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:03.309604 [info ] [MainThread]: 
[0m09:13:03.310220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:13:03.313756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9239464, "process_user_time": 4.528513, "process_kernel_time": 0.595901, "process_mem_max_rss": "127311872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:13:03.315585 [debug] [MainThread]: Command `cli run` succeeded at 09:13:03.315166 after 4.93 seconds
[0m09:13:03.316344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b394af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4aff10>]}
[0m09:13:03.317014 [debug] [MainThread]: Flushing usage events
[0m09:13:10.767145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088cf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fed60>]}


============================== 09:13:10.775554 | cad484b2-a061-4cf7-8772-a42911616a99 ==============================
[0m09:13:10.775554 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:13:10.777773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:13:11.700446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bdd30>]}
[0m09:13:11.865948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a87c0>]}
[0m09:13:11.867504 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:13:11.897895 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:13:11.973907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:11.974679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:11.984272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7afd0>]}
[0m09:13:12.005296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109977070>]}
[0m09:13:12.006150 [info ] [MainThread]: Found 4 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:13:12.006993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975ed90>]}
[0m09:13:12.009513 [info ] [MainThread]: 
[0m09:13:12.010860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:13:12.012659 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:13:12.013714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:13.906034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:13:13.907147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:14.248134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984a400>]}
[0m09:13:14.249557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:13:14.250185 [info ] [MainThread]: 
[0m09:13:14.256604 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m09:13:14.257583 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m09:13:14.259000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m09:13:14.259683 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m09:13:14.277264 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:13:14.279986 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 09:13:14.260222 => 09:13:14.279515
[0m09:13:14.280793 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m09:13:14.332018 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:13:14.334460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:13:14.335305 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m09:13:14.923551 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c8c0ba4c-6445-44bb-8b4d-5843733b66ab&page=queryresults
[0m09:13:15.330264 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 09:13:14.281266 => 09:13:15.329940
[0m09:13:15.331382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cad484b2-a061-4cf7-8772-a42911616a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109777a90>]}
[0m09:13:15.332254 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:13:15.333314 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m09:13:15.336131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:15.336941 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:13:15.337872 [info ] [MainThread]: 
[0m09:13:15.338574 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m09:13:15.339782 [debug] [MainThread]: Command end result
[0m09:13:15.353525 [info ] [MainThread]: 
[0m09:13:15.354509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:15.356031 [info ] [MainThread]: 
[0m09:13:15.356742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:13:15.359373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7067757, "process_user_time": 4.450608, "process_kernel_time": 0.550675, "process_mem_max_rss": "127315968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:13:15.360613 [debug] [MainThread]: Command `cli run` succeeded at 09:13:15.360346 after 4.71 seconds
[0m09:13:15.361380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a87c0>]}
[0m09:13:15.362248 [debug] [MainThread]: Flushing usage events
[0m09:15:44.953341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e277340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a6d60>]}


============================== 09:15:44.961609 | d5ca7e81-58e8-48cc-be94-bef792116cfe ==============================
[0m09:15:44.961609 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:15:44.963131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:15:46.111225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f042910>]}
[0m09:15:46.310028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f149400>]}
[0m09:15:46.312775 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:15:46.348591 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:15:46.478139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:46.478864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:46.494198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4200d0>]}
[0m09:15:46.524084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3437c0>]}
[0m09:15:46.525848 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:15:46.527122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f343af0>]}
[0m09:15:46.531128 [info ] [MainThread]: 
[0m09:15:46.533598 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:15:46.536119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:15:46.537809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:48.486924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:15:48.488341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:48.850864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c21c0>]}
[0m09:15:48.852462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:15:48.853330 [info ] [MainThread]: 
[0m09:15:48.859185 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:15:48.860317 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m09:15:48.861765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m09:15:48.862784 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:15:48.880667 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:15:48.883221 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:15:48.863302 => 09:15:48.882399
[0m09:15:48.884017 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:15:48.941088 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:15:48.942273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:15:48.943133 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:15:49.477893 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b9473749-5b04-4dd9-b89b-4db34b8eb824&page=queryresults
[0m09:15:49.913505 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:15:48.884497 => 09:15:49.913144
[0m09:15:49.914756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ca7e81-58e8-48cc-be94-bef792116cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b5b20>]}
[0m09:15:49.915726 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m09:15:49.917035 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:15:49.919660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:49.920315 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:15:49.920971 [info ] [MainThread]: 
[0m09:15:49.921817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m09:15:49.923740 [debug] [MainThread]: Command end result
[0m09:15:49.940455 [info ] [MainThread]: 
[0m09:15:49.941291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:15:49.942488 [info ] [MainThread]: 
[0m09:15:49.943608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:15:49.947663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1023936, "process_user_time": 5.227362, "process_kernel_time": 0.696171, "process_mem_max_rss": "127541248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:15:49.948993 [debug] [MainThread]: Command `cli run` succeeded at 09:15:49.948741 after 5.10 seconds
[0m09:15:49.949770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4acf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f17fe80>]}
[0m09:15:49.950558 [debug] [MainThread]: Flushing usage events
[0m09:15:53.297425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f456400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f2d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1bf10>]}


============================== 09:15:53.307768 | 5270165a-afcf-43cf-b88b-4e917237672b ==============================
[0m09:15:53.307768 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:15:53.309422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:54.286721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f026a0>]}
[0m09:15:54.482386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f27340>]}
[0m09:15:54.484085 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:15:54.521847 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:15:54.622769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:54.647310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:54.659159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209f0d0>]}
[0m09:15:54.687318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc2340>]}
[0m09:15:54.688170 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:15:54.691251 [info ] [MainThread]: 
[0m09:15:54.693989 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:15:54.696982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:15:54.697782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:55.616643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9744c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a3e20>]}


============================== 09:15:55.625301 | ef62b749-b849-4dac-a9cb-29ff8850dec5 ==============================
[0m09:15:55.625301 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:15:55.626928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:56.584498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b961190>]}
[0m09:15:56.766536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73d0d0>]}
[0m09:15:56.768019 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:15:56.783983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:15:56.785442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:56.808840 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:15:56.905332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:56.906170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:56.918512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb1c0d0>]}
[0m09:15:56.944132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca3f670>]}
[0m09:15:56.945061 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:15:56.945771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca3f8b0>]}
[0m09:15:56.949090 [info ] [MainThread]: 
[0m09:15:56.950933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:15:56.952937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:15:56.953702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:57.081049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d571f0>]}
[0m09:15:57.083667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:15:57.084571 [info ] [MainThread]: 
[0m09:15:57.089083 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:15:57.090033 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m09:15:57.090868 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m09:15:57.092956 [info ] [Thread-1  ]: 1 of 11 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m09:15:57.095247 [info ] [Thread-2  ]: 2 of 11 START seed file analytics.0417_current ................................. [RUN]
[0m09:15:57.097089 [info ] [Thread-3  ]: 3 of 11 START seed file analytics.0417_history ................................. [RUN]
[0m09:15:57.098988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m09:15:57.100775 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m09:15:57.102757 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:15:57.103994 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:15:57.104768 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m09:15:57.138625 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 09:15:57.137339 => 09:15:57.137351
[0m09:15:57.105842 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m09:15:57.164530 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 09:15:57.163680 => 09:15:57.163688
[0m09:15:57.166970 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m09:15:57.139877 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m09:15:57.183487 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:15:57.253778 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:15:57.106868 => 09:15:57.253099
[0m09:15:57.290148 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:15:57.345101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:15:57.382868 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:15:57.464767 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:15:57.890518 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:15:57.893231 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:15:58.389734 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9d6fbec-7c49-404d-b477-a1bdbe264783&page=queryresults
[0m09:15:58.856066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:15:58.857185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:59.166967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8bd730>]}
[0m09:15:59.169202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:15:59.170253 [info ] [MainThread]: 
[0m09:15:59.176973 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m09:15:59.179042 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m09:15:59.180658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m09:15:59.181434 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m09:15:59.197281 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:15:59.198751 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 09:15:59.181894 => 09:15:59.198299
[0m09:15:59.199641 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m09:15:59.258446 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:15:59.259868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:15:59.260877 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m09:15:59.700811 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:67b7636a-4efd-4d96-975d-741e29289e5d&page=queryresults
[0m09:15:59.703375 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m09:15:59.704618 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table ccwj-dbt:analytics.0417_history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_history was not found in location US

Location: US
Job ID: 67b7636a-4efd-4d96-975d-741e29289e5d

[0m09:15:59.705804 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 09:15:59.200223 => 09:15:59.705394
[0m09:15:59.725045 [debug] [Thread-1  ]: Runtime Error in model history (models/groomed/history.sql)
  404 Not found: Table ccwj-dbt:analytics.0417_history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_history was not found in location US
  
  Location: US
  Job ID: 67b7636a-4efd-4d96-975d-741e29289e5d
  
[0m09:15:59.726308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef62b749-b849-4dac-a9cb-29ff8850dec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb8b2b0>]}
[0m09:15:59.727680 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.history ......................... [[31mERROR[0m in 0.55s]
[0m09:15:59.729219 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m09:15:59.732893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:59.733582 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:15:59.734231 [info ] [MainThread]: 
[0m09:15:59.734936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m09:15:59.736513 [debug] [MainThread]: Command end result
[0m09:15:59.763426 [info ] [MainThread]: 
[0m09:15:59.764260 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:15:59.765049 [info ] [MainThread]: 
[0m09:15:59.766517 [error] [MainThread]:   Runtime Error in model history (models/groomed/history.sql)
  404 Not found: Table ccwj-dbt:analytics.0417_history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_history was not found in location US
  
  Location: US
  Job ID: 67b7636a-4efd-4d96-975d-741e29289e5d
  
[0m09:15:59.767244 [info ] [MainThread]: 
[0m09:15:59.768267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:15:59.771299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.276963, "process_user_time": 5.37857, "process_kernel_time": 0.601029, "process_mem_max_rss": "128368640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:15:59.772734 [debug] [MainThread]: Command `cli run` failed at 09:15:59.772385 after 4.28 seconds
[0m09:15:59.774143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c864040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8bd730>]}
[0m09:15:59.775790 [debug] [MainThread]: Flushing usage events
[0m09:16:00.656971 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:15:57.290795 => 09:16:00.656624
[0m09:16:00.658131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123204c0>]}
[0m09:16:00.659042 [info ] [Thread-1  ]: 1 of 11 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.56s]
[0m09:16:00.659948 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:16:00.661124 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:16:00.661803 [info ] [Thread-4  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m09:16:00.662487 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:16:00.663477 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710'
[0m09:16:00.664127 [info ] [Thread-1  ]: 5 of 11 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m09:16:00.664806 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:16:00.665867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m09:16:00.684009 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:16:00.685874 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:16:00.697033 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:16:00.698432 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:16:00.686311 => 09:16:00.698060
[0m09:16:00.699030 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:16:00.699700 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 09:16:00.666295 => 09:16:00.699366
[0m09:16:00.706736 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:16:00.734885 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:16:00.741549 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:16:00.742593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:16:00.743431 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:16:00.745584 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:16:00.746420 [debug] [Thread-4  ]: On test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m09:16:01.364070 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6bb6b6be-1a15-4e51-ad02-de89fc6a0a4c&page=queryresults
[0m09:16:01.399785 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:16:01.472216 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:16:01.565450 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7e2c4955-9361-44a8-9563-7bc76be8659e&page=queryresults
[0m09:16:01.824452 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4fe5eeee-0f43-4328-a31e-956060771f9c&page=queryresults
[0m09:16:01.919530 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0ea693b5-b72e-4b7d-8e4b-0478519b1d08&page=queryresults
[0m09:16:02.140299 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 09:16:00.712640 => 09:16:02.139612
[0m09:16:02.142109 [error] [Thread-4  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.48s]
[0m09:16:02.145429 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:16:02.233834 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:16:02.237027 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:16:00.700040 => 09:16:02.236331
[0m09:16:02.239647 [info ] [Thread-1  ]: 5 of 11 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.57s]
[0m09:16:02.240824 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:16:02.242250 [debug] [Thread-4  ]: Began running node model.ccwj.my_second_dbt_model
[0m09:16:02.246327 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 09:15:57.167869 => 09:16:02.245851
[0m09:16:02.247281 [info ] [Thread-4  ]: 6 of 11 SKIP relation analytics.my_second_dbt_model ............................ [[33mSKIP[0m]
[0m09:16:02.248557 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c90d0>]}
[0m09:16:02.249414 [debug] [Thread-4  ]: Finished running node model.ccwj.my_second_dbt_model
[0m09:16:02.250446 [info ] [Thread-3  ]: 3 of 11 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.15s]
[0m09:16:02.252142 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m09:16:02.253470 [debug] [Thread-1  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:16:02.254284 [debug] [Thread-4  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:16:02.254944 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m09:16:02.256266 [info ] [Thread-1  ]: 7 of 11 SKIP test not_null_my_second_dbt_model_id .............................. [[33mSKIP[0m]
[0m09:16:02.257466 [info ] [Thread-4  ]: 8 of 11 SKIP test unique_my_second_dbt_model_id ................................ [[33mSKIP[0m]
[0m09:16:02.258598 [info ] [Thread-3  ]: 9 of 11 START sql view model analytics.history ................................. [RUN]
[0m09:16:02.259504 [debug] [Thread-1  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:16:02.260800 [debug] [Thread-4  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:16:02.262930 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m09:16:02.264903 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m09:16:02.272056 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:16:02.273863 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 09:16:02.265623 => 09:16:02.273107
[0m09:16:02.274618 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m09:16:02.312108 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:16:02.313255 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:16:02.313912 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m09:16:02.402693 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:16:02.409363 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 09:15:57.206386 => 09:16:02.408972
[0m09:16:02.411124 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215a910>]}
[0m09:16:02.411934 [info ] [Thread-2  ]: 2 of 11 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 6[0m in 5.31s]
[0m09:16:02.412904 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m09:16:02.413806 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:16:02.414485 [info ] [Thread-1  ]: 10 of 11 START sql view model analytics.current ................................ [RUN]
[0m09:16:02.416139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.current)
[0m09:16:02.417114 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:16:02.424526 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:16:02.426561 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:16:02.417797 => 09:16:02.425957
[0m09:16:02.427807 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:16:02.435748 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:16:02.436922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:16:02.437696 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:16:02.865887 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:611cf99f-433f-4aa3-8051-7a0b1986bfc3&page=queryresults
[0m09:16:03.009547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0bed0235-169a-4e99-8712-594202f233d5&page=queryresults
[0m09:16:03.260581 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 09:16:02.275254 => 09:16:03.259636
[0m09:16:03.262038 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112516c40>]}
[0m09:16:03.262979 [info ] [Thread-3  ]: 9 of 11 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m09:16:03.264205 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m09:16:03.621185 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:16:02.428513 => 09:16:03.620747
[0m09:16:03.622850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253fe50>]}
[0m09:16:03.624106 [info ] [Thread-1  ]: 10 of 11 OK created sql view model analytics.current ........................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m09:16:03.625138 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:16:03.626391 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m09:16:03.627359 [info ] [Thread-2  ]: 11 of 11 START sql view model analytics.positions .............................. [RUN]
[0m09:16:03.628663 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.positions)
[0m09:16:03.629219 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m09:16:03.638436 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:16:03.639944 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 09:16:03.629559 => 09:16:03.639555
[0m09:16:03.640500 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m09:16:03.646834 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:16:03.648220 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:16:03.648868 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`current` 
        on current.trade_symbol = history.trade_symbol;


[0m09:16:04.002263 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f6a78f15-cf1f-4ff9-8ccf-8cf42485f8fc&page=queryresults
[0m09:16:04.004135 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword CURRENT at [10:12]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword CURRENT at [10:12]')
[0m09:16:04.914671 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f205b74-f1ca-4b7e-b32a-b9773fc6a3f3&page=queryresults
[0m09:16:04.917122 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f205b74-f1ca-4b7e-b32a-b9773fc6a3f3&page=queryresults
[0m09:16:04.918585 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 09:16:03.640864 => 09:16:04.918089
[0m09:16:04.926564 [debug] [Thread-2  ]: Database Error in model positions (models/core/positions.sql)
  Syntax error: Unexpected keyword CURRENT at [10:12]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m09:16:04.927288 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5270165a-afcf-43cf-b88b-4e917237672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253df10>]}
[0m09:16:04.928237 [error] [Thread-2  ]: 11 of 11 ERROR creating sql view model analytics.positions ..................... [[31mERROR[0m in 1.30s]
[0m09:16:04.929185 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m09:16:04.931448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:04.931976 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:16:04.932505 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:16:04.932966 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:16:04.933396 [debug] [MainThread]: Connection 'test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m09:16:04.933929 [info ] [MainThread]: 
[0m09:16:04.934548 [info ] [MainThread]: Finished running 1 table model, 4 tests, 4 view models, 2 seeds in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m09:16:04.937090 [debug] [MainThread]: Command end result
[0m09:16:04.951741 [info ] [MainThread]: 
[0m09:16:04.952917 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m09:16:04.953730 [info ] [MainThread]: 
[0m09:16:04.954475 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m09:16:04.955092 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:16:04.955606 [info ] [MainThread]: 
[0m09:16:04.956231 [info ] [MainThread]:   compiled Code at target/compiled/ccwj/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m09:16:04.957100 [info ] [MainThread]: 
[0m09:16:04.957760 [error] [MainThread]:   Database Error in model positions (models/core/positions.sql)
  Syntax error: Unexpected keyword CURRENT at [10:12]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m09:16:04.958823 [info ] [MainThread]: 
[0m09:16:04.960591 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=3 TOTAL=11
[0m09:16:04.963766 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.781386, "process_user_time": 6.112741, "process_kernel_time": 0.644358, "process_mem_max_rss": "139276288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:16:04.965264 [debug] [MainThread]: Command `dbt build` failed at 09:16:04.964897 after 11.78 seconds
[0m09:16:04.966076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f456400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d571f0>]}
[0m09:16:04.966985 [debug] [MainThread]: Flushing usage events
[0m09:16:44.055730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f324f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa41fa0>]}


============================== 09:16:44.062316 | 858e2ff1-6d8e-4ce4-b363-4e70df732643 ==============================
[0m09:16:44.062316 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:16:44.063414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:16:44.936042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f8550>]}
[0m09:16:45.099262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8db1f0>]}
[0m09:16:45.100923 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:16:45.129743 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:16:45.207070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:45.207731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:45.221245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb30d0>]}
[0m09:16:45.245628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8460>]}
[0m09:16:45.246587 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:16:45.247268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8850>]}
[0m09:16:45.249756 [info ] [MainThread]: 
[0m09:16:45.251932 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:16:45.254109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:16:45.254947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:46.841790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:16:46.842786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:47.222466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d5d60>]}
[0m09:16:47.224278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:47.225415 [info ] [MainThread]: 
[0m09:16:47.229698 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m09:16:47.230535 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.positions ................................ [RUN]
[0m09:16:47.232065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.positions)
[0m09:16:47.232986 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m09:16:47.247339 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:16:47.249387 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 09:16:47.233657 => 09:16:47.248966
[0m09:16:47.250034 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m09:16:47.299934 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:16:47.301723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:16:47.302773 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol;


[0m09:16:47.953405 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6328aa58-9c68-4ec2-80de-448e53e9c385&page=queryresults
[0m09:16:48.355624 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 09:16:47.250416 => 09:16:48.355293
[0m09:16:48.356968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858e2ff1-6d8e-4ce4-b363-4e70df732643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc47f10>]}
[0m09:16:48.358026 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.positions ........................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m09:16:48.359375 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m09:16:48.361678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:48.362473 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:16:48.363036 [info ] [MainThread]: 
[0m09:16:48.363647 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m09:16:48.365249 [debug] [MainThread]: Command end result
[0m09:16:48.380789 [info ] [MainThread]: 
[0m09:16:48.381456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:16:48.382353 [info ] [MainThread]: 
[0m09:16:48.383759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:16:48.386739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4344554, "process_user_time": 4.754597, "process_kernel_time": 0.529272, "process_mem_max_rss": "127471616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:16:48.387727 [debug] [MainThread]: Command `cli run` succeeded at 09:16:48.387528 after 4.44 seconds
[0m09:16:48.388331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f324f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b87a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b86e040>]}
[0m09:16:48.389044 [debug] [MainThread]: Flushing usage events
[0m12:35:53.838323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3fc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10debd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df07700>]}


============================== 12:35:53.846237 | b484b4b8-052d-4836-a9f9-8971fdce3009 ==============================
[0m12:35:53.846237 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:35:53.847131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:54.719568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df07700>]}
[0m12:35:54.864265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee7ecd0>]}
[0m12:35:54.866006 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:35:54.893556 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:35:54.967715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:54.968553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:54.980134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0780d0>]}
[0m12:35:55.002810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede2490>]}
[0m12:35:55.003835 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:35:55.006920 [info ] [MainThread]: 
[0m12:35:55.008256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:55.010351 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:35:55.011299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:56.755350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:35:56.756474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:57.164973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede5160>]}
[0m12:35:57.166594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:57.167237 [info ] [MainThread]: 
[0m12:35:57.172447 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:35:57.173170 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:35:57.174017 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m12:35:57.174813 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m12:35:57.176310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:35:57.177869 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:35:57.178601 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:35:57.179194 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:35:57.179929 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:35:57.179579 => 12:35:57.179583
[0m12:35:57.180691 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:35:57.180336 => 12:35:57.180341
[0m12:35:57.181815 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:35:57.182671 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:35:57.298275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:57.403658 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:36:01.186388 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:36:01.268931 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:36:01.561430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f1c74e32-a5ef-47ad-96da-1de7e65ae192&page=queryresults
[0m12:36:01.591656 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:af7439f9-43e4-453c-bf48-2522d6a0c02d&page=queryresults
[0m12:36:01.959599 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:36:01.984331 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:35:57.183124 => 12:36:01.983997
[0m12:36:01.985980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d3fa0>]}
[0m12:36:01.986901 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 6[0m in 4.81s]
[0m12:36:01.988120 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:36:01.989999 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:36:01.991068 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m12:36:01.991744 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.current .................................. [RUN]
[0m12:36:01.993000 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m12:36:01.993606 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m12:36:01.996711 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:35:57.213916 => 12:36:01.996403
[0m12:36:02.008017 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:36:02.009335 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f124a60>]}
[0m12:36:02.010498 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 4.83s]
[0m12:36:02.012246 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:36:02.013193 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 12:36:01.997052 => 12:36:02.012657
[0m12:36:02.014328 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m12:36:02.015029 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m12:36:02.015942 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.history .................................. [RUN]
[0m12:36:02.023888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m12:36:02.040557 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m12:36:02.051194 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:36:02.052246 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:36:02.053525 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 12:36:02.047098 => 12:36:02.053160
[0m12:36:02.054123 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:36:02.054642 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m12:36:02.055404 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    case when rating = '--' then null else rating end as rating,
    divident_reinvestment,
    case when is_capital_gain = '--' then null else is_capital_gain end as is_capital_gain,
    case when percent_of_account = '--' then null else percent_of_account end as percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:36:02.061250 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:36:02.064610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:02.065621 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m12:36:02.607522 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5fe4c1e0-6e5b-4358-8f97-ecf9fae6c6e9&page=queryresults
[0m12:36:02.651729 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9d97d2fc-28b9-4410-9276-9670e4eee16b&page=queryresults
[0m12:36:03.028999 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 12:36:02.055952 => 12:36:03.028679
[0m12:36:03.032562 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 12:36:02.016659 => 12:36:03.032258
[0m12:36:03.033523 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4964f0>]}
[0m12:36:03.034633 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d3e50>]}
[0m12:36:03.035449 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:36:03.036267 [info ] [Thread-4  ]: 3 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m12:36:03.037323 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m12:36:03.038176 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m12:36:03.039394 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m12:36:03.040136 [info ] [Thread-2  ]: 5 of 5 START sql view model analytics.positions ................................ [RUN]
[0m12:36:03.041230 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.positions)
[0m12:36:03.041976 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m12:36:03.047645 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m12:36:03.050594 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 12:36:03.042475 => 12:36:03.050074
[0m12:36:03.051239 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m12:36:03.057642 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m12:36:03.058823 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:36:03.059546 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    *
from `ccwj-dbt`.`analytics`.`current`

)

select 
    *
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
limit 100
;;


[0m12:36:03.362130 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:84d8daf4-ebfd-471a-b74d-3137f2022028&page=queryresults
[0m12:36:03.364564 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [20:2]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [20:2]')
[0m12:36:04.252338 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8e7bd889-242e-4825-a320-516f8905ad26&page=queryresults
[0m12:36:04.253813 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8e7bd889-242e-4825-a320-516f8905ad26&page=queryresults
[0m12:36:04.254824 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 12:36:03.051632 => 12:36:04.254449
[0m12:36:04.268535 [debug] [Thread-2  ]: Database Error in model positions (models/core/positions.sql)
  Syntax error: Unexpected ";" at [20:2]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m12:36:04.269293 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b484b4b8-052d-4836-a9f9-8971fdce3009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f491220>]}
[0m12:36:04.270190 [error] [Thread-2  ]: 5 of 5 ERROR creating sql view model analytics.positions ....................... [[31mERROR[0m in 1.23s]
[0m12:36:04.271091 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m12:36:04.273601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:04.274205 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:36:04.274642 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m12:36:04.275060 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:36:04.275581 [info ] [MainThread]: 
[0m12:36:04.276109 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m12:36:04.278171 [debug] [MainThread]: Command end result
[0m12:36:04.293361 [info ] [MainThread]: 
[0m12:36:04.294552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:36:04.295190 [info ] [MainThread]: 
[0m12:36:04.296077 [error] [MainThread]:   Database Error in model positions (models/core/positions.sql)
  Syntax error: Unexpected ";" at [20:2]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m12:36:04.297240 [info ] [MainThread]: 
[0m12:36:04.297891 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:36:04.302133 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 10.567158, "process_user_time": 4.741273, "process_kernel_time": 0.562909, "process_mem_max_rss": "134856704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:04.303465 [debug] [MainThread]: Command `cli build` failed at 12:36:04.303192 after 10.57 seconds
[0m12:36:04.304442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3fc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df07700>]}
[0m12:36:04.305376 [debug] [MainThread]: Flushing usage events
[0m12:36:15.847034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aabe20>]}


============================== 12:36:15.853974 | 68f750e3-109e-481a-ac7b-648210b015d4 ==============================
[0m12:36:15.853974 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:36:15.854994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:16.675957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7c100>]}
[0m12:36:16.838859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a847070>]}
[0m12:36:16.840075 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:36:16.872256 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:36:16.950235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:16.950905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:16.961281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac260d0>]}
[0m12:36:16.985553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab463a0>]}
[0m12:36:16.986548 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:36:16.987546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab46790>]}
[0m12:36:16.990314 [info ] [MainThread]: 
[0m12:36:16.991738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:16.993500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:36:16.994431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:18.600575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:36:18.601770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:18.920594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac15850>]}
[0m12:36:18.922250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:36:18.923279 [info ] [MainThread]: 
[0m12:36:18.927710 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m12:36:18.928751 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.positions ................................ [RUN]
[0m12:36:18.930051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.positions)
[0m12:36:18.930819 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m12:36:18.946396 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m12:36:18.948050 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 12:36:18.931254 => 12:36:18.947521
[0m12:36:18.948941 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m12:36:19.003621 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m12:36:19.004916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:19.005729 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    *
from `ccwj-dbt`.`analytics`.`current`

)

select 
    *
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null;


[0m12:36:19.546973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:157c1e55-0434-45a9-8f9a-fc79e098b929&page=queryresults
[0m12:36:19.853882 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name trade_symbol at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name trade_symbol at [6:6]')
[0m12:36:20.639417 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ffafc6b3-a2f5-4309-9398-e13eab5787f4&page=queryresults
[0m12:36:21.083838 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ffafc6b3-a2f5-4309-9398-e13eab5787f4&page=queryresults
[0m12:36:21.085896 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 12:36:18.949608 => 12:36:21.085057
[0m12:36:21.094051 [debug] [Thread-1  ]: Database Error in model positions (models/core/positions.sql)
  CREATE VIEW has columns with duplicate name trade_symbol at [6:6]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m12:36:21.094922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68f750e3-109e-481a-ac7b-648210b015d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aceb0d0>]}
[0m12:36:21.095914 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.positions ....................... [[31mERROR[0m in 2.17s]
[0m12:36:21.097012 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m12:36:21.099637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:21.100286 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m12:36:21.101155 [info ] [MainThread]: 
[0m12:36:21.104239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m12:36:21.105448 [debug] [MainThread]: Command end result
[0m12:36:21.135640 [info ] [MainThread]: 
[0m12:36:21.144026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:36:21.144976 [info ] [MainThread]: 
[0m12:36:21.145737 [error] [MainThread]:   Database Error in model positions (models/core/positions.sql)
  CREATE VIEW has columns with duplicate name trade_symbol at [6:6]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m12:36:21.147045 [info ] [MainThread]: 
[0m12:36:21.147899 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:36:21.151198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.402721, "process_user_time": 4.471068, "process_kernel_time": 0.460821, "process_mem_max_rss": "128688128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:21.152502 [debug] [MainThread]: Command `cli run` failed at 12:36:21.152179 after 5.41 seconds
[0m12:36:21.153523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7c100>]}
[0m12:36:21.155115 [debug] [MainThread]: Flushing usage events
[0m12:37:51.389115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5ee20>]}


============================== 12:37:51.396844 | a5725a61-acbb-4c46-887f-0aa330a447c9 ==============================
[0m12:37:51.396844 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:37:51.398604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:52.192936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1c1c0>]}
[0m12:37:52.349062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d29f10>]}
[0m12:37:52.350825 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:37:52.379889 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:37:52.457651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:52.458296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:52.468326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ed70d0>]}
[0m12:37:52.487695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dfc550>]}
[0m12:37:52.488530 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:37:52.489255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dfc880>]}
[0m12:37:52.491725 [info ] [MainThread]: 
[0m12:37:52.493119 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:52.494918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:37:52.495726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:54.022038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:37:54.023432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:54.288933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c1f190>]}
[0m12:37:54.290952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:54.291683 [info ] [MainThread]: 
[0m12:37:54.296511 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m12:37:54.298246 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.positions ................................ [RUN]
[0m12:37:54.299761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.positions)
[0m12:37:54.300954 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m12:37:54.330066 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m12:37:54.331872 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 12:37:54.302134 => 12:37:54.331440
[0m12:37:54.332504 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m12:37:54.386471 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m12:37:54.387805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:54.388574 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    *
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m12:37:55.087633 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:556537d7-f5fd-4666-9fe0-be35b0630504&page=queryresults
[0m12:37:55.514277 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 12:37:54.332954 => 12:37:55.513860
[0m12:37:55.515783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5725a61-acbb-4c46-887f-0aa330a447c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f6dac0>]}
[0m12:37:55.516977 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.positions ........................... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m12:37:55.518019 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m12:37:55.520552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:55.521120 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m12:37:55.521741 [info ] [MainThread]: 
[0m12:37:55.522478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:37:55.523835 [debug] [MainThread]: Command end result
[0m12:37:55.538484 [info ] [MainThread]: 
[0m12:37:55.539153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:55.539952 [info ] [MainThread]: 
[0m12:37:55.540818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:55.544412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.256488, "process_user_time": 4.742455, "process_kernel_time": 0.473412, "process_mem_max_rss": "128135168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:37:55.545451 [debug] [MainThread]: Command `cli run` succeeded at 12:37:55.545117 after 4.26 seconds
[0m12:37:55.546900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f64af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b72250>]}
[0m12:37:55.547748 [debug] [MainThread]: Flushing usage events
[0m12:39:53.341295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4a1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4eb250>]}


============================== 12:39:53.349635 | 16af2561-2d6a-41c0-b683-705673e0574b ==============================
[0m12:39:53.349635 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:39:53.351070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:54.265939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f96a0>]}
[0m12:39:54.419642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110305b20>]}
[0m12:39:54.421435 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:39:54.451254 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:39:54.551295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:54.551961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:54.562438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11065a970>]}
[0m12:39:54.584570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105860a0>]}
[0m12:39:54.585748 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:39:54.589697 [info ] [MainThread]: 
[0m12:39:54.610602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:39:54.633370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:39:54.641468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:57.062730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:39:57.063757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:57.415852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027f700>]}
[0m12:39:57.417596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:57.418712 [info ] [MainThread]: 
[0m12:39:57.423548 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:39:57.424595 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m12:39:57.425335 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:39:57.426419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:39:57.427189 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m12:39:57.427909 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:39:57.429023 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:39:57.430375 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:39:57.429646 => 12:39:57.429654
[0m12:39:57.431321 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:39:57.432192 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:39:57.433036 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:39:57.432682 => 12:39:57.432686
[0m12:39:57.457778 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:39:57.497087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:57.605276 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:40:01.482729 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:40:01.826423 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d5f756ea-3295-48cf-ba71-bf67875529f7&page=queryresults
[0m12:40:02.015021 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:40:02.230814 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:40:02.253439 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:39:57.433551 => 12:40:02.252920
[0m12:40:02.254627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ddf10>]}
[0m12:40:02.255374 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 4[0m in 4.83s]
[0m12:40:02.256323 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:40:02.257418 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m12:40:02.258351 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.current .................................. [RUN]
[0m12:40:02.260075 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m12:40:02.260826 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m12:40:02.273958 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:40:02.275101 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 12:40:02.261183 => 12:40:02.274780
[0m12:40:02.275621 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m12:40:02.305613 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:40:02.307168 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:40:02.308416 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    case when rating = '--' then null else rating end as rating,
    divident_reinvestment,
    case when is_capital_gain = '--' then null else is_capital_gain end as is_capital_gain,
    case when percent_of_account = '--' then null else percent_of_account end as percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:40:02.378703 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c662b871-0030-4e30-a35c-e2a136b7f37a&page=queryresults
[0m12:40:02.733351 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:40:02.738684 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:39:57.463825 => 12:40:02.738179
[0m12:40:02.740002 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ccb50>]}
[0m12:40:02.740916 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 5.31s]
[0m12:40:02.741920 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:40:02.742899 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m12:40:02.743551 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.history .................................. [RUN]
[0m12:40:02.744703 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m12:40:02.745546 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m12:40:02.750941 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:40:02.753371 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 12:40:02.746069 => 12:40:02.752919
[0m12:40:02.754048 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m12:40:02.758659 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:40:02.760048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:02.761087 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m12:40:02.830181 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0775801c-9be1-4f82-911d-41808fbf5ce0&page=queryresults
[0m12:40:03.153294 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator = for argument types: INT64, STRING. Supported signature: ANY = ANY at [46:15]; reason: invalidQuery, location: query, message: No matching signature for operator = for argument types: INT64, STRING. Supported signature: ANY = ANY at [46:15]')
[0m12:40:03.265687 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:698c3724-e1b1-409d-b4ad-277d12ef267f&page=queryresults
[0m12:40:03.639699 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 12:40:02.754381 => 12:40:03.639235
[0m12:40:03.644559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071a5b0>]}
[0m12:40:03.645715 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m12:40:03.646721 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m12:40:03.712104 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8e225467-fbb1-4135-943d-28bdca3aad35&page=queryresults
[0m12:40:04.021641 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8e225467-fbb1-4135-943d-28bdca3aad35&page=queryresults
[0m12:40:04.022686 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 12:40:02.275946 => 12:40:04.022313
[0m12:40:04.038200 [debug] [Thread-4  ]: Database Error in model current (models/groomed/current.sql)
  No matching signature for operator = for argument types: INT64, STRING. Supported signature: ANY = ANY at [46:15]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:40:04.038955 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16af2561-2d6a-41c0-b683-705673e0574b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106bfdf0>]}
[0m12:40:04.039893 [error] [Thread-4  ]: 3 of 5 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 1.78s]
[0m12:40:04.040804 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m12:40:04.042464 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m12:40:04.043286 [info ] [Thread-2  ]: 5 of 5 SKIP relation analytics.positions ....................................... [[33mSKIP[0m]
[0m12:40:04.044153 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m12:40:04.046793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:04.047312 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:40:04.047882 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:40:04.048320 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:40:04.048830 [info ] [MainThread]: 
[0m12:40:04.049352 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 9.45 seconds (9.45s).
[0m12:40:04.051159 [debug] [MainThread]: Command end result
[0m12:40:04.073861 [info ] [MainThread]: 
[0m12:40:04.074552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:04.075227 [info ] [MainThread]: 
[0m12:40:04.075939 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  No matching signature for operator = for argument types: INT64, STRING. Supported signature: ANY = ANY at [46:15]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:40:04.076534 [info ] [MainThread]: 
[0m12:40:04.077149 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m12:40:04.081268 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 10.847325, "process_user_time": 4.85472, "process_kernel_time": 0.566601, "process_mem_max_rss": "134291456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:40:04.082208 [debug] [MainThread]: Command `cli build` failed at 12:40:04.082006 after 10.85 seconds
[0m12:40:04.082854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ddf10>]}
[0m12:40:04.083458 [debug] [MainThread]: Flushing usage events
[0m12:40:37.496385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdaee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8811f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b0d60>]}


============================== 12:40:37.504644 | 5a1d40fe-0098-4641-94e5-524c4e202e4c ==============================
[0m12:40:37.504644 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:40:37.506067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:40:38.467819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b7a30>]}
[0m12:40:38.625248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b7a00>]}
[0m12:40:38.628072 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:40:38.659821 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:40:38.733156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:38.733839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:38.743947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea2a0d0>]}
[0m12:40:38.766522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e950610>]}
[0m12:40:38.767333 [info ] [MainThread]: Found 5 models, 4 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:40:38.771189 [info ] [MainThread]: 
[0m12:40:38.773577 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:38.776055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:40:38.776830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:41.137807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:40:41.138842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:41.432308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82f8e0>]}
[0m12:40:41.433793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:41.434629 [info ] [MainThread]: 
[0m12:40:41.439882 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m12:40:41.440729 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m12:40:41.441553 [info ] [Thread-1  ]: 1 of 11 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m12:40:41.442332 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m12:40:41.443048 [info ] [Thread-2  ]: 2 of 11 START seed file analytics.0417_current ................................. [RUN]
[0m12:40:41.444439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m12:40:41.445322 [info ] [Thread-3  ]: 3 of 11 START seed file analytics.0417_history ................................. [RUN]
[0m12:40:41.446793 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m12:40:41.447492 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m12:40:41.448653 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:40:41.449337 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m12:40:41.469114 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m12:40:41.470262 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m12:40:41.471080 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 12:40:41.470696 => 12:40:41.470701
[0m12:40:41.472206 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 12:40:41.471829 => 12:40:41.471834
[0m12:40:41.472894 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m12:40:41.473618 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m12:40:41.474461 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 12:40:41.449828 => 12:40:41.474032
[0m12:40:41.514723 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m12:40:41.579884 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:40:41.606884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:41.681073 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:40:42.027630 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m12:40:42.028978 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:40:42.482837 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dca54a0c-090a-4d5c-913c-0319d9b1474c&page=queryresults
[0m12:40:44.481292 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 12:40:41.565338 => 12:40:44.480982
[0m12:40:44.482362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecaab50>]}
[0m12:40:44.483150 [info ] [Thread-1  ]: 1 of 11 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.04s]
[0m12:40:44.484099 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m12:40:44.485065 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:40:44.485788 [info ] [Thread-4  ]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m12:40:44.486682 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:40:44.487653 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:40:44.488265 [info ] [Thread-1  ]: 5 of 11 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m12:40:44.490208 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:40:44.491965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m12:40:44.512185 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:40:44.512849 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:40:44.522933 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m12:40:44.524195 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 12:40:44.493079 => 12:40:44.523772
[0m12:40:44.524770 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:40:44.531302 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 12:40:44.513363 => 12:40:44.530694
[0m12:40:44.543391 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:40:44.552160 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:40:44.558970 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m12:40:44.560924 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:40:44.561749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:44.562839 [debug] [Thread-4  ]: On test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m12:40:44.563697 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:45.143479 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:81c3d079-0dc7-42ab-8bd3-2d5e55af2362&page=queryresults
[0m12:40:45.360453 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:423359c2-0934-411c-9082-f8cedaeeb28b&page=queryresults
[0m12:40:45.841479 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:40:45.850553 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 12:40:44.525112 => 12:40:45.849763
[0m12:40:45.853195 [error] [Thread-4  ]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.37s]
[0m12:40:45.855033 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:40:45.940337 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:40:45.981385 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 12:40:44.552597 => 12:40:45.980639
[0m12:40:45.983393 [info ] [Thread-1  ]: 5 of 11 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.49s]
[0m12:40:45.985136 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:40:45.986465 [debug] [Thread-4  ]: Began running node model.ccwj.my_second_dbt_model
[0m12:40:45.987342 [info ] [Thread-4  ]: 6 of 11 SKIP relation analytics.my_second_dbt_model ............................ [[33mSKIP[0m]
[0m12:40:45.988186 [debug] [Thread-4  ]: Finished running node model.ccwj.my_second_dbt_model
[0m12:40:45.989197 [debug] [Thread-1  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:40:45.989961 [debug] [Thread-4  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:40:45.990667 [info ] [Thread-1  ]: 7 of 11 SKIP test not_null_my_second_dbt_model_id .............................. [[33mSKIP[0m]
[0m12:40:45.991475 [info ] [Thread-4  ]: 8 of 11 SKIP test unique_my_second_dbt_model_id ................................ [[33mSKIP[0m]
[0m12:40:45.992307 [debug] [Thread-1  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:40:45.992956 [debug] [Thread-4  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:40:46.191336 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4e7803a0-1169-421f-9462-142589f2c53a&page=queryresults
[0m12:40:46.286490 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2dc356d3-1105-422d-86ce-ffc5419e36d9&page=queryresults
[0m12:40:46.656367 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:40:46.661445 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 12:40:41.497826 => 12:40:46.661069
[0m12:40:46.662736 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaed9a0>]}
[0m12:40:46.663740 [info ] [Thread-3  ]: 3 of 11 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.21s]
[0m12:40:46.664886 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m12:40:46.665809 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m12:40:46.666507 [info ] [Thread-1  ]: 9 of 11 START sql view model analytics.history ................................. [RUN]
[0m12:40:46.667584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.history)
[0m12:40:46.668198 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m12:40:46.673241 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:40:46.674505 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 12:40:46.668573 => 12:40:46.674133
[0m12:40:46.675098 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m12:40:46.705823 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:40:46.707301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:46.708080 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m12:40:46.720217 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:40:46.724139 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 12:40:41.474825 => 12:40:46.723813
[0m12:40:46.725156 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac6f70>]}
[0m12:40:46.725920 [info ] [Thread-2  ]: 2 of 11 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 4[0m in 5.28s]
[0m12:40:46.726915 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m12:40:46.728176 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m12:40:46.729009 [info ] [Thread-3  ]: 10 of 11 START sql view model analytics.current ................................ [RUN]
[0m12:40:46.730746 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current)
[0m12:40:46.731512 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m12:40:46.736427 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:40:46.737584 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 12:40:46.731899 => 12:40:46.737235
[0m12:40:46.738140 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m12:40:46.743906 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:40:46.745410 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:40:46.746250 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:40:47.168181 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a3952faf-094c-4e9f-8715-41664f650c7f&page=queryresults
[0m12:40:47.259405 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:afc6f9f2-b624-4ab5-afe6-63edd8fec753&page=queryresults
[0m12:40:47.522191 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 12:40:46.738483 => 12:40:47.521752
[0m12:40:47.523665 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec6a60>]}
[0m12:40:47.524557 [info ] [Thread-3  ]: 10 of 11 OK created sql view model analytics.current ........................... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m12:40:47.525669 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m12:40:47.563451 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 12:40:46.675457 => 12:40:47.563116
[0m12:40:47.564560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee2e7f0>]}
[0m12:40:47.565377 [info ] [Thread-1  ]: 9 of 11 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m12:40:47.566260 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m12:40:47.567570 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m12:40:47.568430 [info ] [Thread-2  ]: 11 of 11 START sql view model analytics.positions .............................. [RUN]
[0m12:40:47.570502 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.positions)
[0m12:40:47.571258 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m12:40:47.581355 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m12:40:47.582704 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 12:40:47.571788 => 12:40:47.582306
[0m12:40:47.583519 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m12:40:47.589086 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m12:40:47.590183 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:40:47.590867 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    *
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m12:40:48.129935 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e790929a-9847-41d7-9b40-a7cf30828fd3&page=queryresults
[0m12:40:48.748957 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 12:40:47.583897 => 12:40:48.748523
[0m12:40:48.750504 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1d40fe-0098-4641-94e5-524c4e202e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec45b0>]}
[0m12:40:48.751418 [info ] [Thread-2  ]: 11 of 11 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m12:40:48.752436 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m12:40:48.755244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:48.755879 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:40:48.756397 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m12:40:48.757028 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:40:48.757541 [debug] [MainThread]: Connection 'test.ccwj.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m12:40:48.758107 [info ] [MainThread]: 
[0m12:40:48.758642 [info ] [MainThread]: Finished running 1 table model, 4 tests, 4 view models, 2 seeds in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m12:40:48.761414 [debug] [MainThread]: Command end result
[0m12:40:48.775816 [info ] [MainThread]: 
[0m12:40:48.776765 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:48.777415 [info ] [MainThread]: 
[0m12:40:48.777978 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m12:40:48.778489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:40:48.779257 [info ] [MainThread]: 
[0m12:40:48.780171 [info ] [MainThread]:   compiled Code at target/compiled/ccwj/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m12:40:48.780915 [info ] [MainThread]: 
[0m12:40:48.782088 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=3 TOTAL=11
[0m12:40:48.786684 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.402074, "process_user_time": 5.350667, "process_kernel_time": 0.618099, "process_mem_max_rss": "137388032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:40:48.787784 [debug] [MainThread]: Command `cli build` failed at 12:40:48.787530 after 11.40 seconds
[0m12:40:48.788467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdaee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e64b790>]}
[0m12:40:48.789080 [debug] [MainThread]: Flushing usage events
[0m12:41:25.237416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d30220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5eaf0>]}


============================== 12:41:25.243637 | 77366bef-cb15-4fc6-9453-5e85409c5ab3 ==============================
[0m12:41:25.243637 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:41:25.244897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:25.962867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1c100>]}
[0m12:41:26.104474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdca00>]}
[0m12:41:26.105614 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:41:26.130306 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:41:26.198107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:26.198728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:26.208780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed30d0>]}
[0m12:41:26.227952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add62e0>]}
[0m12:41:26.228822 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:41:26.232284 [info ] [MainThread]: 
[0m12:41:26.233862 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:41:26.236042 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:41:26.236822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:27.846686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:41:27.848646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:28.158298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac99910>]}
[0m12:41:28.159786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:28.160468 [info ] [MainThread]: 
[0m12:41:28.165245 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m12:41:28.166204 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m12:41:28.167173 [info ] [Thread-1  ]: 1 of 10 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m12:41:28.168046 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m12:41:28.168860 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m12:41:28.170174 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m12:41:28.170998 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m12:41:28.172418 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m12:41:28.173251 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m12:41:28.174530 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:41:28.175379 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m12:41:28.190501 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m12:41:28.191302 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m12:41:28.192153 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 12:41:28.191764 => 12:41:28.191770
[0m12:41:28.193505 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 12:41:28.192937 => 12:41:28.192943
[0m12:41:28.194432 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m12:41:28.195371 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m12:41:28.196255 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 12:41:28.175899 => 12:41:28.195865
[0m12:41:28.225418 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m12:41:28.287941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:41:28.309796 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:41:28.391466 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:41:28.706264 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m12:41:28.707623 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:41:29.249244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b460232a-ba01-4f8c-8401-66b8b3216329&page=queryresults
[0m12:41:31.159248 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 12:41:28.234046 => 12:41:31.158923
[0m12:41:31.160395 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff9bb0>]}
[0m12:41:31.161431 [info ] [Thread-1  ]: 1 of 10 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.99s]
[0m12:41:31.162577 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m12:41:31.163758 [debug] [Thread-4  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:41:31.164481 [info ] [Thread-4  ]: 4 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m12:41:31.165999 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ccwj.unique_my_first_dbt_model_id.16e066b321'
[0m12:41:31.166634 [debug] [Thread-4  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:41:31.180666 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m12:41:31.181951 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 12:41:31.166978 => 12:41:31.181543
[0m12:41:31.182601 [debug] [Thread-4  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:41:31.206106 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m12:41:31.207522 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:41:31.208258 [debug] [Thread-4  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:31.924530 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:41:31.949696 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5c6e66fd-b870-41d8-8988-a822712a9add&page=queryresults
[0m12:41:32.212822 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8469e5f0-016e-49e7-8a31-c012d1b85dcf&page=queryresults
[0m12:41:32.529019 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:41:32.532864 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 12:41:28.196671 => 12:41:32.532551
[0m12:41:32.533929 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6fa60>]}
[0m12:41:32.535072 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 4[0m in 4.36s]
[0m12:41:32.536477 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m12:41:32.537474 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:41:32.538219 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m12:41:32.539388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.current)
[0m12:41:32.540253 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:41:32.546030 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:41:32.547960 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:41:32.540726 => 12:41:32.547418
[0m12:41:32.548690 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:41:32.583510 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:41:32.584359 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:41:32.586931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:41:32.588361 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    security_type
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:41:32.637976 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 12:41:31.182948 => 12:41:32.637564
[0m12:41:32.639347 [info ] [Thread-4  ]: 4 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.47s]
[0m12:41:32.640395 [debug] [Thread-4  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m12:41:32.641465 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m12:41:32.642198 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m12:41:32.643460 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.my_second_dbt_model)
[0m12:41:32.644053 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m12:41:32.649417 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m12:41:32.650552 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 12:41:32.644395 => 12:41:32.650222
[0m12:41:32.651269 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m12:41:32.656948 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m12:41:32.658028 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:41:32.658927 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m12:41:32.970368 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:85199cc7-fe74-4e20-bb9d-31283f43c3b4&page=queryresults
[0m12:41:33.107948 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ec9ae4e8-8a09-4918-ad6d-7318ff635242&page=queryresults
[0m12:41:33.150945 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6ae9f490-6433-4d57-bb71-5311f0d359d2&page=queryresults
[0m12:41:33.338317 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:41:33.343612 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 12:41:28.203272 => 12:41:33.343235
[0m12:41:33.344960 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af88040>]}
[0m12:41:33.345823 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.17s]
[0m12:41:33.347031 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m12:41:33.348239 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m12:41:33.349067 [info ] [Thread-4  ]: 7 of 10 START sql view model analytics.history ................................. [RUN]
[0m12:41:33.350404 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.history)
[0m12:41:33.351045 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m12:41:33.355555 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:41:33.356640 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 12:41:33.351428 => 12:41:33.356303
[0m12:41:33.357183 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m12:41:33.362064 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:41:33.363098 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:41:33.363818 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m12:41:33.700424 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:41:32.549210 => 12:41:33.700099
[0m12:41:33.701528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31abb0>]}
[0m12:41:33.702350 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m12:41:33.703229 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:41:33.758551 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 12:41:32.651630 => 12:41:33.758188
[0m12:41:33.759873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34eeb0>]}
[0m12:41:33.760753 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m12:41:33.761643 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m12:41:33.762605 [debug] [Thread-3  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:41:33.763276 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:41:33.763848 [info ] [Thread-3  ]: 8 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m12:41:33.764639 [info ] [Thread-1  ]: 9 of 10 START test unique_my_second_dbt_model_id ............................... [RUN]
[0m12:41:33.766106 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m12:41:33.767063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m12:41:33.767672 [debug] [Thread-3  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:41:33.768223 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:41:33.788759 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m12:41:33.783591 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:41:33.790374 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 12:41:33.768584 => 12:41:33.789958
[0m12:41:33.791109 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 12:41:33.777924 => 12:41:33.790754
[0m12:41:33.791684 [debug] [Thread-3  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:41:33.792291 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:41:33.796736 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m12:41:33.800557 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:41:33.802488 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:41:33.803344 [debug] [Thread-3  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m12:41:33.805134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:41:33.806173 [debug] [Thread-1  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:33.809606 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0e1506d6-1c85-4694-8fb8-e9e64f2e91a2&page=queryresults
[0m12:41:34.264084 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 12:41:33.357549 => 12:41:34.263713
[0m12:41:34.265423 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af43a00>]}
[0m12:41:34.266362 [info ] [Thread-4  ]: 7 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m12:41:34.267549 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m12:41:34.268633 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m12:41:34.269371 [info ] [Thread-2  ]: 10 of 10 START sql view model analytics.positions .............................. [RUN]
[0m12:41:34.270758 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now model.ccwj.positions)
[0m12:41:34.271405 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m12:41:34.276444 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m12:41:34.277602 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 12:41:34.271776 => 12:41:34.277241
[0m12:41:34.278413 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m12:41:34.283428 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m12:41:34.285007 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:41:34.285842 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    *
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m12:41:34.415236 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bc151cb7-1e20-4bfb-84d2-8c3ab29c7099&page=queryresults
[0m12:41:34.536433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:35a494f6-b42b-4438-8bad-d68e3a692aa4&page=queryresults
[0m12:41:34.999585 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 12:41:33.792737 => 12:41:34.999111
[0m12:41:35.001374 [info ] [Thread-3  ]: 8 of 10 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.24s]
[0m12:41:35.002550 [debug] [Thread-3  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m12:41:35.078260 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:96514662-2bd9-4c07-8be2-3f8e1366d802&page=queryresults
[0m12:41:35.178530 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 12:41:33.797216 => 12:41:35.178021
[0m12:41:35.180117 [info ] [Thread-1  ]: 9 of 10 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 1.41s]
[0m12:41:35.181272 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m12:41:35.503804 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 12:41:34.278794 => 12:41:35.503438
[0m12:41:35.505083 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77366bef-cb15-4fc6-9453-5e85409c5ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af43820>]}
[0m12:41:35.505980 [info ] [Thread-2  ]: 10 of 10 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m12:41:35.507242 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m12:41:35.509864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:35.510383 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:41:35.510825 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m12:41:35.511250 [debug] [MainThread]: Connection 'test.ccwj.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m12:41:35.511674 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:41:35.512200 [info ] [MainThread]: 
[0m12:41:35.512733 [info ] [MainThread]: Finished running 1 table model, 2 seeds, 3 tests, 4 view models in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m12:41:35.515675 [debug] [MainThread]: Command end result
[0m12:41:35.537743 [info ] [MainThread]: 
[0m12:41:35.538462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:35.539273 [info ] [MainThread]: 
[0m12:41:35.540146 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m12:41:35.544134 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.399091, "process_user_time": 4.920784, "process_kernel_time": 0.507168, "process_mem_max_rss": "139456512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:35.545160 [debug] [MainThread]: Command `cli build` succeeded at 12:41:35.544889 after 10.40 seconds
[0m12:41:35.545939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acbe760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f1730>]}
[0m12:41:35.546963 [debug] [MainThread]: Flushing usage events
[0m12:49:41.448825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e24e20>]}


============================== 12:49:41.455477 | e6e83fda-0eb1-42c1-9d79-84be9b014bdd ==============================
[0m12:49:41.455477 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:49:41.456297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:42.251012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b14580>]}
[0m12:49:42.370771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc26d0>]}
[0m12:49:42.372188 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:49:42.394517 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:49:42.455649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:42.456234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:42.464795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f999a0>]}
[0m12:49:42.481718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3190>]}
[0m12:49:42.482544 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:49:42.483117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec34c0>]}
[0m12:49:42.485401 [info ] [MainThread]: 
[0m12:49:42.486556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:49:42.488041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:49:42.488662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:44.276484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:49:44.277509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:44.575359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c87100>]}
[0m12:49:44.577117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:44.577833 [info ] [MainThread]: 
[0m12:49:44.582714 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:49:44.583431 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:49:44.584292 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m12:49:44.585106 [info ] [Thread-2  ]: 2 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m12:49:44.586239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:49:44.587338 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:49:44.587918 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:49:44.588464 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:49:44.589186 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:49:44.588846 => 12:49:44.588853
[0m12:49:44.589840 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:49:44.589542 => 12:49:44.589544
[0m12:49:44.590391 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:49:44.591017 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:49:44.634200 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:49:44.723629 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:49:48.339302 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:49:48.734564 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f2ef1e2a-f383-41de-ab46-2327a42962b0&page=queryresults
[0m12:49:48.912421 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:49:49.086367 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:49:49.109478 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:49:44.591384 => 12:49:49.109185
[0m12:49:49.110630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901cfa0>]}
[0m12:49:49.111323 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 12[0m in 4.52s]
[0m12:49:49.112250 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:49:49.273011 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:da286f06-57eb-43e8-bdc6-7e94942d244c&page=queryresults
[0m12:49:49.687708 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:49:49.693001 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:49:44.614516 => 12:49:49.692643
[0m12:49:49.694123 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e83fda-0eb1-42c1-9d79-84be9b014bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c491f0>]}
[0m12:49:49.694947 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 5.11s]
[0m12:49:49.695900 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:49:49.698347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:49.698808 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:49:49.699228 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:49:49.699697 [info ] [MainThread]: 
[0m12:49:49.700433 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m12:49:49.702346 [debug] [MainThread]: Command end result
[0m12:49:49.715855 [info ] [MainThread]: 
[0m12:49:49.716631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:49.717309 [info ] [MainThread]: 
[0m12:49:49.718063 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:49:49.721415 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.358029, "process_user_time": 3.881752, "process_kernel_time": 0.469531, "process_mem_max_rss": "133296128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:49:49.722399 [debug] [MainThread]: Command `dbt seed` succeeded at 12:49:49.722154 after 8.36 seconds
[0m12:49:49.723235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c84670>]}
[0m12:49:49.723789 [debug] [MainThread]: Flushing usage events
[0m12:51:36.421638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d64f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12afa0>]}


============================== 12:51:36.428764 | a88cc65f-cdf0-4c29-b04b-f870d2f8d41e ==============================
[0m12:51:36.428764 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:51:36.430090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:51:37.265633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e1790>]}
[0m12:51:37.531476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff78640>]}
[0m12:51:37.533514 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:51:37.573949 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:51:37.669477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:37.670587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:37.682788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102990d0>]}
[0m12:51:37.705006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110199130>]}
[0m12:51:37.705859 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:51:37.706513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110199340>]}
[0m12:51:37.709789 [info ] [MainThread]: 
[0m12:51:37.712204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:37.714842 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:51:37.715922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:39.465284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:51:39.466797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:40.319548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffdb2b0>]}
[0m12:51:40.321195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:40.322160 [info ] [MainThread]: 
[0m12:51:40.325903 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:51:40.326837 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:51:40.328197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:51:40.329047 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:51:40.342985 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:51:40.345040 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:51:40.329462 => 12:51:40.344657
[0m12:51:40.345610 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:51:40.402464 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:51:40.404395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:51:40.405507 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_low,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:51:40.982598 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1c748944-f98c-4840-a523-a13e07560f63&page=queryresults
[0m12:51:41.285961 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name annual_week_low at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name annual_week_low at [6:6]')
[0m12:51:41.874422 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dc217500-2a51-41dd-b4bb-f96221fa5934&page=queryresults
[0m12:51:42.221122 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dc217500-2a51-41dd-b4bb-f96221fa5934&page=queryresults
[0m12:51:42.222350 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:51:40.345978 => 12:51:42.221894
[0m12:51:42.238905 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  CREATE VIEW has columns with duplicate name annual_week_low at [6:6]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:51:42.239852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88cc65f-cdf0-4c29-b04b-f870d2f8d41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110299310>]}
[0m12:51:42.240828 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 1.91s]
[0m12:51:42.241939 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:51:42.244498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:42.245094 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:51:42.246057 [info ] [MainThread]: 
[0m12:51:42.246851 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m12:51:42.248421 [debug] [MainThread]: Command end result
[0m12:51:42.274937 [info ] [MainThread]: 
[0m12:51:42.275855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:51:42.277016 [info ] [MainThread]: 
[0m12:51:42.278226 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  CREATE VIEW has columns with duplicate name annual_week_low at [6:6]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:51:42.279113 [info ] [MainThread]: 
[0m12:51:42.280192 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:51:42.283131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.961024, "process_user_time": 4.610614, "process_kernel_time": 0.476603, "process_mem_max_rss": "128274432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:51:42.284327 [debug] [MainThread]: Command `cli run` failed at 12:51:42.284046 after 5.96 seconds
[0m12:51:42.284977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d64f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf0e7f0>]}
[0m12:51:42.285557 [debug] [MainThread]: Flushing usage events
[0m12:52:04.805780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d9c40>]}


============================== 12:52:04.811924 | 340dd38d-856b-4152-a04c-6a3064c1a548 ==============================
[0m12:52:04.811924 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:52:04.812801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:05.488559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b7d30>]}
[0m12:52:05.617239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775ed00>]}
[0m12:52:05.618309 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:52:05.641341 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:52:05.708685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:05.709299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:05.718575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795b0d0>]}
[0m12:52:05.736040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107883190>]}
[0m12:52:05.736791 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:52:05.737391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107883580>]}
[0m12:52:05.739856 [info ] [MainThread]: 
[0m12:52:05.741136 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:05.742787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:52:05.743558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:07.211875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:52:07.213113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:07.509860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107929b20>]}
[0m12:52:07.511551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:07.512219 [info ] [MainThread]: 
[0m12:52:07.515969 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:52:07.516605 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:52:07.539651 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m12:52:07.541116 [info ] [Thread-2  ]: 2 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m12:52:07.542906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:52:07.544906 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:52:07.546020 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:52:07.546626 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:52:07.547460 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:52:07.547066 => 12:52:07.547071
[0m12:52:07.548188 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:52:07.547859 => 12:52:07.547864
[0m12:52:07.548763 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:52:07.549320 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:52:07.613346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:07.706702 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:52:12.492546 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:52:12.817286 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:be177cac-61a2-4044-a596-bbdc210c898c&page=queryresults
[0m12:52:13.222288 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:52:13.241075 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:52:07.549760 => 12:52:13.240760
[0m12:52:13.242083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dcfa0>]}
[0m12:52:13.242792 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 12[0m in 5.70s]
[0m12:52:13.243819 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:52:13.821016 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:52:14.150383 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c62c4f50-aacc-463c-8504-f495f8e651f4&page=queryresults
[0m12:52:14.533557 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:52:14.537079 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:52:07.572019 => 12:52:14.536783
[0m12:52:14.538015 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '340dd38d-856b-4152-a04c-6a3064c1a548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a05b80>]}
[0m12:52:14.538688 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2482[0m in 6.99s]
[0m12:52:14.539593 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:52:14.541936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:14.542478 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:52:14.543073 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:52:14.543819 [info ] [MainThread]: 
[0m12:52:14.544819 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 8.80 seconds (8.80s).
[0m12:52:14.546566 [debug] [MainThread]: Command end result
[0m12:52:14.558880 [info ] [MainThread]: 
[0m12:52:14.559617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:14.560297 [info ] [MainThread]: 
[0m12:52:14.561209 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:52:14.563499 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 9.8429985, "process_user_time": 4.165781, "process_kernel_time": 0.390044, "process_mem_max_rss": "132059136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:14.564968 [debug] [MainThread]: Command `dbt seed` succeeded at 12:52:14.564626 after 9.84 seconds
[0m12:52:14.565839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107720d00>]}
[0m12:52:14.566672 [debug] [MainThread]: Flushing usage events
[0m12:52:20.849016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105306b20>]}


============================== 12:52:20.856695 | 5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471 ==============================
[0m12:52:20.856695 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:52:20.857629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:52:21.631625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bdd00>]}
[0m12:52:21.787253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a8880>]}
[0m12:52:21.788763 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:52:21.817058 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:52:21.896397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:21.897069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:21.907653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064760d0>]}
[0m12:52:21.930956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106375220>]}
[0m12:52:21.932221 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:52:21.933101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106375610>]}
[0m12:52:21.935980 [info ] [MainThread]: 
[0m12:52:21.937387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:21.939406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:52:21.940202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:23.571827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:52:23.589707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:23.950259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ee0a0>]}
[0m12:52:23.951803 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:23.952441 [info ] [MainThread]: 
[0m12:52:23.956177 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:52:23.957103 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:52:23.958841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:52:23.959632 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:52:23.973798 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:52:23.975247 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:52:23.960078 => 12:52:23.974755
[0m12:52:23.975991 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:52:24.024158 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:52:24.025638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:24.026836 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:52:24.672047 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4a350e4b-5e56-404a-8ad8-ff63a1484246&page=queryresults
[0m12:52:24.994402 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]; reason: invalidQuery, location: query, message: Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]')
[0m12:52:26.244006 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ca7c5cff-4094-4629-ac9d-43e628f68845&page=queryresults
[0m12:52:26.597363 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ca7c5cff-4094-4629-ac9d-43e628f68845&page=queryresults
[0m12:52:26.599926 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:52:23.976459 => 12:52:26.599037
[0m12:52:26.607391 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:52:26.608329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd0a068-eb0a-4cbb-98d1-6c4c0ceba471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645bbb0>]}
[0m12:52:26.609252 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 2.65s]
[0m12:52:26.610760 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:52:26.614140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:26.614657 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:52:26.615134 [info ] [MainThread]: 
[0m12:52:26.615801 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m12:52:26.617413 [debug] [MainThread]: Command end result
[0m12:52:26.647066 [info ] [MainThread]: 
[0m12:52:26.647905 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:26.648782 [info ] [MainThread]: 
[0m12:52:26.649759 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:52:26.650715 [info ] [MainThread]: 
[0m12:52:26.652045 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:26.655279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9077997, "process_user_time": 4.585555, "process_kernel_time": 0.474315, "process_mem_max_rss": "129265664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:26.656611 [debug] [MainThread]: Command `cli run` failed at 12:52:26.656303 after 5.91 seconds
[0m12:52:26.657397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cff40>]}
[0m12:52:26.658162 [debug] [MainThread]: Flushing usage events
[0m12:53:11.489657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c6fa0>]}


============================== 12:53:11.496936 | 1079782f-55f1-478d-bb7e-53f3bfb1c680 ==============================
[0m12:53:11.496936 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:53:11.498343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:12.394968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88f160>]}
[0m12:53:12.568769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e780040>]}
[0m12:53:12.570169 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:53:12.600850 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:53:12.681367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:12.682058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:12.693117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea36fd0>]}
[0m12:53:12.714383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e935160>]}
[0m12:53:12.715228 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:53:12.716097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e935550>]}
[0m12:53:12.718920 [info ] [MainThread]: 
[0m12:53:12.720429 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:53:12.722252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:53:12.723176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:14.532833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:53:14.534230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:15.156708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e715b80>]}
[0m12:53:15.159024 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:15.160148 [info ] [MainThread]: 
[0m12:53:15.165685 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:53:15.167250 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:53:15.169479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:53:15.170194 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:53:15.189019 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:53:15.194727 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:53:15.170641 => 12:53:15.191130
[0m12:53:15.196072 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:53:15.299460 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:53:15.331231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:15.353051 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:53:15.865217 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a08a22a9-f410-4b71-adad-850097a238ab&page=queryresults
[0m12:53:16.207978 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]; reason: invalidQuery, location: query, message: Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]')
[0m12:53:16.925688 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:83616d24-43ac-4ae5-8012-09df333d30ff&page=queryresults
[0m12:53:17.282760 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:83616d24-43ac-4ae5-8012-09df333d30ff&page=queryresults
[0m12:53:17.284010 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:53:15.196720 => 12:53:17.283559
[0m12:53:17.291660 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:53:17.292750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1079782f-55f1-478d-bb7e-53f3bfb1c680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea36c70>]}
[0m12:53:17.293929 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 2.12s]
[0m12:53:17.295133 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:53:17.299061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:17.299909 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:53:17.300680 [info ] [MainThread]: 
[0m12:53:17.301324 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m12:53:17.302475 [debug] [MainThread]: Command end result
[0m12:53:17.331115 [info ] [MainThread]: 
[0m12:53:17.332365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:17.333143 [info ] [MainThread]: 
[0m12:53:17.334029 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  Unrecognized name: annual_week_high; Did you mean annual_week_low? at [56:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:53:17.335297 [info ] [MainThread]: 
[0m12:53:17.336366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:53:17.338782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9665494, "process_user_time": 5.047664, "process_kernel_time": 0.554409, "process_mem_max_rss": "128311296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:53:17.339968 [debug] [MainThread]: Command `cli run` failed at 12:53:17.339658 after 5.97 seconds
[0m12:53:17.341066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6137f0>]}
[0m12:53:17.342277 [debug] [MainThread]: Flushing usage events
[0m12:53:39.306368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6a7820>]}


============================== 12:53:39.311939 | bcc19eef-e19f-4682-9d65-f34a0f11f4b0 ==============================
[0m12:53:39.311939 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:53:39.312780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:39.954206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c318340>]}
[0m12:53:40.075547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e505370>]}
[0m12:53:40.076595 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:53:40.098585 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:53:40.160957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:40.161541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:40.170199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e826940>]}
[0m12:53:40.186931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7500d0>]}
[0m12:53:40.187638 [info ] [MainThread]: Found 5 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:53:40.188203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e750460>]}
[0m12:53:40.190518 [info ] [MainThread]: 
[0m12:53:40.191708 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:53:40.193247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:53:40.194055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:41.568661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:53:41.569869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:41.865117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5da190>]}
[0m12:53:41.866832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:41.867530 [info ] [MainThread]: 
[0m12:53:41.870859 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:53:41.871510 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:53:41.872156 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m12:53:41.872915 [info ] [Thread-2  ]: 2 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m12:53:41.874083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:53:41.875170 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:53:41.875766 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:53:41.876329 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:53:41.877062 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:53:41.876710 => 12:53:41.876714
[0m12:53:41.877735 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:53:41.877411 => 12:53:41.877414
[0m12:53:41.878492 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:53:41.879080 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:53:41.931980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:42.014663 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:53:45.608002 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:53:45.795215 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:53:45.931216 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:62553e90-d85f-43a0-810e-6ad0024ffe26&page=queryresults
[0m12:53:46.112313 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa08aa95-138a-41e7-891d-ba542d8150a7&page=queryresults
[0m12:53:46.265801 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:53:46.292098 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:53:41.879447 => 12:53:46.291793
[0m12:53:46.293197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a9eb0>]}
[0m12:53:46.294133 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mCREATE 12[0m in 4.42s]
[0m12:53:46.295194 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:53:46.431645 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:53:46.438035 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:53:41.901410 => 12:53:46.437537
[0m12:53:46.439279 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc19eef-e19f-4682-9d65-f34a0f11f4b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8d2e20>]}
[0m12:53:46.440100 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file analytics.0417_history .............................. [[32mCREATE 2482[0m in 4.56s]
[0m12:53:46.441230 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:53:46.444258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:46.444737 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:53:46.445312 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:53:46.445849 [info ] [MainThread]: 
[0m12:53:46.446489 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m12:53:46.447961 [debug] [MainThread]: Command end result
[0m12:53:46.461496 [info ] [MainThread]: 
[0m12:53:46.462616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:46.463499 [info ] [MainThread]: 
[0m12:53:46.464178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:53:46.466362 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.2427087, "process_user_time": 3.872648, "process_kernel_time": 0.365845, "process_mem_max_rss": "132964352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:53:46.467822 [debug] [MainThread]: Command `dbt seed` succeeded at 12:53:46.467443 after 7.24 seconds
[0m12:53:46.468986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e59fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e53a190>]}
[0m12:53:46.470090 [debug] [MainThread]: Flushing usage events
[0m10:03:30.672289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103164370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c66e20>]}


============================== 10:03:30.680913 | 2c733ded-0f91-4a83-aa0b-bad9a73bb172 ==============================
[0m10:03:30.680913 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:03:30.681932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:03:31.756315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c25190>]}
[0m10:03:31.932579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a273a0>]}
[0m10:03:31.934494 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:03:31.967332 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:03:32.055345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:32.056498 [debug] [MainThread]: Partial parsing: updated file: ccwj://models/intermediate/overall_position_performance.sql
[0m10:03:32.293135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f02e50>]}
[0m10:03:32.313168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cee4f0>]}
[0m10:03:32.314130 [info ] [MainThread]: Found 7 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:03:32.315231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceed00>]}
[0m10:03:32.319214 [info ] [MainThread]: 
[0m10:03:32.320734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:03:32.322439 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:03:32.323219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:34.247890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:03:34.248787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:34.613526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dac820>]}
[0m10:03:34.615424 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:34.616058 [info ] [MainThread]: 
[0m10:03:34.621905 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m10:03:34.622815 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m10:03:34.624492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m10:03:34.625335 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m10:03:34.638857 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:03:34.640769 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 10:03:34.625718 => 10:03:34.640352
[0m10:03:34.641329 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m10:03:34.688573 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:03:34.690667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:03:34.691786 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
limit 100;


[0m10:03:35.240379 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0b9c6f2a-5a63-4958-93fe-5e8021d0b626&page=queryresults
[0m10:03:35.680527 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 10:03:34.641673 => 10:03:35.680048
[0m10:03:35.682010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c733ded-0f91-4a83-aa0b-bad9a73bb172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff5f40>]}
[0m10:03:35.682948 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m10:03:35.684093 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m10:03:35.686630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:35.687290 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:03:35.687859 [info ] [MainThread]: 
[0m10:03:35.688444 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m10:03:35.690132 [debug] [MainThread]: Command end result
[0m10:03:35.711183 [info ] [MainThread]: 
[0m10:03:35.711912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:35.712682 [info ] [MainThread]: 
[0m10:03:35.713486 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:03:35.717940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1651707, "process_user_time": 5.160141, "process_kernel_time": 0.623049, "process_mem_max_rss": "131076096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:03:35.719633 [debug] [MainThread]: Command `cli run` succeeded at 10:03:35.719214 after 5.17 seconds
[0m10:03:35.721258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103164370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8d3d0>]}
[0m10:03:35.722374 [debug] [MainThread]: Flushing usage events
[0m10:10:14.229080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a60d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105575d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105563dc0>]}


============================== 10:10:14.237719 | cd8856fd-d2d6-4e55-8ad4-348409dadc1d ==============================
[0m10:10:14.237719 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:10:14.239049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:15.329986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d7c0>]}
[0m10:10:15.520844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e6f70>]}
[0m10:10:15.522952 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:10:15.557265 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:10:15.885190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:15.886257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:15.906209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eb0d0>]}
[0m10:10:15.951508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ef490>]}
[0m10:10:15.953383 [info ] [MainThread]: Found 7 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:10:15.955853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efbe0>]}
[0m10:10:15.960551 [info ] [MainThread]: 
[0m10:10:15.963285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:10:15.966229 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:10:15.967372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:19.358018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:10:19.359784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:19.695396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ef040>]}
[0m10:10:19.697013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:19.697680 [info ] [MainThread]: 
[0m10:10:19.702264 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m10:10:19.703541 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m10:10:19.705020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m10:10:19.705737 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m10:10:19.725306 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:10:19.727333 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 10:10:19.706164 => 10:10:19.726887
[0m10:10:19.727995 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m10:10:19.793624 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:10:19.794906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:10:19.795740 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT';


[0m10:10:20.526869 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:68def8ad-5aeb-4045-a034-edcefec475b0&page=queryresults
[0m10:10:20.949121 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 10:10:19.728394 => 10:10:20.948736
[0m10:10:20.950602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd8856fd-d2d6-4e55-8ad4-348409dadc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677ffd0>]}
[0m10:10:20.951681 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m10:10:20.952663 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m10:10:20.955072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:20.955579 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:10:20.956081 [info ] [MainThread]: 
[0m10:10:20.956722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m10:10:20.958266 [debug] [MainThread]: Command end result
[0m10:10:20.973674 [info ] [MainThread]: 
[0m10:10:20.974443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:20.975444 [info ] [MainThread]: 
[0m10:10:20.976662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:10:20.980222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8660746, "process_user_time": 5.032459, "process_kernel_time": 0.68764, "process_mem_max_rss": "126857216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:10:20.981121 [debug] [MainThread]: Command `cli run` succeeded at 10:10:20.980921 after 6.87 seconds
[0m10:10:20.981856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a60d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e6760>]}
[0m10:10:20.982489 [debug] [MainThread]: Flushing usage events
[0m10:22:31.743474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fcd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ecdc0>]}


============================== 10:22:31.751732 | b95880c8-b0de-4bd8-8da4-1194143c9a70 ==============================
[0m10:22:31.751732 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:22:31.752754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:32.831370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b5c40>]}
[0m10:22:32.995452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a0be0>]}
[0m10:22:32.997118 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:22:33.032040 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:22:33.117538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:33.118173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:33.129833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078780d0>]}
[0m10:22:33.152726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107796790>]}
[0m10:22:33.153718 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:22:33.154406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077968e0>]}
[0m10:22:33.156808 [info ] [MainThread]: 
[0m10:22:33.158160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:22:33.160977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:22:33.162693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:35.740834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:22:35.741858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:36.302465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750bb80>]}
[0m10:22:36.304314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:36.305205 [info ] [MainThread]: 
[0m10:22:36.313053 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:22:36.314471 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_dates ........................... [RUN]
[0m10:22:36.316046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:22:36.316875 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:22:36.331841 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:22:36.335317 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:22:36.317560 => 10:22:36.334463
[0m10:22:36.336259 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:22:36.404881 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:22:36.406240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:36.407011 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:22:37.097306 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dbfe3533-88e0-4322-a372-c4da40f663b6&page=queryresults
[0m10:22:37.552520 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:22:36.336898 => 10:22:37.552109
[0m10:22:37.553855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b95880c8-b0de-4bd8-8da4-1194143c9a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ad90>]}
[0m10:22:37.555227 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m10:22:37.556463 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:22:37.560469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:37.561706 [debug] [MainThread]: Connection 'model.ccwj.calendar_dates' was properly closed.
[0m10:22:37.562781 [info ] [MainThread]: 
[0m10:22:37.563704 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m10:22:37.565430 [debug] [MainThread]: Command end result
[0m10:22:37.584324 [info ] [MainThread]: 
[0m10:22:37.585631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:37.587727 [info ] [MainThread]: 
[0m10:22:37.589025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:22:37.593240 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9486427, "process_user_time": 4.576009, "process_kernel_time": 0.607385, "process_mem_max_rss": "127655936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:22:37.594299 [debug] [MainThread]: Command `cli run` succeeded at 10:22:37.594068 after 5.95 seconds
[0m10:22:37.594963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107668190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107656520>]}
[0m10:22:37.595583 [debug] [MainThread]: Flushing usage events
[0m12:05:19.866198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106343c10>]}


============================== 12:05:19.874199 | 7927ab05-8d8f-4a68-8d77-53cfc95045d4 ==============================
[0m12:05:19.874199 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:05:19.875155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:20.793992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107172340>]}
[0m12:05:20.944856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6f40>]}
[0m12:05:20.946541 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:05:20.984957 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:05:21.090262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:21.090887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:21.101260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074df0d0>]}
[0m12:05:21.125591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074010a0>]}
[0m12:05:21.126387 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:05:21.127240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107401af0>]}
[0m12:05:21.130082 [info ] [MainThread]: 
[0m12:05:21.131468 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:21.133658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:05:21.134351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:38.859434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:05:38.861627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:44.741754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071931f0>]}
[0m12:05:44.743246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:44.744145 [info ] [MainThread]: 
[0m12:05:44.749902 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m12:05:44.750951 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m12:05:44.752201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m12:05:44.752807 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m12:05:44.768772 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m12:05:44.770715 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 12:05:44.753160 => 12:05:44.770289
[0m12:05:44.771262 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m12:05:44.832582 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m12:05:44.834454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:44.835204 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with combined as (
select 
   symbol,
   current_date() as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
UNION ALL 
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)


select 
    daily_dates.day,
    daily_dates.symbol,
    round(sum(case when security_type = 'Equity' then amount end),2) as gain_or_loss_stock,
    round(sum(case when security_type = 'Option' then amount end),2) as gain_or_loss_option,
    round(sum(case when security_type in ('Option','Equity') then amount end),2) as gain_or_loss_stock_and_option,
from daily_dates 
    join combined 
        on combined.symbol = daily_dates.symbol
            and combined.date <= daily_dates.day 
where daily_dates.symbol = 'CFLT'
group by 1,2
order by 1 desc;


[0m12:05:48.653042 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ad92162d-2eec-4043-ac38-2249534828c3&page=queryresults
[0m12:05:55.358827 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 12:05:44.771593 => 12:05:55.358454
[0m12:05:55.360024 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7927ab05-8d8f-4a68-8d77-53cfc95045d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575be0>]}
[0m12:05:55.360935 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 10.61s]
[0m12:05:55.361850 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m12:05:55.364298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:55.364850 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m12:05:55.365347 [info ] [MainThread]: 
[0m12:05:55.366088 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 34.23 seconds (34.23s).
[0m12:05:55.367228 [debug] [MainThread]: Command end result
[0m12:05:55.385224 [info ] [MainThread]: 
[0m12:05:55.386127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:55.386933 [info ] [MainThread]: 
[0m12:05:55.387553 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:05:55.392570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 35.63981, "process_user_time": 5.115703, "process_kernel_time": 0.676593, "process_mem_max_rss": "127586304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:55.393771 [debug] [MainThread]: Command `cli run` succeeded at 12:05:55.393452 after 35.64 seconds
[0m12:05:55.394498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107112190>]}
[0m12:05:55.395192 [debug] [MainThread]: Flushing usage events
[0m12:27:31.346404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa06fa0>]}


============================== 12:27:31.355823 | b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a ==============================
[0m12:27:31.355823 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:27:31.357000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:32.369234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bdc40>]}
[0m12:27:32.523613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78c6a0>]}
[0m12:27:32.525321 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:27:32.559405 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:27:32.659704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:32.661358 [debug] [MainThread]: Partial parsing: updated file: ccwj://models/core/daily_totals.sql
[0m12:27:32.916033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9e0d0>]}
[0m12:27:32.941010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba9c790>]}
[0m12:27:32.941852 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:27:32.942486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b95e190>]}
[0m12:27:32.944666 [info ] [MainThread]: 
[0m12:27:32.946435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:32.949622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:27:32.950665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:42.825911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:27:42.827095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:46.709310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81eac0>]}
[0m12:27:46.711200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:46.711940 [info ] [MainThread]: 
[0m12:27:46.717132 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m12:27:46.718257 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m12:27:46.719558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m12:27:46.720322 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m12:27:46.734020 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m12:27:46.736276 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 12:27:46.720728 => 12:27:46.735820
[0m12:27:46.737169 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m12:27:46.785183 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m12:27:46.786751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:27:46.787598 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with combined as (
select 
   symbol,
   current_date() as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
UNION ALL 
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)


select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join combined 
        on combined.symbol = daily_dates.symbol
            and combined.date <= daily_dates.day 
where daily_dates.symbol = 'CFLT'
group by 1,2,3
order by 1 desc;


[0m12:27:47.895372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:485cf95a-f703-4f6b-8864-51045ef53ffe&page=queryresults
[0m12:27:48.891813 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 12:27:46.737626 => 12:27:48.891480
[0m12:27:48.892938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29cf9fd-4063-4e1b-abc0-1d6c3cacce0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd83190>]}
[0m12:27:48.893789 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 2.17s]
[0m12:27:48.894823 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m12:27:48.897784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:48.898353 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m12:27:48.898857 [info ] [MainThread]: 
[0m12:27:48.899516 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.95 seconds (15.95s).
[0m12:27:48.900644 [debug] [MainThread]: Command end result
[0m12:27:48.923464 [info ] [MainThread]: 
[0m12:27:48.924357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:48.925255 [info ] [MainThread]: 
[0m12:27:48.926242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:27:48.929606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.804403, "process_user_time": 5.245715, "process_kernel_time": 0.680209, "process_mem_max_rss": "131284992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:27:48.931162 [debug] [MainThread]: Command `cli run` succeeded at 12:27:48.930583 after 17.81 seconds
[0m12:27:48.932289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bdc40>]}
[0m12:27:48.932943 [debug] [MainThread]: Flushing usage events
[0m12:27:57.571248 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:28:01.815424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5053a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e4c10>]}


============================== 12:28:01.822130 | 5ea9bfae-d625-4056-8e7c-6a80c5033daa ==============================
[0m12:28:01.822130 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:28:01.823289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:02.632887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e30f9a0>]}
[0m12:28:02.782909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccf070>]}
[0m12:28:02.784081 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:28:02.810785 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:28:02.889957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:02.890582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:02.902032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6810d0>]}
[0m12:28:02.921300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a31f0>]}
[0m12:28:02.922219 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:28:02.923046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a3910>]}
[0m12:28:02.925605 [info ] [MainThread]: 
[0m12:28:02.927273 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:02.929390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:28:02.930116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:05.576253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:28:05.577266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:06.679399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d6b80>]}
[0m12:28:06.680901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:06.681567 [info ] [MainThread]: 
[0m12:28:06.685789 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m12:28:06.686647 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m12:28:06.688231 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m12:28:06.688974 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m12:28:06.703891 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m12:28:06.705221 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 12:28:06.689367 => 12:28:06.704820
[0m12:28:06.705801 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m12:28:06.761619 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m12:28:06.763110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:06.763990 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with combined as (
select 
   symbol,
   current_date() as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
UNION ALL 
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)


select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join combined 
        on combined.symbol = daily_dates.symbol
            and combined.date <= daily_dates.day 
where daily_dates.symbol = 'CFLT'
group by 1,2,3
order by 1 desc;


[0m12:28:08.526512 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:58a46877-c032-443e-8a20-f3f8b8caab79&page=queryresults
[0m12:28:09.020416 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 12:28:06.706167 => 12:28:09.020103
[0m12:28:09.021561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea9bfae-d625-4056-8e7c-6a80c5033daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7a7d60>]}
[0m12:28:09.022423 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m12:28:09.023610 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m12:28:09.026396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:09.026931 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m12:28:09.027407 [info ] [MainThread]: 
[0m12:28:09.028009 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m12:28:09.029495 [debug] [MainThread]: Command end result
[0m12:28:09.043978 [info ] [MainThread]: 
[0m12:28:09.044727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:09.045554 [info ] [MainThread]: 
[0m12:28:09.046216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:09.049930 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.328868, "process_user_time": 4.585225, "process_kernel_time": 0.477867, "process_mem_max_rss": "127078400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:09.051363 [debug] [MainThread]: Command `cli run` succeeded at 12:28:09.050945 after 7.33 seconds
[0m12:28:09.052086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e46f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e46f6d0>]}
[0m12:28:09.052929 [debug] [MainThread]: Flushing usage events
[0m12:43:30.744072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073734c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a2e20>]}


============================== 12:43:30.753339 | 608008e8-d8c1-4db1-b7c0-12193c412ce6 ==============================
[0m12:43:30.753339 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:43:30.754846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:32.592706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107361550>]}
[0m12:43:32.812848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822a2b0>]}
[0m12:43:32.814759 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:43:32.864556 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:43:32.969624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:32.970710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:32.990605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085260d0>]}
[0m12:43:33.019277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084435e0>]}
[0m12:43:33.020575 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:43:33.022017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084438b0>]}
[0m12:43:33.026767 [info ] [MainThread]: 
[0m12:43:33.029278 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:43:33.032708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:43:33.034811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:35.942270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:43:35.944034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:36.333623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831a6a0>]}
[0m12:43:36.335207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:36.335889 [info ] [MainThread]: 
[0m12:43:36.340675 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m12:43:36.341953 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m12:43:36.343313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m12:43:36.344050 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m12:43:36.359627 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m12:43:36.361646 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 12:43:36.344489 => 12:43:36.361142
[0m12:43:36.362553 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m12:43:36.432123 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m12:43:36.433663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:36.434546 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with combined as (
select 
   symbol,
   current_date() as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
UNION ALL 
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)


select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join combined 
        on combined.symbol = daily_dates.symbol
            and combined.date <= daily_dates.day 

group by 1,2,3
order by 1 desc;


[0m12:43:37.070290 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:27ca3d7a-610f-4a29-8837-5bd5784e80c1&page=queryresults
[0m12:43:37.519111 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 12:43:36.363175 => 12:43:37.518767
[0m12:43:37.520559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608008e8-d8c1-4db1-b7c0-12193c412ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bac40>]}
[0m12:43:37.521611 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m12:43:37.522915 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m12:43:37.526170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:37.526767 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m12:43:37.528200 [info ] [MainThread]: 
[0m12:43:37.529564 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m12:43:37.531271 [debug] [MainThread]: Command end result
[0m12:43:37.548653 [info ] [MainThread]: 
[0m12:43:37.549675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:37.550649 [info ] [MainThread]: 
[0m12:43:37.551355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:37.555071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.94214, "process_user_time": 6.67642, "process_kernel_time": 0.860395, "process_mem_max_rss": "127234048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:43:37.556314 [debug] [MainThread]: Command `cli run` succeeded at 12:43:37.556045 after 6.94 seconds
[0m12:43:37.557398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b2c70>]}
[0m12:43:37.558390 [debug] [MainThread]: Flushing usage events
[0m12:51:11.553940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111057a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b65b20>]}


============================== 12:51:11.562535 | c63fcdeb-794c-450d-bfb4-35b6f150bd4c ==============================
[0m12:51:11.562535 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:51:11.563756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:12.545094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1c670>]}
[0m12:51:12.698252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113abc250>]}
[0m12:51:12.699905 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:51:12.749695 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:51:12.825943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:12.826608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:12.838398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cdf940>]}
[0m12:51:12.858689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bfe2e0>]}
[0m12:51:12.859748 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:51:12.860442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e5a00>]}
[0m12:51:12.863370 [info ] [MainThread]: 
[0m12:51:12.864908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:12.866641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:51:12.867426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:14.997083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:51:14.998170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:15.519284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e5a30>]}
[0m12:51:15.520769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:15.521493 [info ] [MainThread]: 
[0m12:51:15.526417 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m12:51:15.527285 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m12:51:15.528726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m12:51:15.529692 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m12:51:15.546591 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m12:51:15.548389 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 12:51:15.530119 => 12:51:15.547812
[0m12:51:15.549321 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m12:51:15.609944 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m12:51:15.611210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:51:15.612038 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with combined as (
select 
   symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
UNION ALL 
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)


select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join combined 
        on combined.symbol = daily_dates.symbol
            and combined.date <= daily_dates.day 

group by 1,2,3
order by 1 desc;


[0m12:51:16.319283 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e7c2eac8-e45c-4828-bdce-cfa7e0429737&page=queryresults
[0m12:51:16.794341 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 12:51:15.550165 => 12:51:16.793989
[0m12:51:16.795553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63fcdeb-794c-450d-bfb4-35b6f150bd4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e04fa0>]}
[0m12:51:16.796451 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m12:51:16.797423 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m12:51:16.799891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:16.800422 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m12:51:16.800937 [info ] [MainThread]: 
[0m12:51:16.801549 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m12:51:16.802760 [debug] [MainThread]: Command end result
[0m12:51:16.818297 [info ] [MainThread]: 
[0m12:51:16.819006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:16.819589 [info ] [MainThread]: 
[0m12:51:16.820689 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:16.829498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.393085, "process_user_time": 5.385373, "process_kernel_time": 0.684536, "process_mem_max_rss": "127180800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:51:16.831029 [debug] [MainThread]: Command `cli run` succeeded at 12:51:16.830695 after 5.39 seconds
[0m12:51:16.832193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111057a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a4a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1c640>]}
[0m12:51:16.833027 [debug] [MainThread]: Flushing usage events
[0m14:01:45.201534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131abe20>]}


============================== 14:01:45.213937 | dd6365f3-7e13-41e9-b639-f5c1d16fac1e ==============================
[0m14:01:45.213937 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:01:45.215626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:46.142852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11316a6d0>]}
[0m14:01:46.326816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fc95b0>]}
[0m14:01:46.328928 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:01:46.360747 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m14:01:46.449202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:46.450395 [debug] [MainThread]: Partial parsing: updated file: ccwj://models/core/daily_totals.sql
[0m14:01:46.716447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11444e0d0>]}
[0m14:01:46.740421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11424b8e0>]}
[0m14:01:46.741434 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:01:46.742310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140d1f70>]}
[0m14:01:46.745066 [info ] [MainThread]: 
[0m14:01:46.746722 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:01:46.748814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:01:46.749950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:48.888458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:01:48.889906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:49.297504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140476d0>]}
[0m14:01:49.299390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:49.300420 [info ] [MainThread]: 
[0m14:01:49.306899 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m14:01:49.307838 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m14:01:49.309191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m14:01:49.310155 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m14:01:49.328213 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m14:01:49.331529 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 14:01:49.311050 => 14:01:49.331011
[0m14:01:49.332360 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m14:01:49.387344 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m14:01:49.389961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:49.391103 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where final.symbol = 'CFLT'
order by 1 desc 
limit 300;


[0m14:01:50.069294 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ea454fad-673a-46f2-a021-da49f63f699e&page=queryresults
[0m14:01:50.583301 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 14:01:49.332775 => 14:01:50.582928
[0m14:01:50.584569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6365f3-7e13-41e9-b639-f5c1d16fac1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d3fa0>]}
[0m14:01:50.585532 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m14:01:50.586607 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m14:01:50.590078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:50.591022 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m14:01:50.591715 [info ] [MainThread]: 
[0m14:01:50.592393 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m14:01:50.594117 [debug] [MainThread]: Command end result
[0m14:01:50.623798 [info ] [MainThread]: 
[0m14:01:50.624729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:50.625894 [info ] [MainThread]: 
[0m14:01:50.626908 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:01:50.631545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.552274, "process_user_time": 5.197024, "process_kernel_time": 0.542479, "process_mem_max_rss": "131026944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:01:50.633615 [debug] [MainThread]: Command `cli run` succeeded at 14:01:50.633080 after 5.55 seconds
[0m14:01:50.634752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11316a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11412ddf0>]}
[0m14:01:50.635747 [debug] [MainThread]: Flushing usage events
[0m10:12:43.847371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872ebb0>]}


============================== 10:12:43.856167 | 7e17376a-520c-4db7-80b3-cb042e67110c ==============================
[0m10:12:43.856167 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:12:43.857215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:44.861534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593340>]}
[0m10:12:45.022524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ba550>]}
[0m10:12:45.024242 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:12:45.056097 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:12:45.133711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:45.134423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:45.145348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c2fa0>]}
[0m10:12:45.167008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956e640>]}
[0m10:12:45.167939 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:12:45.169162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d7250>]}
[0m10:12:45.172106 [info ] [MainThread]: 
[0m10:12:45.173785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:12:45.175539 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:12:45.176391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:47.950926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:12:47.951998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:48.425040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109582d00>]}
[0m10:12:48.426655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:12:48.427345 [info ] [MainThread]: 
[0m10:12:48.432924 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m10:12:48.434147 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m10:12:48.435798 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m10:12:48.436895 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m10:12:48.455191 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:12:48.457340 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 10:12:48.437622 => 10:12:48.456868
[0m10:12:48.458009 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m10:12:48.517358 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:12:48.518799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:12:48.519658 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where final.symbol = 'CFLT'
order by 1 desc;


[0m10:12:49.304260 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ddfbab6f-04d7-4cea-972b-ea9040ab091f&page=queryresults
[0m10:12:49.766219 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 10:12:48.458626 => 10:12:49.765880
[0m10:12:49.767490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e17376a-520c-4db7-80b3-cb042e67110c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cf190>]}
[0m10:12:49.768383 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m10:12:49.769331 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m10:12:49.771892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:49.772630 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:12:49.773162 [info ] [MainThread]: 
[0m10:12:49.773737 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m10:12:49.774751 [debug] [MainThread]: Command end result
[0m10:12:49.791595 [info ] [MainThread]: 
[0m10:12:49.792313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:49.792897 [info ] [MainThread]: 
[0m10:12:49.793510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:49.797041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0574746, "process_user_time": 4.99036, "process_kernel_time": 0.65923, "process_mem_max_rss": "128090112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:12:49.798688 [debug] [MainThread]: Command `cli run` succeeded at 10:12:49.798349 after 6.06 seconds
[0m10:12:49.800003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ba550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593340>]}
[0m10:12:49.801469 [debug] [MainThread]: Flushing usage events
[0m09:52:13.395167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebbf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc44c0>]}


============================== 09:52:13.400382 | e56c4a38-29c5-4251-86da-ecd0904eeaea ==============================
[0m09:52:13.400382 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:52:13.401130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:13.966073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d6a00>]}
[0m09:52:14.070421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1e850>]}
[0m09:52:14.071426 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:52:14.092238 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:52:14.147912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:14.148398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:14.155377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd40970>]}
[0m09:52:14.172678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63070>]}
[0m09:52:14.173514 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:52:14.173980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63490>]}
[0m09:52:14.176683 [info ] [MainThread]: 
[0m09:52:14.178169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:14.179838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:52:14.180471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:15.482026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:52:15.496303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:16.064923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd40400>]}
[0m09:52:16.066460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:16.067078 [info ] [MainThread]: 
[0m09:52:16.072526 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:52:16.073483 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m09:52:16.074711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m09:52:16.075418 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:52:16.089468 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:52:16.090857 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:52:16.075836 => 09:52:16.090448
[0m09:52:16.091448 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:52:16.113758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:16.538802 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:52:16.540612 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:52:17.048549 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1d5d2f67-5b39-413b-8e63-cd320e85145d&page=queryresults
[0m09:52:20.499405 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:52:16.091802 => 09:52:20.499086
[0m09:52:20.500544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e56c4a38-29c5-4251-86da-ecd0904eeaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd6d90>]}
[0m09:52:20.501524 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.43s]
[0m09:52:20.502500 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:52:20.505302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:20.505804 [debug] [MainThread]: Connection 'model.ccwj.my_first_dbt_model' was properly closed.
[0m09:52:20.506245 [info ] [MainThread]: 
[0m09:52:20.506710 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m09:52:20.507642 [debug] [MainThread]: Command end result
[0m09:52:20.520525 [info ] [MainThread]: 
[0m09:52:20.521469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:20.522158 [info ] [MainThread]: 
[0m09:52:20.523013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:52:20.525864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2063956, "process_user_time": 3.279024, "process_kernel_time": 0.334466, "process_mem_max_rss": "128217088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:20.527430 [debug] [MainThread]: Command `cli run` succeeded at 09:52:20.527069 after 7.21 seconds
[0m09:52:20.528188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe58a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdcc9d0>]}
[0m09:52:20.528851 [debug] [MainThread]: Flushing usage events
[0m09:52:27.347449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a74f0>]}


============================== 09:52:27.352363 | 3409dde0-d18e-4897-96dd-a27cb9cb5493 ==============================
[0m09:52:27.352363 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:52:27.353277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:27.880406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf4f0>]}
[0m09:52:27.983425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64d1f0>]}
[0m09:52:27.984386 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:52:28.004521 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:52:28.061023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:28.061496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:28.068697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa400d0>]}
[0m09:52:28.084190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9632e0>]}
[0m09:52:28.084970 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:52:28.087072 [info ] [MainThread]: 
[0m09:52:28.088332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:28.090394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:52:28.091104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:29.814228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:52:29.815535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:30.316711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7da9a0>]}
[0m09:52:30.318582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:30.319319 [info ] [MainThread]: 
[0m09:52:30.323816 [debug] [Thread-1  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:52:30.325137 [info ] [Thread-1  ]: 1 of 2 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m09:52:30.327034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.my_first_dbt_model)
[0m09:52:30.328056 [debug] [Thread-1  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:52:30.343843 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:52:30.345364 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:52:30.328598 => 09:52:30.344951
[0m09:52:30.346047 [debug] [Thread-1  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:52:30.366978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:30.766758 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:52:30.767806 [debug] [Thread-1  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:52:31.186064 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6b3c5512-60dd-4cd4-846a-646649a8d7e1&page=queryresults
[0m09:52:33.435236 [debug] [Thread-1  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:52:30.346418 => 09:52:33.434871
[0m09:52:33.436496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3409dde0-d18e-4897-96dd-a27cb9cb5493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2b970>]}
[0m09:52:33.437373 [info ] [Thread-1  ]: 1 of 2 OK created sql table model analytics.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.11s]
[0m09:52:33.438781 [debug] [Thread-1  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:52:33.440021 [debug] [Thread-3  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:33.440633 [info ] [Thread-3  ]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m09:52:33.441842 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.ccwj.unique_my_first_dbt_model_id.16e066b321'
[0m09:52:33.442431 [debug] [Thread-3  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:33.455322 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:52:33.457319 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:52:33.442773 => 09:52:33.456579
[0m09:52:33.458688 [debug] [Thread-3  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:33.480831 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:52:33.503873 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:52:33.504909 [debug] [Thread-3  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:52:34.219269 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6333660d-34c3-488c-9f1a-4f2a3f2dcc6a&page=queryresults
[0m09:52:34.914309 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:52:33.459591 => 09:52:34.913607
[0m09:52:34.916407 [info ] [Thread-3  ]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.47s]
[0m09:52:34.917672 [debug] [Thread-3  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:34.920399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:34.920995 [debug] [MainThread]: Connection 'model.ccwj.my_first_dbt_model' was properly closed.
[0m09:52:34.921495 [debug] [MainThread]: Connection 'test.ccwj.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m09:52:34.922067 [info ] [MainThread]: 
[0m09:52:34.922652 [info ] [MainThread]: Finished running 1 table model, 1 test in 0 hours 0 minutes and 6.83 seconds (6.83s).
[0m09:52:34.924370 [debug] [MainThread]: Command end result
[0m09:52:34.939349 [info ] [MainThread]: 
[0m09:52:34.941187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:34.942975 [info ] [MainThread]: 
[0m09:52:34.943951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:52:34.946679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.6734133, "process_user_time": 3.460618, "process_kernel_time": 0.339417, "process_mem_max_rss": "129220608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:34.947893 [debug] [MainThread]: Command `cli build` succeeded at 09:52:34.947584 after 7.67 seconds
[0m09:52:34.948785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e8070>]}
[0m09:52:34.949680 [debug] [MainThread]: Flushing usage events
[0m09:52:38.229867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aea400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ecaf0>]}


============================== 09:52:38.234787 | 56e99501-58da-4a4c-86cf-a8b4b5e9f438 ==============================
[0m09:52:38.234787 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:52:38.235439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:38.769049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065aaa60>]}
[0m09:52:38.868409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073db7c0>]}
[0m09:52:38.869379 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:52:38.891964 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:52:38.946071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:38.946558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:38.954032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776efa0>]}
[0m09:52:38.972364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692190>]}
[0m09:52:38.973070 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:52:38.975812 [info ] [MainThread]: 
[0m09:52:38.976946 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:38.978880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:52:38.979562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:40.351567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:52:40.353049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:40.728436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5400>]}
[0m09:52:40.730132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:40.730791 [info ] [MainThread]: 
[0m09:52:40.735219 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:52:40.736060 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:52:40.737216 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m09:52:40.738088 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m09:52:40.738834 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m09:52:40.739641 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m09:52:40.740908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:52:40.741724 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m09:52:40.742504 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m09:52:40.743931 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m09:52:40.744640 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:52:40.745869 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m09:52:40.746896 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:52:40.747471 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:52:40.754747 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m09:52:40.760839 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:52:40.761549 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m09:52:40.766065 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:52:40.766971 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 09:52:40.766598 => 09:52:40.766602
[0m09:52:40.767852 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 09:52:40.767533 => 09:52:40.767537
[0m09:52:40.768641 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m09:52:40.769661 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m09:52:40.775482 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:52:40.761932 => 09:52:40.775045
[0m09:52:40.776131 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:52:40.747868 => 09:52:40.775826
[0m09:52:40.804330 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:52:40.820362 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:52:40.860684 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:52:40.866389 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:52:40.931805 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:52:40.955766 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:52:40.958888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:40.960221 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:52:41.343099 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:52:41.345823 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:52:41.499782 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d32a94a-a1be-4c86-b827-521632f8628c&page=queryresults
[0m09:52:41.755404 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f64d4c90-bf8b-4552-a5b9-2b46504a3fd6&page=queryresults
[0m09:52:41.901741 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:52:40.879285 => 09:52:41.901356
[0m09:52:41.902878 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a048e0>]}
[0m09:52:41.903853 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m09:52:41.904903 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:52:44.845491 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:52:40.839000 => 09:52:44.845223
[0m09:52:44.846625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f4ca0>]}
[0m09:52:44.847402 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.10s]
[0m09:52:44.848277 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:52:44.849329 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:44.849806 [info ] [Thread-1  ]: 5 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m09:52:44.850853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m09:52:44.851384 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:44.867804 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:52:44.868939 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:52:44.851663 => 09:52:44.868601
[0m09:52:44.869385 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:44.893089 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:52:44.894142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:44.894715 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:52:45.043501 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:52:45.120360 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:52:45.399886 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b5537e79-c295-4d86-88e8-dc8e54798cb9&page=queryresults
[0m09:52:45.492176 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:75e3a30e-b50b-4e5b-8f16-72ff76e7c24b&page=queryresults
[0m09:52:45.501201 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a9dda535-edca-4d9e-b258-c3112206b1a6&page=queryresults
[0m09:52:45.884130 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:52:45.891655 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 09:52:40.770728 => 09:52:45.891227
[0m09:52:45.893045 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107819f70>]}
[0m09:52:45.893897 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 5.15s]
[0m09:52:45.894874 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m09:52:45.895857 [debug] [Thread-2  ]: Began running node model.ccwj.current
[0m09:52:45.896576 [info ] [Thread-2  ]: 6 of 14 START sql view model analytics.current ................................. [RUN]
[0m09:52:45.897808 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.current)
[0m09:52:45.898472 [debug] [Thread-2  ]: Began compiling node model.ccwj.current
[0m09:52:45.903596 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:52:45.906199 [debug] [Thread-2  ]: Timing info for model.ccwj.current (compile): 09:52:45.898849 => 09:52:45.905726
[0m09:52:45.906860 [debug] [Thread-2  ]: Began executing node model.ccwj.current
[0m09:52:45.913012 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:52:45.915858 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:52:45.916777 [debug] [Thread-2  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:52:46.126752 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:52:46.131728 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 09:52:40.778392 => 09:52:46.131363
[0m09:52:46.132876 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782ccd0>]}
[0m09:52:46.133648 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.39s]
[0m09:52:46.134559 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m09:52:46.135570 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m09:52:46.136288 [info ] [Thread-3  ]: 7 of 14 START sql view model analytics.history ................................. [RUN]
[0m09:52:46.137408 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m09:52:46.152924 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m09:52:46.161469 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:52:46.164762 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 09:52:46.155270 => 09:52:46.164307
[0m09:52:46.165366 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m09:52:46.170678 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:52:46.172422 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:52:46.177164 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:52:44.869657 => 09:52:46.176317
[0m09:52:46.179656 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT';


[0m09:52:46.182631 [info ] [Thread-1  ]: 5 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.33s]
[0m09:52:46.187111 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:52:46.191440 [debug] [Thread-4  ]: Began running node model.ccwj.my_second_dbt_model
[0m09:52:46.192813 [info ] [Thread-4  ]: 8 of 14 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m09:52:46.194877 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.my_second_dbt_model)
[0m09:52:46.195902 [debug] [Thread-4  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m09:52:46.204206 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m09:52:46.206650 [debug] [Thread-4  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 09:52:46.196341 => 09:52:46.205939
[0m09:52:46.207500 [debug] [Thread-4  ]: Began executing node model.ccwj.my_second_dbt_model
[0m09:52:46.216596 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m09:52:46.217859 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:52:46.218558 [debug] [Thread-4  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m09:52:46.677889 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:74eb78df-e1ae-41fa-ae3f-0898e218f6e9&page=queryresults
[0m09:52:46.681637 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0efedb27-3d7b-40d7-b88e-485f71a6a4ed&page=queryresults
[0m09:52:46.775728 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:50d7ee25-8536-41e4-8c6c-42d35e322163&page=queryresults
[0m09:52:47.041949 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 09:52:46.165716 => 09:52:47.041640
[0m09:52:47.043062 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789c610>]}
[0m09:52:47.043860 [info ] [Thread-3  ]: 7 of 14 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m09:52:47.044715 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m09:52:47.177216 [debug] [Thread-4  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 09:52:46.208712 => 09:52:47.176757
[0m09:52:47.178698 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1310>]}
[0m09:52:47.179670 [info ] [Thread-4  ]: 8 of 14 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m09:52:47.180955 [debug] [Thread-4  ]: Finished running node model.ccwj.my_second_dbt_model
[0m09:52:47.182110 [debug] [Thread-1  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:52:47.182853 [debug] [Thread-3  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:52:47.183497 [info ] [Thread-1  ]: 9 of 14 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m09:52:47.184193 [info ] [Thread-3  ]: 10 of 14 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m09:52:47.185481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m09:52:47.186506 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m09:52:47.187293 [debug] [Thread-1  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:52:47.187990 [debug] [Thread-3  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:52:47.200402 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:52:47.207169 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:52:47.208356 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 09:52:47.188418 => 09:52:47.208032
[0m09:52:47.208972 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 09:52:47.200847 => 09:52:47.208690
[0m09:52:47.209434 [debug] [Thread-1  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:52:47.209955 [debug] [Thread-3  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:52:47.213881 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:52:47.217416 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:52:47.218545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:47.219097 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:52:47.219781 [debug] [Thread-1  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m09:52:47.220445 [debug] [Thread-3  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:52:47.319595 [debug] [Thread-2  ]: Timing info for model.ccwj.current (execute): 09:52:45.907252 => 09:52:47.319227
[0m09:52:47.320986 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107882820>]}
[0m09:52:47.322121 [info ] [Thread-2  ]: 6 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m09:52:47.323964 [debug] [Thread-2  ]: Finished running node model.ccwj.current
[0m09:52:47.325304 [debug] [Thread-4  ]: Began running node model.ccwj.current_position_information
[0m09:52:47.325974 [debug] [Thread-2  ]: Began running node model.ccwj.daily_totals
[0m09:52:47.326892 [info ] [Thread-4  ]: 11 of 14 START sql view model analytics.current_position_information ........... [RUN]
[0m09:52:47.328141 [info ] [Thread-2  ]: 12 of 14 START sql view model analytics.daily_totals ........................... [RUN]
[0m09:52:47.329516 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now model.ccwj.current_position_information)
[0m09:52:47.330546 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.daily_totals)
[0m09:52:47.331206 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_position_information
[0m09:52:47.331957 [debug] [Thread-2  ]: Began compiling node model.ccwj.daily_totals
[0m09:52:47.346679 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m09:52:47.348861 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m09:52:47.350100 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (compile): 09:52:47.332427 => 09:52:47.349753
[0m09:52:47.350658 [debug] [Thread-4  ]: Began executing node model.ccwj.current_position_information
[0m09:52:47.356873 [debug] [Thread-2  ]: Timing info for model.ccwj.daily_totals (compile): 09:52:47.335627 => 09:52:47.356439
[0m09:52:47.356267 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m09:52:47.358188 [debug] [Thread-2  ]: Began executing node model.ccwj.daily_totals
[0m09:52:47.364073 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m09:52:47.365128 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:52:47.365695 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:52:47.366288 [debug] [Thread-4  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cast_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m09:52:47.366957 [debug] [Thread-2  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where final.symbol = 'CFLT'
order by 1 desc;


[0m09:52:48.025867 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0855c642-26c5-48e8-8a6d-4077d55ba68d&page=queryresults
[0m09:52:48.026686 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c8963b11-7186-44ca-96a1-28b7944d6425&page=queryresults
[0m09:52:48.027658 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:88c7fcfb-e852-4845-a5b9-a74ba0ff4ef0&page=queryresults
[0m09:52:48.072644 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f4db635c-bfb9-4c55-a944-f9e1a8b8355f&page=queryresults
[0m09:52:48.404192 [debug] [Thread-2  ]: Timing info for model.ccwj.daily_totals (execute): 09:52:47.358744 => 09:52:48.403743
[0m09:52:48.405825 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0c340>]}
[0m09:52:48.406979 [info ] [Thread-2  ]: 12 of 14 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m09:52:48.408045 [debug] [Thread-2  ]: Finished running node model.ccwj.daily_totals
[0m09:52:48.408878 [debug] [Thread-2  ]: Began running node model.ccwj.overall_position_performance
[0m09:52:48.409752 [info ] [Thread-2  ]: 13 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m09:52:48.411077 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.daily_totals, now model.ccwj.overall_position_performance)
[0m09:52:48.411819 [debug] [Thread-2  ]: Began compiling node model.ccwj.overall_position_performance
[0m09:52:48.417355 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m09:52:48.418671 [debug] [Thread-2  ]: Timing info for model.ccwj.overall_position_performance (compile): 09:52:48.412411 => 09:52:48.418285
[0m09:52:48.419300 [debug] [Thread-2  ]: Began executing node model.ccwj.overall_position_performance
[0m09:52:48.424865 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m09:52:48.427561 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:52:48.429389 [debug] [Thread-2  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
where symbol = 'CFLT'
group by 1;


[0m09:52:48.466866 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: cast_bases; Did you mean cost_bases? at [12:4]; reason: invalidQuery, location: query, message: Unrecognized name: cast_bases; Did you mean cost_bases? at [12:4]')
[0m09:52:48.666041 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 09:52:47.210287 => 09:52:48.665332
[0m09:52:48.667887 [info ] [Thread-1  ]: 9 of 14 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.48s]
[0m09:52:48.669164 [debug] [Thread-1  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:52:48.670413 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m09:52:48.671454 [info ] [Thread-1  ]: 14 of 14 START sql view model analytics.positions .............................. [RUN]
[0m09:52:48.672709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.positions)
[0m09:52:48.673419 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m09:52:48.678827 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:52:48.681188 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 09:52:48.673832 => 09:52:48.680589
[0m09:52:48.681900 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m09:52:48.692163 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:52:48.695287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:48.696110 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m09:52:48.702268 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 09:52:47.214368 => 09:52:48.701861
[0m09:52:48.703510 [info ] [Thread-3  ]: 10 of 14 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.52s]
[0m09:52:48.704597 [debug] [Thread-3  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:52:48.991013 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6a5383ee-3911-4d4c-b87c-a430fb0678e3&page=queryresults
[0m09:52:49.044022 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f2c54ea4-f3a6-4112-8496-b225d2b3d630&page=queryresults
[0m09:52:49.381750 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5911b9b4-09d4-400a-a961-07bbcf2a35b3&page=queryresults
[0m09:52:49.411454 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6a5383ee-3911-4d4c-b87c-a430fb0678e3&page=queryresults
[0m09:52:49.413831 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (execute): 09:52:47.351096 => 09:52:49.413145
[0m09:52:49.437287 [debug] [Thread-4  ]: Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Unrecognized name: cast_bases; Did you mean cost_bases? at [12:4]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m09:52:49.438212 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1100>]}
[0m09:52:49.439507 [error] [Thread-4  ]: 11 of 14 ERROR creating sql view model analytics.current_position_information .. [[31mERROR[0m in 2.11s]
[0m09:52:49.440566 [debug] [Thread-4  ]: Finished running node model.ccwj.current_position_information
[0m09:52:49.451917 [debug] [Thread-2  ]: Timing info for model.ccwj.overall_position_performance (execute): 09:52:48.419779 => 09:52:49.451481
[0m09:52:49.453185 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c965b0>]}
[0m09:52:49.454101 [info ] [Thread-2  ]: 13 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m09:52:49.455173 [debug] [Thread-2  ]: Finished running node model.ccwj.overall_position_performance
[0m09:52:50.078169 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 09:52:48.682269 => 09:52:50.077720
[0m09:52:50.080009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e99501-58da-4a4c-86cf-a8b4b5e9f438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc82b0>]}
[0m09:52:50.081068 [info ] [Thread-1  ]: 14 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m09:52:50.082095 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m09:52:50.084753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:50.085312 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:52:50.085800 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m09:52:50.086276 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m09:52:50.086746 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m09:52:50.087337 [info ] [MainThread]: 
[0m09:52:50.087915 [info ] [MainThread]: Finished running 8 view models, 1 table model, 2 seeds, 3 tests in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m09:52:50.092112 [debug] [MainThread]: Command end result
[0m09:52:50.106762 [info ] [MainThread]: 
[0m09:52:50.107571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:52:50.108116 [info ] [MainThread]: 
[0m09:52:50.108645 [error] [MainThread]:   Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Unrecognized name: cast_bases; Did you mean cost_bases? at [12:4]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m09:52:50.109204 [info ] [MainThread]: 
[0m09:52:50.109845 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m09:52:50.115302 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.9526, "process_user_time": 4.240098, "process_kernel_time": 0.407637, "process_mem_max_rss": "142594048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:50.116213 [debug] [MainThread]: Command `cli build` failed at 09:52:50.115992 after 11.95 seconds
[0m09:52:50.116873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aea400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065aaa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692160>]}
[0m09:52:50.117491 [debug] [MainThread]: Flushing usage events
[0m09:53:38.561945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ea370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052aa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f4f10>]}


============================== 09:53:38.568188 | f547fae1-504e-427e-89c0-ef2747c7b83b ==============================
[0m09:53:38.568188 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:53:38.569077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:53:39.286305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b8610>]}
[0m09:53:39.400679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106075b80>]}
[0m09:53:39.401904 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:53:39.426436 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:53:39.489016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:39.489598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:39.497822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e0d0>]}
[0m09:53:39.513906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106396640>]}
[0m09:53:39.514635 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:53:39.517703 [info ] [MainThread]: 
[0m09:53:39.542027 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:53:39.546092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:53:39.547302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:41.141310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:53:41.142196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:41.442686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bc190>]}
[0m09:53:41.444323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:41.445056 [info ] [MainThread]: 
[0m09:53:41.449481 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:53:41.450156 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:53:41.450654 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m09:53:41.451178 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m09:53:41.451814 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m09:53:41.452613 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m09:53:41.453521 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m09:53:41.454513 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m09:53:41.455685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:53:41.456578 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m09:53:41.457878 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m09:53:41.458934 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:53:41.459526 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:53:41.460049 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:53:41.460556 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m09:53:41.461055 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m09:53:41.471726 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:53:41.475795 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:53:41.476522 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 09:53:41.476205 => 09:53:41.476210
[0m09:53:41.477291 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 09:53:41.476883 => 09:53:41.476887
[0m09:53:41.478564 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m09:53:41.480880 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:53:41.472168 => 09:53:41.480148
[0m09:53:41.482200 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m09:53:41.483279 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:53:41.461396 => 09:53:41.482729
[0m09:53:41.486878 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:53:41.509021 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:53:41.550444 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:53:41.570779 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:53:41.646494 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:53:41.665179 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:53:41.667853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:41.668969 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:53:41.990340 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:53:41.991398 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:53:42.142593 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:43d6812b-4c07-4333-8ff8-0efe17aa8d1b&page=queryresults
[0m09:53:42.460156 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b5f168e0-457f-44d3-a269-f63686974057&page=queryresults
[0m09:53:42.510442 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:53:41.577537 => 09:53:42.510169
[0m09:53:42.511558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106725f70>]}
[0m09:53:42.512667 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m09:53:42.513922 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:53:44.485085 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:53:41.538952 => 09:53:44.484606
[0m09:53:44.486820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654dcd0>]}
[0m09:53:44.487899 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.03s]
[0m09:53:44.488957 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:53:44.490112 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:53:44.490833 [info ] [Thread-1  ]: 5 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m09:53:44.492158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m09:53:44.492925 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:53:44.508021 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:53:44.510408 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:53:44.493354 => 09:53:44.509902
[0m09:53:44.511105 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:53:44.539909 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:53:44.541373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:44.542126 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:53:45.278747 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:28faab60-40b3-42ab-a04c-2caafd381a08&page=queryresults
[0m09:53:45.671894 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:53:45.991963 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:650cd7af-5864-4d36-8716-86833c6d3856&page=queryresults
[0m09:53:46.019017 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:53:44.511468 => 09:53:46.018297
[0m09:53:46.020969 [info ] [Thread-1  ]: 5 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.53s]
[0m09:53:46.022366 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:53:46.023557 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m09:53:46.024344 [info ] [Thread-2  ]: 6 of 14 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m09:53:46.025599 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.my_second_dbt_model)
[0m09:53:46.026389 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m09:53:46.031304 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m09:53:46.032570 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 09:53:46.026820 => 09:53:46.032187
[0m09:53:46.033220 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m09:53:46.038854 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m09:53:46.040026 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:53:46.040736 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m09:53:46.349320 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:53:46.353673 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 09:53:41.483737 => 09:53:46.353320
[0m09:53:46.354747 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651ab50>]}
[0m09:53:46.355497 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 4.90s]
[0m09:53:46.356362 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m09:53:46.357306 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:53:46.357978 [info ] [Thread-1  ]: 7 of 14 START sql view model analytics.current ................................. [RUN]
[0m09:53:46.359163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.current)
[0m09:53:46.359863 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:53:46.365154 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:53:46.366351 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:53:46.360233 => 09:53:46.365998
[0m09:53:46.366938 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:53:46.372692 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:53:46.374577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:46.375583 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:53:46.639754 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:47369b76-c3d0-40e6-a54a-dcd45a227c99&page=queryresults
[0m09:53:46.906626 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:39e92aaa-42f1-4968-a704-f42ab3fd210b&page=queryresults
[0m09:53:47.065953 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 09:53:46.033732 => 09:53:47.065492
[0m09:53:47.067446 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106730610>]}
[0m09:53:47.068650 [info ] [Thread-2  ]: 6 of 14 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m09:53:47.070283 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m09:53:47.071314 [debug] [Thread-3  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:53:47.071962 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:53:47.072531 [info ] [Thread-3  ]: 8 of 14 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m09:53:47.073217 [info ] [Thread-2  ]: 9 of 14 START test unique_my_second_dbt_model_id ............................... [RUN]
[0m09:53:47.074509 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m09:53:47.075574 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m09:53:47.076260 [debug] [Thread-3  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:53:47.076849 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:53:47.092050 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:53:47.102088 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 09:53:47.077286 => 09:53:47.101690
[0m09:53:47.104847 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:53:47.106921 [debug] [Thread-3  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:53:47.112339 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:53:47.113783 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 09:53:47.088184 => 09:53:47.113385
[0m09:53:47.114552 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:53:47.115152 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:53:47.115811 [debug] [Thread-3  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m09:53:47.119819 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:53:47.123092 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:53:47.123938 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:53:47.129832 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:53:47.327325 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:53:46.367292 => 09:53:47.326952
[0m09:53:47.328750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659f1c0>]}
[0m09:53:47.329651 [info ] [Thread-1  ]: 7 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m09:53:47.330602 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:53:47.331696 [debug] [Thread-1  ]: Began running node model.ccwj.current_position_information
[0m09:53:47.332389 [info ] [Thread-1  ]: 10 of 14 START sql view model analytics.current_position_information ........... [RUN]
[0m09:53:47.333624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m09:53:47.334381 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_position_information
[0m09:53:47.339407 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m09:53:47.340502 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (compile): 09:53:47.334750 => 09:53:47.340176
[0m09:53:47.341011 [debug] [Thread-1  ]: Began executing node model.ccwj.current_position_information
[0m09:53:47.345722 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m09:53:47.346877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:47.347528 [debug] [Thread-1  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases?,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m09:53:47.573977 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b36680f5-cf07-4d44-ae46-e75e235cfd87&page=queryresults
[0m09:53:47.624773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c93c1a8b-532b-4a11-b20f-053c17532043&page=queryresults
[0m09:53:47.626892 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got "?" at [12:14]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got "?" at [12:14]')
[0m09:53:47.861854 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:af8ac244-18b7-4da2-aff0-dd7c61ea12c7&page=queryresults
[0m09:53:47.934783 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:53:47.938648 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 09:53:41.489065 => 09:53:47.938382
[0m09:53:47.939586 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652ae50>]}
[0m09:53:47.940230 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 6.48s]
[0m09:53:47.941069 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m09:53:47.941936 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m09:53:47.942517 [info ] [Thread-4  ]: 11 of 14 START sql view model analytics.history ................................ [RUN]
[0m09:53:47.943543 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m09:53:47.944120 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m09:53:47.948983 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:53:47.949926 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 09:53:47.944501 => 09:53:47.949657
[0m09:53:47.950396 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m09:53:47.959106 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:53:47.961733 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:53:47.962949 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT';


[0m09:53:48.023501 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a02123ea-c0d8-4b83-88fb-91cd76f7e185&page=queryresults
[0m09:53:48.158430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa0b59c0-dc9a-4d14-8674-18fce5ab7c18&page=queryresults
[0m09:53:48.161101 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa0b59c0-dc9a-4d14-8674-18fce5ab7c18&page=queryresults
[0m09:53:48.162746 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (execute): 09:53:47.341315 => 09:53:48.162131
[0m09:53:48.185175 [debug] [Thread-1  ]: Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Syntax error: Expected end of input but got "?" at [12:14]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m09:53:48.185998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068de3d0>]}
[0m09:53:48.186992 [error] [Thread-1  ]: 10 of 14 ERROR creating sql view model analytics.current_position_information .. [[31mERROR[0m in 0.85s]
[0m09:53:48.188669 [debug] [Thread-1  ]: Finished running node model.ccwj.current_position_information
[0m09:53:48.413911 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f621642f-9960-4b83-92e2-018e9e7008e4&page=queryresults
[0m09:53:48.544686 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 09:53:47.108167 => 09:53:48.543902
[0m09:53:48.547201 [info ] [Thread-3  ]: 8 of 14 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.47s]
[0m09:53:48.548731 [debug] [Thread-3  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:53:48.652081 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 09:53:47.116183 => 09:53:48.651487
[0m09:53:48.654649 [info ] [Thread-2  ]: 9 of 14 PASS unique_my_second_dbt_model_id ..................................... [[32mPASS[0m in 1.58s]
[0m09:53:48.655822 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:53:48.996514 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 09:53:47.950675 => 09:53:48.996159
[0m09:53:48.997737 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678aa30>]}
[0m09:53:48.998675 [info ] [Thread-4  ]: 11 of 14 OK created sql view model analytics.history ........................... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m09:53:48.999670 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m09:53:49.001172 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m09:53:49.001838 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m09:53:49.002587 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m09:53:49.003483 [info ] [Thread-1  ]: 12 of 14 START sql view model analytics.daily_totals ........................... [RUN]
[0m09:53:49.004966 [info ] [Thread-3  ]: 13 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m09:53:49.006082 [info ] [Thread-2  ]: 14 of 14 START sql view model analytics.positions .............................. [RUN]
[0m09:53:49.007347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.daily_totals)
[0m09:53:49.008378 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.overall_position_performance)
[0m09:53:49.009340 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.positions)
[0m09:53:49.009954 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m09:53:49.010548 [debug] [Thread-3  ]: Began compiling node model.ccwj.overall_position_performance
[0m09:53:49.011130 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m09:53:49.017780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m09:53:49.023130 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m09:53:49.029742 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:53:49.031308 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 09:53:49.011569 => 09:53:49.030946
[0m09:53:49.031978 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 09:53:49.023679 => 09:53:49.031657
[0m09:53:49.032556 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (compile): 09:53:49.018406 => 09:53:49.032264
[0m09:53:49.033041 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m09:53:49.033585 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m09:53:49.034108 [debug] [Thread-3  ]: Began executing node model.ccwj.overall_position_performance
[0m09:53:49.039614 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m09:53:49.045185 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:53:49.049836 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m09:53:49.051337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:49.052078 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where final.symbol = 'CFLT'
order by 1 desc;


[0m09:53:49.052705 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:53:49.054970 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:53:49.056122 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m09:53:49.057579 [debug] [Thread-3  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
where symbol = 'CFLT'
group by 1;


[0m09:53:49.654548 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3ff9b418-0e57-4241-b88d-01f7a0e3e171&page=queryresults
[0m09:53:49.741864 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:624189b5-5a95-4999-a591-f29a263ec78e&page=queryresults
[0m09:53:49.823160 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1359e202-50d9-4b2f-8cca-8bd1e3791e72&page=queryresults
[0m09:53:50.040643 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 09:53:49.040186 => 09:53:50.040207
[0m09:53:50.042045 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad1d30>]}
[0m09:53:50.042946 [info ] [Thread-2  ]: 14 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m09:53:50.043949 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m09:53:50.226213 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (execute): 09:53:49.045676 => 09:53:50.225640
[0m09:53:50.227658 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aeaac0>]}
[0m09:53:50.228582 [info ] [Thread-3  ]: 13 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m09:53:50.229823 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m09:53:50.315338 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 09:53:49.034515 => 09:53:50.314974
[0m09:53:50.316655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f547fae1-504e-427e-89c0-ef2747c7b83b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abafa0>]}
[0m09:53:50.317600 [info ] [Thread-1  ]: 12 of 14 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m09:53:50.318743 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m09:53:50.321881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:50.322472 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m09:53:50.322934 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:53:50.323384 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m09:53:50.323832 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:53:50.324423 [info ] [MainThread]: 
[0m09:53:50.325016 [info ] [MainThread]: Finished running 8 view models, 1 table model, 3 tests, 2 seeds in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m09:53:50.328802 [debug] [MainThread]: Command end result
[0m09:53:50.344412 [info ] [MainThread]: 
[0m09:53:50.346147 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:53:50.346919 [info ] [MainThread]: 
[0m09:53:50.347507 [error] [MainThread]:   Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Syntax error: Expected end of input but got "?" at [12:14]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m09:53:50.348179 [info ] [MainThread]: 
[0m09:53:50.348842 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m09:53:50.353005 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.864837, "process_user_time": 4.560189, "process_kernel_time": 0.494139, "process_mem_max_rss": "142110720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:53:50.354010 [debug] [MainThread]: Command `cli build` failed at 09:53:50.353776 after 11.87 seconds
[0m09:53:50.354966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ea370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106075b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aeaac0>]}
[0m09:53:50.355754 [debug] [MainThread]: Flushing usage events
[0m09:54:05.122338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106830220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685eaf0>]}


============================== 09:54:05.127457 | 7a5d5aa7-dd30-4949-b20d-024324d21414 ==============================
[0m09:54:05.127457 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:54:05.128168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:05.679080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681cca0>]}
[0m09:54:05.786186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e4040>]}
[0m09:54:05.787053 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:54:05.808596 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:54:05.862124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:05.862710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:05.870313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079df0d0>]}
[0m09:54:05.885695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107908730>]}
[0m09:54:05.886261 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:54:05.888636 [info ] [MainThread]: 
[0m09:54:05.889941 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:54:05.892178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:54:05.892694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:07.096007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:54:07.097289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:07.392537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106830100>]}
[0m09:54:07.394222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:07.394883 [info ] [MainThread]: 
[0m09:54:07.398740 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:54:07.399651 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m09:54:07.400837 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:54:07.401770 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m09:54:07.402364 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m09:54:07.403402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:54:07.404211 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m09:54:07.404970 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m09:54:07.405759 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m09:54:07.406736 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:54:07.408007 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m09:54:07.409353 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m09:54:07.410391 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:54:07.423153 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:54:07.423988 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:54:07.424589 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m09:54:07.425114 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m09:54:07.431602 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:54:07.432571 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 09:54:07.432156 => 09:54:07.432162
[0m09:54:07.433281 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 09:54:07.432966 => 09:54:07.432970
[0m09:54:07.433865 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:54:07.410809 => 09:54:07.433572
[0m09:54:07.434627 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m09:54:07.435418 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m09:54:07.436139 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:54:07.436967 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:54:07.425667 => 09:54:07.436470
[0m09:54:07.528224 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:54:07.540594 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:54:07.546916 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:54:07.573694 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:54:07.606709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:07.611956 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:54:07.613856 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:54:07.963675 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:54:07.964743 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:54:08.009738 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e89d0423-a413-406a-a51d-0cbd4263b4c0&page=queryresults
[0m09:54:08.406678 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5c5e07ce-9f79-4da3-bacc-cb0af7c540b5&page=queryresults
[0m09:54:08.607846 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:54:07.480353 => 09:54:08.607546
[0m09:54:08.608873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac6280>]}
[0m09:54:08.609633 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m09:54:08.610454 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:54:10.359294 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:54:07.547222 => 09:54:10.358877
[0m09:54:10.360613 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0adf0>]}
[0m09:54:10.361568 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.95s]
[0m09:54:10.362623 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:54:10.363692 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:54:10.364389 [info ] [Thread-1  ]: 5 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m09:54:10.365683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m09:54:10.366379 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:54:10.385995 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:54:10.387455 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:54:10.366782 => 09:54:10.387046
[0m09:54:10.388087 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:54:10.414825 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:54:10.415963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:10.416623 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:11.122451 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6c680111-a6ca-40d5-bff8-540418b9d9fa&page=queryresults
[0m09:54:11.564101 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:54:11.597687 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:54:11.811890 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:54:10.388452 => 09:54:11.811320
[0m09:54:11.813597 [info ] [Thread-1  ]: 5 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.45s]
[0m09:54:11.814621 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:54:11.815756 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m09:54:11.816551 [info ] [Thread-2  ]: 6 of 14 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m09:54:11.817973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.my_second_dbt_model)
[0m09:54:11.818747 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m09:54:11.823718 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m09:54:11.824997 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 09:54:11.819144 => 09:54:11.824626
[0m09:54:11.825605 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m09:54:11.830724 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m09:54:11.831795 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:54:11.832487 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m09:54:11.910497 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f154d207-0923-466b-b9a3-f5741b47ecd0&page=queryresults
[0m09:54:11.915137 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:136be672-02ae-4a20-9295-8ce4da4fb565&page=queryresults
[0m09:54:12.255303 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:54:12.259404 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 09:54:07.437810 => 09:54:12.259065
[0m09:54:12.260481 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8bbb0>]}
[0m09:54:12.261262 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 4.85s]
[0m09:54:12.262164 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m09:54:12.263156 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m09:54:12.263874 [info ] [Thread-1  ]: 7 of 14 START sql view model analytics.current ................................. [RUN]
[0m09:54:12.264937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.current)
[0m09:54:12.265559 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m09:54:12.271082 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:54:12.272338 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 09:54:12.265922 => 09:54:12.271989
[0m09:54:12.272936 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m09:54:12.280380 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:54:12.281597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:12.282483 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:54:12.311669 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:87788cfb-5afd-4526-8af6-4f063301eaec&page=queryresults
[0m09:54:12.535552 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:54:12.580367 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 09:54:07.443036 => 09:54:12.579924
[0m09:54:12.599025 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa1040>]}
[0m09:54:12.621997 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.19s]
[0m09:54:12.624085 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m09:54:12.625616 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m09:54:12.626606 [info ] [Thread-3  ]: 8 of 14 START sql view model analytics.history ................................. [RUN]
[0m09:54:12.628364 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m09:54:12.629167 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m09:54:12.640014 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:54:12.642716 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 09:54:12.629627 => 09:54:12.641670
[0m09:54:12.643632 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m09:54:12.648511 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:54:12.649528 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:54:12.650328 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT';


[0m09:54:12.670180 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 09:54:11.825983 => 09:54:12.669766
[0m09:54:12.672152 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cad9d0>]}
[0m09:54:12.673514 [info ] [Thread-2  ]: 6 of 14 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m09:54:12.674761 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m09:54:12.676265 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:54:12.677016 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:54:12.677689 [info ] [Thread-4  ]: 9 of 14 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m09:54:12.678336 [info ] [Thread-2  ]: 10 of 14 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m09:54:12.679674 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m09:54:12.680675 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m09:54:12.681294 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:54:12.681829 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:54:12.692983 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:54:12.700928 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:54:12.702402 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 09:54:12.682178 => 09:54:12.701899
[0m09:54:12.703276 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:54:12.704024 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 09:54:12.693503 => 09:54:12.703652
[0m09:54:12.708122 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:54:12.708852 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:54:12.712784 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:54:12.713631 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:54:12.714288 [debug] [Thread-4  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m09:54:12.716270 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:54:12.717411 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:12.838069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1b7ed550-b0a0-4a90-9c07-c6ac287e12f2&page=queryresults
[0m09:54:13.131428 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bfb5d416-89c6-4147-997e-38c50217f369&page=queryresults
[0m09:54:13.397781 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:947cb460-a7e3-49ae-a4b4-7466a8cf6538&page=queryresults
[0m09:54:13.452615 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 09:54:12.273325 => 09:54:13.452298
[0m09:54:13.453616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e89e20>]}
[0m09:54:13.454303 [info ] [Thread-1  ]: 7 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m09:54:13.455204 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m09:54:13.456113 [debug] [Thread-1  ]: Began running node model.ccwj.current_position_information
[0m09:54:13.456942 [info ] [Thread-1  ]: 11 of 14 START sql view model analytics.current_position_information ........... [RUN]
[0m09:54:13.457939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m09:54:13.458522 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_position_information
[0m09:54:13.463804 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m09:54:13.465187 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e105bb90-9224-41d2-af0d-d8ddaad7effa&page=queryresults
[0m09:54:13.466468 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (compile): 09:54:13.458842 => 09:54:13.466155
[0m09:54:13.467868 [debug] [Thread-1  ]: Began executing node model.ccwj.current_position_information
[0m09:54:13.473564 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m09:54:13.484301 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 09:54:12.644048 => 09:54:13.483511
[0m09:54:13.485342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:54:13.487860 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df66d0>]}
[0m09:54:13.489254 [debug] [Thread-1  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m09:54:13.490992 [info ] [Thread-3  ]: 8 of 14 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m09:54:13.494816 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m09:54:13.497680 [debug] [Thread-3  ]: Began running node model.ccwj.daily_totals
[0m09:54:13.498748 [info ] [Thread-3  ]: 12 of 14 START sql view model analytics.daily_totals ........................... [RUN]
[0m09:54:13.500211 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.daily_totals)
[0m09:54:13.501052 [debug] [Thread-3  ]: Began compiling node model.ccwj.daily_totals
[0m09:54:13.510183 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m09:54:13.511190 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (compile): 09:54:13.501579 => 09:54:13.510898
[0m09:54:13.511665 [debug] [Thread-3  ]: Began executing node model.ccwj.daily_totals
[0m09:54:13.515936 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m09:54:13.517408 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:54:13.518219 [debug] [Thread-3  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where final.symbol = 'CFLT'
order by 1 desc;


[0m09:54:14.101305 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2ef10005-679c-4ca5-9799-3b65c7c8ce9d&page=queryresults
[0m09:54:14.103966 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 09:54:12.704341 => 09:54:14.103551
[0m09:54:14.105368 [info ] [Thread-4  ]: 9 of 14 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.43s]
[0m09:54:14.107212 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:54:14.108218 [debug] [Thread-4  ]: Began running node model.ccwj.overall_position_performance
[0m09:54:14.109750 [info ] [Thread-4  ]: 13 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m09:54:14.111250 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.overall_position_performance)
[0m09:54:14.112075 [debug] [Thread-4  ]: Began compiling node model.ccwj.overall_position_performance
[0m09:54:14.116762 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m09:54:14.118227 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4ebc0aca-b240-4d14-9c3b-597d4c5835af&page=queryresults
[0m09:54:14.120664 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (compile): 09:54:14.112456 => 09:54:14.120269
[0m09:54:14.122007 [debug] [Thread-4  ]: Began executing node model.ccwj.overall_position_performance
[0m09:54:14.129341 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m09:54:14.130754 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:54:14.131533 [debug] [Thread-4  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
where symbol = 'CFLT'
group by 1;


[0m09:54:14.218080 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 09:54:12.709400 => 09:54:14.217728
[0m09:54:14.219108 [info ] [Thread-2  ]: 10 of 14 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.54s]
[0m09:54:14.219854 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:54:14.220519 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m09:54:14.221136 [info ] [Thread-2  ]: 14 of 14 START sql view model analytics.positions .............................. [RUN]
[0m09:54:14.222224 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.positions)
[0m09:54:14.223054 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m09:54:14.228267 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:54:14.229285 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 09:54:14.223563 => 09:54:14.228991
[0m09:54:14.229769 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m09:54:14.339395 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:54:14.340775 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:54:14.341769 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m09:54:14.481674 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (execute): 09:54:13.468467 => 09:54:14.481218
[0m09:54:14.483302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec9160>]}
[0m09:54:14.484406 [info ] [Thread-1  ]: 11 of 14 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m09:54:14.485551 [debug] [Thread-1  ]: Finished running node model.ccwj.current_position_information
[0m09:54:14.698903 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (execute): 09:54:13.511935 => 09:54:14.698464
[0m09:54:14.700330 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f09f70>]}
[0m09:54:14.701372 [info ] [Thread-3  ]: 12 of 14 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m09:54:14.702391 [debug] [Thread-3  ]: Finished running node model.ccwj.daily_totals
[0m09:54:14.831557 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:66293b6c-7f1b-4130-ad80-99afac1bbc75&page=queryresults
[0m09:54:14.959210 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:720ec9b5-2475-4f57-a6f8-f16f7d99df4c&page=queryresults
[0m09:54:15.174575 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (execute): 09:54:14.122810 => 09:54:15.174206
[0m09:54:15.175879 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb1ee0>]}
[0m09:54:15.176782 [info ] [Thread-4  ]: 13 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:54:15.177803 [debug] [Thread-4  ]: Finished running node model.ccwj.overall_position_performance
[0m09:54:15.582035 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 09:54:14.230056 => 09:54:15.581420
[0m09:54:15.583634 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5d5aa7-dd30-4949-b20d-024324d21414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efbb20>]}
[0m09:54:15.584560 [info ] [Thread-2  ]: 14 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m09:54:15.585520 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m09:54:15.588050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:15.588556 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m09:54:15.588998 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:54:15.589447 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m09:54:15.589892 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m09:54:15.590445 [info ] [MainThread]: 
[0m09:54:15.590981 [info ] [MainThread]: Finished running 8 view models, 1 table model, 3 tests, 2 seeds in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m09:54:15.594822 [debug] [MainThread]: Command end result
[0m09:54:15.608032 [info ] [MainThread]: 
[0m09:54:15.609257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:15.611076 [info ] [MainThread]: 
[0m09:54:15.612417 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m09:54:15.614682 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.559056, "process_user_time": 4.22172, "process_kernel_time": 0.405758, "process_mem_max_rss": "141455360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:54:15.615584 [debug] [MainThread]: Command `cli build` succeeded at 09:54:15.615371 after 10.56 seconds
[0m09:54:15.616818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e4040>]}
[0m09:54:15.618010 [debug] [MainThread]: Flushing usage events
[0m10:19:37.390487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111364370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e374c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e66e20>]}


============================== 10:19:37.396851 | 6d86fc9f-1978-49e8-a266-bdfc12dc3984 ==============================
[0m10:19:37.396851 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:19:37.397700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:38.205543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e25190>]}
[0m10:19:38.311224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113de8fd0>]}
[0m10:19:38.313208 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:19:38.335773 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:19:38.391537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:38.392016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:38.399329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fe90d0>]}
[0m10:19:38.416635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0bb50>]}
[0m10:19:38.417303 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:19:38.418055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0bbb0>]}
[0m10:19:38.420108 [info ] [MainThread]: 
[0m10:19:38.421304 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:19:38.422655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:19:38.423289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:40.309798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:19:40.311138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:40.859306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c82460>]}
[0m10:19:40.860821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:40.861478 [info ] [MainThread]: 
[0m10:19:40.866492 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m10:19:40.867594 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m10:19:40.868978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m10:19:40.869884 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m10:19:40.884549 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:19:40.887043 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 10:19:40.870354 => 10:19:40.886628
[0m10:19:40.887828 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m10:19:40.936710 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:19:40.938443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:40.939356 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:19:41.753208 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8bdb5cde-631b-4ebb-8406-a720e9bd2b84&page=queryresults
[0m10:19:42.244791 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 10:19:40.888510 => 10:19:42.244448
[0m10:19:42.246015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d86fc9f-1978-49e8-a266-bdfc12dc3984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0bb80>]}
[0m10:19:42.247006 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m10:19:42.248509 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m10:19:42.251272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:42.251863 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:19:42.252386 [info ] [MainThread]: 
[0m10:19:42.253061 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m10:19:42.254460 [debug] [MainThread]: Command end result
[0m10:19:42.268523 [info ] [MainThread]: 
[0m10:19:42.269193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:42.269725 [info ] [MainThread]: 
[0m10:19:42.270457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:19:42.275135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9553223, "process_user_time": 3.510605, "process_kernel_time": 0.486836, "process_mem_max_rss": "127078400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:19:42.276268 [debug] [MainThread]: Command `cli run` succeeded at 10:19:42.276035 after 4.96 seconds
[0m10:19:42.276905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111364370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e25190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11407af70>]}
[0m10:19:42.277490 [debug] [MainThread]: Flushing usage events
[0m10:22:12.941721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa38400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c50b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c53aaf0>]}


============================== 10:22:12.948130 | 9905f211-0036-4b69-b4da-9e6a744ac4c3 ==============================
[0m10:22:12.948130 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:22:12.948912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:22:13.680985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f8a60>]}
[0m10:22:13.782237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2ee0a0>]}
[0m10:22:13.783833 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:22:13.807706 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:22:13.889548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:13.890034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:13.897546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bc0d0>]}
[0m10:22:13.913249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e0430>]}
[0m10:22:13.913837 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:22:13.916704 [info ] [MainThread]: 
[0m10:22:13.918226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:22:13.920599 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:22:13.921241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:15.554894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:22:15.556150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:15.841485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32d040>]}
[0m10:22:15.843042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:15.843731 [info ] [MainThread]: 
[0m10:22:15.848676 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:22:15.849586 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m10:22:15.850512 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m10:22:15.851233 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m10:22:15.852058 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m10:22:15.852848 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m10:22:15.853819 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m10:22:15.854744 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m10:22:15.856071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:22:15.857475 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m10:22:15.858559 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m10:22:15.859660 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:22:15.860319 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:22:15.860943 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m10:22:15.861518 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m10:22:15.862115 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m10:22:15.879410 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m10:22:15.874941 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:22:15.880935 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 10:22:15.880269 => 10:22:15.880280
[0m10:22:15.881898 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 10:22:15.881545 => 10:22:15.881550
[0m10:22:15.882877 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m10:22:15.883680 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m10:22:15.884381 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:22:15.862581 => 10:22:15.884035
[0m10:22:15.888775 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 10:22:15.875289 => 10:22:15.888293
[0m10:22:15.916550 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:22:15.919272 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m10:22:15.985791 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:22:16.030552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:22:16.044091 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:22:16.053152 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:22:16.057620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:16.058647 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:22:16.388429 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m10:22:16.390399 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m10:22:16.509970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4114e5e5-4c65-49cf-88d8-a540b47c7d41&page=queryresults
[0m10:22:16.867209 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:45bcf3a9-6eeb-489a-82f5-7ed3f4510e73&page=queryresults
[0m10:22:16.910309 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:22:15.955068 => 10:22:16.909981
[0m10:22:16.912295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d934d90>]}
[0m10:22:16.913581 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m10:22:16.915713 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:22:19.154755 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 10:22:15.986178 => 10:22:19.154304
[0m10:22:19.155972 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e6fa0>]}
[0m10:22:19.156889 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.30s]
[0m10:22:19.158129 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m10:22:19.159206 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:22:19.159860 [info ] [Thread-1  ]: 5 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m10:22:19.161057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m10:22:19.161729 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:22:19.177326 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:22:19.179996 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 10:22:19.162122 => 10:22:19.179535
[0m10:22:19.180730 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:22:19.210813 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:22:19.211861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:19.212532 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:22:19.969414 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:22:19.991868 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:177855da-555c-4d24-92a3-aa5c4b016237&page=queryresults
[0m10:22:20.060750 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:22:20.362856 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cbcc53ca-f7ec-4669-af9e-b2b1f6b698e2&page=queryresults
[0m10:22:20.424545 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:efcda0d5-1041-42c1-99aa-837dc31b825b&page=queryresults
[0m10:22:20.640711 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 10:22:19.181129 => 10:22:20.640166
[0m10:22:20.642383 [info ] [Thread-1  ]: 5 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.48s]
[0m10:22:20.643704 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:22:20.644721 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m10:22:20.645542 [info ] [Thread-2  ]: 6 of 14 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m10:22:20.646806 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.my_second_dbt_model)
[0m10:22:20.647507 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m10:22:20.652934 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m10:22:20.657408 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 10:22:20.647889 => 10:22:20.656806
[0m10:22:20.658473 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m10:22:20.665369 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m10:22:20.667209 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:22:20.668274 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m10:22:20.749594 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:22:20.754904 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 10:22:15.884894 => 10:22:20.754561
[0m10:22:20.756129 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d755340>]}
[0m10:22:20.756913 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 4.90s]
[0m10:22:20.757792 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m10:22:20.758766 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m10:22:20.759442 [info ] [Thread-1  ]: 7 of 14 START sql view model analytics.current ................................. [RUN]
[0m10:22:20.760520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.current)
[0m10:22:20.761141 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m10:22:20.766146 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:22:20.769620 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 10:22:20.761487 => 10:22:20.768848
[0m10:22:20.770369 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m10:22:20.776040 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:22:20.779574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:20.780615 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:22:20.874414 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:22:20.881104 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 10:22:15.891079 => 10:22:20.880590
[0m10:22:20.882360 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d778b20>]}
[0m10:22:20.883266 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.02s]
[0m10:22:20.884606 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m10:22:20.886045 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m10:22:20.886864 [info ] [Thread-3  ]: 8 of 14 START sql view model analytics.history ................................. [RUN]
[0m10:22:20.888186 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m10:22:20.888930 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m10:22:20.893976 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:22:20.896567 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 10:22:20.889431 => 10:22:20.896095
[0m10:22:20.897225 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m10:22:20.907406 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:22:20.910163 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:22:20.911095 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT';


[0m10:22:21.073368 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3ec98614-db7f-41de-b43e-7a443357f074&page=queryresults
[0m10:22:21.283420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8746c697-cdb2-43b3-a0b5-c910039c3d41&page=queryresults
[0m10:22:21.455901 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1077887a-c7e7-4ef4-9e9f-dcfa6319d5e2&page=queryresults
[0m10:22:21.462329 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 10:22:20.660191 => 10:22:21.461964
[0m10:22:21.463809 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e6fd0>]}
[0m10:22:21.464795 [info ] [Thread-2  ]: 6 of 14 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m10:22:21.466841 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m10:22:21.468705 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:22:21.469517 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:22:21.470112 [info ] [Thread-4  ]: 9 of 14 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m10:22:21.470803 [info ] [Thread-2  ]: 10 of 14 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m10:22:21.472207 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m10:22:21.473230 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m10:22:21.473860 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:22:21.474513 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:22:21.485502 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:22:21.496221 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:22:21.499046 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 10:22:21.474914 => 10:22:21.498624
[0m10:22:21.499829 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 10:22:21.487758 => 10:22:21.499483
[0m10:22:21.500433 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:22:21.501050 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:22:21.506031 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:22:21.511514 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:22:21.513756 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:22:21.515231 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:22:21.516725 [debug] [Thread-4  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m10:22:21.518643 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:22:21.689438 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 10:22:20.770732 => 10:22:21.688984
[0m10:22:21.692670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db282b0>]}
[0m10:22:21.693890 [info ] [Thread-1  ]: 7 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m10:22:21.695731 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m10:22:21.696777 [debug] [Thread-1  ]: Began running node model.ccwj.current_position_information
[0m10:22:21.697503 [info ] [Thread-1  ]: 11 of 14 START sql view model analytics.current_position_information ........... [RUN]
[0m10:22:21.698629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m10:22:21.699376 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_position_information
[0m10:22:21.704405 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m10:22:21.707351 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (compile): 10:22:21.699813 => 10:22:21.706701
[0m10:22:21.708117 [debug] [Thread-1  ]: Began executing node model.ccwj.current_position_information
[0m10:22:21.714680 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m10:22:21.715798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:21.716759 [debug] [Thread-1  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m10:22:21.858909 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 10:22:20.897596 => 10:22:21.858545
[0m10:22:21.860190 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ec490>]}
[0m10:22:21.861106 [info ] [Thread-3  ]: 8 of 14 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m10:22:21.862319 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m10:22:21.863401 [debug] [Thread-3  ]: Began running node model.ccwj.daily_totals
[0m10:22:21.864138 [info ] [Thread-3  ]: 12 of 14 START sql view model analytics.daily_totals ........................... [RUN]
[0m10:22:21.865305 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.daily_totals)
[0m10:22:21.866011 [debug] [Thread-3  ]: Began compiling node model.ccwj.daily_totals
[0m10:22:21.872588 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:22:21.875588 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (compile): 10:22:21.866404 => 10:22:21.875102
[0m10:22:21.876269 [debug] [Thread-3  ]: Began executing node model.ccwj.daily_totals
[0m10:22:21.881312 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:22:21.882969 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:22:21.883829 [debug] [Thread-3  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:22:22.191539 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c1b51278-9a9b-4845-92ea-9c5154472b6d&page=queryresults
[0m10:22:22.279711 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e8bfbcb3-c5c5-40cf-b8c4-f749d459cf8e&page=queryresults
[0m10:22:22.326958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1ece1bb7-3a70-4041-b2ef-d04a696faed4&page=queryresults
[0m10:22:22.623140 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7593ebe3-5dba-486c-a9a9-322c38c2c21e&page=queryresults
[0m10:22:22.700580 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (execute): 10:22:21.708572 => 10:22:22.700197
[0m10:22:22.702393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db41220>]}
[0m10:22:22.703352 [info ] [Thread-1  ]: 11 of 14 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:22:22.704402 [debug] [Thread-1  ]: Finished running node model.ccwj.current_position_information
[0m10:22:22.705184 [debug] [Thread-1  ]: Began running node model.ccwj.overall_position_performance
[0m10:22:22.705976 [info ] [Thread-1  ]: 13 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m10:22:22.707178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.overall_position_performance)
[0m10:22:22.707850 [debug] [Thread-1  ]: Began compiling node model.ccwj.overall_position_performance
[0m10:22:22.713072 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m10:22:22.715178 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (compile): 10:22:22.708234 => 10:22:22.714741
[0m10:22:22.715863 [debug] [Thread-1  ]: Began executing node model.ccwj.overall_position_performance
[0m10:22:22.721862 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m10:22:22.723456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:22:22.724684 [debug] [Thread-1  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
where symbol = 'CFLT'
group by 1;


[0m10:22:22.870509 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 10:22:21.501579 => 10:22:22.869886
[0m10:22:22.891394 [info ] [Thread-4  ]: 9 of 14 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.42s]
[0m10:22:22.893273 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:22:22.894494 [debug] [Thread-4  ]: Began running node model.ccwj.positions
[0m10:22:22.895532 [info ] [Thread-4  ]: 14 of 14 START sql view model analytics.positions .............................. [RUN]
[0m10:22:22.897216 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.positions)
[0m10:22:22.898059 [debug] [Thread-4  ]: Began compiling node model.ccwj.positions
[0m10:22:22.904630 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.positions"
[0m10:22:22.907199 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 10:22:21.506672 => 10:22:22.906541
[0m10:22:22.910234 [info ] [Thread-2  ]: 10 of 14 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.44s]
[0m10:22:22.911627 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:22:22.912602 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (compile): 10:22:22.898495 => 10:22:22.912235
[0m10:22:22.913202 [debug] [Thread-4  ]: Began executing node model.ccwj.positions
[0m10:22:22.924163 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.positions"
[0m10:22:22.925649 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:22:22.926447 [debug] [Thread-4  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m10:22:23.019346 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (execute): 10:22:21.876642 => 10:22:23.018981
[0m10:22:23.022596 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbc2610>]}
[0m10:22:23.023601 [info ] [Thread-3  ]: 12 of 14 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m10:22:23.026954 [debug] [Thread-3  ]: Finished running node model.ccwj.daily_totals
[0m10:22:23.344645 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6d1a37cd-2c6f-48ae-90fa-0936dd28d02a&page=queryresults
[0m10:22:23.535347 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:26f1712f-0a45-432a-8478-f7bac52d0161&page=queryresults
[0m10:22:23.706197 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (execute): 10:22:22.716364 => 10:22:23.705821
[0m10:22:23.707667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db4b1f0>]}
[0m10:22:23.708586 [info ] [Thread-1  ]: 13 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:22:23.710224 [debug] [Thread-1  ]: Finished running node model.ccwj.overall_position_performance
[0m10:22:23.889725 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (execute): 10:22:22.913582 => 10:22:23.889279
[0m10:22:23.891038 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9905f211-0036-4b69-b4da-9e6a744ac4c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db74820>]}
[0m10:22:23.891980 [info ] [Thread-4  ]: 14 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m10:22:23.893012 [debug] [Thread-4  ]: Finished running node model.ccwj.positions
[0m10:22:23.895686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:23.896243 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m10:22:23.896726 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m10:22:23.897199 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:22:23.897651 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m10:22:23.898227 [info ] [MainThread]: 
[0m10:22:23.898785 [info ] [MainThread]: Finished running 8 view models, 1 table model, 3 tests, 2 seeds in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m10:22:23.903514 [debug] [MainThread]: Command end result
[0m10:22:23.921109 [info ] [MainThread]: 
[0m10:22:23.921990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:23.922618 [info ] [MainThread]: 
[0m10:22:23.923292 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m10:22:23.929512 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.063087, "process_user_time": 4.547925, "process_kernel_time": 0.575733, "process_mem_max_rss": "140853248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:22:23.930754 [debug] [MainThread]: Command `cli build` succeeded at 10:22:23.930442 after 11.06 seconds
[0m10:22:23.931741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa38400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d398b80>]}
[0m10:22:23.932917 [debug] [MainThread]: Flushing usage events
[0m10:24:57.321079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f856400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111319520>]}


============================== 10:24:57.327127 | 6db7e4cb-1b5b-4359-9625-8063b3addbb5 ==============================
[0m10:24:57.327127 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:24:57.327798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:24:58.127186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fe730>]}
[0m10:24:58.230338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120db880>]}
[0m10:24:58.232149 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:24:58.255279 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:24:58.337748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:58.368546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:58.381904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a40d0>]}
[0m10:24:58.398766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cd730>]}
[0m10:24:58.399415 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:24:58.401815 [info ] [MainThread]: 
[0m10:24:58.403166 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:58.405146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:24:58.405753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:00.118634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:25:00.119689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:00.419595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112246760>]}
[0m10:25:00.421162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:00.421823 [info ] [MainThread]: 
[0m10:25:00.427407 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:25:00.428462 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m10:25:00.429242 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m10:25:00.430006 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m10:25:00.430743 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m10:25:00.431510 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m10:25:00.432318 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m10:25:00.433622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:25:00.434487 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m10:25:00.435933 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m10:25:00.437202 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m10:25:00.437914 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:25:00.439021 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:25:00.439620 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m10:25:00.440199 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m10:25:00.453150 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:25:00.453876 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m10:25:00.458592 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m10:25:00.459477 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 10:25:00.459098 => 10:25:00.459102
[0m10:25:00.460774 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 10:25:00.460307 => 10:25:00.460316
[0m10:25:00.462382 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:25:00.440627 => 10:25:00.461952
[0m10:25:00.463212 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m10:25:00.463877 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m10:25:00.464530 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:25:00.465172 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 10:25:00.454277 => 10:25:00.464868
[0m10:25:00.530988 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:25:00.545687 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m10:25:00.554354 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:25:00.601477 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:25:00.631304 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:25:00.632614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:00.633327 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:25:01.015226 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m10:25:01.040725 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m10:25:01.127508 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3e54e758-38c0-4f23-9ea9-02f1a8d0208f&page=queryresults
[0m10:25:01.476339 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ae5bce52-62fa-4c84-8b44-f4a77c95c661&page=queryresults
[0m10:25:01.734535 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:25:00.498652 => 10:25:01.734209
[0m10:25:01.735641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112524580>]}
[0m10:25:01.736670 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m10:25:01.737972 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:25:03.571693 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 10:25:00.583752 => 10:25:03.571168
[0m10:25:03.573235 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11277bf10>]}
[0m10:25:03.574375 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.14s]
[0m10:25:03.575828 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m10:25:03.577012 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:25:03.577704 [info ] [Thread-1  ]: 5 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m10:25:03.578882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m10:25:03.579542 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:25:03.594652 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:25:03.597357 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 10:25:03.579937 => 10:25:03.596734
[0m10:25:03.599276 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:25:03.627721 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:25:03.629156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:03.630354 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:25:04.339020 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c960eec4-c60e-4eef-9ea9-c61d9715359a&page=queryresults
[0m10:25:04.643174 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:25:04.822912 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:25:05.052468 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:54443f43-2783-49d4-9997-eb2a19d56618&page=queryresults
[0m10:25:05.090398 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 10:25:03.599948 => 10:25:05.089831
[0m10:25:05.092087 [info ] [Thread-1  ]: 5 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.51s]
[0m10:25:05.093174 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:25:05.095053 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m10:25:05.095913 [info ] [Thread-2  ]: 6 of 14 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m10:25:05.097148 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.my_second_dbt_model)
[0m10:25:05.097830 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m10:25:05.102961 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m10:25:05.104203 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 10:25:05.098409 => 10:25:05.103843
[0m10:25:05.104826 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m10:25:05.110097 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m10:25:05.111840 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:25:05.112609 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m10:25:05.200965 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d4ad2e9a-c5ec-4df1-8782-78422e57780f&page=queryresults
[0m10:25:05.485827 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:25:05.489984 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 10:25:00.468697 => 10:25:05.489643
[0m10:25:05.491086 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112560bb0>]}
[0m10:25:05.491930 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.05s]
[0m10:25:05.493222 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m10:25:05.494240 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m10:25:05.494968 [info ] [Thread-1  ]: 7 of 14 START sql view model analytics.history ................................. [RUN]
[0m10:25:05.496107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.history)
[0m10:25:05.496759 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m10:25:05.502397 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:25:05.503737 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 10:25:05.497134 => 10:25:05.503337
[0m10:25:05.504448 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m10:25:05.509975 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:25:05.511180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:05.511945 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m10:25:05.563807 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:08e2687a-7854-453a-a11f-5175d132cc8b&page=queryresults
[0m10:25:05.627318 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:25:05.631834 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 10:25:00.465547 => 10:25:05.631423
[0m10:25:05.633020 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254fd00>]}
[0m10:25:05.633806 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 5.20s]
[0m10:25:05.634719 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m10:25:05.635684 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m10:25:05.636431 [info ] [Thread-4  ]: 8 of 14 START sql view model analytics.current ................................. [RUN]
[0m10:25:05.637614 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current)
[0m10:25:05.638282 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m10:25:05.644272 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:25:05.645500 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 10:25:05.638674 => 10:25:05.645148
[0m10:25:05.646069 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m10:25:05.655384 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:25:05.656597 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:25:05.657505 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:25:05.951226 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e5ef0ebb-1693-49ad-9128-d11e90e613ac&page=queryresults
[0m10:25:06.009319 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 10:25:05.105211 => 10:25:06.008953
[0m10:25:06.010608 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11295cdf0>]}
[0m10:25:06.011534 [info ] [Thread-2  ]: 6 of 14 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m10:25:06.012567 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m10:25:06.013583 [debug] [Thread-3  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:25:06.014223 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:25:06.014875 [info ] [Thread-3  ]: 9 of 14 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m10:25:06.015686 [info ] [Thread-2  ]: 10 of 14 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m10:25:06.017442 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m10:25:06.018663 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m10:25:06.019355 [debug] [Thread-3  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:25:06.019944 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:25:06.031083 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:25:06.037913 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:25:06.039210 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 10:25:06.020327 => 10:25:06.038850
[0m10:25:06.040006 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 10:25:06.031681 => 10:25:06.039577
[0m10:25:06.041197 [debug] [Thread-3  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:25:06.043596 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:25:06.048172 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:25:06.055509 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:25:06.058221 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:25:06.059155 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:25:06.059918 [debug] [Thread-3  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m10:25:06.060725 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:25:06.443936 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:113e4a54-d893-423e-ac22-6f69c91fa4a5&page=queryresults
[0m10:25:06.540124 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 10:25:05.504860 => 10:25:06.539675
[0m10:25:06.541601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112955bb0>]}
[0m10:25:06.542542 [info ] [Thread-1  ]: 7 of 14 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m10:25:06.543568 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m10:25:06.809014 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:241a4420-18e9-49fe-b168-bfde68567e4b&page=queryresults
[0m10:25:06.901137 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 10:25:05.646423 => 10:25:06.900270
[0m10:25:06.902527 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112958e80>]}
[0m10:25:06.903468 [info ] [Thread-4  ]: 8 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m10:25:06.904462 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m10:25:06.905623 [debug] [Thread-1  ]: Began running node model.ccwj.current_position_information
[0m10:25:06.906439 [info ] [Thread-1  ]: 11 of 14 START sql view model analytics.current_position_information ........... [RUN]
[0m10:25:06.907151 [debug] [Thread-4  ]: Began running node model.ccwj.daily_totals
[0m10:25:06.908164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_position_information)
[0m10:25:06.908941 [info ] [Thread-4  ]: 12 of 14 START sql view model analytics.daily_totals ........................... [RUN]
[0m10:25:06.909632 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_position_information
[0m10:25:06.910760 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.daily_totals)
[0m10:25:06.915639 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m10:25:06.916466 [debug] [Thread-4  ]: Began compiling node model.ccwj.daily_totals
[0m10:25:06.920514 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (compile): 10:25:06.911206 => 10:25:06.920034
[0m10:25:06.926676 [debug] [Thread-1  ]: Began executing node model.ccwj.current_position_information
[0m10:25:06.930760 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:25:06.937758 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m10:25:06.939602 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5b126842-9f05-4cf8-aad6-b7071e77a4e3&page=queryresults
[0m10:25:06.940765 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (compile): 10:25:06.917170 => 10:25:06.940362
[0m10:25:06.942818 [debug] [Thread-4  ]: Began executing node model.ccwj.daily_totals
[0m10:25:06.948100 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:25:06.949873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:25:06.951648 [debug] [Thread-1  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m10:25:06.953937 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:25:06.954807 [debug] [Thread-4  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    history.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`history`
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:25:07.541304 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 10:25:06.044412 => 10:25:07.540847
[0m10:25:07.542676 [info ] [Thread-3  ]: 9 of 14 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 1.53s]
[0m10:25:07.543702 [debug] [Thread-3  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:25:07.544529 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m10:25:07.545384 [info ] [Thread-3  ]: 13 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m10:25:07.546550 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.overall_position_performance)
[0m10:25:07.547205 [debug] [Thread-3  ]: Began compiling node model.ccwj.overall_position_performance
[0m10:25:07.552940 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m10:25:07.555450 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (compile): 10:25:07.547584 => 10:25:07.554898
[0m10:25:07.556200 [debug] [Thread-3  ]: Began executing node model.ccwj.overall_position_performance
[0m10:25:07.561651 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m10:25:07.563886 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:eeea85f9-01cd-45ac-9665-b53b2ad617e6&page=queryresults
[0m10:25:07.566039 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9e0e1364-5ead-4105-b589-ace2a7df6b41&page=queryresults
[0m10:25:07.567408 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:25:07.571845 [debug] [Thread-3  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m10:25:07.647279 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 10:25:06.048665 => 10:25:07.646871
[0m10:25:07.648626 [info ] [Thread-2  ]: 10 of 14 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.63s]
[0m10:25:07.650045 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:25:07.650842 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m10:25:07.651677 [info ] [Thread-2  ]: 14 of 14 START sql view model analytics.positions .............................. [RUN]
[0m10:25:07.652712 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.positions)
[0m10:25:07.653299 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m10:25:07.657937 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m10:25:07.659812 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 10:25:07.653623 => 10:25:07.659404
[0m10:25:07.660371 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m10:25:07.668530 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m10:25:07.669812 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:25:07.670446 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m10:25:07.978667 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (execute): 10:25:06.943328 => 10:25:07.978300
[0m10:25:07.980064 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d29a0>]}
[0m10:25:07.980998 [info ] [Thread-4  ]: 12 of 14 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m10:25:07.982198 [debug] [Thread-4  ]: Finished running node model.ccwj.daily_totals
[0m10:25:07.997210 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (execute): 10:25:06.931363 => 10:25:07.996828
[0m10:25:07.998645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e77f0>]}
[0m10:25:07.999710 [info ] [Thread-1  ]: 11 of 14 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m10:25:08.001244 [debug] [Thread-1  ]: Finished running node model.ccwj.current_position_information
[0m10:25:08.178663 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8feb1664-333c-47ba-bafb-4df056c03b1c&page=queryresults
[0m10:25:08.216222 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d932a929-0fe2-4c9a-824f-6b01f27fa58b&page=queryresults
[0m10:25:08.534483 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 10:25:07.660703 => 10:25:08.532865
[0m10:25:08.536301 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112986ca0>]}
[0m10:25:08.537382 [info ] [Thread-2  ]: 14 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m10:25:08.538931 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m10:25:08.543415 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (execute): 10:25:07.556603 => 10:25:08.543078
[0m10:25:08.544679 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6db7e4cb-1b5b-4359-9625-8063b3addbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112986d30>]}
[0m10:25:08.545598 [info ] [Thread-3  ]: 13 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:25:08.546624 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m10:25:08.549358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:08.550138 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m10:25:08.550650 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m10:25:08.551095 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m10:25:08.551532 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:25:08.552154 [info ] [MainThread]: 
[0m10:25:08.552763 [info ] [MainThread]: Finished running 8 view models, 1 table model, 3 tests, 2 seeds in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m10:25:08.556528 [debug] [MainThread]: Command end result
[0m10:25:08.689506 [info ] [MainThread]: 
[0m10:25:08.690201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:25:08.690906 [info ] [MainThread]: 
[0m10:25:08.691620 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m10:25:08.694345 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.447844, "process_user_time": 4.611073, "process_kernel_time": 0.606926, "process_mem_max_rss": "141017088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:25:08.695670 [debug] [MainThread]: Command `cli build` succeeded at 10:25:08.695267 after 11.45 seconds
[0m10:25:08.696483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f856400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121598b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120bffd0>]}
[0m10:25:08.697439 [debug] [MainThread]: Flushing usage events
[0m10:32:07.535705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b2fa0>]}


============================== 10:32:07.543010 | 29d22870-e713-49cf-9b20-c2a38f93b32b ==============================
[0m10:32:07.543010 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:32:07.543822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:08.301435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e26a550>]}
[0m10:32:08.403097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f14d1f0>]}
[0m10:32:08.404942 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:32:08.426366 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:32:08.483528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:32:08.484013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:32:08.491090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f42d0d0>]}
[0m10:32:08.506491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f352130>]}
[0m10:32:08.507085 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:32:08.507521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f352850>]}
[0m10:32:08.509879 [info ] [MainThread]: 
[0m10:32:08.511252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:32:08.513587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:32:08.514612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:10.289088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:32:10.290093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:32:10.588526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f223ee0>]}
[0m10:32:10.590039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:32:10.590706 [info ] [MainThread]: 
[0m10:32:10.596230 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m10:32:10.597471 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m10:32:10.598753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m10:32:10.599489 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m10:32:10.614321 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:32:10.616040 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 10:32:10.599902 => 10:32:10.615604
[0m10:32:10.616846 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m10:32:10.666002 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:32:10.666919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:32:10.667562 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:32:11.265702 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b8074b27-8ab7-4a14-817c-1b80541b17e5&page=queryresults
[0m10:32:11.838826 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 10:32:10.617668 => 10:32:11.838486
[0m10:32:11.840147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29d22870-e713-49cf-9b20-c2a38f93b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c3880>]}
[0m10:32:11.841144 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m10:32:11.842172 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m10:32:11.844687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:11.845209 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:32:11.845724 [info ] [MainThread]: 
[0m10:32:11.846474 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m10:32:11.847800 [debug] [MainThread]: Command end result
[0m10:32:11.861167 [info ] [MainThread]: 
[0m10:32:11.861923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:32:11.862690 [info ] [MainThread]: 
[0m10:32:11.864437 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:32:11.869022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4048934, "process_user_time": 3.442774, "process_kernel_time": 0.47475, "process_mem_max_rss": "127868928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:32:11.869957 [debug] [MainThread]: Command `cli run` succeeded at 10:32:11.869754 after 4.41 seconds
[0m10:32:11.870541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f223c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c32e0>]}
[0m10:32:11.871098 [debug] [MainThread]: Flushing usage events
[0m11:48:30.633838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134063a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e5c10>]}


============================== 11:48:30.640239 | 3920142f-786e-4982-b447-4a31f8c34d2e ==============================
[0m11:48:30.640239 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:48:30.640902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:48:31.404333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ca040>]}
[0m11:48:31.512045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141cc3d0>]}
[0m11:48:31.513656 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:48:31.535507 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:48:31.594242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:31.594745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:31.602425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145840d0>]}
[0m11:48:31.619008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144a5310>]}
[0m11:48:31.619618 [info ] [MainThread]: Found 10 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:48:31.620140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144a5700>]}
[0m11:48:31.622350 [info ] [MainThread]: 
[0m11:48:31.623516 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:48:31.624848 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:48:31.625416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:33.548225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:48:33.549434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:33.830908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11436f520>]}
[0m11:48:33.832591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:33.833250 [info ] [MainThread]: 
[0m11:48:33.838724 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m11:48:33.840002 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m11:48:33.841794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m11:48:33.842580 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m11:48:33.858731 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m11:48:33.860823 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 11:48:33.843018 => 11:48:33.860377
[0m11:48:33.861467 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m11:48:33.914929 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m11:48:33.915942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:33.916809 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    left join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m11:48:34.626430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d14b2645-b81e-4cec-aedc-51bead10a029&page=queryresults
[0m11:48:35.124719 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 11:48:33.861831 => 11:48:35.124391
[0m11:48:35.126255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3920142f-786e-4982-b447-4a31f8c34d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114618b20>]}
[0m11:48:35.127235 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m11:48:35.128553 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m11:48:35.130979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:35.131527 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m11:48:35.132022 [info ] [MainThread]: 
[0m11:48:35.132540 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m11:48:35.133792 [debug] [MainThread]: Command end result
[0m11:48:35.148166 [info ] [MainThread]: 
[0m11:48:35.148987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:35.149682 [info ] [MainThread]: 
[0m11:48:35.150822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:35.156145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5997434, "process_user_time": 3.406016, "process_kernel_time": 0.473595, "process_mem_max_rss": "127598592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:48:35.157609 [debug] [MainThread]: Command `cli run` succeeded at 11:48:35.157245 after 4.60 seconds
[0m11:48:35.158760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11436f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11436d610>]}
[0m11:48:35.159843 [debug] [MainThread]: Flushing usage events
[0m11:53:12.856299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf901f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfbfd60>]}


============================== 11:53:12.862609 | d88ac883-5883-44cb-be7e-50900e3ec9f8 ==============================
[0m11:53:12.862609 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:53:12.863992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:13.687973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd0730>]}
[0m11:53:13.794468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce59fa0>]}
[0m11:53:13.796310 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:53:13.817461 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:53:13.872073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:13.872612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:13.880921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1430d0>]}
[0m11:53:13.897628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06cd60>]}
[0m11:53:13.898257 [info ] [MainThread]: Found 10 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:53:13.900939 [info ] [MainThread]: 
[0m11:53:13.902066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:13.903980 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:53:13.904619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:15.568626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:53:15.569877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:15.945675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06c0a0>]}
[0m11:53:15.947484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:15.948513 [info ] [MainThread]: 
[0m11:53:15.954329 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m11:53:15.955098 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m11:53:15.955683 [debug] [Thread-3  ]: Began running node model.ccwj.my_python_model_test
[0m11:53:15.956389 [info ] [Thread-1  ]: 1 of 15 START sql view model analytics.calendar_dates .......................... [RUN]
[0m11:53:15.957171 [info ] [Thread-2  ]: 2 of 15 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m11:53:15.957921 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_current
[0m11:53:15.958744 [info ] [Thread-3  ]: 3 of 15 START python table model analytics.my_python_model_test ................ [RUN]
[0m11:53:15.959973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m11:53:15.961280 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m11:53:15.962119 [info ] [Thread-4  ]: 4 of 15 START seed file analytics.0417_current ................................. [RUN]
[0m11:53:15.963486 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.my_python_model_test'
[0m11:53:15.964382 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m11:53:15.964959 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m11:53:15.966035 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m11:53:15.966602 [debug] [Thread-3  ]: Began compiling node model.ccwj.my_python_model_test
[0m11:53:15.978030 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m11:53:15.983378 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m11:53:15.984198 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_current
[0m11:53:15.988691 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_current (compile): 11:53:15.988114 => 11:53:15.988122
[0m11:53:15.992274 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_current
[0m11:53:16.004313 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 11:53:15.967025 => 11:53:16.003857
[0m11:53:16.005066 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 11:53:15.978607 => 11:53:16.004721
[0m11:53:16.026195 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m11:53:16.044415 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.my_python_model_test"
[0m11:53:16.048792 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m11:53:16.067361 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:53:16.092345 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m11:53:16.099773 [debug] [Thread-3  ]: Timing info for model.ccwj.my_python_model_test (compile): 11:53:15.984610 => 11:53:16.099340
[0m11:53:16.106920 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:53:16.107884 [debug] [Thread-3  ]: Began executing node model.ccwj.my_python_model_test
[0m11:53:16.109062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:16.123929 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m11:53:16.135330 [debug] [Thread-3  ]: Writing runtime python for node "model.ccwj.my_python_model_test"
[0m11:53:16.138787 [debug] [Thread-3  ]: On model.ccwj.my_python_model_test: 
  
    
from pyspark.sql import SparkSession

spark = SparkSession.builder.appName('smallTest').getOrCreate()

spark.conf.set("viewsEnabled","true")
spark.conf.set("temporaryGcsBucket","None")

def model(dbt, session):

    # Fetch the data
    import yfinance as yf
    tickers_list = ['AAPL', 'WMT', 'IBM', 'MU', 'BA', 'AXP']

    data = yf.download(tickers_list,'2015-1-1')['Adj Close']

    # Print first 5 rows of the data
    print(data.head())

    return final_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "ccwj-dbt"
    schema = "analytics"
    identifier = "my_python_model_test"
    
    def __repr__(self):
        return 'ccwj-dbt.analytics.my_python_model_test'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



dbt = dbtObj(spark.read.format("bigquery").load)
df = model(dbt, spark)

# COMMAND ----------
# this is materialization code dbt generated, please do not modify

import pyspark
# make sure pandas exists before using it
try:
  import pandas
  pandas_available = True
except ImportError:
  pandas_available = False

# make sure pyspark.pandas exists before using it
try:
  import pyspark.pandas
  pyspark_pandas_api_available = True
except ImportError:
  pyspark_pandas_api_available = False

# make sure databricks.koalas exists before using it
try:
  import databricks.koalas
  koalas_available = True
except ImportError:
  koalas_available = False

# preferentially convert pandas DataFrames to pandas-on-Spark or Koalas DataFrames first
# since they know how to convert pandas DataFrames better than `spark.createDataFrame(df)`
# and converting from pandas-on-Spark to Spark DataFrame has no overhead
if pyspark_pandas_api_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = pyspark.pandas.frame.DataFrame(df)
elif koalas_available and pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = databricks.koalas.frame.DataFrame(df)

# convert to pyspark.sql.dataframe.DataFrame
if isinstance(df, pyspark.sql.dataframe.DataFrame):
  pass  # since it is already a Spark DataFrame
elif pyspark_pandas_api_available and isinstance(df, pyspark.pandas.frame.DataFrame):
  df = df.to_spark()
elif koalas_available and isinstance(df, databricks.koalas.frame.DataFrame):
  df = df.to_spark()
elif pandas_available and isinstance(df, pandas.core.frame.DataFrame):
  df = spark.createDataFrame(df)
else:
  msg = f"{type(df)} is not a supported type for dbt Python materialization"
  raise Exception(msg)

df.write \
  .mode("overwrite") \
  .format("bigquery") \
  .option("writeMethod", "indirect").option("writeDisposition", 'WRITE_TRUNCATE') \
  .save("ccwj-dbt.analytics.my_python_model_test")

  
[0m11:53:16.139772 [debug] [Thread-3  ]: Timing info for model.ccwj.my_python_model_test (execute): 11:53:16.110839 => 11:53:16.139479
[0m11:53:16.140814 [error] [Thread-3  ]: [31mUnhandled error while executing target/run/ccwj/models/example/my_python_model_test.py[0m
Need to supply dataproc_region in profile to submit python job
[0m11:53:16.148859 [debug] [Thread-3  ]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 380, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 326, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/base.py", line 427, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.9/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 89, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/context/providers.py", line 1348, in submit_python_job
    return self.adapter.submit_python_job(parsed_model, compiled_code)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 155, in execution_with_log
    response = code_execution_function(*args)
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 1450, in submit_python_job
    job_helper = self.python_submission_helpers[submission_method](
  File "/usr/local/lib/python3.9/site-packages/dbt/adapters/bigquery/python_submissions.py", line 39, in __init__
    raise ValueError(
ValueError: Need to supply dataproc_region in profile to submit python job

[0m11:53:16.149690 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d7370>]}
[0m11:53:16.150450 [error] [Thread-3  ]: 3 of 15 ERROR creating python table model analytics.my_python_model_test ....... [[31mERROR[0m in 0.19s]
[0m11:53:16.151460 [debug] [Thread-3  ]: Finished running node model.ccwj.my_python_model_test
[0m11:53:16.152115 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m11:53:16.152970 [info ] [Thread-3  ]: 5 of 15 START seed file analytics.0417_history ................................. [RUN]
[0m11:53:16.153891 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.my_python_model_test, now seed.ccwj.0417_history)
[0m11:53:16.154382 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m11:53:16.154921 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 11:53:16.154665 => 11:53:16.154668
[0m11:53:16.155421 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m11:53:16.239792 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:53:16.640978 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m11:53:16.641965 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:53:16.759812 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1aab1b0f-577f-4b06-b19f-517c8a2a7c3c&page=queryresults
[0m11:53:17.076298 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:023d95e7-684a-413d-9ef7-755eaae522a0&page=queryresults
[0m11:53:17.210926 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 11:53:16.059347 => 11:53:17.210640
[0m11:53:17.211934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23ae20>]}
[0m11:53:17.212725 [info ] [Thread-1  ]: 1 of 15 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m11:53:17.213733 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m11:53:20.150837 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 11:53:16.092675 => 11:53:20.150384
[0m11:53:20.152528 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a5af0>]}
[0m11:53:20.153730 [info ] [Thread-2  ]: 2 of 15 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.19s]
[0m11:53:20.154817 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m11:53:20.155914 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:53:20.156595 [info ] [Thread-1  ]: 6 of 15 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m11:53:20.157830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m11:53:20.158525 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:53:20.175352 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:53:20.179105 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 11:53:20.158917 => 11:53:20.178569
[0m11:53:20.179825 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:53:20.204778 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:53:20.206271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:20.206931 [debug] [Thread-1  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:53:20.414648 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m11:53:20.834532 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7e6ed168-ee40-4f72-9bf3-4a00df582e65&page=queryresults
[0m11:53:20.885383 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4b78957e-08e4-4069-8e8b-8bbc09083084&page=queryresults
[0m11:53:21.243593 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m11:53:21.249767 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 11:53:16.156117 => 11:53:21.249397
[0m11:53:21.250985 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d38c910>]}
[0m11:53:21.251811 [info ] [Thread-3  ]: 5 of 15 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.10s]
[0m11:53:21.252747 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m11:53:21.253771 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m11:53:21.254502 [info ] [Thread-2  ]: 7 of 15 START sql view model analytics.history ................................. [RUN]
[0m11:53:21.255669 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.history)
[0m11:53:21.256362 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m11:53:21.261174 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:53:21.262448 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 11:53:21.256745 => 11:53:21.262092
[0m11:53:21.263026 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m11:53:21.269695 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:53:21.270867 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:53:21.271603 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m11:53:21.529354 [debug] [Thread-4  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:53:21.633234 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 11:53:20.180251 => 11:53:21.632706
[0m11:53:21.634617 [info ] [Thread-1  ]: 6 of 15 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.48s]
[0m11:53:21.635657 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:53:21.636787 [debug] [Thread-3  ]: Began running node model.ccwj.my_second_dbt_model
[0m11:53:21.637599 [info ] [Thread-3  ]: 8 of 15 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m11:53:21.639135 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.my_second_dbt_model)
[0m11:53:21.639882 [debug] [Thread-3  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m11:53:21.644653 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m11:53:21.646894 [debug] [Thread-3  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 11:53:21.640286 => 11:53:21.646376
[0m11:53:21.647728 [debug] [Thread-3  ]: Began executing node model.ccwj.my_second_dbt_model
[0m11:53:21.653040 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m11:53:21.654143 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:53:21.654825 [debug] [Thread-3  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m11:53:21.822629 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:06a3b36a-45cb-4279-b90a-33762426b27a&page=queryresults
[0m11:53:21.909603 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c5cc181f-40da-4360-ba70-bf5765d71629&page=queryresults
[0m11:53:22.116578 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:df74f5f0-ed49-4f79-aeb9-baed682b0e68&page=queryresults
[0m11:53:22.222946 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 11:53:21.263384 => 11:53:22.222570
[0m11:53:22.224371 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d692be0>]}
[0m11:53:22.225365 [info ] [Thread-2  ]: 7 of 15 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m11:53:22.226461 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m11:53:22.289664 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:53:22.294214 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_current (execute): 11:53:15.998444 => 11:53:22.293895
[0m11:53:22.295499 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c60a0>]}
[0m11:53:22.296371 [info ] [Thread-4  ]: 4 of 15 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 6.33s]
[0m11:53:22.297943 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_current
[0m11:53:22.299091 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m11:53:22.299935 [info ] [Thread-1  ]: 9 of 15 START sql view model analytics.current ................................. [RUN]
[0m11:53:22.301051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.current)
[0m11:53:22.301695 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m11:53:22.307511 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:53:22.309964 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 11:53:22.302047 => 11:53:22.309462
[0m11:53:22.310583 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m11:53:22.317064 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:53:22.318564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:22.319483 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:53:22.541063 [debug] [Thread-3  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 11:53:21.648133 => 11:53:22.540698
[0m11:53:22.542353 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b6b80>]}
[0m11:53:22.543277 [info ] [Thread-3  ]: 8 of 15 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:53:22.544294 [debug] [Thread-3  ]: Finished running node model.ccwj.my_second_dbt_model
[0m11:53:22.545686 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:53:22.546760 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:53:22.549492 [info ] [Thread-4  ]: 10 of 15 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m11:53:22.551195 [info ] [Thread-2  ]: 11 of 15 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:53:22.553677 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m11:53:22.558449 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:53:22.559798 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:53:22.560920 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:53:22.576674 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:53:22.590542 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:53:22.591571 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:53:22.561530 => 11:53:22.591176
[0m11:53:22.592277 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:53:22.592993 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:53:22.577201 => 11:53:22.592652
[0m11:53:22.597400 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:53:22.598260 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:53:22.603237 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:53:22.604809 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:53:22.605580 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:53:22.606618 [debug] [Thread-4  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m11:53:22.607331 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:53:22.882335 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:52d8f31a-dd38-4388-a2b3-ca1fbe2985a9&page=queryresults
[0m11:53:23.342471 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ce958746-3f07-4c8c-8a6d-6ec3783708af&page=queryresults
[0m11:53:23.372440 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 11:53:22.310938 => 11:53:23.372073
[0m11:53:23.374464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d271d00>]}
[0m11:53:23.375521 [info ] [Thread-1  ]: 9 of 15 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m11:53:23.376552 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fe327dcd-2084-43ab-a074-324cf284f696&page=queryresults
[0m11:53:23.377563 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m11:53:23.380939 [debug] [Thread-3  ]: Began running node model.ccwj.current_position_information
[0m11:53:23.381658 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m11:53:23.382808 [info ] [Thread-3  ]: 12 of 15 START sql view model analytics.current_position_information ........... [RUN]
[0m11:53:23.384236 [info ] [Thread-1  ]: 13 of 15 START sql view model analytics.daily_totals ........................... [RUN]
[0m11:53:23.385561 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now model.ccwj.current_position_information)
[0m11:53:23.386598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.daily_totals)
[0m11:53:23.387240 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_position_information
[0m11:53:23.387919 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m11:53:23.392617 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m11:53:23.398923 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m11:53:23.401341 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (compile): 11:53:23.388358 => 11:53:23.400889
[0m11:53:23.402120 [debug] [Thread-3  ]: Began executing node model.ccwj.current_position_information
[0m11:53:23.408199 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m11:53:23.408977 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 11:53:23.393118 => 11:53:23.408615
[0m11:53:23.409777 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m11:53:23.417303 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m11:53:23.418295 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:53:23.419291 [debug] [Thread-3  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m11:53:23.421568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:23.422994 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m11:53:24.117763 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9ea905f-c8d0-41f2-9719-98f1c6e2b5e3&page=queryresults
[0m11:53:24.122354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ca559875-59ba-48ed-8a65-44a760094d48&page=queryresults
[0m11:53:24.143879 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:53:22.593309 => 11:53:24.143176
[0m11:53:24.146110 [info ] [Thread-4  ]: 10 of 15 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.59s]
[0m11:53:24.147497 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:53:24.148822 [debug] [Thread-4  ]: Began running node model.ccwj.overall_position_performance
[0m11:53:24.149876 [info ] [Thread-4  ]: 14 of 15 START sql view model analytics.overall_position_performance ........... [RUN]
[0m11:53:24.151444 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.overall_position_performance)
[0m11:53:24.153594 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:53:22.598961 => 11:53:24.153160
[0m11:53:24.154304 [debug] [Thread-4  ]: Began compiling node model.ccwj.overall_position_performance
[0m11:53:24.155563 [info ] [Thread-2  ]: 11 of 15 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.60s]
[0m11:53:24.160679 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m11:53:24.161711 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:53:24.162910 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m11:53:24.164078 [info ] [Thread-2  ]: 15 of 15 START sql view model analytics.positions .............................. [RUN]
[0m11:53:24.165049 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (compile): 11:53:24.156055 => 11:53:24.164604
[0m11:53:24.166162 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.positions)
[0m11:53:24.166917 [debug] [Thread-4  ]: Began executing node model.ccwj.overall_position_performance
[0m11:53:24.167546 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m11:53:24.173743 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m11:53:24.179775 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m11:53:24.182426 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:53:24.183762 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 11:53:24.174255 => 11:53:24.183141
[0m11:53:24.184985 [debug] [Thread-4  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m11:53:24.185944 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m11:53:24.196814 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m11:53:24.200058 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:53:24.201595 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m11:53:24.517011 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 11:53:23.410154 => 11:53:24.516641
[0m11:53:24.520943 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (execute): 11:53:23.402560 => 11:53:24.520603
[0m11:53:24.522212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d728fa0>]}
[0m11:53:24.523265 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f66a0>]}
[0m11:53:24.524128 [info ] [Thread-1  ]: 13 of 15 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m11:53:24.525053 [info ] [Thread-3  ]: 12 of 15 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m11:53:24.526187 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m11:53:24.527104 [debug] [Thread-3  ]: Finished running node model.ccwj.current_position_information
[0m11:53:24.784079 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:18d14700-8cfa-4ecb-991d-32845ca068fb&page=queryresults
[0m11:53:24.911119 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:beb96752-819f-4b99-86ce-8b23a026bea0&page=queryresults
[0m11:53:25.181539 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 11:53:24.188453 => 11:53:25.180913
[0m11:53:25.183381 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d650fa0>]}
[0m11:53:25.184469 [info ] [Thread-2  ]: 15 of 15 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m11:53:25.185868 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m11:53:25.272438 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (execute): 11:53:24.167952 => 11:53:25.272070
[0m11:53:25.273782 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd88ac883-5883-44cb-be7e-50900e3ec9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1eef70>]}
[0m11:53:25.274715 [info ] [Thread-4  ]: 14 of 15 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m11:53:25.275759 [debug] [Thread-4  ]: Finished running node model.ccwj.overall_position_performance
[0m11:53:25.278473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:25.279043 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m11:53:25.279558 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m11:53:25.280053 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m11:53:25.280831 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m11:53:25.281581 [info ] [MainThread]: 
[0m11:53:25.282289 [info ] [MainThread]: Finished running 2 table models, 8 view models, 2 seeds, 3 tests in 0 hours 0 minutes and 11.38 seconds (11.38s).
[0m11:53:25.286508 [debug] [MainThread]: Command end result
[0m11:53:25.307511 [info ] [MainThread]: 
[0m11:53:25.308420 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:53:25.309161 [info ] [MainThread]: 
[0m11:53:25.309833 [error] [MainThread]:   Need to supply dataproc_region in profile to submit python job
[0m11:53:25.310504 [info ] [MainThread]: 
[0m11:53:25.311110 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m11:53:25.315365 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 12.539095, "process_user_time": 4.554387, "process_kernel_time": 0.593398, "process_mem_max_rss": "141553664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:25.316603 [debug] [MainThread]: Command `cli build` failed at 11:53:25.316326 after 12.54 seconds
[0m11:53:25.317439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce04520>]}
[0m11:53:25.318202 [debug] [MainThread]: Flushing usage events
[0m11:54:12.917692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf78400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7aaf0>]}


============================== 11:54:12.924074 | 89f104e0-e3c7-4b7f-9f6e-1cf110de4152 ==============================
[0m11:54:12.924074 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:54:12.924827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:54:13.658754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da38ca0>]}
[0m11:54:13.761006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e802ee0>]}
[0m11:54:13.762479 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:54:13.784634 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:54:13.873015 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:54:13.873870 [debug] [MainThread]: Partial parsing: deleted file: ccwj://models/example/my_python_model_test.py
[0m11:54:13.889865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec020d0>]}
[0m11:54:13.908013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaeb100>]}
[0m11:54:13.908639 [info ] [MainThread]: Found 9 models, 3 tests, 2 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:54:13.911458 [info ] [MainThread]: 
[0m11:54:13.912504 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:54:13.914301 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:54:13.914835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:15.949932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:54:15.950994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:16.334202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e914130>]}
[0m11:54:16.335828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:16.336477 [info ] [MainThread]: 
[0m11:54:16.342123 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m11:54:16.342889 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m11:54:16.343597 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m11:54:16.344211 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m11:54:16.362679 [info ] [Thread-1  ]: 1 of 14 START sql view model analytics.calendar_dates .......................... [RUN]
[0m11:54:16.363852 [info ] [Thread-2  ]: 2 of 14 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m11:54:16.365137 [info ] [Thread-3  ]: 3 of 14 START seed file analytics.0417_current ................................. [RUN]
[0m11:54:16.366466 [info ] [Thread-4  ]: 4 of 14 START seed file analytics.0417_history ................................. [RUN]
[0m11:54:16.367846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m11:54:16.369251 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m11:54:16.370407 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m11:54:16.371488 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:54:16.372129 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m11:54:16.372856 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m11:54:16.373562 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m11:54:16.374256 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m11:54:16.387818 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m11:54:16.391348 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 11:54:16.390893 => 11:54:16.390900
[0m11:54:16.393927 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 11:54:16.393565 => 11:54:16.393570
[0m11:54:16.401130 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m11:54:16.402019 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m11:54:16.402625 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m11:54:16.403231 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 11:54:16.374851 => 11:54:16.402927
[0m11:54:16.422243 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 11:54:16.380544 => 11:54:16.421761
[0m11:54:16.432561 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m11:54:16.439521 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m11:54:16.456821 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:54:16.503957 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:54:16.530924 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m11:54:16.566674 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:54:16.570100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:16.570927 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m11:54:16.978845 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m11:54:16.979879 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:54:17.119862 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6ee89d8c-67f2-48c9-a79a-fc03fd630d1a&page=queryresults
[0m11:54:17.374224 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5cbed87b-3a72-430e-8f8c-068b04d741a2&page=queryresults
[0m11:54:17.583461 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 11:54:16.462698 => 11:54:17.583145
[0m11:54:17.584730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eec5c40>]}
[0m11:54:17.585786 [info ] [Thread-1  ]: 1 of 14 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m11:54:17.586733 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m11:54:20.508540 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:54:20.831010 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0c1faf29-9b93-4889-ac53-041cd9b157a5&page=queryresults
[0m11:54:20.838160 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m11:54:21.235607 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b00a179c-82fe-467d-9492-7a34eef8bb33&page=queryresults
[0m11:54:21.248777 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:54:21.254314 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 11:54:16.403726 => 11:54:21.253951
[0m11:54:21.255453 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca4fa0>]}
[0m11:54:21.256227 [info ] [Thread-3  ]: 3 of 14 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 4.89s]
[0m11:54:21.257114 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m11:54:21.257982 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m11:54:21.258675 [info ] [Thread-1  ]: 5 of 14 START sql view model analytics.current ................................. [RUN]
[0m11:54:21.259724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m11:54:21.260313 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m11:54:21.265774 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:54:21.266946 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 11:54:21.260679 => 11:54:21.266599
[0m11:54:21.267503 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m11:54:21.272078 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:54:21.273829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:21.274584 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:54:21.663961 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m11:54:21.670226 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 11:54:16.422579 => 11:54:21.669772
[0m11:54:21.671596 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc4100>]}
[0m11:54:21.672438 [info ] [Thread-4  ]: 4 of 14 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 5.30s]
[0m11:54:21.673426 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m11:54:21.674588 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m11:54:21.675373 [info ] [Thread-3  ]: 6 of 14 START sql view model analytics.history ................................. [RUN]
[0m11:54:21.677222 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m11:54:21.678116 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m11:54:21.685867 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:54:21.688602 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 11:54:21.678581 => 11:54:21.687455
[0m11:54:21.690554 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m11:54:21.697310 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:54:21.699221 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:54:21.700828 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m11:54:21.805152 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 11:54:16.492042 => 11:54:21.804770
[0m11:54:21.806399 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eecf3a0>]}
[0m11:54:21.807450 [info ] [Thread-2  ]: 2 of 14 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 5.44s]
[0m11:54:21.809255 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m11:54:21.810324 [debug] [Thread-4  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:54:21.811172 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bd075a7d-e41f-4d07-af4c-2525258253fb&page=queryresults
[0m11:54:21.811759 [info ] [Thread-4  ]: 7 of 14 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m11:54:21.814719 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m11:54:21.816216 [debug] [Thread-4  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:54:21.830220 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:54:21.831671 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 11:54:21.816838 => 11:54:21.831241
[0m11:54:21.832387 [debug] [Thread-4  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:54:21.855175 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:54:21.856165 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:21.856731 [debug] [Thread-4  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:54:22.191768 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:67d50942-39e0-418d-8d2a-a909ab359be9&page=queryresults
[0m11:54:22.242945 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 11:54:21.267859 => 11:54:22.242584
[0m11:54:22.244251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f094730>]}
[0m11:54:22.245164 [info ] [Thread-1  ]: 5 of 14 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m11:54:22.246227 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m11:54:22.247314 [debug] [Thread-2  ]: Began running node model.ccwj.current_position_information
[0m11:54:22.248392 [info ] [Thread-2  ]: 8 of 14 START sql view model analytics.current_position_information ............ [RUN]
[0m11:54:22.250218 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now model.ccwj.current_position_information)
[0m11:54:22.251091 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_position_information
[0m11:54:22.255651 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m11:54:22.256843 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (compile): 11:54:22.251514 => 11:54:22.256480
[0m11:54:22.257465 [debug] [Thread-2  ]: Began executing node model.ccwj.current_position_information
[0m11:54:22.262532 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m11:54:22.263562 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:22.264429 [debug] [Thread-2  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m11:54:22.546851 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:04d3c5b0-b13e-44f0-b5e0-60afc4a6000f&page=queryresults
[0m11:54:22.580008 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 11:54:21.691292 => 11:54:22.579525
[0m11:54:22.581604 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed37a90>]}
[0m11:54:22.582626 [info ] [Thread-3  ]: 6 of 14 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m11:54:22.583655 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m11:54:22.584804 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m11:54:22.585741 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m11:54:22.586567 [info ] [Thread-1  ]: 9 of 14 START sql view model analytics.daily_totals ............................ [RUN]
[0m11:54:22.587364 [info ] [Thread-3  ]: 10 of 14 START sql view model analytics.overall_position_performance ........... [RUN]
[0m11:54:22.588647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.daily_totals)
[0m11:54:22.589737 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.overall_position_performance)
[0m11:54:22.590414 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m11:54:22.591000 [debug] [Thread-3  ]: Began compiling node model.ccwj.overall_position_performance
[0m11:54:22.597195 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m11:54:22.604373 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m11:54:22.607264 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 11:54:22.591389 => 11:54:22.606785
[0m11:54:22.608051 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (compile): 11:54:22.597744 => 11:54:22.607709
[0m11:54:22.608571 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m11:54:22.609142 [debug] [Thread-3  ]: Began executing node model.ccwj.overall_position_performance
[0m11:54:22.614184 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m11:54:22.620934 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m11:54:22.622532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:22.623225 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:54:22.624136 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m11:54:22.625107 [debug] [Thread-3  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m11:54:22.791685 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9d7f1269-5aa2-446e-80d0-b6d6184c350a&page=queryresults
[0m11:54:23.189006 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (execute): 11:54:22.257854 => 11:54:23.188438
[0m11:54:23.191198 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f08bbe0>]}
[0m11:54:23.192110 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b9879505-eea9-4d90-af87-4d6285cadc54&page=queryresults
[0m11:54:23.193012 [info ] [Thread-2  ]: 8 of 14 OK created sql view model analytics.current_position_information ....... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:54:23.195872 [debug] [Thread-2  ]: Finished running node model.ccwj.current_position_information
[0m11:54:23.197046 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m11:54:23.198194 [info ] [Thread-2  ]: 11 of 14 START sql view model analytics.positions .............................. [RUN]
[0m11:54:23.199800 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.positions)
[0m11:54:23.200532 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m11:54:23.206269 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m11:54:23.207515 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 11:54:23.200931 => 11:54:23.207146
[0m11:54:23.208101 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m11:54:23.213200 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m11:54:23.214365 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:54:23.215135 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m11:54:23.262456 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 11:54:21.832756 => 11:54:23.262001
[0m11:54:23.263821 [info ] [Thread-4  ]: 7 of 14 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.45s]
[0m11:54:23.265071 [debug] [Thread-4  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:54:23.266000 [debug] [Thread-4  ]: Began running node model.ccwj.my_second_dbt_model
[0m11:54:23.266697 [info ] [Thread-4  ]: 12 of 14 START sql view model analytics.my_second_dbt_model .................... [RUN]
[0m11:54:23.267796 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m11:54:23.268428 [debug] [Thread-4  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m11:54:23.273408 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m11:54:23.275312 [debug] [Thread-4  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 11:54:23.268792 => 11:54:23.274787
[0m11:54:23.276058 [debug] [Thread-4  ]: Began executing node model.ccwj.my_second_dbt_model
[0m11:54:23.282988 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m11:54:23.284182 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:54:23.284909 [debug] [Thread-4  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m11:54:23.316479 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f95fd2b-022e-4bad-a3bc-7397d9fe0678&page=queryresults
[0m11:54:23.766307 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (execute): 11:54:22.614701 => 11:54:23.765927
[0m11:54:23.770353 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 11:54:22.609511 => 11:54:23.769997
[0m11:54:23.771749 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1321c0>]}
[0m11:54:23.772892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0486a0>]}
[0m11:54:23.773790 [info ] [Thread-3  ]: 10 of 14 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m11:54:23.774681 [info ] [Thread-1  ]: 9 of 14 OK created sql view model analytics.daily_totals ....................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m11:54:23.775903 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m11:54:23.776865 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m11:54:23.829690 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9702a16-3c55-4307-ab53-a44aef44cbb4&page=queryresults
[0m11:54:23.880154 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:17d73098-a6b1-45e0-8a3a-07823bf14567&page=queryresults
[0m11:54:24.195114 [debug] [Thread-4  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 11:54:23.276458 => 11:54:24.194661
[0m11:54:24.196686 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f148f70>]}
[0m11:54:24.197782 [info ] [Thread-4  ]: 12 of 14 OK created sql view model analytics.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m11:54:24.198968 [debug] [Thread-4  ]: Finished running node model.ccwj.my_second_dbt_model
[0m11:54:24.200232 [debug] [Thread-3  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:24.201009 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:24.201855 [info ] [Thread-3  ]: 13 of 14 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m11:54:24.203055 [info ] [Thread-1  ]: 14 of 14 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:54:24.205250 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.overall_position_performance, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m11:54:24.206830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.daily_totals, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:54:24.207713 [debug] [Thread-3  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:24.208458 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:24.223312 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:54:24.231375 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:54:24.232723 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:54:24.209034 => 11:54:24.232214
[0m11:54:24.233438 [debug] [Thread-3  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:24.238330 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:54:24.239915 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:54:24.223894 => 11:54:24.239458
[0m11:54:24.241314 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:24.246907 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:54:24.247966 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:54:24.249527 [debug] [Thread-3  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m11:54:24.251154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:24.254642 [debug] [Thread-1  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:54:24.291536 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 11:54:23.208469 => 11:54:24.290892
[0m11:54:24.294356 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89f104e0-e3c7-4b7f-9f6e-1cf110de4152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f090850>]}
[0m11:54:24.295910 [info ] [Thread-2  ]: 11 of 14 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m11:54:24.297609 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m11:54:24.914354 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1251d54c-2160-42ff-89c8-9b6768193263&page=queryresults
[0m11:54:25.104046 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:875de7d1-5e2d-464a-9235-993334e86b31&page=queryresults
[0m11:54:25.518398 [debug] [Thread-3  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:54:24.233912 => 11:54:25.517696
[0m11:54:25.520617 [info ] [Thread-3  ]: 13 of 14 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.32s]
[0m11:54:25.522394 [debug] [Thread-3  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:25.816447 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:54:24.242087 => 11:54:25.815743
[0m11:54:25.818617 [info ] [Thread-1  ]: 14 of 14 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.61s]
[0m11:54:25.820238 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:25.823230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:25.823795 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:54:25.824317 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m11:54:25.824826 [debug] [MainThread]: Connection 'test.ccwj.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m11:54:25.825318 [debug] [MainThread]: Connection 'model.ccwj.my_second_dbt_model' was properly closed.
[0m11:54:25.825945 [info ] [MainThread]: 
[0m11:54:25.826565 [info ] [MainThread]: Finished running 8 view models, 2 seeds, 1 table model, 3 tests in 0 hours 0 minutes and 11.91 seconds (11.91s).
[0m11:54:25.830667 [debug] [MainThread]: Command end result
[0m11:54:25.852536 [info ] [MainThread]: 
[0m11:54:25.854058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:25.856598 [info ] [MainThread]: 
[0m11:54:25.858304 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m11:54:25.863284 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.025006, "process_user_time": 4.464935, "process_kernel_time": 0.567765, "process_mem_max_rss": "141889536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:25.866171 [debug] [MainThread]: Command `cli build` succeeded at 11:54:25.865693 after 13.03 seconds
[0m11:54:25.867061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf78400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f148f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e960910>]}
[0m11:54:25.867770 [debug] [MainThread]: Flushing usage events
[0m09:44:17.119079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae2af0>]}


============================== 09:44:17.128661 | c3ac3e0d-2f10-4830-9798-e07b54860aea ==============================
[0m09:44:17.128661 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:44:17.129706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:17.961127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab3130>]}
[0m09:44:18.089159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a52ca0>]}
[0m09:44:18.091001 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:44:18.115488 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:44:18.212688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:44:18.213406 [debug] [MainThread]: Partial parsing: added file: ccwj://seeds/cflt_prices.csv
[0m09:44:18.369069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dac0d0>]}
[0m09:44:18.388905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c2edf0>]}
[0m09:44:18.389599 [info ] [MainThread]: Found 9 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:44:18.392569 [info ] [MainThread]: 
[0m09:44:18.394007 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:44:18.395877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:44:18.396461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:20.178685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:44:20.180023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:20.575181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a77640>]}
[0m09:44:20.577270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:20.577974 [info ] [MainThread]: 
[0m09:44:20.582333 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:44:20.583437 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m09:44:20.584395 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m09:44:20.585262 [info ] [Thread-1  ]: 1 of 15 START sql view model analytics.calendar_dates .......................... [RUN]
[0m09:44:20.586132 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m09:44:20.587032 [info ] [Thread-2  ]: 2 of 15 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m09:44:20.587852 [info ] [Thread-3  ]: 3 of 15 START seed file analytics.0417_current ................................. [RUN]
[0m09:44:20.590710 [info ] [Thread-4  ]: 4 of 15 START seed file analytics.0417_history ................................. [RUN]
[0m09:44:20.594359 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m09:44:20.597488 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m09:44:20.589093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:44:20.601149 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:44:20.601896 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m09:44:20.602498 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m09:44:20.603068 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:44:20.603632 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m09:44:20.617584 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m09:44:20.618758 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 09:44:20.618155 => 09:44:20.618163
[0m09:44:20.622933 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:44:20.624167 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 09:44:20.623774 => 09:44:20.623781
[0m09:44:20.625881 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m09:44:20.628341 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m09:44:20.671088 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:44:20.619345 => 09:44:20.670628
[0m09:44:20.678389 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:44:20.680435 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 09:44:20.604033 => 09:44:20.679936
[0m09:44:20.689371 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:44:20.727213 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m09:44:20.782337 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:44:20.822254 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:44:20.862765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:44:20.873493 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:44:20.881400 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:44:21.272419 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m09:44:21.275656 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m09:44:21.358207 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9b8a62dd-fc0c-48bc-947c-ffe61d382bd1&page=queryresults
[0m09:44:21.740956 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dcf48483-79a4-49df-ab6c-e907c3b6b9ed&page=queryresults
[0m09:44:21.788370 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:44:20.697667 => 09:44:21.787928
[0m09:44:21.790141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f73f10>]}
[0m09:44:21.791794 [info ] [Thread-1  ]: 1 of 15 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m09:44:21.794768 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:44:21.795715 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m09:44:21.796890 [info ] [Thread-1  ]: 5 of 15 START seed file analytics.cflt_prices .................................. [RUN]
[0m09:44:21.798133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m09:44:21.798819 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m09:44:21.799610 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 09:44:21.799229 => 09:44:21.799234
[0m09:44:21.800309 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m09:44:21.818234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:44:24.062451 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 09:44:20.789831 => 09:44:24.061925
[0m09:44:24.063875 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4bd60>]}
[0m09:44:24.064835 [info ] [Thread-2  ]: 2 of 15 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.47s]
[0m09:44:24.065844 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m09:44:24.067184 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:44:24.068024 [info ] [Thread-2  ]: 6 of 15 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m09:44:24.069621 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m09:44:24.070826 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:44:24.095050 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:44:24.099433 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 09:44:24.071464 => 09:44:24.098765
[0m09:44:24.100219 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:44:24.133554 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m09:44:24.135239 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:24.136063 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:44:24.979481 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:44:25.035612 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:396c5ba3-3464-41a8-a6ac-01e4a930e45b&page=queryresults
[0m09:44:25.302464 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9de1884c-d64a-435b-a146-f06ac9f50a5e&page=queryresults
[0m09:44:25.683951 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:44:25.690745 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 09:44:20.628854 => 09:44:25.690275
[0m09:44:25.692662 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4b970>]}
[0m09:44:25.693813 [info ] [Thread-3  ]: 3 of 15 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 5.10s]
[0m09:44:25.697615 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m09:44:25.698872 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m09:44:25.699798 [info ] [Thread-3  ]: 7 of 15 START sql view model analytics.current ................................. [RUN]
[0m09:44:25.701403 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current)
[0m09:44:25.702843 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m09:44:25.716616 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:44:25.723326 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 09:44:24.100704 => 09:44:25.722255
[0m09:44:25.728592 [info ] [Thread-2  ]: 6 of 15 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.66s]
[0m09:44:25.731085 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m09:44:25.733002 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 09:44:25.704495 => 09:44:25.732175
[0m09:44:25.735020 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m09:44:25.737398 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m09:44:25.740034 [info ] [Thread-2  ]: 8 of 15 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m09:44:25.769904 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m09:44:25.771510 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:44:25.772784 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m09:44:25.784515 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m09:44:25.786763 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:44:25.789307 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:44:25.793552 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 09:44:25.773978 => 09:44:25.792574
[0m09:44:25.797929 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m09:44:25.807467 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m09:44:25.811437 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:25.812490 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m09:44:26.317934 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d4008d01-abd5-491a-8484-e2adb46a52cf&page=queryresults
[0m09:44:26.322534 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a969efca-a1c8-4e2d-8627-a1406e663547&page=queryresults
[0m09:44:26.672640 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 09:44:25.742218 => 09:44:26.672213
[0m09:44:26.677335 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a230760>]}
[0m09:44:26.678539 [info ] [Thread-3  ]: 7 of 15 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m09:44:26.680579 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m09:44:26.685216 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 09:44:25.799265 => 09:44:26.684768
[0m09:44:26.686028 [debug] [Thread-3  ]: Began running node model.ccwj.current_position_information
[0m09:44:26.687818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d67430>]}
[0m09:44:26.689162 [info ] [Thread-3  ]: 9 of 15 START sql view model analytics.current_position_information ............ [RUN]
[0m09:44:26.690870 [info ] [Thread-2  ]: 8 of 15 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m09:44:26.694351 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m09:44:26.696997 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m09:44:26.697863 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_position_information
[0m09:44:26.698985 [debug] [Thread-2  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:44:26.704364 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m09:44:26.707399 [info ] [Thread-2  ]: 10 of 15 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m09:44:26.710569 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m09:44:26.713463 [debug] [Thread-2  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:44:26.714706 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (compile): 09:44:26.699508 => 09:44:26.714141
[0m09:44:26.728270 [debug] [Thread-3  ]: Began executing node model.ccwj.current_position_information
[0m09:44:26.733531 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:44:26.745677 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m09:44:26.748692 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 09:44:26.716374 => 09:44:26.748092
[0m09:44:26.749611 [debug] [Thread-2  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:44:26.753882 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:44:26.758407 [debug] [Thread-3  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m09:44:26.766918 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m09:44:26.894680 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:26.898529 [debug] [Thread-2  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m09:44:27.508063 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e2d59ce9-2bb6-4812-8fdd-be1d67013254&page=queryresults
[0m09:44:27.556025 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:44:27.610448 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5a214a3d-ebdd-4558-b95c-f283f329668e&page=queryresults
[0m09:44:27.930007 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m09:44:27.946065 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (execute): 09:44:26.734165 => 09:44:27.945566
[0m09:44:27.947402 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a226d60>]}
[0m09:44:27.948317 [info ] [Thread-3  ]: 9 of 15 OK created sql view model analytics.current_position_information ....... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m09:44:27.949283 [debug] [Thread-3  ]: Finished running node model.ccwj.current_position_information
[0m09:44:27.950050 [debug] [Thread-3  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:44:27.950855 [info ] [Thread-3  ]: 11 of 15 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m09:44:27.952603 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m09:44:27.955101 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f42875a0-08d7-4874-803e-0bff7231b14f&page=queryresults
[0m09:44:27.956017 [debug] [Thread-3  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:44:27.968452 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:44:27.970678 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 09:44:27.959025 => 09:44:27.970200
[0m09:44:27.971588 [debug] [Thread-3  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:44:27.978065 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:44:27.980151 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:44:27.983239 [debug] [Thread-3  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:44:28.308360 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 09:44:26.750138 => 09:44:28.307954
[0m09:44:28.324972 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f103237-0115-4091-9caf-91d8e8c63e66&page=queryresults
[0m09:44:28.348952 [info ] [Thread-2  ]: 10 of 15 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.64s]
[0m09:44:28.352044 [debug] [Thread-2  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m09:44:28.357512 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:44:28.362742 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 09:44:20.656397 => 09:44:28.362220
[0m09:44:28.363795 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e63f40>]}
[0m09:44:28.364471 [info ] [Thread-4  ]: 4 of 15 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2482[0m in 7.76s]
[0m09:44:28.365348 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m09:44:28.366190 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m09:44:28.366830 [info ] [Thread-2  ]: 12 of 15 START sql view model analytics.history ................................ [RUN]
[0m09:44:28.367774 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.history)
[0m09:44:28.368356 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m09:44:28.374188 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:44:28.375713 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 09:44:28.368694 => 09:44:28.375336
[0m09:44:28.376296 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m09:44:28.381231 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:44:28.382651 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:28.383386 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix;


[0m09:44:28.852963 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m09:44:28.864003 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 09:44:21.800756 => 09:44:28.863652
[0m09:44:28.865237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e4af0>]}
[0m09:44:28.866070 [info ] [Thread-1  ]: 5 of 15 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 82[0m in 7.07s]
[0m09:44:28.867459 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m09:44:28.878345 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:709bfa0b-821a-4bdc-8622-e90c184d91d0&page=queryresults
[0m09:44:28.988926 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0bb154f2-fdf9-498c-be21-f50b6a15621e&page=queryresults
[0m09:44:29.330084 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 09:44:28.376626 => 09:44:29.329721
[0m09:44:29.331453 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e673a0>]}
[0m09:44:29.332353 [info ] [Thread-2  ]: 12 of 15 OK created sql view model analytics.history ........................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m09:44:29.333410 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m09:44:29.334800 [debug] [Thread-4  ]: Began running node model.ccwj.daily_totals
[0m09:44:29.335598 [debug] [Thread-1  ]: Began running node model.ccwj.overall_position_performance
[0m09:44:29.336163 [debug] [Thread-2  ]: Began running node model.ccwj.positions
[0m09:44:29.336822 [info ] [Thread-4  ]: 13 of 15 START sql view model analytics.daily_totals ........................... [RUN]
[0m09:44:29.337615 [info ] [Thread-1  ]: 14 of 15 START sql view model analytics.overall_position_performance ........... [RUN]
[0m09:44:29.338721 [info ] [Thread-2  ]: 15 of 15 START sql view model analytics.positions .............................. [RUN]
[0m09:44:29.340138 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.daily_totals)
[0m09:44:29.341319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.overall_position_performance)
[0m09:44:29.342560 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.positions)
[0m09:44:29.343211 [debug] [Thread-4  ]: Began compiling node model.ccwj.daily_totals
[0m09:44:29.343780 [debug] [Thread-1  ]: Began compiling node model.ccwj.overall_position_performance
[0m09:44:29.344378 [debug] [Thread-2  ]: Began compiling node model.ccwj.positions
[0m09:44:29.350716 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m09:44:29.360974 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.positions"
[0m09:44:29.367688 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m09:44:29.369967 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (compile): 09:44:29.353365 => 09:44:29.369450
[0m09:44:29.370964 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (compile): 09:44:29.351234 => 09:44:29.370413
[0m09:44:29.371770 [debug] [Thread-2  ]: Began executing node model.ccwj.positions
[0m09:44:29.372450 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (compile): 09:44:29.344778 => 09:44:29.372122
[0m09:44:29.373017 [debug] [Thread-1  ]: Began executing node model.ccwj.overall_position_performance
[0m09:44:29.378988 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.positions"
[0m09:44:29.379804 [debug] [Thread-4  ]: Began executing node model.ccwj.daily_totals
[0m09:44:29.385426 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m09:44:29.393822 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m09:44:29.395610 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:29.397698 [debug] [Thread-2  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m09:44:29.398571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:44:29.400375 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:44:29.401149 [debug] [Thread-1  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m09:44:29.402103 [debug] [Thread-4  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
where symbol = 'UNIT'
order by 1 desc;


[0m09:44:29.671267 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 09:44:27.972392 => 09:44:29.670833
[0m09:44:29.673361 [info ] [Thread-3  ]: 11 of 15 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.72s]
[0m09:44:29.674925 [debug] [Thread-3  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m09:44:30.097674 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:54d313b7-c935-4109-a9d4-8e1599f28235&page=queryresults
[0m09:44:30.098750 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:93d68f66-c88d-41b8-b962-57b747c75711&page=queryresults
[0m09:44:30.099727 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2a873331-1220-423d-a263-60f9b4356882&page=queryresults
[0m09:44:30.502062 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (execute): 09:44:29.380212 => 09:44:30.501682
[0m09:44:30.503436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebd460>]}
[0m09:44:30.504459 [info ] [Thread-1  ]: 14 of 15 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m09:44:30.505783 [debug] [Thread-1  ]: Finished running node model.ccwj.overall_position_performance
[0m09:44:30.522317 [debug] [Thread-2  ]: Timing info for model.ccwj.positions (execute): 09:44:29.373394 => 09:44:30.521888
[0m09:44:30.524925 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a053280>]}
[0m09:44:30.525978 [info ] [Thread-2  ]: 15 of 15 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m09:44:30.527725 [debug] [Thread-2  ]: Finished running node model.ccwj.positions
[0m09:44:30.535595 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (execute): 09:44:29.386158 => 09:44:30.535069
[0m09:44:30.537198 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ac3e0d-2f10-4830-9798-e07b54860aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e252b0>]}
[0m09:44:30.538307 [info ] [Thread-4  ]: 13 of 15 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m09:44:30.539454 [debug] [Thread-4  ]: Finished running node model.ccwj.daily_totals
[0m09:44:30.543371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:30.544646 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m09:44:30.545305 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m09:44:30.545856 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m09:44:30.546449 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m09:44:30.547263 [info ] [MainThread]: 
[0m09:44:30.547863 [info ] [MainThread]: Finished running 8 view models, 1 table model, 3 seeds, 3 tests in 0 hours 0 minutes and 12.15 seconds (12.15s).
[0m09:44:30.552009 [debug] [MainThread]: Command end result
[0m09:44:30.577589 [info ] [MainThread]: 
[0m09:44:30.578822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:30.579780 [info ] [MainThread]: 
[0m09:44:30.580600 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m09:44:30.585030 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.551871, "process_user_time": 5.365033, "process_kernel_time": 0.687442, "process_mem_max_rss": "140722176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:44:30.586546 [debug] [MainThread]: Command `cli build` succeeded at 09:44:30.586056 after 13.55 seconds
[0m09:44:30.587412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109924250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a52ca0>]}
[0m09:44:30.588103 [debug] [MainThread]: Flushing usage events
[0m09:47:56.528202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cf8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ce6be0>]}


============================== 09:47:56.534881 | 7810c8a3-6ca6-4c03-bb22-4cb2e6541240 ==============================
[0m09:47:56.534881 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:47:56.536572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed -s cflt_prices', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:47:57.369092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6f3d0>]}
[0m09:47:57.474013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b8c610>]}
[0m09:47:57.475728 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:47:57.497905 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:47:57.600729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:57.601226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:57.608385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e730d0>]}
[0m09:47:57.630139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d96040>]}
[0m09:47:57.630957 [info ] [MainThread]: Found 9 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:47:57.631647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d96af0>]}
[0m09:47:57.633690 [info ] [MainThread]: 
[0m09:47:57.634952 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:47:57.637340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:47:57.639330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:59.530980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:47:59.532214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:59.879809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c33a00>]}
[0m09:47:59.881323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:59.881973 [info ] [MainThread]: 
[0m09:47:59.886753 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m09:47:59.888590 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.cflt_prices ................................... [RUN]
[0m09:47:59.890956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.cflt_prices)
[0m09:47:59.891768 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m09:47:59.892709 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 09:47:59.892258 => 09:47:59.892271
[0m09:47:59.895067 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m09:47:59.958723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:48:04.117507 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m09:48:04.571091 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1f4b43a9-7592-4ae3-be5b-95a44fdb0395&page=queryresults
[0m09:48:04.982225 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m09:48:05.011498 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 09:47:59.895784 => 09:48:05.010250
[0m09:48:05.012847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7810c8a3-6ca6-4c03-bb22-4cb2e6541240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114eefdc0>]}
[0m09:48:05.013701 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 5.12s]
[0m09:48:05.014644 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m09:48:05.017434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:05.018674 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m09:48:05.019434 [info ] [MainThread]: 
[0m09:48:05.020261 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m09:48:05.022371 [debug] [MainThread]: Command end result
[0m09:48:05.045804 [info ] [MainThread]: 
[0m09:48:05.047988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:48:05.049080 [info ] [MainThread]: 
[0m09:48:05.050458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:48:05.055482 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.612988, "process_user_time": 3.603207, "process_kernel_time": 0.44218, "process_mem_max_rss": "127459328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:48:05.058478 [debug] [MainThread]: Command `dbt seed` succeeded at 09:48:05.057214 after 8.62 seconds
[0m09:48:05.060237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b8c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ae5f40>]}
[0m09:48:05.061065 [debug] [MainThread]: Flushing usage events
[0m10:10:01.169499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113af8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae6b50>]}


============================== 10:10:01.177143 | 75bcc8f7-52d0-48df-814f-cf8e8c6cfe31 ==============================
[0m10:10:01.177143 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:10:01.178162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed -s cflt_prices', 'send_anonymous_usage_stats': 'True'}
[0m10:10:02.023999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11487a220>]}
[0m10:10:02.145378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149923a0>]}
[0m10:10:02.147235 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:10:02.186647 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:10:02.289163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:02.289733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:02.299282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c750d0>]}
[0m10:10:02.319431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b932b0>]}
[0m10:10:02.320107 [info ] [MainThread]: Found 9 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:10:02.320592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b93a00>]}
[0m10:10:02.322310 [info ] [MainThread]: 
[0m10:10:02.323706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:10:02.325501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:10:02.326241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:04.732307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:10:04.734966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:05.138374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a46a30>]}
[0m10:10:05.139658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:05.140251 [info ] [MainThread]: 
[0m10:10:05.144318 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m10:10:05.145058 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.cflt_prices ................................... [RUN]
[0m10:10:05.146175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.cflt_prices)
[0m10:10:05.146763 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:10:05.147739 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:10:05.147251 => 10:10:05.147259
[0m10:10:05.148676 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m10:10:05.192003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:10:12.013534 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:10:12.343683 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1ab2abb3-b261-4637-b37b-5fe9a543bc4c&page=queryresults
[0m10:10:12.798927 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:10:12.839119 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:10:05.148997 => 10:10:12.838738
[0m10:10:12.840494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75bcc8f7-52d0-48df-814f-cf8e8c6cfe31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cf2eb0>]}
[0m10:10:12.841408 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 7.69s]
[0m10:10:12.842417 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m10:10:12.844828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:12.845363 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m10:10:12.845890 [info ] [MainThread]: 
[0m10:10:12.846819 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.52 seconds (10.52s).
[0m10:10:12.848662 [debug] [MainThread]: Command end result
[0m10:10:12.876285 [info ] [MainThread]: 
[0m10:10:12.877582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:12.878380 [info ] [MainThread]: 
[0m10:10:12.879407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:10:12.885068 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.83338, "process_user_time": 3.765951, "process_kernel_time": 0.567061, "process_mem_max_rss": "127746048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:10:12.886944 [debug] [MainThread]: Command `dbt seed` succeeded at 10:10:12.886604 after 11.84 seconds
[0m10:10:12.887805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a64c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498c160>]}
[0m10:10:12.891165 [debug] [MainThread]: Flushing usage events
[0m15:15:20.465217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102743d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104257d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104247dc0>]}


============================== 15:15:20.473427 | a2f60a4a-6194-4c7a-a006-cd968b05c5e4 ==============================
[0m15:15:20.473427 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:15:20.474350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:15:21.429391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104210520>]}
[0m15:15:21.569326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdaaf0>]}
[0m15:15:21.571700 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:15:21.597194 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m15:15:21.667177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:21.667860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:21.677961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d9fd0>]}
[0m15:15:21.700628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed160>]}
[0m15:15:21.701872 [info ] [MainThread]: Found 10 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:15:21.703206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed550>]}
[0m15:15:21.705832 [info ] [MainThread]: 
[0m15:15:21.707158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:15:21.708781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:15:21.709414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:28.386642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:15:28.387801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:28.693848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed3d0>]}
[0m15:15:28.695376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:28.696082 [info ] [MainThread]: 
[0m15:15:28.701539 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m15:15:28.702421 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m15:15:28.703726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m15:15:28.704646 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m15:15:28.722314 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m15:15:28.725330 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 15:15:28.705215 => 15:15:28.724877
[0m15:15:28.725957 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m15:15:28.778429 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m15:15:28.779589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:28.780407 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m15:15:29.424009 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dd2c301b-2bf2-467b-9665-84682e2dd299&page=queryresults
[0m15:15:29.806174 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]; reason: invalidQuery, location: query, message: Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]")
[0m15:15:30.330958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e5fd7d16-3169-468f-ab00-dfe2505f9c57&page=queryresults
[0m15:15:30.681493 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e5fd7d16-3169-468f-ab00-dfe2505f9c57&page=queryresults
[0m15:15:30.683370 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 15:15:28.726317 => 15:15:30.682703
[0m15:15:30.707464 [debug] [Thread-1  ]: Database Error in model daily_totals (models/core/daily_totals.sql)
  Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]
  compiled Code at target/run/ccwj/models/core/daily_totals.sql
[0m15:15:30.708266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2f60a4a-6194-4c7a-a006-cd968b05c5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ff850>]}
[0m15:15:30.709108 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.daily_totals .................... [[31mERROR[0m in 2.01s]
[0m15:15:30.709978 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m15:15:30.712341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:30.712833 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m15:15:30.713311 [info ] [MainThread]: 
[0m15:15:30.713830 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m15:15:30.714972 [debug] [MainThread]: Command end result
[0m15:15:30.731734 [info ] [MainThread]: 
[0m15:15:30.732856 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:30.734031 [info ] [MainThread]: 
[0m15:15:30.735454 [error] [MainThread]:   Database Error in model daily_totals (models/core/daily_totals.sql)
  Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]
  compiled Code at target/run/ccwj/models/core/daily_totals.sql
[0m15:15:30.736607 [info ] [MainThread]: 
[0m15:15:30.737426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:30.752933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.398982, "process_user_time": 4.587807, "process_kernel_time": 0.57572, "process_mem_max_rss": "128946176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:15:30.754074 [debug] [MainThread]: Command `cli run` failed at 15:15:30.753785 after 10.40 seconds
[0m15:15:30.754725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102743d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed3d0>]}
[0m15:15:30.755282 [debug] [MainThread]: Flushing usage events
[0m08:02:52.472605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd8df0>]}


============================== 08:02:52.479304 | dae22170-3228-48b1-a391-8c3df3168dac ==============================
[0m08:02:52.479304 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:02:52.480122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:53.266161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba17c0>]}
[0m08:02:53.371438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c63490>]}
[0m08:02:53.372977 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:02:53.397577 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m08:02:53.488727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:53.489205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:53.497333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6a0d0>]}
[0m08:02:53.516283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac84220>]}
[0m08:02:53.516926 [info ] [MainThread]: Found 10 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:02:53.517442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac84640>]}
[0m08:02:53.519678 [info ] [MainThread]: 
[0m08:02:53.521106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:02:53.522634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:02:53.523322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:55.454683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:02:55.456108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:55.793838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa84520>]}
[0m08:02:55.795425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:02:55.796077 [info ] [MainThread]: 
[0m08:02:55.800807 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m08:02:55.802770 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m08:02:55.804843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m08:02:55.805664 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m08:02:55.821152 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m08:02:55.823549 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 08:02:55.806097 => 08:02:55.823056
[0m08:02:55.824313 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m08:02:55.872826 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m08:02:55.874063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:02:55.874701 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m08:02:56.565045 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:56978587-2f62-4e28-a023-1228853d5c4b&page=queryresults
[0m08:02:56.911673 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]; reason: invalidQuery, location: query, message: Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]")
[0m08:02:58.301225 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:063917f1-a688-410d-a3b5-390556db1dab&page=queryresults
[0m08:02:58.658257 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:063917f1-a688-410d-a3b5-390556db1dab&page=queryresults
[0m08:02:58.659246 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 08:02:55.824674 => 08:02:58.658875
[0m08:02:58.673616 [debug] [Thread-1  ]: Database Error in model daily_totals (models/core/daily_totals.sql)
  Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]
  compiled Code at target/run/ccwj/models/core/daily_totals.sql
[0m08:02:58.674404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae22170-3228-48b1-a391-8c3df3168dac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6a880>]}
[0m08:02:58.675663 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.daily_totals .................... [[31mERROR[0m in 2.87s]
[0m08:02:58.676639 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m08:02:58.680071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:58.680672 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m08:02:58.681177 [info ] [MainThread]: 
[0m08:02:58.681923 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m08:02:58.682924 [debug] [MainThread]: Command end result
[0m08:02:58.709481 [info ] [MainThread]: 
[0m08:02:58.710596 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:02:58.711415 [info ] [MainThread]: 
[0m08:02:58.712154 [error] [MainThread]:   Database Error in model daily_totals (models/core/daily_totals.sql)
  Column 'date' in USING has incompatible types that cannot be directly compared using equality on either side of the join: DATE and STRING at [23:54]
  compiled Code at target/run/ccwj/models/core/daily_totals.sql
[0m08:02:58.712723 [info ] [MainThread]: 
[0m08:02:58.713303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:02:58.743865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3496537, "process_user_time": 3.43697, "process_kernel_time": 0.472339, "process_mem_max_rss": "128757760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:02:58.744935 [debug] [MainThread]: Command `cli run` failed at 08:02:58.744670 after 6.36 seconds
[0m08:02:58.745972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6aac0>]}
[0m08:02:58.746919 [debug] [MainThread]: Flushing usage events
[0m08:20:37.400428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd66e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8519a0>]}


============================== 08:20:37.407280 | 299216f5-3a09-4e91-a90b-ef07b5ce11dc ==============================
[0m08:20:37.407280 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:20:37.408245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:20:38.206618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f680550>]}
[0m08:20:38.307426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f61d7f0>]}
[0m08:20:38.308765 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:20:38.341793 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m08:20:38.439236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:38.440077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:38.477425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9f00d0>]}
[0m08:20:38.543795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f721f70>]}
[0m08:20:38.545024 [info ] [MainThread]: Found 10 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:20:38.546036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6c8070>]}
[0m08:20:38.549604 [info ] [MainThread]: 
[0m08:20:38.551048 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:38.553124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:20:38.553965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:40.365764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:20:40.366937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:40.658577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7b37f0>]}
[0m08:20:40.660215 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:20:40.660873 [info ] [MainThread]: 
[0m08:20:40.665408 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m08:20:40.666280 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m08:20:40.667044 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m08:20:40.667679 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m08:20:40.668693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m08:20:40.669386 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m08:20:40.670069 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m08:20:40.670687 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m08:20:40.671771 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m08:20:40.672971 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m08:20:40.674072 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 08:20:40.673498 => 08:20:40.673519
[0m08:20:40.674773 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m08:20:40.675255 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m08:20:40.675740 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m08:20:40.676305 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 08:20:40.676047 => 08:20:40.676050
[0m08:20:40.676851 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 08:20:40.676597 => 08:20:40.676599
[0m08:20:40.697268 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m08:20:40.702669 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m08:20:40.719720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:20:40.728709 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:20:40.808478 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:20:44.542225 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m08:20:44.546961 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m08:20:44.836402 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m08:20:44.870044 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c7378ae0-4d61-4f69-a22a-d7143f4a4ebc&page=queryresults
[0m08:20:44.904976 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9b024e0f-59f1-428c-85b2-ae37a15c666e&page=queryresults
[0m08:20:45.198891 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d03830f7-317a-4dc8-8179-57dc2863895f&page=queryresults
[0m08:20:45.274945 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m08:20:45.278283 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m08:20:45.296594 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 08:20:40.722743 => 08:20:45.296321
[0m08:20:45.297680 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab5160>]}
[0m08:20:45.300594 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 08:20:40.677322 => 08:20:45.300341
[0m08:20:45.301238 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 4.63s]
[0m08:20:45.302443 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa72850>]}
[0m08:20:45.303161 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m08:20:45.303749 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 11[0m in 4.63s]
[0m08:20:45.305024 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m08:20:45.628395 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m08:20:45.633358 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 08:20:40.715441 => 08:20:45.632997
[0m08:20:45.634562 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '299216f5-3a09-4e91-a90b-ef07b5ce11dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac5310>]}
[0m08:20:45.635392 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2492[0m in 4.96s]
[0m08:20:45.636358 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m08:20:45.638954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:45.639474 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m08:20:45.639902 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m08:20:45.640319 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m08:20:45.640959 [info ] [MainThread]: 
[0m08:20:45.641842 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m08:20:45.643374 [debug] [MainThread]: Command end result
[0m08:20:45.658858 [info ] [MainThread]: 
[0m08:20:45.659550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:45.660047 [info ] [MainThread]: 
[0m08:20:45.660580 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:20:45.663758 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.340745, "process_user_time": 3.659688, "process_kernel_time": 0.450022, "process_mem_max_rss": "133079040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:20:45.665129 [debug] [MainThread]: Command `dbt seed` succeeded at 08:20:45.664690 after 8.34 seconds
[0m08:20:45.666638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd66e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7b38e0>]}
[0m08:20:45.669070 [debug] [MainThread]: Flushing usage events
[0m08:32:25.732472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109637400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b130a90>]}


============================== 08:32:25.738188 | fd9f1482-50f0-44e2-83c3-e97ee79ad0d6 ==============================
[0m08:32:25.738188 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:32:25.739204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:32:26.491726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1155e0>]}
[0m08:32:26.598051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bffb040>]}
[0m08:32:26.599674 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:32:26.621046 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m08:32:26.676009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:32:26.676491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:32:26.684218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c40d0>]}
[0m08:32:26.701672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e0040>]}
[0m08:32:26.702310 [info ] [MainThread]: Found 11 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:32:26.702793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0994f0>]}
[0m08:32:26.704965 [info ] [MainThread]: 
[0m08:32:26.706376 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:32:26.708373 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:32:26.709094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:28.293339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:32:28.294594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:32:28.644815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b9f70>]}
[0m08:32:28.646428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:32:28.647121 [info ] [MainThread]: 
[0m08:32:28.652687 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_symbol_dates
[0m08:32:28.654034 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m08:32:28.655586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_symbol_dates)
[0m08:32:28.656419 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m08:32:28.669805 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m08:32:28.672379 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 08:32:28.656870 => 08:32:28.671804
[0m08:32:28.673025 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m08:32:28.721084 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m08:32:28.722367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:32:28.723102 [debug] [Thread-1  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct trade_symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.trade_symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m08:32:29.346127 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b1e3fe0e-3952-490f-846a-a457b050abd5&page=queryresults
[0m08:32:29.798649 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 08:32:28.673382 => 08:32:29.798343
[0m08:32:29.799730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9f1482-50f0-44e2-83c3-e97ee79ad0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c349190>]}
[0m08:32:29.800587 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m08:32:29.801444 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m08:32:29.804422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:29.804963 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m08:32:29.805433 [info ] [MainThread]: 
[0m08:32:29.805925 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m08:32:29.807339 [debug] [MainThread]: Command end result
[0m08:32:29.820649 [info ] [MainThread]: 
[0m08:32:29.821341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:32:29.821857 [info ] [MainThread]: 
[0m08:32:29.822626 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:32:29.825961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1672463, "process_user_time": 3.366788, "process_kernel_time": 0.42256, "process_mem_max_rss": "127127552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:32:29.826798 [debug] [MainThread]: Command `cli run` succeeded at 08:32:29.826623 after 4.17 seconds
[0m08:32:29.827567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109637400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c074b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec7ac0>]}
[0m08:32:29.828205 [debug] [MainThread]: Flushing usage events
[0m10:39:21.982933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e921610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e954d00>]}


============================== 10:39:21.989548 | f3807e1c-7f3b-4d9f-bc1f-da8e25955010 ==============================
[0m10:39:21.989548 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:39:21.990381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:39:22.770793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93a640>]}
[0m10:39:22.873972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f11b880>]}
[0m10:39:22.875247 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:39:22.902469 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:39:22.995006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:22.995567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:23.003867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faf3d90>]}
[0m10:39:23.021903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa024f0>]}
[0m10:39:23.022597 [info ] [MainThread]: Found 12 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:39:23.023080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa02c40>]}
[0m10:39:23.025714 [info ] [MainThread]: 
[0m10:39:23.026852 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:39:23.028283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:39:23.028833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:24.656849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:39:24.657613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:25.082045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e0490>]}
[0m10:39:25.083661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:39:25.084329 [info ] [MainThread]: 
[0m10:39:25.089927 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m10:39:25.090799 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m10:39:25.091617 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m10:39:25.093066 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m10:39:25.094055 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m10:39:25.094943 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m10:39:25.096226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m10:39:25.097524 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:39:25.098580 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m10:39:25.099279 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m10:39:25.100412 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m10:39:25.101699 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:39:25.103545 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 10:39:25.102896 => 10:39:25.102908
[0m10:39:25.105450 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 10:39:25.104962 => 10:39:25.104967
[0m10:39:25.107515 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:39:25.107012 => 10:39:25.107020
[0m10:39:25.108269 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m10:39:25.108968 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m10:39:25.109657 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m10:39:25.182002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:39:25.187815 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:39:25.264651 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:39:28.868509 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:39:28.933579 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:39:29.125779 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:39:29.220430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0db9db65-0bba-47bd-817b-58224d9301c1&page=queryresults
[0m10:39:29.239683 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e887eb6f-69d7-4a8a-8d55-9b216f40bea1&page=queryresults
[0m10:39:29.454673 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:169e3bcc-cd41-48c0-98b7-4b8c1c16b815&page=queryresults
[0m10:39:29.600062 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:39:29.621838 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 10:39:25.110154 => 10:39:29.621332
[0m10:39:29.624090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb6dd90>]}
[0m10:39:29.626727 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:39:29.627532 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 11[0m in 4.53s]
[0m10:39:29.628799 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m10:39:29.632232 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:39:25.161692 => 10:39:29.631903
[0m10:39:29.633521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc7d60>]}
[0m10:39:29.634606 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 4.54s]
[0m10:39:29.635647 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m10:39:29.817654 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:39:29.822721 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 10:39:25.133381 => 10:39:29.822348
[0m10:39:29.823956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807e1c-7f3b-4d9f-bc1f-da8e25955010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb97dc0>]}
[0m10:39:29.824800 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2492[0m in 4.73s]
[0m10:39:29.825929 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m10:39:29.828377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:29.828897 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m10:39:29.829356 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m10:39:29.829891 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m10:39:29.830492 [info ] [MainThread]: 
[0m10:39:29.831089 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m10:39:29.832917 [debug] [MainThread]: Command end result
[0m10:39:29.850775 [info ] [MainThread]: 
[0m10:39:29.852795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:29.853927 [info ] [MainThread]: 
[0m10:39:29.854819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:39:29.859555 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.9762907, "process_user_time": 3.652854, "process_kernel_time": 0.46527, "process_mem_max_rss": "133087232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:29.861233 [debug] [MainThread]: Command `dbt seed` succeeded at 10:39:29.860891 after 7.98 seconds
[0m10:39:29.862019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc03910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f88f3d0>]}
[0m10:39:29.862663 [debug] [MainThread]: Flushing usage events
[0m10:19:04.556025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113030850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305e8e0>]}


============================== 10:19:04.563372 | dba2ea0e-8945-4b1e-9642-aa9584e6f271 ==============================
[0m10:19:04.563372 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:19:04.564343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:19:05.314417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11301c100>]}
[0m10:19:05.432407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ebde20>]}
[0m10:19:05.434358 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:19:05.461452 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:19:05.560140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:05.561114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:05.569591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ea0d0>]}
[0m10:19:05.589519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410ba90>]}
[0m10:19:05.590155 [info ] [MainThread]: Found 12 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:19:05.592628 [info ] [MainThread]: 
[0m10:19:05.594143 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:19:05.595789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:19:05.596424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:07.395809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:19:07.396638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:07.754884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ffa880>]}
[0m10:19:07.756015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:07.756498 [info ] [MainThread]: 
[0m10:19:07.761426 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:19:07.762162 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m10:19:07.762670 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m10:19:07.763411 [info ] [Thread-1  ]: 1 of 6 START sql view model analytics.calendar_dates ........................... [RUN]
[0m10:19:07.764149 [info ] [Thread-2  ]: 2 of 6 START seed file analytics.0417_history .................................. [RUN]
[0m10:19:07.764900 [info ] [Thread-3  ]: 3 of 6 START seed file analytics.cflt_prices ................................... [RUN]
[0m10:19:07.765928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:19:07.766891 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:19:07.767776 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m10:19:07.769316 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:19:07.769938 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m10:19:07.770451 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:19:07.780988 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:19:07.781786 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 10:19:07.781457 => 10:19:07.781463
[0m10:19:07.782362 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:19:07.782097 => 10:19:07.782099
[0m10:19:07.783019 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m10:19:07.783538 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m10:19:07.798554 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:19:07.770782 => 10:19:07.798175
[0m10:19:07.806981 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:19:07.872621 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:19:07.883393 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:19:07.908803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:07.931807 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:19:07.968531 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:19:08.469174 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ff0c567c-1eed-4412-add6-fb5af10e7590&page=queryresults
[0m10:19:08.952287 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:19:07.815807 => 10:19:08.952003
[0m10:19:08.953275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114310fa0>]}
[0m10:19:08.954002 [info ] [Thread-1  ]: 1 of 6 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m10:19:08.954952 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:19:11.821625 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:19:12.073622 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:19:12.224474 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d040dd55-d0e8-4e2b-862f-2874250ce5b2&page=queryresults
[0m10:19:12.423948 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0fc4708e-2a15-4561-84c9-a9f7c383e69f&page=queryresults
[0m10:19:12.609739 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:19:12.613672 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:19:07.792311 => 10:19:12.613385
[0m10:19:12.614653 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429ee80>]}
[0m10:19:12.615330 [info ] [Thread-3  ]: 3 of 6 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 98[0m in 4.85s]
[0m10:19:12.616349 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m10:19:12.816746 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:19:12.819911 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 10:19:07.783887 => 10:19:12.819651
[0m10:19:12.820751 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114284d90>]}
[0m10:19:12.821355 [info ] [Thread-2  ]: 2 of 6 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2492[0m in 5.05s]
[0m10:19:12.822182 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m10:19:12.823262 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m10:19:12.824010 [info ] [Thread-4  ]: 4 of 6 START sql view model analytics.history .................................. [RUN]
[0m10:19:12.825204 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m10:19:12.826002 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m10:19:12.830988 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:19:12.832315 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 10:19:12.826521 => 10:19:12.832022
[0m10:19:12.832782 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m10:19:12.836882 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:19:12.837887 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:19:12.838518 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where trade_symbol = 'CFLT'
order by date desc;


[0m10:19:13.398874 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9b734d95-935e-4e6b-9bdd-faad7f50302d&page=queryresults
[0m10:19:13.822253 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 10:19:12.833064 => 10:19:13.821984
[0m10:19:13.823322 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114622df0>]}
[0m10:19:13.824112 [info ] [Thread-4  ]: 4 of 6 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:19:13.825367 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m10:19:13.827792 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m10:19:13.829312 [info ] [Thread-3  ]: 5 of 6 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m10:19:13.830532 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.calendar_symbol_dates)
[0m10:19:13.831215 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m10:19:13.836053 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m10:19:13.838381 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 10:19:13.831516 => 10:19:13.837950
[0m10:19:13.839097 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m10:19:13.847398 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m10:19:13.848574 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:19:13.849281 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct trade_symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.trade_symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m10:19:14.504757 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8efc395e-aa22-49fd-9b7f-e7c24ff41f9a&page=queryresults
[0m10:19:15.131130 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 10:19:13.839813 => 10:19:15.130556
[0m10:19:15.133321 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146352b0>]}
[0m10:19:15.134638 [info ] [Thread-3  ]: 5 of 6 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m10:19:15.136416 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m10:19:15.138304 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m10:19:15.139394 [info ] [Thread-1  ]: 6 of 6 START sql view model analytics.historical_equity_held ................... [RUN]
[0m10:19:15.140923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.historical_equity_held)
[0m10:19:15.141988 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m10:19:15.150458 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m10:19:15.153457 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 10:19:15.142794 => 10:19:15.152868
[0m10:19:15.154426 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m10:19:15.161993 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m10:19:15.164118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:15.165494 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.trade_symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.trade_symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.trade_symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m10:19:15.970936 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b6e441d3-8df3-412a-9797-58174a5d4c31&page=queryresults
[0m10:19:16.381295 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 10:19:15.155000 => 10:19:16.380991
[0m10:19:16.382459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba2ea0e-8945-4b1e-9642-aa9584e6f271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11460d310>]}
[0m10:19:16.383241 [info ] [Thread-1  ]: 6 of 6 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m10:19:16.384088 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m10:19:16.386356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:16.386847 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m10:19:16.387252 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m10:19:16.387642 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m10:19:16.388219 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:19:16.389079 [info ] [MainThread]: 
[0m10:19:16.389828 [info ] [MainThread]: Finished running 4 view models, 2 seeds in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m10:19:16.391900 [debug] [MainThread]: Command end result
[0m10:19:16.408443 [info ] [MainThread]: 
[0m10:19:16.409119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:16.410200 [info ] [MainThread]: 
[0m10:19:16.411217 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:19:16.414759 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.946095, "process_user_time": 3.983098, "process_kernel_time": 0.494581, "process_mem_max_rss": "136581120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:19:16.415926 [debug] [MainThread]: Command `cli build` succeeded at 10:19:16.415584 after 11.95 seconds
[0m10:19:16.416926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11431c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea45e0>]}
[0m10:19:16.417916 [debug] [MainThread]: Flushing usage events
[0m10:24:20.659829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf4250>]}


============================== 10:24:20.666216 | 5799f603-b963-4212-8940-85d100e007e8 ==============================
[0m10:24:20.666216 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:24:20.668424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:21.643996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbf550>]}
[0m10:24:21.766700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8e910>]}
[0m10:24:21.768026 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:24:21.794049 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:24:21.878206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:21.879023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:21.887600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d780d0>]}
[0m10:24:21.907571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8b430>]}
[0m10:24:21.908240 [info ] [MainThread]: Found 12 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:24:21.910657 [info ] [MainThread]: 
[0m10:24:21.911761 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:21.913393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:24:21.914019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:23.628636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:24:23.629803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:24.135512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afa730>]}
[0m10:24:24.137063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:24.137949 [info ] [MainThread]: 
[0m10:24:24.142247 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:24:24.143906 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m10:24:24.143073 [info ] [Thread-1  ]: 1 of 6 START sql view model analytics.calendar_dates ........................... [RUN]
[0m10:24:24.146201 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m10:24:24.145341 [info ] [Thread-2  ]: 2 of 6 START seed file analytics.0417_history .................................. [RUN]
[0m10:24:24.147565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:24:24.148270 [info ] [Thread-3  ]: 3 of 6 START seed file analytics.cflt_prices ................................... [RUN]
[0m10:24:24.149392 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:24:24.149997 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:24:24.150921 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m10:24:24.151634 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m10:24:24.163145 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:24:24.162790 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:24:24.164130 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 10:24:24.163776 => 10:24:24.163781
[0m10:24:24.165150 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:24:24.164595 => 10:24:24.164611
[0m10:24:24.166764 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m10:24:24.167498 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m10:24:24.178554 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:24:24.152047 => 10:24:24.178030
[0m10:24:24.210797 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:24:24.274175 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:24:24.294666 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:24:24.316182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:24:24.322509 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:24:24.362935 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:24:24.909528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f60b91f3-54c4-4bd1-9ed6-921b5a6587c3&page=queryresults
[0m10:24:25.445559 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:24:24.211300 => 10:24:25.445286
[0m10:24:25.446773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea4bb0>]}
[0m10:24:25.447498 [info ] [Thread-1  ]: 1 of 6 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m10:24:25.448475 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:24:28.153727 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:24:28.240331 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:24:28.487443 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:70c35435-e096-4ccb-9c7e-d4a858da66e2&page=queryresults
[0m10:24:28.678665 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f16999d0-1350-4385-ab07-7341ffa6d9e9&page=queryresults
[0m10:24:28.875203 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:24:28.881704 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:24:24.179017 => 10:24:28.881276
[0m10:24:28.882589 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2c9a0>]}
[0m10:24:28.883212 [info ] [Thread-3  ]: 3 of 6 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 4.73s]
[0m10:24:28.884006 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m10:24:29.117057 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:24:29.122313 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 10:24:24.168045 => 10:24:29.122056
[0m10:24:29.123149 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11ca0>]}
[0m10:24:29.123732 [info ] [Thread-2  ]: 2 of 6 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2492[0m in 4.97s]
[0m10:24:29.124574 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m10:24:29.125709 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m10:24:29.126421 [info ] [Thread-4  ]: 4 of 6 START sql view model analytics.history .................................. [RUN]
[0m10:24:29.127505 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m10:24:29.128002 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m10:24:29.132494 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:24:29.133448 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 10:24:29.128283 => 10:24:29.133176
[0m10:24:29.133891 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m10:24:29.138099 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:24:29.138931 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:24:29.139505 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where trade_symbol = 'CFLT'
order by date desc;


[0m10:24:29.780094 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e3e45494-a3d1-4f2f-9680-d87485c528d7&page=queryresults
[0m10:24:30.161220 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 10:24:29.134180 => 10:24:30.160963
[0m10:24:30.162743 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0c10>]}
[0m10:24:30.163428 [info ] [Thread-4  ]: 4 of 6 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m10:24:30.164242 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m10:24:30.165626 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m10:24:30.166384 [info ] [Thread-3  ]: 5 of 6 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m10:24:30.167441 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.calendar_symbol_dates)
[0m10:24:30.167968 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m10:24:30.172142 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m10:24:30.174259 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 10:24:30.168258 => 10:24:30.173955
[0m10:24:30.174709 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m10:24:30.179957 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m10:24:30.180792 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:24:30.181333 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct trade_symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.trade_symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m10:24:30.877045 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:98088d68-bcb9-4934-ac18-afdc1398c7b6&page=queryresults
[0m10:24:31.224943 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 10:24:30.174984 => 10:24:31.224656
[0m10:24:31.226428 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0c10>]}
[0m10:24:31.227625 [info ] [Thread-3  ]: 5 of 6 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m10:24:31.229009 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m10:24:31.231076 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m10:24:31.232320 [info ] [Thread-1  ]: 6 of 6 START sql view model analytics.historical_equity_held ................... [RUN]
[0m10:24:31.233828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.historical_equity_held)
[0m10:24:31.234644 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m10:24:31.241603 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m10:24:31.245792 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 10:24:31.235126 => 10:24:31.244848
[0m10:24:31.246688 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m10:24:31.253251 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m10:24:31.255078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:24:31.256123 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.trade_symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.trade_symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.trade_symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m10:24:32.020867 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d43253b1-4774-46a5-8cf5-b1d8352ffd70&page=queryresults
[0m10:24:32.498620 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 10:24:31.247245 => 10:24:32.498027
[0m10:24:32.499875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5799f603-b963-4212-8940-85d100e007e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be460>]}
[0m10:24:32.500925 [info ] [Thread-1  ]: 6 of 6 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m10:24:32.502272 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m10:24:32.505088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:32.505775 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m10:24:32.506472 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m10:24:32.506902 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m10:24:32.507302 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:24:32.507797 [info ] [MainThread]: 
[0m10:24:32.508392 [info ] [MainThread]: Finished running 4 view models, 2 seeds in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m10:24:32.510510 [debug] [MainThread]: Command end result
[0m10:24:32.524727 [info ] [MainThread]: 
[0m10:24:32.525476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:32.526384 [info ] [MainThread]: 
[0m10:24:32.526989 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:24:32.530153 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.948777, "process_user_time": 3.901851, "process_kernel_time": 0.507399, "process_mem_max_rss": "135438336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:24:32.531193 [debug] [MainThread]: Command `cli build` succeeded at 10:24:32.530872 after 11.95 seconds
[0m10:24:32.531979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b09b50>]}
[0m10:24:32.533049 [debug] [MainThread]: Flushing usage events
[0m13:21:35.168083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101825b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104700130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104700160>]}


============================== 13:21:35.174532 | 83677050-0f3a-4b36-a66d-4ebbc2355fb5 ==============================
[0m13:21:35.174532 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:21:35.175264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m +student_weekly_progress_report_staging student_weekly_progress_report', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:21:36.652246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159ec430>]}
[0m13:21:36.667276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a03820>]}
[0m13:21:36.669384 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m13:21:36.702085 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:21:36.726527 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:21:36.727622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a03a30>]}
[0m13:21:37.965872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cbc0d0>]}
[0m13:21:37.982416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aa09d0>]}
[0m13:21:37.983001 [info ] [MainThread]: Found 12 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 390 macros, 0 groups, 0 semantic models
[0m13:21:37.983444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83677050-0f3a-4b36-a66d-4ebbc2355fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b8e070>]}
[0m13:21:37.984265 [warn ] [MainThread]: The selection criterion '+student_weekly_progress_report_staging' does not match any nodes
[0m13:21:37.984811 [warn ] [MainThread]: The selection criterion 'student_weekly_progress_report' does not match any nodes
[0m13:21:37.985821 [info ] [MainThread]: 
[0m13:21:37.986272 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:37.986847 [debug] [MainThread]: Command end result
[0m13:21:37.997356 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:37.997172 after 2.86 seconds
[0m13:21:37.998050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101825b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c25ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aa0910>]}
[0m13:21:37.998591 [debug] [MainThread]: Flushing usage events
[0m08:34:18.505877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11249b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11249b100>]}


============================== 08:34:18.511424 | 06a6020f-5d80-45fb-bb9d-3334f8b6a19a ==============================
[0m08:34:18.511424 [info ] [MainThread]: Running with dbt=1.6.1
[0m08:34:18.512314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed -s 0417_history', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:34:27.974648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12374b2e0>]}
[0m08:34:27.985295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237648e0>]}
[0m08:34:27.986296 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:34:28.024266 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m08:34:28.043319 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:34:28.044095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237649a0>]}
[0m08:34:29.254034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a1e0d0>]}
[0m08:34:29.274599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123978a90>]}
[0m08:34:29.275204 [info ] [MainThread]: Found 12 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 390 macros, 0 groups, 0 semantic models
[0m08:34:29.275656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238eb190>]}
[0m08:34:29.277077 [info ] [MainThread]: 
[0m08:34:29.278020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:34:29.279116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:34:29.279734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:31.286990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:34:31.288539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:31.636519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383e460>]}
[0m08:34:31.637802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:34:31.638301 [info ] [MainThread]: 
[0m08:34:31.642514 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_history
[0m08:34:31.643199 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.0417_history .................................. [RUN]
[0m08:34:31.644162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_history)
[0m08:34:31.644719 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_history
[0m08:34:31.645332 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (compile): 08:34:31.645067 => 08:34:31.645073
[0m08:34:31.645776 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_history
[0m08:34:31.758452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:34:37.413669 [debug] [Thread-1  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m08:34:37.771715 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fabb0903-0a64-449a-ad61-afe2f6d9a2ae&page=queryresults
[0m08:34:38.413012 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m08:34:38.431529 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (execute): 08:34:31.646091 => 08:34:38.431239
[0m08:34:38.432379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a6020f-5d80-45fb-bb9d-3334f8b6a19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a70a90>]}
[0m08:34:38.432969 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2491[0m in 6.79s]
[0m08:34:38.433865 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_history
[0m08:34:38.436063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:38.436467 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m08:34:38.437106 [info ] [MainThread]: 
[0m08:34:38.437761 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m08:34:38.438735 [debug] [MainThread]: Command end result
[0m08:34:38.451498 [info ] [MainThread]: 
[0m08:34:38.452575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:34:38.453280 [info ] [MainThread]: 
[0m08:34:38.454237 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:34:38.455241 [debug] [MainThread]: Command `dbt seed` succeeded at 08:34:38.455096 after 19.99 seconds
[0m08:34:38.455750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123983d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239789d0>]}
[0m08:34:38.456179 [debug] [MainThread]: Flushing usage events
[0m08:48:10.176361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c87190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c87130>]}


============================== 08:48:10.182912 | 2b5d56bc-610f-49a9-ba35-21316cfcc28c ==============================
[0m08:48:10.182912 [info ] [MainThread]: Running with dbt=1.6.1
[0m08:48:10.183608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:48:11.279904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f58a00>]}
[0m08:48:11.291044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f9e880>]}
[0m08:48:11.292168 [info ] [MainThread]: Registered adapter: bigquery=1.6.4
[0m08:48:11.321645 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m08:48:11.406953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:11.407482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:11.415796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231720d0>]}
[0m08:48:11.433857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123138b20>]}
[0m08:48:11.434487 [info ] [MainThread]: Found 12 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 390 macros, 0 groups, 0 semantic models
[0m08:48:11.437155 [info ] [MainThread]: 
[0m08:48:11.438236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:48:11.440213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:48:11.441009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:13.223010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:48:13.223955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:13.512499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fa7be0>]}
[0m08:48:13.513765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:48:13.514346 [info ] [MainThread]: 
[0m08:48:13.521176 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m08:48:13.521998 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m08:48:13.522691 [info ] [Thread-1  ]: 1 of 18 START sql view model analytics.calendar_dates .......................... [RUN]
[0m08:48:13.523281 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m08:48:13.523876 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m08:48:13.524559 [info ] [Thread-2  ]: 2 of 18 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m08:48:13.525585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m08:48:13.526173 [info ] [Thread-3  ]: 3 of 18 START seed file analytics.0417_current ................................. [RUN]
[0m08:48:13.526904 [info ] [Thread-4  ]: 4 of 18 START seed file analytics.0417_history ................................. [RUN]
[0m08:48:13.528289 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m08:48:13.528968 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m08:48:13.530269 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m08:48:13.531441 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m08:48:13.532172 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m08:48:13.542610 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m08:48:13.543284 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m08:48:13.544021 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m08:48:13.548294 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m08:48:13.549192 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 08:48:13.548861 => 08:48:13.548867
[0m08:48:13.550009 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 08:48:13.549733 => 08:48:13.549736
[0m08:48:13.551228 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m08:48:13.552118 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m08:48:13.559409 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 08:48:13.532988 => 08:48:13.559014
[0m08:48:13.565284 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 08:48:13.544445 => 08:48:13.564975
[0m08:48:13.594246 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m08:48:13.606499 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m08:48:13.632908 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:48:13.787816 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m08:48:13.800797 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:48:13.807276 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:48:13.812616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:48:13.814196 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m08:48:14.180546 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m08:48:14.191536 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m08:48:14.493500 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:65a2eec4-4ce0-4b77-a5ca-2d62a27ce311&page=queryresults
[0m08:48:14.648227 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9d56640e-fe0d-49a7-a550-e420e9bd7fc9&page=queryresults
[0m08:48:14.935884 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 08:48:13.648658 => 08:48:14.935662
[0m08:48:14.936716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231727c0>]}
[0m08:48:14.937467 [info ] [Thread-1  ]: 1 of 18 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m08:48:14.938290 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m08:48:14.938791 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m08:48:14.939365 [info ] [Thread-1  ]: 5 of 18 START seed file analytics.cflt_prices .................................. [RUN]
[0m08:48:14.940200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m08:48:14.940618 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m08:48:14.941110 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 08:48:14.940907 => 08:48:14.940909
[0m08:48:14.941494 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m08:48:14.949559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:48:16.932274 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 08:48:13.689263 => 08:48:16.932041
[0m08:48:16.933147 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12329ffd0>]}
[0m08:48:16.933779 [info ] [Thread-2  ]: 2 of 18 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.41s]
[0m08:48:16.934547 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m08:48:16.935243 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m08:48:16.935675 [info ] [Thread-2  ]: 6 of 18 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m08:48:16.936530 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m08:48:16.936945 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m08:48:16.949564 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m08:48:16.951563 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 08:48:16.937367 => 08:48:16.951103
[0m08:48:16.952267 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m08:48:16.979372 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m08:48:16.980784 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:48:16.981279 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:48:17.715400 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m08:48:17.808395 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e46fd4ff-7325-407e-9720-b8ec4339b94e&page=queryresults
[0m08:48:18.167124 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0f144005-6363-415c-856b-84384fb0e813&page=queryresults
[0m08:48:18.244848 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m08:48:18.533861 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 08:48:16.952707 => 08:48:18.533559
[0m08:48:18.534909 [info ] [Thread-2  ]: 6 of 18 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.60s]
[0m08:48:18.535733 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m08:48:18.536414 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m08:48:18.537001 [info ] [Thread-2  ]: 7 of 18 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m08:48:18.538143 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m08:48:18.538593 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m08:48:18.542093 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m08:48:18.544224 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 08:48:18.538961 => 08:48:18.543628
[0m08:48:18.544782 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m08:48:18.549283 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m08:48:18.550176 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:48:18.550625 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m08:48:18.601986 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:340f4e35-ccc9-43af-adaa-c8e71928e17c&page=queryresults
[0m08:48:18.685579 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m08:48:18.825833 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m08:48:18.829639 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 08:48:13.552700 => 08:48:18.829420
[0m08:48:18.830719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123220c70>]}
[0m08:48:18.831738 [info ] [Thread-3  ]: 3 of 18 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 5.30s]
[0m08:48:18.832545 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m08:48:18.833231 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m08:48:18.833739 [info ] [Thread-3  ]: 8 of 18 START sql view model analytics.current ................................. [RUN]
[0m08:48:18.834758 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current)
[0m08:48:18.835200 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m08:48:18.839532 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m08:48:18.841379 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 08:48:18.835501 => 08:48:18.841004
[0m08:48:18.841970 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m08:48:18.845931 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m08:48:18.846874 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:48:18.847476 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m08:48:18.980177 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m08:48:18.984587 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 08:48:13.571401 => 08:48:18.984282
[0m08:48:18.985736 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123253ca0>]}
[0m08:48:18.986383 [info ] [Thread-4  ]: 4 of 18 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2491[0m in 5.45s]
[0m08:48:18.987182 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m08:48:18.987849 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m08:48:18.988346 [info ] [Thread-4  ]: 9 of 18 START sql view model analytics.history ................................. [RUN]
[0m08:48:18.989159 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m08:48:18.989572 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m08:48:18.993286 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m08:48:18.995305 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 08:48:18.989872 => 08:48:18.995030
[0m08:48:18.995938 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m08:48:19.004689 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m08:48:19.006161 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:48:19.007145 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where trade_symbol = 'CFLT'
order by date desc;


[0m08:48:19.075031 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a9dba96d-3b4a-4fa3-be07-b256856c4555&page=queryresults
[0m08:48:19.110755 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0b59f4b5-2484-4517-a731-a06e98263df3&page=queryresults
[0m08:48:19.363889 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a7d2250d-936f-4025-aba8-9b9b6fd1c21f&page=queryresults
[0m08:48:19.541863 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 08:48:18.545199 => 08:48:19.541638
[0m08:48:19.542709 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231e6730>]}
[0m08:48:19.543628 [info ] [Thread-2  ]: 7 of 18 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m08:48:19.544629 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m08:48:19.545709 [debug] [Thread-2  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m08:48:19.546165 [info ] [Thread-2  ]: 10 of 18 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m08:48:19.547029 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m08:48:19.547450 [debug] [Thread-2  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m08:48:19.555848 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m08:48:19.557096 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 08:48:19.547739 => 08:48:19.556780
[0m08:48:19.557627 [debug] [Thread-2  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m08:48:19.561275 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m08:48:19.584259 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:48:19.584778 [debug] [Thread-2  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m08:48:19.697199 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m08:48:19.701527 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 08:48:14.941775 => 08:48:19.701308
[0m08:48:19.702356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12344fbb0>]}
[0m08:48:19.702915 [info ] [Thread-1  ]: 5 of 18 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 82[0m in 4.76s]
[0m08:48:19.703931 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m08:48:19.704420 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m08:48:19.704921 [info ] [Thread-1  ]: 11 of 18 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m08:48:19.706190 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:48:19.706796 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m08:48:19.712591 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:48:19.713568 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 08:48:19.707104 => 08:48:19.713291
[0m08:48:19.714018 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m08:48:19.717485 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:48:19.718456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:48:19.719034 [debug] [Thread-1  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:48:19.784778 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d8a2be8a-ff52-4f8a-91ef-02121bcb701c&page=queryresults
[0m08:48:19.791035 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 08:48:18.842272 => 08:48:19.790819
[0m08:48:19.791866 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123613340>]}
[0m08:48:19.792496 [info ] [Thread-3  ]: 8 of 18 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m08:48:19.793408 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m08:48:19.794099 [debug] [Thread-3  ]: Began running node model.ccwj.current_position_information
[0m08:48:19.794701 [info ] [Thread-3  ]: 12 of 18 START sql view model analytics.current_position_information ........... [RUN]
[0m08:48:19.795677 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m08:48:19.796237 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_position_information
[0m08:48:19.800129 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m08:48:19.802721 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (compile): 08:48:19.796541 => 08:48:19.802341
[0m08:48:19.803296 [debug] [Thread-3  ]: Began executing node model.ccwj.current_position_information
[0m08:48:19.808756 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m08:48:19.810170 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:48:19.810719 [debug] [Thread-3  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m08:48:20.307438 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bcb2be3b-6d4d-4d8a-9a57-a1d144eca71c&page=queryresults
[0m08:48:20.830351 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1ca81483-8ca6-4d40-9379-b122830f4c86&page=queryresults
[0m08:48:20.932691 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 08:48:18.996350 => 08:48:20.931498
[0m08:48:20.953391 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235f55b0>]}
[0m08:48:20.959605 [info ] [Thread-4  ]: 9 of 18 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m08:48:20.966391 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m08:48:20.988590 [debug] [Thread-4  ]: Began running node model.ccwj.calendar_symbol_dates
[0m08:48:20.992376 [info ] [Thread-4  ]: 13 of 18 START sql view model analytics.calendar_symbol_dates .................. [RUN]
[0m08:48:21.000597 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.calendar_symbol_dates)
[0m08:48:21.006319 [debug] [Thread-4  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m08:48:21.028851 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m08:48:21.062908 [debug] [Thread-4  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 08:48:21.007808 => 08:48:21.043226
[0m08:48:21.070576 [debug] [Thread-4  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m08:48:21.079958 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m08:48:21.082593 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:48:21.087607 [debug] [Thread-4  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct trade_symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.trade_symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m08:48:21.215510 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 08:48:19.557985 => 08:48:21.215218
[0m08:48:21.216438 [info ] [Thread-2  ]: 10 of 18 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.67s]
[0m08:48:21.217248 [debug] [Thread-2  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m08:48:21.217875 [debug] [Thread-2  ]: Began running node model.ccwj.daily_totals
[0m08:48:21.218472 [info ] [Thread-2  ]: 14 of 18 START sql view model analytics.daily_totals ........................... [RUN]
[0m08:48:21.219324 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.daily_totals)
[0m08:48:21.220038 [debug] [Thread-2  ]: Began compiling node model.ccwj.daily_totals
[0m08:48:21.225756 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m08:48:21.229149 [debug] [Thread-2  ]: Timing info for model.ccwj.daily_totals (compile): 08:48:21.220407 => 08:48:21.228825
[0m08:48:21.229604 [debug] [Thread-2  ]: Began executing node model.ccwj.daily_totals
[0m08:48:21.233568 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m08:48:21.234457 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:48:21.234999 [debug] [Thread-2  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m08:48:21.251196 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (execute): 08:48:19.803664 => 08:48:21.250849
[0m08:48:21.252454 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123664f40>]}
[0m08:48:21.253485 [info ] [Thread-3  ]: 12 of 18 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m08:48:21.254481 [debug] [Thread-3  ]: Finished running node model.ccwj.current_position_information
[0m08:48:21.255137 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m08:48:21.255808 [info ] [Thread-3  ]: 15 of 18 START sql view model analytics.overall_position_performance ........... [RUN]
[0m08:48:21.257508 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.overall_position_performance)
[0m08:48:21.258415 [debug] [Thread-3  ]: Began compiling node model.ccwj.overall_position_performance
[0m08:48:21.264771 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m08:48:21.266668 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (compile): 08:48:21.259136 => 08:48:21.266219
[0m08:48:21.267527 [debug] [Thread-3  ]: Began executing node model.ccwj.overall_position_performance
[0m08:48:21.274324 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m08:48:21.275404 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:48:21.276260 [debug] [Thread-3  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m08:48:21.433908 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5b62b005-b2cb-470b-9dcd-8b08eb2f8dc5&page=queryresults
[0m08:48:21.659493 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3fcfab96-cb57-483d-9d65-935f8c2574ed&page=queryresults
[0m08:48:21.957277 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e66d2ef2-3894-4dc2-a25b-282163ab3be4&page=queryresults
[0m08:48:22.135345 [debug] [Thread-4  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 08:48:21.071405 => 08:48:22.135129
[0m08:48:22.136204 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12315e940>]}
[0m08:48:22.136826 [info ] [Thread-4  ]: 13 of 18 OK created sql view model analytics.calendar_symbol_dates ............. [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m08:48:22.137828 [debug] [Thread-4  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m08:48:22.138318 [debug] [Thread-4  ]: Began running node model.ccwj.positions
[0m08:48:22.138992 [info ] [Thread-4  ]: 16 of 18 START sql view model analytics.positions .............................. [RUN]
[0m08:48:22.139821 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.positions)
[0m08:48:22.140245 [debug] [Thread-4  ]: Began compiling node model.ccwj.positions
[0m08:48:22.149532 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.positions"
[0m08:48:22.150527 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (compile): 08:48:22.140531 => 08:48:22.150236
[0m08:48:22.151096 [debug] [Thread-4  ]: Began executing node model.ccwj.positions
[0m08:48:22.155203 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.positions"
[0m08:48:22.156125 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:48:22.156906 [debug] [Thread-4  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m08:48:22.161869 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 08:48:19.714320 => 08:48:22.161439
[0m08:48:22.163184 [info ] [Thread-1  ]: 11 of 18 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.46s]
[0m08:48:22.164414 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m08:48:22.165086 [debug] [Thread-1  ]: Began running node model.ccwj.testing
[0m08:48:22.165754 [info ] [Thread-1  ]: 17 of 18 START sql view model analytics.testing ................................ [RUN]
[0m08:48:22.166876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.testing)
[0m08:48:22.167442 [debug] [Thread-1  ]: Began compiling node model.ccwj.testing
[0m08:48:22.171753 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.testing"
[0m08:48:22.172934 [debug] [Thread-1  ]: Timing info for model.ccwj.testing (compile): 08:48:22.167800 => 08:48:22.172594
[0m08:48:22.173505 [debug] [Thread-1  ]: Began executing node model.ccwj.testing
[0m08:48:22.178808 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.testing"
[0m08:48:22.181039 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d2c6be81-1852-4aa6-b39f-df059866df8f&page=queryresults
[0m08:48:22.182796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:48:22.183604 [debug] [Thread-1  ]: On model.ccwj.testing: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.testing"} */


  create or replace view `ccwj-dbt`.`analytics`.`testing`
  OPTIONS()
  as select *
from `ccwj-dbt`.`analytics`.`history`;


[0m08:48:22.401017 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (execute): 08:48:21.268218 => 08:48:22.400798
[0m08:48:22.401938 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12329f850>]}
[0m08:48:22.402587 [info ] [Thread-3  ]: 15 of 18 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m08:48:22.404399 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m08:48:22.404914 [debug] [Thread-3  ]: Began running node model.ccwj.historical_equity_held
[0m08:48:22.405479 [info ] [Thread-3  ]: 18 of 18 START sql view model analytics.historical_equity_held ................. [RUN]
[0m08:48:22.406379 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.overall_position_performance, now model.ccwj.historical_equity_held)
[0m08:48:22.406799 [debug] [Thread-3  ]: Began compiling node model.ccwj.historical_equity_held
[0m08:48:22.411428 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m08:48:22.414138 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_equity_held (compile): 08:48:22.407086 => 08:48:22.413882
[0m08:48:22.414723 [debug] [Thread-3  ]: Began executing node model.ccwj.historical_equity_held
[0m08:48:22.418698 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m08:48:22.420277 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:48:22.420818 [debug] [Thread-3  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.trade_symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.trade_symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.trade_symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m08:48:22.659155 [debug] [Thread-2  ]: Timing info for model.ccwj.daily_totals (execute): 08:48:21.229892 => 08:48:22.658921
[0m08:48:22.660241 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234793a0>]}
[0m08:48:22.660965 [info ] [Thread-2  ]: 14 of 18 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m08:48:22.661971 [debug] [Thread-2  ]: Finished running node model.ccwj.daily_totals
[0m08:48:22.701328 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:854d23d3-ec0a-41f6-8555-ac976e58c23f&page=queryresults
[0m08:48:23.088432 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (execute): 08:48:22.151393 => 08:48:23.088198
[0m08:48:23.089296 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123640220>]}
[0m08:48:23.090164 [info ] [Thread-4  ]: 16 of 18 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m08:48:23.090910 [debug] [Thread-4  ]: Finished running node model.ccwj.positions
[0m08:48:23.101810 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:32712567-0743-4e0a-87ed-da8abc68f3ac&page=queryresults
[0m08:48:23.169738 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:07d1c6c1-9573-4f73-b6f1-ab128e71524f&page=queryresults
[0m08:48:23.493658 [debug] [Thread-1  ]: Timing info for model.ccwj.testing (execute): 08:48:22.174009 => 08:48:23.493437
[0m08:48:23.494620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236401c0>]}
[0m08:48:23.495355 [info ] [Thread-1  ]: 17 of 18 OK created sql view model analytics.testing ........................... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m08:48:23.496153 [debug] [Thread-1  ]: Finished running node model.ccwj.testing
[0m08:48:23.549752 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_equity_held (execute): 08:48:22.415022 => 08:48:23.549519
[0m08:48:23.550781 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b5d56bc-610f-49a9-ba35-21316cfcc28c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236d9b20>]}
[0m08:48:23.551481 [info ] [Thread-3  ]: 18 of 18 OK created sql view model analytics.historical_equity_held ............ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m08:48:23.552326 [debug] [Thread-3  ]: Finished running node model.ccwj.historical_equity_held
[0m08:48:23.554573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:23.554961 [debug] [MainThread]: Connection 'model.ccwj.testing' was properly closed.
[0m08:48:23.555288 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m08:48:23.555703 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m08:48:23.556052 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m08:48:23.556843 [info ] [MainThread]: 
[0m08:48:23.557450 [info ] [MainThread]: Finished running 11 view models, 1 table model, 3 tests, 3 seeds in 0 hours 0 minutes and 12.12 seconds (12.12s).
[0m08:48:23.561759 [debug] [MainThread]: Command end result
[0m08:48:23.586356 [info ] [MainThread]: 
[0m08:48:23.587185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:23.587838 [info ] [MainThread]: 
[0m08:48:23.588549 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m08:48:23.589526 [debug] [MainThread]: Command `dbt build` succeeded at 08:48:23.589372 after 13.44 seconds
[0m08:48:23.590556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12308f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12308f040>]}
[0m08:48:23.591098 [debug] [MainThread]: Flushing usage events
[0m09:12:22.679329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f27d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2acd60>]}


============================== 09:12:22.685036 | 6768c29c-5091-4d96-bca4-6435e091290f ==============================
[0m09:12:22.685036 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:12:22.685950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:12:23.681824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26aa90>]}
[0m09:12:23.806005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110033ee0>]}
[0m09:12:23.807994 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:12:23.838671 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:12:23.946359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:23.946897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:23.956429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104390d0>]}
[0m09:12:23.975355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103562b0>]}
[0m09:12:23.976004 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:12:23.976763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016d8e0>]}
[0m09:12:23.979114 [info ] [MainThread]: 
[0m09:12:23.980456 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:12:23.982630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:12:23.983394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:26.207981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:12:26.209025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:26.591777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103565b0>]}
[0m09:12:26.593162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:26.593961 [info ] [MainThread]: 
[0m09:12:26.615803 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m09:12:26.616600 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m09:12:26.617775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m09:12:26.618393 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m09:12:26.631493 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:12:26.632865 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 09:12:26.618868 => 09:12:26.632484
[0m09:12:26.633520 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m09:12:26.688815 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:12:26.690188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:12:26.690874 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
order by date desc;


[0m09:12:27.239414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9146ace5-bea7-4fa9-8545-bfbb305f033c&page=queryresults
[0m09:12:27.683054 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 09:12:26.633864 => 09:12:27.682774
[0m09:12:27.684111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6768c29c-5091-4d96-bca4-6435e091290f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d0f40>]}
[0m09:12:27.684894 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:12:27.686174 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m09:12:27.688782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:27.689648 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:12:27.690163 [info ] [MainThread]: 
[0m09:12:27.690676 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m09:12:27.691932 [debug] [MainThread]: Command end result
[0m09:12:27.707825 [info ] [MainThread]: 
[0m09:12:27.708628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:27.709283 [info ] [MainThread]: 
[0m09:12:27.710167 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:12:27.726975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.136556, "process_user_time": 3.682948, "process_kernel_time": 0.452357, "process_mem_max_rss": "127639552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:12:27.728617 [debug] [MainThread]: Command `cli run` succeeded at 09:12:27.728130 after 5.14 seconds
[0m09:12:27.729708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103562b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bc9a0>]}
[0m09:12:27.730723 [debug] [MainThread]: Flushing usage events
[0m09:12:38.452187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112108d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113be8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd8dc0>]}


============================== 09:12:38.457855 | 050dc289-e002-480b-9682-d97ed486ca54 ==============================
[0m09:12:38.457855 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:12:38.459164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:12:39.283807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba1a60>]}
[0m09:12:39.461317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a0b5e0>]}
[0m09:12:39.463002 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:12:39.501214 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:12:39.643726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:39.644400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:39.656444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d6e970>]}
[0m09:12:39.698431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c90040>]}
[0m09:12:39.699842 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:12:39.701263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aa4040>]}
[0m09:12:39.704506 [info ] [MainThread]: 
[0m09:12:39.706533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:12:39.708457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:12:39.709280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:41.872662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:12:41.874932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:42.227681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a6ac40>]}
[0m09:12:42.229273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:42.230143 [info ] [MainThread]: 
[0m09:12:42.236094 [debug] [Thread-1  ]: Began running node model.ccwj.historical_options_held
[0m09:12:42.237200 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.historical_options_held .................. [RUN]
[0m09:12:42.238797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.historical_options_held)
[0m09:12:42.239787 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_options_held
[0m09:12:42.259110 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m09:12:42.262028 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_options_held (compile): 09:12:42.240426 => 09:12:42.261318
[0m09:12:42.263155 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_options_held
[0m09:12:42.334934 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m09:12:42.337226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:12:42.338431 [debug] [Thread-1  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as select 
*
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'

order by date desc 
limit 100;


[0m09:12:42.911338 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:58443f72-4c98-4738-99f8-a6289b189dc4&page=queryresults
[0m09:12:43.296162 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_options_held (execute): 09:12:42.263832 => 09:12:43.295775
[0m09:12:43.297326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050dc289-e002-480b-9682-d97ed486ca54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e07c40>]}
[0m09:12:43.298217 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.historical_options_held ............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m09:12:43.299682 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_options_held
[0m09:12:43.302834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:43.303479 [debug] [MainThread]: Connection 'model.ccwj.historical_options_held' was properly closed.
[0m09:12:43.304070 [info ] [MainThread]: 
[0m09:12:43.304859 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m09:12:43.306077 [debug] [MainThread]: Command end result
[0m09:12:43.322527 [info ] [MainThread]: 
[0m09:12:43.323463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:43.324293 [info ] [MainThread]: 
[0m09:12:43.325142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:12:43.329364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9718966, "process_user_time": 4.123576, "process_kernel_time": 0.509761, "process_mem_max_rss": "127647744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:12:43.330506 [debug] [MainThread]: Command `cli run` succeeded at 09:12:43.330306 after 4.97 seconds
[0m09:12:43.331086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112108d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e835b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b42ca0>]}
[0m09:12:43.331773 [debug] [MainThread]: Flushing usage events
[0m09:25:51.969534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c4f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272afa0>]}


============================== 09:25:51.976883 | 2cfc35e3-e60e-4839-bf18-076c833d3710 ==============================
[0m09:25:51.976883 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:25:51.978105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:25:52.856650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279ddc0>]}
[0m09:25:52.998690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136833d0>]}
[0m09:25:53.000173 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:25:53.034097 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:25:53.157940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:25:53.158633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:25:53.173317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b00d0>]}
[0m09:25:53.201972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137cc3a0>]}
[0m09:25:53.202730 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:25:53.203348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137cc610>]}
[0m09:25:53.206361 [info ] [MainThread]: 
[0m09:25:53.208708 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:25:53.211453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:25:53.212243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:55.204302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:25:55.205441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:25:55.590194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11358dee0>]}
[0m09:25:55.591963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:25:55.592810 [info ] [MainThread]: 
[0m09:25:55.598483 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m09:25:55.599204 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m09:25:55.600198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m09:25:55.600855 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m09:25:55.613752 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:25:55.614988 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 09:25:55.601208 => 09:25:55.614582
[0m09:25:55.615634 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m09:25:55.666092 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:25:55.667084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:25:55.667748 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
order by date desc;


[0m09:25:56.233476 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0c127058-490d-42ea-824b-5a4bf29358e4&page=queryresults
[0m09:25:56.882492 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 09:25:55.615967 => 09:25:56.882082
[0m09:25:56.883476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cfc35e3-e60e-4839-bf18-076c833d3710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357c220>]}
[0m09:25:56.884248 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m09:25:56.885671 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m09:25:56.888556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:56.889127 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:25:56.889539 [info ] [MainThread]: 
[0m09:25:56.890234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m09:25:56.891606 [debug] [MainThread]: Command end result
[0m09:25:56.905272 [info ] [MainThread]: 
[0m09:25:56.905895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:56.906368 [info ] [MainThread]: 
[0m09:25:56.906901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:25:56.910359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.128913, "process_user_time": 4.131329, "process_kernel_time": 0.582433, "process_mem_max_rss": "127348736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:25:56.912788 [debug] [MainThread]: Command `cli run` succeeded at 09:25:56.911050 after 5.13 seconds
[0m09:25:56.914022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c4f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139299a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e4610>]}
[0m09:25:56.914855 [debug] [MainThread]: Flushing usage events
[0m09:33:06.354414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c94fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e463d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e453dc0>]}


============================== 09:33:06.362223 | aed65f50-d9d6-4bbd-8fdd-48f20f1e958f ==============================
[0m09:33:06.362223 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:33:06.363057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:33:07.161548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41c520>]}
[0m09:33:07.291064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2c7430>]}
[0m09:33:07.292596 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:33:07.317940 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:33:07.414391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:07.415040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:07.425025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5ecfa0>]}
[0m09:33:07.444219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f508130>]}
[0m09:33:07.444878 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:33:07.445493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3bda00>]}
[0m09:33:07.447704 [info ] [MainThread]: 
[0m09:33:07.449134 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:07.451133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:33:07.452142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:10.085156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:33:10.086525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:10.532926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3dd670>]}
[0m09:33:10.535079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:10.535987 [info ] [MainThread]: 
[0m09:33:10.542064 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_symbol_dates
[0m09:33:10.543319 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m09:33:10.545214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_symbol_dates)
[0m09:33:10.546322 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m09:33:10.570951 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m09:33:10.573619 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 09:33:10.547344 => 09:33:10.572944
[0m09:33:10.574838 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m09:33:10.858314 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m09:33:10.860609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:33:10.861449 [debug] [Thread-1  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.trade_symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m09:33:11.556250 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:31357040-6273-4c03-9b85-8a26e2054e4a&page=queryresults
[0m09:33:11.954699 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name trade_symbol not found inside all_symbols at [13:17]; reason: invalidQuery, location: query, message: Name trade_symbol not found inside all_symbols at [13:17]')
[0m09:33:12.628571 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d703955-c8a3-4efd-9fd3-3903fa46f129&page=queryresults
[0m09:33:13.033541 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d703955-c8a3-4efd-9fd3-3903fa46f129&page=queryresults
[0m09:33:13.034925 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 09:33:10.575658 => 09:33:13.034324
[0m09:33:13.055569 [debug] [Thread-1  ]: Database Error in model calendar_symbol_dates (models/intermediate/calendar_symbol_dates.sql)
  Name trade_symbol not found inside all_symbols at [13:17]
  compiled Code at target/run/ccwj/models/intermediate/calendar_symbol_dates.sql
[0m09:33:13.056350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed65f50-d9d6-4bbd-8fdd-48f20f1e958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6a7a60>]}
[0m09:33:13.057244 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.calendar_symbol_dates ........... [[31mERROR[0m in 2.51s]
[0m09:33:13.059337 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m09:33:13.062417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:13.062930 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m09:33:13.063650 [info ] [MainThread]: 
[0m09:33:13.064526 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m09:33:13.066083 [debug] [MainThread]: Command end result
[0m09:33:13.086288 [info ] [MainThread]: 
[0m09:33:13.087433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:33:13.088416 [info ] [MainThread]: 
[0m09:33:13.089430 [error] [MainThread]:   Database Error in model calendar_symbol_dates (models/intermediate/calendar_symbol_dates.sql)
  Name trade_symbol not found inside all_symbols at [13:17]
  compiled Code at target/run/ccwj/models/intermediate/calendar_symbol_dates.sql
[0m09:33:13.090971 [info ] [MainThread]: 
[0m09:33:13.092425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:33:13.096385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.825433, "process_user_time": 3.857063, "process_kernel_time": 0.52117, "process_mem_max_rss": "127836160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:13.097577 [debug] [MainThread]: Command `cli run` failed at 09:33:13.097361 after 6.83 seconds
[0m09:33:13.098177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c94fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3bda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2c7430>]}
[0m09:33:13.098721 [debug] [MainThread]: Flushing usage events
[0m09:33:29.911285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110337250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3ad60>]}


============================== 09:33:29.918898 | a6c368d8-1a14-43dc-8e7e-3914d234e613 ==============================
[0m09:33:29.918898 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:33:29.920473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:33:30.697520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4d730>]}
[0m09:33:30.822456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd5fa0>]}
[0m09:33:30.824339 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:33:30.849519 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:33:30.920341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:30.920919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:30.930691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc70d0>]}
[0m09:33:30.961920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee4220>]}
[0m09:33:30.962532 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:33:30.963166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f94d00>]}
[0m09:33:30.965654 [info ] [MainThread]: 
[0m09:33:30.967853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:30.969970 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:33:30.971066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:32.844864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:33:32.845781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:33.150936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3d4c0>]}
[0m09:33:33.152051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:33.152547 [info ] [MainThread]: 
[0m09:33:33.157451 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_symbol_dates
[0m09:33:33.158229 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m09:33:33.159284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_symbol_dates)
[0m09:33:33.160111 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m09:33:33.173373 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m09:33:33.176128 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 09:33:33.160666 => 09:33:33.175438
[0m09:33:33.176905 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m09:33:33.226546 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m09:33:33.227460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:33:33.228086 [debug] [Thread-1  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m09:33:33.757480 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e2eeffe7-5193-4fb3-b4a0-cbbc0f616ee5&page=queryresults
[0m09:33:34.162248 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 09:33:33.177492 => 09:33:34.161980
[0m09:33:34.163386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c368d8-1a14-43dc-8e7e-3914d234e613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305eee0>]}
[0m09:33:34.164126 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m09:33:34.165080 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m09:33:34.167485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:34.168055 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m09:33:34.168529 [info ] [MainThread]: 
[0m09:33:34.169326 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m09:33:34.171160 [debug] [MainThread]: Command end result
[0m09:33:34.186467 [info ] [MainThread]: 
[0m09:33:34.187069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:34.187560 [info ] [MainThread]: 
[0m09:33:34.188072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:33:34.191279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3627987, "process_user_time": 3.621783, "process_kernel_time": 0.479239, "process_mem_max_rss": "127057920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:34.192415 [debug] [MainThread]: Command `cli run` succeeded at 09:33:34.192166 after 4.36 seconds
[0m09:33:34.193069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110337250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bfed30>]}
[0m09:33:34.193562 [debug] [MainThread]: Flushing usage events
[0m11:18:16.934817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104364400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e25a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5ca90>]}


============================== 11:18:16.940383 | 2f9d3027-0732-4fd2-9b34-52e94eecf871 ==============================
[0m11:18:16.940383 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:18:16.941193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:17.590210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e3d0>]}
[0m11:18:17.717827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c020d0>]}
[0m11:18:17.719601 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:18:17.745668 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:18:17.813665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:17.814449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:17.824285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff70d0>]}
[0m11:18:17.844399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0d4f0>]}
[0m11:18:17.845437 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:18:17.846023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb760>]}
[0m11:18:17.848483 [info ] [MainThread]: 
[0m11:18:17.849682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:17.851160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:18:17.851773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:19.616725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:18:19.617620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:19.896905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9b670>]}
[0m11:18:19.898212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:19.898753 [info ] [MainThread]: 
[0m11:18:19.904218 [debug] [Thread-1  ]: Began running node model.ccwj.historical_options_held
[0m11:18:19.904940 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.historical_options_held .................. [RUN]
[0m11:18:19.906329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.historical_options_held)
[0m11:18:19.906933 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_options_held
[0m11:18:19.919526 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m11:18:19.921913 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_options_held (compile): 11:18:19.907338 => 11:18:19.921549
[0m11:18:19.922465 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_options_held
[0m11:18:19.970242 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m11:18:19.971195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:18:19.971959 [debug] [Thread-1  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m11:18:20.703655 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0038ac4a-73b8-43f0-8e48-e73137931007&page=queryresults
[0m11:18:21.077530 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_options_held (execute): 11:18:19.922846 => 11:18:21.077237
[0m11:18:21.078636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9d3027-0732-4fd2-9b34-52e94eecf871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c59370>]}
[0m11:18:21.079434 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.historical_options_held ............. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m11:18:21.080415 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_options_held
[0m11:18:21.082970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:21.083453 [debug] [MainThread]: Connection 'model.ccwj.historical_options_held' was properly closed.
[0m11:18:21.083889 [info ] [MainThread]: 
[0m11:18:21.084376 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m11:18:21.085705 [debug] [MainThread]: Command end result
[0m11:18:21.101409 [info ] [MainThread]: 
[0m11:18:21.102470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:21.103464 [info ] [MainThread]: 
[0m11:18:21.104139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:21.106831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.255519, "process_user_time": 3.688183, "process_kernel_time": 0.412882, "process_mem_max_rss": "127127552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:21.107747 [debug] [MainThread]: Command `cli run` succeeded at 11:18:21.107543 after 4.26 seconds
[0m11:18:21.109452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104364400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c020d0>]}
[0m11:18:21.110461 [debug] [MainThread]: Flushing usage events
[0m11:18:52.024035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104694be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061623d0>]}


============================== 11:18:52.030940 | 8387b686-30cc-43e9-a44a-0e4c92626da2 ==============================
[0m11:18:52.030940 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:18:52.031798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:52.799242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e94580>]}
[0m11:18:52.932515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a41af0>]}
[0m11:18:52.933528 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:18:52.960143 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:18:53.033034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:53.033783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:53.046575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073330d0>]}
[0m11:18:53.069817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072497f0>]}
[0m11:18:53.070755 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:18:53.071482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb73d0>]}
[0m11:18:53.074219 [info ] [MainThread]: 
[0m11:18:53.076549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:53.078902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:18:53.079645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:54.602379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:18:54.603284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:54.891299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bd4f0>]}
[0m11:18:54.892649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:54.893499 [info ] [MainThread]: 
[0m11:18:54.896830 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m11:18:54.897599 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.historical_equity_held ................... [RUN]
[0m11:18:54.898704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.historical_equity_held)
[0m11:18:54.899347 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m11:18:54.913727 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m11:18:54.917420 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 11:18:54.899812 => 11:18:54.916911
[0m11:18:54.917993 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m11:18:54.969617 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m11:18:54.971341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:18:54.972269 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m11:18:55.610805 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b730cbfc-db44-4d5f-b630-ec6a2588f827&page=queryresults
[0m11:18:55.974798 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 11:18:54.918330 => 11:18:55.974519
[0m11:18:55.975860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8387b686-30cc-43e9-a44a-0e4c92626da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322640>]}
[0m11:18:55.976904 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m11:18:55.978101 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m11:18:55.980814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:55.981417 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m11:18:55.981874 [info ] [MainThread]: 
[0m11:18:55.982653 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m11:18:55.984242 [debug] [MainThread]: Command end result
[0m11:18:55.997339 [info ] [MainThread]: 
[0m11:18:55.998625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:55.999591 [info ] [MainThread]: 
[0m11:18:56.000273 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:56.002823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0772767, "process_user_time": 3.979685, "process_kernel_time": 0.450714, "process_mem_max_rss": "126980096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:56.003809 [debug] [MainThread]: Command `cli run` succeeded at 11:18:56.003422 after 4.08 seconds
[0m11:18:56.004931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104694be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a41af0>]}
[0m11:18:56.005728 [debug] [MainThread]: Flushing usage events
[0m11:19:01.438628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106261d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d78370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d584f0>]}


============================== 11:19:01.445044 | 0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789 ==============================
[0m11:19:01.445044 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:19:01.446300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:19:02.179450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3d640>]}
[0m11:19:02.306634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107611be0>]}
[0m11:19:02.307634 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:19:02.333250 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:19:02.402190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:02.402726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:02.413277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f000d0>]}
[0m11:19:02.431808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e16820>]}
[0m11:19:02.432571 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:19:02.436301 [info ] [MainThread]: 
[0m11:19:02.437556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:19:02.439688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:19:02.440280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:04.419338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:19:04.420772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:04.730692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb6c70>]}
[0m11:19:04.735822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:04.737852 [info ] [MainThread]: 
[0m11:19:04.748689 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m11:19:04.750455 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m11:19:04.752340 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m11:19:04.753295 [info ] [Thread-1  ]: 1 of 8 START sql view model analytics.calendar_dates ........................... [RUN]
[0m11:19:04.754409 [info ] [Thread-2  ]: 2 of 8 START seed file analytics.0417_history .................................. [RUN]
[0m11:19:04.755396 [info ] [Thread-3  ]: 3 of 8 START seed file analytics.cflt_prices ................................... [RUN]
[0m11:19:04.756543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m11:19:04.758230 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:19:04.760467 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m11:19:04.761654 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m11:19:04.762385 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m11:19:04.763058 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:19:04.771648 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 11:19:04.770665 => 11:19:04.770674
[0m11:19:04.783223 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:19:04.781532 => 11:19:04.781575
[0m11:19:04.792204 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m11:19:04.795011 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m11:19:04.796946 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m11:19:04.816771 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 11:19:04.763626 => 11:19:04.816327
[0m11:19:04.837548 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m11:19:04.958026 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:19:04.965269 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m11:19:04.990526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:19:05.007465 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m11:19:05.081697 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:19:05.536071 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:79e579ba-506c-4b4a-a73f-03f9527a174e&page=queryresults
[0m11:19:06.054401 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 11:19:04.856134 => 11:19:06.054085
[0m11:19:06.055472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f80610>]}
[0m11:19:06.056286 [info ] [Thread-1  ]: 1 of 8 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m11:19:06.057250 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m11:19:08.839969 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:19:09.116596 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4ee99f4d-aa23-4e03-83e3-aae3a12c50db&page=queryresults
[0m11:19:09.536956 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:19:09.540845 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:19:04.808820 => 11:19:09.540439
[0m11:19:09.541839 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa5cd0>]}
[0m11:19:09.542533 [info ] [Thread-3  ]: 3 of 8 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 4.78s]
[0m11:19:09.543295 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m11:19:16.181523 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m11:19:16.584531 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:16f284ba-c5f8-466d-9bd2-787efa133b13&page=queryresults
[0m11:19:16.937173 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m11:19:16.941150 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 11:19:04.800402 => 11:19:16.940624
[0m11:19:16.942268 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f886a0>]}
[0m11:19:16.942882 [info ] [Thread-2  ]: 2 of 8 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2460[0m in 12.18s]
[0m11:19:16.943725 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m11:19:16.944895 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m11:19:16.945853 [info ] [Thread-4  ]: 4 of 8 START sql view model analytics.history .................................. [RUN]
[0m11:19:16.946914 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m11:19:16.947469 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m11:19:16.951974 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:19:16.954887 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 11:19:16.947764 => 11:19:16.954514
[0m11:19:16.955384 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m11:19:16.959579 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:19:16.960516 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:19:16.961157 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
order by date desc;


[0m11:19:17.505053 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:35f2cf36-9e05-4f06-bb84-9c9826cc5265&page=queryresults
[0m11:19:17.868300 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 11:19:16.955663 => 11:19:17.868033
[0m11:19:17.869217 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093300a0>]}
[0m11:19:17.870087 [info ] [Thread-4  ]: 4 of 8 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m11:19:17.871069 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m11:19:17.872723 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m11:19:17.873949 [info ] [Thread-3  ]: 5 of 8 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m11:19:17.875227 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.calendar_symbol_dates)
[0m11:19:17.875768 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m11:19:17.881117 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m11:19:17.883787 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 11:19:17.876199 => 11:19:17.883287
[0m11:19:17.884459 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m11:19:17.889847 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m11:19:17.890839 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:19:17.892016 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m11:19:18.425096 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5c488558-35ac-4a1d-b7a7-c23fc4f7ba38&page=queryresults
[0m11:19:18.783930 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 11:19:17.884873 => 11:19:18.783653
[0m11:19:18.784901 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb5430>]}
[0m11:19:18.785589 [info ] [Thread-3  ]: 5 of 8 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m11:19:18.786697 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m11:19:18.787889 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m11:19:18.788541 [debug] [Thread-4  ]: Began running node model.ccwj.historical_options_held
[0m11:19:18.789582 [info ] [Thread-1  ]: 6 of 8 START sql view model analytics.historical_equity_held ................... [RUN]
[0m11:19:18.790580 [info ] [Thread-4  ]: 7 of 8 START sql view model analytics.historical_options_held .................. [RUN]
[0m11:19:18.793937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.historical_equity_held)
[0m11:19:18.795325 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.historical_options_held)
[0m11:19:18.796368 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m11:19:18.797250 [debug] [Thread-4  ]: Began compiling node model.ccwj.historical_options_held
[0m11:19:18.803876 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m11:19:18.809334 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m11:19:18.810806 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 11:19:18.797885 => 11:19:18.810305
[0m11:19:18.811606 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_options_held (compile): 11:19:18.804283 => 11:19:18.811312
[0m11:19:18.812067 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m11:19:18.812674 [debug] [Thread-4  ]: Began executing node model.ccwj.historical_options_held
[0m11:19:18.819296 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m11:19:18.825412 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m11:19:18.826374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:19:18.827038 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m11:19:18.827857 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:19:18.829708 [debug] [Thread-4  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m11:19:19.556960 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ac1683c2-0906-4923-a76f-69bda5441a52&page=queryresults
[0m11:19:19.559156 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c501c8e2-4989-4cda-bdbc-569e897da7f8&page=queryresults
[0m11:19:19.946830 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_options_held (execute): 11:19:18.820158 => 11:19:19.946517
[0m11:19:19.948679 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109368e20>]}
[0m11:19:19.950155 [info ] [Thread-4  ]: 7 of 8 OK created sql view model analytics.historical_options_held ............. [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m11:19:19.955099 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 11:19:18.813426 => 11:19:19.954739
[0m11:19:19.956043 [debug] [Thread-4  ]: Finished running node model.ccwj.historical_options_held
[0m11:19:19.957216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936a400>]}
[0m11:19:19.958357 [info ] [Thread-1  ]: 6 of 8 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m11:19:19.959465 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m11:19:19.960747 [debug] [Thread-3  ]: Began running node model.ccwj.historical_positions_held
[0m11:19:19.961543 [info ] [Thread-3  ]: 8 of 8 START sql view model analytics.historical_positions_held ................ [RUN]
[0m11:19:19.963186 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.historical_positions_held)
[0m11:19:19.964014 [debug] [Thread-3  ]: Began compiling node model.ccwj.historical_positions_held
[0m11:19:19.969396 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.historical_positions_held"
[0m11:19:19.970591 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (compile): 11:19:19.964562 => 11:19:19.970248
[0m11:19:19.971392 [debug] [Thread-3  ]: Began executing node model.ccwj.historical_positions_held
[0m11:19:19.981449 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.historical_positions_held"
[0m11:19:19.982898 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:19:19.983746 [debug] [Thread-3  ]: On model.ccwj.historical_positions_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_positions_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_positions_held`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    historical_options_held.amount as option_amount,
    historical_equity_held.total_gain_or_loss as equity_amount,

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day);


[0m11:19:20.781801 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1a41c473-01be-47f9-b36d-19978a9c6b4c&page=queryresults
[0m11:19:21.166286 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (execute): 11:19:19.971749 => 11:19:21.165702
[0m11:19:21.167532 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed7a23e-aed7-4dfc-8dca-eddbe1c3f789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093293a0>]}
[0m11:19:21.168257 [info ] [Thread-3  ]: 8 of 8 OK created sql view model analytics.historical_positions_held ........... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m11:19:21.169088 [debug] [Thread-3  ]: Finished running node model.ccwj.historical_positions_held
[0m11:19:21.172317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:21.172757 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m11:19:21.173210 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m11:19:21.173542 [debug] [MainThread]: Connection 'model.ccwj.historical_positions_held' was properly closed.
[0m11:19:21.173868 [debug] [MainThread]: Connection 'model.ccwj.historical_options_held' was properly closed.
[0m11:19:21.174288 [info ] [MainThread]: 
[0m11:19:21.174764 [info ] [MainThread]: Finished running 6 view models, 2 seeds in 0 hours 0 minutes and 18.74 seconds (18.74s).
[0m11:19:21.177274 [debug] [MainThread]: Command end result
[0m11:19:21.192571 [info ] [MainThread]: 
[0m11:19:21.193457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:21.194299 [info ] [MainThread]: 
[0m11:19:21.194967 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:19:21.196934 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 19.838778, "process_user_time": 4.291063, "process_kernel_time": 0.465794, "process_mem_max_rss": "137273344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:19:21.199654 [debug] [MainThread]: Command `cli build` succeeded at 11:19:21.199343 after 19.84 seconds
[0m11:19:21.200913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106261d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b92a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd0490>]}
[0m11:19:21.201636 [debug] [MainThread]: Flushing usage events
[0m11:15:15.176416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5fc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0bda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f3a90>]}


============================== 11:15:15.182980 | 304de98a-bbfa-4e39-be40-d90eeea3f491 ==============================
[0m11:15:15.182980 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:15:15.183878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:15.952963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304de98a-bbfa-4e39-be40-d90eeea3f491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff13730>]}
[0m11:15:16.084028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304de98a-bbfa-4e39-be40-d90eeea3f491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99db80>]}
[0m11:15:16.085596 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:15:16.113518 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:15:16.178034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:16.178555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:16.188164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304de98a-bbfa-4e39-be40-d90eeea3f491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102900d0>]}
[0m11:15:16.208129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304de98a-bbfa-4e39-be40-d90eeea3f491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a1940>]}
[0m11:15:16.208881 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:15:16.209557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304de98a-bbfa-4e39-be40-d90eeea3f491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11025bc40>]}
[0m11:15:16.212221 [info ] [MainThread]: 
[0m11:15:16.214116 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:15:16.215609 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:15:16.216223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:18.421641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now create_ccwj-dbt_analytics)
[0m11:15:18.432529 [debug] [ThreadPool]: Creating schema "database: "ccwj-dbt"
schema: "analytics"
"
[0m11:15:18.446176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:18.446851 [debug] [ThreadPool]: On create_ccwj-dbt_analytics: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "connection_name": "create_ccwj-dbt_analytics"} */
create schema if not exists `ccwj-dbt`.`analytics`
  
[0m11:15:18.812983 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fd2d15ce-4ed1-47a0-9103-46ffee59a540&page=queryresults
[0m11:15:18.819107 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m11:15:18.826610 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m11:15:18.835765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:18.840112 [debug] [MainThread]: Connection 'create_ccwj-dbt_analytics' was properly closed.
[0m11:15:18.844639 [info ] [MainThread]: 
[0m11:15:18.854188 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m11:15:18.865136 [error] [MainThread]: Encountered an error:
Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m11:15:18.882119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7985752, "process_user_time": 3.479491, "process_kernel_time": 0.520106, "process_mem_max_rss": "123924480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:15:18.884671 [debug] [MainThread]: Command `cli run` failed at 11:15:18.884077 after 3.80 seconds
[0m11:15:18.888081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5fc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110317700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103177f0>]}
[0m11:15:18.890426 [debug] [MainThread]: Flushing usage events
[0m11:16:19.979747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110873340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a2d60>]}


============================== 11:16:19.985839 | 18f3bfce-50b3-430e-a4aa-73e0f07d089f ==============================
[0m11:16:19.985839 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:16:19.986655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:16:20.746715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b7fd0>]}
[0m11:16:20.862489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111667700>]}
[0m11:16:20.863605 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:16:20.886960 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:16:20.975553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:20.976255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:20.985903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a340d0>]}
[0m11:16:21.003868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111945670>]}
[0m11:16:21.004967 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:16:21.005461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117447c0>]}
[0m11:16:21.007479 [info ] [MainThread]: 
[0m11:16:21.009175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:16:21.011346 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:16:21.012069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:22.639818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:16:22.640822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:22.945312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175b160>]}
[0m11:16:22.946792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:22.947360 [info ] [MainThread]: 
[0m11:16:22.952204 [debug] [Thread-1  ]: Began running node model.ccwj.historical_positions_held
[0m11:16:22.953134 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.historical_positions_held ................ [RUN]
[0m11:16:22.954858 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.historical_positions_held)
[0m11:16:22.955622 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_positions_held
[0m11:16:22.971238 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_positions_held"
[0m11:16:22.973738 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_positions_held (compile): 11:16:22.956139 => 11:16:22.973372
[0m11:16:22.974244 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_positions_held
[0m11:16:23.023548 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_positions_held"
[0m11:16:23.024530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:16:23.025138 [debug] [Thread-1  ]: On model.ccwj.historical_positions_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_positions_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_positions_held`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Options' as equity_type,
    historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)
UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Stock' as equity_type,
    historical_equity_held.total_gain_or_loss as total,

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)

UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Total' as equity_type,
    historical_equity_held.total_gain_or_loss + historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day);


[0m11:16:23.825468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4a42ebe6-c2b9-45e3-b9a9-70442b57302b&page=queryresults
[0m11:16:24.219681 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_positions_held (execute): 11:16:22.974563 => 11:16:24.219313
[0m11:16:24.220772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f3bfce-50b3-430e-a4aa-73e0f07d089f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cebe0>]}
[0m11:16:24.221537 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.historical_positions_held ........... [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m11:16:24.222341 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_positions_held
[0m11:16:24.224565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:24.225025 [debug] [MainThread]: Connection 'model.ccwj.historical_positions_held' was properly closed.
[0m11:16:24.225464 [info ] [MainThread]: 
[0m11:16:24.225930 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m11:16:24.227001 [debug] [MainThread]: Command end result
[0m11:16:24.240068 [info ] [MainThread]: 
[0m11:16:24.240710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:24.241533 [info ] [MainThread]: 
[0m11:16:24.242246 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:24.244895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3456135, "process_user_time": 4.329713, "process_kernel_time": 0.584553, "process_mem_max_rss": "127066112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:16:24.245700 [debug] [MainThread]: Command `cli run` succeeded at 11:16:24.245513 after 4.35 seconds
[0m11:16:24.246284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117447c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119fec70>]}
[0m11:16:24.247091 [debug] [MainThread]: Flushing usage events
[0m13:04:36.614828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f631610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f665d00>]}


============================== 13:04:36.628496 | c871cd69-61a7-4c2e-8b80-f0973c0038ff ==============================
[0m13:04:36.628496 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:04:36.630033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:38.732236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f64c5e0>]}
[0m13:04:38.979502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040efa0>]}
[0m13:04:38.981898 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:04:39.040748 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:04:39.276700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:39.277894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:39.296695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108040d0>]}
[0m13:04:39.339245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071a1c0>]}
[0m13:04:39.340298 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:04:39.341241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071a970>]}
[0m13:04:39.344770 [info ] [MainThread]: 
[0m13:04:39.346542 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:04:39.350384 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:04:39.351599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:44.013984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:04:44.017762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:44.472171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071a040>]}
[0m13:04:44.474917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:44.476056 [info ] [MainThread]: 
[0m13:04:44.491240 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m13:04:44.493237 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m13:04:44.511381 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m13:04:44.519938 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:04:44.495714 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m13:04:44.537317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m13:04:44.504472 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m13:04:44.539066 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m13:04:44.549952 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 13:04:44.548663 => 13:04:44.548673
[0m13:04:44.527488 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m13:04:44.551885 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m13:04:44.554515 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 13:04:44.553611 => 13:04:44.553620
[0m13:04:44.543699 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m13:04:44.575426 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m13:04:44.599235 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m13:04:44.657027 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:04:44.661482 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:04:44.660940 => 13:04:44.660948
[0m13:04:44.662582 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m13:04:44.819614 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:04:44.820746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:44.992157 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:04:49.261600 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:04:49.323899 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:04:49.659492 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:04:49.685567 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:513cb7d8-bd66-49a7-84bd-ba2c83fcbd1b&page=queryresults
[0m13:04:49.969845 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2ec4fb60-15ff-4e52-ab66-eee0977888f0&page=queryresults
[0m13:04:50.061516 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a4a4f8e2-6a41-42f9-b268-dc54dea672d5&page=queryresults
[0m13:04:50.367368 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:04:50.512102 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 13:04:44.619188 => 13:04:50.511440
[0m13:04:50.515383 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c1280>]}
[0m13:04:50.518698 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:04:50.522904 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:04:50.525088 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2460[0m in 6.00s]
[0m13:04:50.527817 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m13:04:50.541631 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:04:44.685633 => 13:04:50.541074
[0m13:04:50.542924 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 13:04:44.558347 => 13:04:50.542496
[0m13:04:50.544612 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7bc70>]}
[0m13:04:50.547934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c871cd69-61a7-4c2e-8b80-f0973c0038ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110884f70>]}
[0m13:04:50.549858 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 82[0m in 5.95s]
[0m13:04:50.551706 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 11[0m in 6.01s]
[0m13:04:50.553632 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m13:04:50.558055 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m13:04:50.565155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:50.567420 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m13:04:50.568306 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m13:04:50.569580 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m13:04:50.570375 [info ] [MainThread]: 
[0m13:04:50.571971 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 11.22 seconds (11.22s).
[0m13:04:50.575803 [debug] [MainThread]: Command end result
[0m13:04:50.612365 [info ] [MainThread]: 
[0m13:04:50.615013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:50.616711 [info ] [MainThread]: 
[0m13:04:50.618404 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:04:50.623986 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 14.288636, "process_user_time": 7.373972, "process_kernel_time": 1.094064, "process_mem_max_rss": "132579328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:04:50.625989 [debug] [MainThread]: Command `dbt seed` succeeded at 13:04:50.625534 after 14.29 seconds
[0m13:04:50.627588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11091bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a8040>]}
[0m13:04:50.629017 [debug] [MainThread]: Flushing usage events
[0m13:10:55.056028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2681c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b256c70>]}


============================== 13:10:55.066452 | a46488fc-1a48-4f15-9682-3c566a399147 ==============================
[0m13:10:55.066452 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:10:55.067809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:56.658207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23d670>]}
[0m13:10:56.993462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bffd5e0>]}
[0m13:10:56.995571 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:10:57.049867 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:10:57.223931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:57.224885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:57.241576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f20d0>]}
[0m13:10:57.278400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c315100>]}
[0m13:10:57.279494 [info ] [MainThread]: Found 14 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:10:57.284493 [info ] [MainThread]: 
[0m13:10:57.288841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:10:57.293614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:10:57.294780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:01.402546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:11:01.405135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:02.356323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c07f3d0>]}
[0m13:11:02.359968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:02.363844 [info ] [MainThread]: 
[0m13:11:02.420418 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m13:11:02.425429 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m13:11:02.423519 [info ] [Thread-1  ]: 1 of 20 START sql view model analytics.calendar_dates .......................... [RUN]
[0m13:11:02.427520 [debug] [Thread-3  ]: Began running node model.ccwj.testing
[0m13:11:02.429534 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_current
[0m13:11:02.431574 [info ] [Thread-2  ]: 2 of 20 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m13:11:02.434252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m13:11:02.435818 [info ] [Thread-3  ]: 3 of 20 START sql view model analytics.testing ................................. [RUN]
[0m13:11:02.438927 [info ] [Thread-4  ]: 4 of 20 START seed file analytics.0417_current ................................. [RUN]
[0m13:11:02.443158 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m13:11:02.445221 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m13:11:02.449772 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.testing'
[0m13:11:02.452281 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m13:11:02.502206 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_current
[0m13:11:02.454608 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m13:11:02.504738 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_current (compile): 13:11:02.503363 => 13:11:02.503372
[0m13:11:02.506137 [debug] [Thread-3  ]: Began compiling node model.ccwj.testing
[0m13:11:02.539105 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_current
[0m13:11:02.552980 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m13:11:02.560259 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m13:11:02.574040 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.testing"
[0m13:11:02.613390 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 13:11:02.456470 => 13:11:02.612293
[0m13:11:02.632517 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 13:11:02.517221 => 13:11:02.631569
[0m13:11:02.697276 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m13:11:02.698858 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m13:11:02.701385 [debug] [Thread-3  ]: Timing info for model.ccwj.testing (compile): 13:11:02.560857 => 13:11:02.700473
[0m13:11:02.797500 [debug] [Thread-3  ]: Began executing node model.ccwj.testing
[0m13:11:03.205530 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:11:03.254860 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:11:03.391196 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m13:11:03.397556 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.testing"
[0m13:11:03.401681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:03.404223 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m13:11:03.409984 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:11:03.413935 [debug] [Thread-3  ]: On model.ccwj.testing: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.testing"} */


  create or replace view `ccwj-dbt`.`analytics`.`testing`
  OPTIONS()
  as select *
from `stitch-data-warehouse-333020`.`airtable`.`all_attempts`
where id = 'clqy0ly8x001531s6b1a0gcol';


[0m13:11:04.019828 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m13:11:04.027592 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:11:04.368162 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ce755f05-9222-4938-b4c6-3d503f4e4a8d&page=queryresults
[0m13:11:04.507315 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f499d62-16d1-4e18-824d-b707cabe7436&page=queryresults
[0m13:11:04.747797 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:16b54b2c-c5d3-46ae-9622-0cc6da9c9278&page=queryresults
[0m13:11:04.750384 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:16b54b2c-c5d3-46ae-9622-0cc6da9c9278&page=queryresults
[0m13:11:04.752488 [debug] [Thread-3  ]: Timing info for model.ccwj.testing (execute): 13:11:02.798946 => 13:11:04.751901
[0m13:11:04.933014 [debug] [Thread-3  ]: Database Error in model testing (models/testing.sql)
  Access Denied: Table stitch-data-warehouse-333020:airtable.all_attempts: User does not have permission to query table stitch-data-warehouse-333020:airtable.all_attempts, or perhaps it does not exist.
  compiled Code at target/run/ccwj/models/testing.sql
[0m13:11:04.935044 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464f40>]}
[0m13:11:04.937589 [error] [Thread-3  ]: 3 of 20 ERROR creating sql view model analytics.testing ........................ [[31mERROR[0m in 2.49s]
[0m13:11:04.940755 [debug] [Thread-3  ]: Finished running node model.ccwj.testing
[0m13:11:04.942989 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m13:11:04.947965 [info ] [Thread-3  ]: 5 of 20 START seed file analytics.0417_history ................................. [RUN]
[0m13:11:04.951040 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.testing, now seed.ccwj.0417_history)
[0m13:11:04.952656 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m13:11:04.957413 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 13:11:04.956200 => 13:11:04.956341
[0m13:11:04.960720 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m13:11:05.311461 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 13:11:02.702371 => 13:11:05.310568
[0m13:11:05.342906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a3b80>]}
[0m13:11:05.362352 [info ] [Thread-1  ]: 1 of 20 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 2.91s]
[0m13:11:05.371322 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:11:05.375737 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m13:11:05.381119 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m13:11:05.383493 [info ] [Thread-1  ]: 6 of 20 START seed file analytics.cflt_prices .................................. [RUN]
[0m13:11:05.387996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m13:11:05.390175 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:11:05.392866 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:11:05.391444 => 13:11:05.391453
[0m13:11:05.394583 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m13:11:05.431146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:06.527838 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 13:11:02.746867 => 13:11:06.526898
[0m13:11:06.531632 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464cd0>]}
[0m13:11:06.533896 [info ] [Thread-2  ]: 2 of 20 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.09s]
[0m13:11:06.536835 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m13:11:06.542031 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m13:11:06.543796 [info ] [Thread-2  ]: 7 of 20 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m13:11:06.547401 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m13:11:06.549319 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m13:11:06.615441 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:06.621873 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 13:11:06.550483 => 13:11:06.620027
[0m13:11:06.625339 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m13:11:06.707916 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:06.711472 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:11:06.714130 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:11:07.876275 [debug] [Thread-4  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:11:08.280378 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e4296013-5d20-4b3d-8aeb-6020be0fac83&page=queryresults
[0m13:11:08.422740 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:92233973-0df2-4841-8b97-584c5aa49b70&page=queryresults
[0m13:11:08.715247 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:11:08.730765 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_current (execute): 13:11:02.576421 => 13:11:08.729703
[0m13:11:08.737048 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464fd0>]}
[0m13:11:08.740878 [info ] [Thread-4  ]: 4 of 20 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 6.29s]
[0m13:11:08.743663 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_current
[0m13:11:08.746085 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m13:11:08.748532 [info ] [Thread-4  ]: 8 of 20 START sql view model analytics.current ................................. [RUN]
[0m13:11:08.751415 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current)
[0m13:11:08.753031 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m13:11:08.770475 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:11:08.776774 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 13:11:08.754861 => 13:11:08.775667
[0m13:11:08.779589 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m13:11:08.798795 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:11:08.801836 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:11:08.804329 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:11:09.454676 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:11:09.586703 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 13:11:06.627021 => 13:11:09.585696
[0m13:11:09.590502 [info ] [Thread-2  ]: 7 of 20 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 3.04s]
[0m13:11:09.593154 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m13:11:09.596617 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m13:11:09.598487 [info ] [Thread-2  ]: 9 of 20 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m13:11:09.601198 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m13:11:09.602960 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m13:11:09.618141 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m13:11:09.623985 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 13:11:09.605836 => 13:11:09.622724
[0m13:11:09.625900 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m13:11:09.646932 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m13:11:09.650985 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:11:09.653015 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m13:11:09.728438 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:11:09.836886 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:50686d3e-ad8e-42b3-bb97-088fa0c3326c&page=queryresults
[0m13:11:09.916360 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:349d778e-6528-4b08-b868-9205de42f712&page=queryresults
[0m13:11:10.062387 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f368ce90-217e-4d26-a291-9aa8f13e6a1f&page=queryresults
[0m13:11:10.275388 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 13:11:08.780854 => 13:11:10.274420
[0m13:11:10.287207 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca015b0>]}
[0m13:11:10.290860 [info ] [Thread-4  ]: 8 of 20 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m13:11:10.294418 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m13:11:10.304081 [debug] [Thread-4  ]: Began running node model.ccwj.current_position_information
[0m13:11:10.306987 [info ] [Thread-4  ]: 10 of 20 START sql view model analytics.current_position_information ........... [RUN]
[0m13:11:10.311169 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_position_information)
[0m13:11:10.313043 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_position_information
[0m13:11:10.331199 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m13:11:10.340443 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (compile): 13:11:10.317165 => 13:11:10.339334
[0m13:11:10.342148 [debug] [Thread-4  ]: Began executing node model.ccwj.current_position_information
[0m13:11:10.384114 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m13:11:10.389106 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:11:10.392698 [debug] [Thread-4  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m13:11:10.499110 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:11:10.510334 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 13:11:04.961957 => 13:11:10.509357
[0m13:11:10.516864 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c556910>]}
[0m13:11:10.519325 [info ] [Thread-3  ]: 5 of 20 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2460[0m in 5.57s]
[0m13:11:10.523138 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m13:11:10.528484 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m13:11:10.530624 [info ] [Thread-3  ]: 11 of 20 START sql view model analytics.history ................................ [RUN]
[0m13:11:10.533289 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m13:11:10.535724 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m13:11:10.548481 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:11:10.551761 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 13:11:10.536599 => 13:11:10.550726
[0m13:11:10.555345 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m13:11:10.581786 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:11:10.584552 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:11:10.585967 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
order by date desc;


[0m13:11:10.627731 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:11:10.641269 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:11:05.395769 => 13:11:10.636786
[0m13:11:10.644312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c967640>]}
[0m13:11:10.645641 [info ] [Thread-1  ]: 6 of 20 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 82[0m in 5.26s]
[0m13:11:10.648283 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m13:11:10.701874 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3e5112a9-353d-4e6f-b953-20eba21604fb&page=queryresults
[0m13:11:11.250119 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 13:11:09.627579 => 13:11:11.248780
[0m13:11:11.259916 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca01190>]}
[0m13:11:11.274566 [info ] [Thread-2  ]: 9 of 20 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m13:11:11.277753 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m13:11:11.282225 [debug] [Thread-1  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:11.284133 [info ] [Thread-1  ]: 12 of 20 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m13:11:11.287108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m13:11:11.290930 [debug] [Thread-1  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:11.372922 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:11.418511 [info ] [Thread-2  ]: 13 of 20 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:11:11.425327 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:11.444223 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:11:11.461585 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:11.470472 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dcd7bac3-7a63-4165-a62a-12651987e001&page=queryresults
[0m13:11:11.478393 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 13:11:11.292026 => 13:11:11.477462
[0m13:11:11.484274 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:11.492750 [debug] [Thread-1  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:11.508869 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:11.511729 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 13:11:11.463349 => 13:11:11.510635
[0m13:11:11.513712 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:11.534416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:11.536044 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:11.542354 [debug] [Thread-1  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m13:11:11.548807 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:11:11.553229 [debug] [Thread-2  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:11:11.709231 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cfaef0ff-4c07-4d2d-8a51-f309d6f564ec&page=queryresults
[0m13:11:12.328398 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 13:11:10.558046 => 13:11:12.327462
[0m13:11:12.331887 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca00af0>]}
[0m13:11:12.334064 [info ] [Thread-3  ]: 11 of 20 OK created sql view model analytics.history ........................... [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m13:11:12.336738 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m13:11:12.339625 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:11:12.341448 [info ] [Thread-3  ]: 14 of 20 START sql view model analytics.calendar_symbol_dates .................. [RUN]
[0m13:11:12.344060 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.calendar_symbol_dates)
[0m13:11:12.345742 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:11:12.381268 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:11:12.388714 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:11:12.351496 => 13:11:12.386633
[0m13:11:12.390589 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:11:13.030825 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:11:13.034833 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:11:13.037279 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m13:11:13.303378 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (execute): 13:11:10.343672 => 13:11:13.302298
[0m13:11:13.306907 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c524520>]}
[0m13:11:13.309288 [info ] [Thread-4  ]: 10 of 20 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 3.00s]
[0m13:11:13.312091 [debug] [Thread-4  ]: Finished running node model.ccwj.current_position_information
[0m13:11:13.314083 [debug] [Thread-4  ]: Began running node model.ccwj.daily_totals
[0m13:11:13.316104 [info ] [Thread-4  ]: 15 of 20 START sql view model analytics.daily_totals ........................... [RUN]
[0m13:11:13.319409 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.daily_totals)
[0m13:11:13.321584 [debug] [Thread-4  ]: Began compiling node model.ccwj.daily_totals
[0m13:11:13.340545 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m13:11:13.345277 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (compile): 13:11:13.323428 => 13:11:13.344202
[0m13:11:13.348554 [debug] [Thread-4  ]: Began executing node model.ccwj.daily_totals
[0m13:11:13.364458 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m13:11:13.367099 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:11:13.370013 [debug] [Thread-4  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m13:11:13.669337 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0cf83d6c-671d-493c-8f5e-a4e750e02fe1&page=queryresults
[0m13:11:13.830356 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:12bc23c0-375a-4ae3-882c-04a3f8cabd65&page=queryresults
[0m13:11:13.989635 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d5db6ee2-843b-4cad-909a-6c71ce8ece58&page=queryresults
[0m13:11:14.068653 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:11:12.391825 => 13:11:14.066256
[0m13:11:14.077384 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c550e50>]}
[0m13:11:14.079928 [info ] [Thread-3  ]: 14 of 20 OK created sql view model analytics.calendar_symbol_dates ............. [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m13:11:14.082785 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:11:14.085089 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m13:11:14.090352 [info ] [Thread-3  ]: 16 of 20 START sql view model analytics.overall_position_performance ........... [RUN]
[0m13:11:14.094693 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.overall_position_performance)
[0m13:11:14.096015 [debug] [Thread-3  ]: Began compiling node model.ccwj.overall_position_performance
[0m13:11:14.110703 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m13:11:14.113560 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (compile): 13:11:14.097165 => 13:11:14.112678
[0m13:11:14.115188 [debug] [Thread-3  ]: Began executing node model.ccwj.overall_position_performance
[0m13:11:14.136203 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m13:11:14.141498 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:11:14.144514 [debug] [Thread-3  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m13:11:14.372763 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0352124d-96d6-45b0-a395-a036b29d9039&page=queryresults
[0m13:11:14.542267 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 13:11:11.496194 => 13:11:14.541666
[0m13:11:14.544410 [info ] [Thread-1  ]: 12 of 20 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 3.26s]
[0m13:11:14.545863 [debug] [Thread-1  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:14.546893 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m13:11:14.548919 [info ] [Thread-1  ]: 17 of 20 START sql view model analytics.positions .............................. [RUN]
[0m13:11:14.551922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.positions)
[0m13:11:14.553132 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m13:11:14.570789 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m13:11:14.574504 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 13:11:14.554598 => 13:11:14.573543
[0m13:11:14.576656 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m13:11:14.595704 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m13:11:14.599726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:14.605396 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m13:11:14.755896 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 13:11:11.514864 => 13:11:14.751986
[0m13:11:14.760392 [info ] [Thread-2  ]: 13 of 20 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.32s]
[0m13:11:14.763139 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:14.764740 [debug] [Thread-2  ]: Began running node model.ccwj.historical_equity_held
[0m13:11:14.767860 [info ] [Thread-2  ]: 18 of 20 START sql view model analytics.historical_equity_held ................. [RUN]
[0m13:11:14.776116 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.historical_equity_held)
[0m13:11:14.778432 [debug] [Thread-2  ]: Began compiling node model.ccwj.historical_equity_held
[0m13:11:14.803445 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m13:11:14.814820 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_equity_held (compile): 13:11:14.781207 => 13:11:14.813483
[0m13:11:14.819460 [debug] [Thread-2  ]: Began executing node model.ccwj.historical_equity_held
[0m13:11:14.869807 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m13:11:14.881941 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:11:14.886393 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (execute): 13:11:13.349627 => 13:11:14.885657
[0m13:11:14.887708 [debug] [Thread-2  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m13:11:14.891149 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca198b0>]}
[0m13:11:14.894286 [info ] [Thread-4  ]: 15 of 20 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m13:11:14.896502 [debug] [Thread-4  ]: Finished running node model.ccwj.daily_totals
[0m13:11:14.897796 [debug] [Thread-4  ]: Began running node model.ccwj.historical_options_held
[0m13:11:14.901598 [info ] [Thread-4  ]: 19 of 20 START sql view model analytics.historical_options_held ................ [RUN]
[0m13:11:14.905034 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.daily_totals, now model.ccwj.historical_options_held)
[0m13:11:14.906518 [debug] [Thread-4  ]: Began compiling node model.ccwj.historical_options_held
[0m13:11:14.922606 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m13:11:14.935042 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_options_held (compile): 13:11:14.907257 => 13:11:14.933807
[0m13:11:14.937121 [debug] [Thread-4  ]: Began executing node model.ccwj.historical_options_held
[0m13:11:14.955724 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m13:11:14.960612 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:11:14.963961 [debug] [Thread-4  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m13:11:15.176988 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6f051fbd-2ee3-4b32-8c23-91e1b404bb70&page=queryresults
[0m13:11:15.635515 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:41332a01-6367-4cfd-b7e4-c3117782abb2&page=queryresults
[0m13:11:15.643593 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b6a63ff9-a045-4303-a873-fc23a3de3ce0&page=queryresults
[0m13:11:16.245634 [debug] [Thread-3  ]: Timing info for model.ccwj.overall_position_performance (execute): 13:11:14.116175 => 13:11:16.244368
[0m13:11:16.254164 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c72ad60>]}
[0m13:11:16.256440 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 13:11:14.582614 => 13:11:16.252431
[0m13:11:16.258509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca37e20>]}
[0m13:11:16.259772 [info ] [Thread-3  ]: 16 of 20 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 2.16s]
[0m13:11:16.262890 [info ] [Thread-1  ]: 17 of 20 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m13:11:16.265495 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m13:11:16.276090 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_equity_held (execute): 13:11:14.827409 => 13:11:16.275309
[0m13:11:16.279087 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m13:11:16.282406 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca399a0>]}
[0m13:11:16.284643 [info ] [Thread-2  ]: 18 of 20 OK created sql view model analytics.historical_equity_held ............ [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m13:11:16.286972 [debug] [Thread-2  ]: Finished running node model.ccwj.historical_equity_held
[0m13:11:16.416663 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5b39b99e-9095-4a2e-918a-66f18a401998&page=queryresults
[0m13:11:16.843051 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_options_held (execute): 13:11:14.939135 => 13:11:16.842550
[0m13:11:16.844658 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c49a9d0>]}
[0m13:11:16.845891 [info ] [Thread-4  ]: 19 of 20 OK created sql view model analytics.historical_options_held ........... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m13:11:16.847804 [debug] [Thread-4  ]: Finished running node model.ccwj.historical_options_held
[0m13:11:16.849691 [debug] [Thread-3  ]: Began running node model.ccwj.historical_positions_held
[0m13:11:16.851267 [info ] [Thread-3  ]: 20 of 20 START sql view model analytics.historical_positions_held .............. [RUN]
[0m13:11:16.852998 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.overall_position_performance, now model.ccwj.historical_positions_held)
[0m13:11:16.854069 [debug] [Thread-3  ]: Began compiling node model.ccwj.historical_positions_held
[0m13:11:16.867994 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.historical_positions_held"
[0m13:11:16.875439 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (compile): 13:11:16.855365 => 13:11:16.874101
[0m13:11:16.877314 [debug] [Thread-3  ]: Began executing node model.ccwj.historical_positions_held
[0m13:11:16.889748 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.historical_positions_held"
[0m13:11:16.892348 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:11:16.894630 [debug] [Thread-3  ]: On model.ccwj.historical_positions_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_positions_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_positions_held`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Options' as equity_type,
    historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)
UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Stock' as equity_type,
    historical_equity_held.total_gain_or_loss as total,

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)

UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Total' as equity_type,
    historical_equity_held.total_gain_or_loss + historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day);


[0m13:11:18.100682 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4b168718-e475-4e9d-a0f5-7515e041adea&page=queryresults
[0m13:11:19.189894 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (execute): 13:11:16.878725 => 13:11:19.189311
[0m13:11:19.192876 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46488fc-1a48-4f15-9682-3c566a399147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c49a9d0>]}
[0m13:11:19.194119 [info ] [Thread-3  ]: 20 of 20 OK created sql view model analytics.historical_positions_held ......... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m13:11:19.195509 [debug] [Thread-3  ]: Finished running node model.ccwj.historical_positions_held
[0m13:11:19.198902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:19.200276 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m13:11:19.201414 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m13:11:19.202608 [debug] [MainThread]: Connection 'model.ccwj.historical_positions_held' was properly closed.
[0m13:11:19.203365 [debug] [MainThread]: Connection 'model.ccwj.historical_options_held' was properly closed.
[0m13:11:19.204166 [info ] [MainThread]: 
[0m13:11:19.205978 [info ] [MainThread]: Finished running 13 view models, 1 table model, 3 seeds, 3 tests in 0 hours 0 minutes and 21.92 seconds (21.92s).
[0m13:11:19.216277 [debug] [MainThread]: Command end result
[0m13:11:19.257856 [info ] [MainThread]: 
[0m13:11:19.263231 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:19.265763 [info ] [MainThread]: 
[0m13:11:19.268831 [error] [MainThread]:   Database Error in model testing (models/testing.sql)
  Access Denied: Table stitch-data-warehouse-333020:airtable.all_attempts: User does not have permission to query table stitch-data-warehouse-333020:airtable.all_attempts, or perhaps it does not exist.
  compiled Code at target/run/ccwj/models/testing.sql
[0m13:11:19.273986 [info ] [MainThread]: 
[0m13:11:19.275953 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=1 SKIP=0 TOTAL=20
[0m13:11:19.282466 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 24.378252, "process_user_time": 9.558842, "process_kernel_time": 1.196123, "process_mem_max_rss": "139812864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:11:19.288419 [debug] [MainThread]: Command `dbt build` failed at 13:11:19.287475 after 24.38 seconds
[0m13:11:19.290526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c14d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bffd5e0>]}
[0m13:11:19.291474 [debug] [MainThread]: Flushing usage events
[0m13:14:04.525854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46fd60>]}


============================== 13:14:04.552485 | e5cca9dd-51ea-4cb2-b412-c616d2bae7ee ==============================
[0m13:14:04.552485 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:14:04.555458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:14:08.210112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102846a0>]}
[0m13:14:08.762026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a3400>]}
[0m13:14:08.782875 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:14:09.009355 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:14:09.337822 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:14:09.339301 [debug] [MainThread]: Partial parsing: deleted file: ccwj://models/testing.sql
[0m13:14:09.398243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105f8f40>]}
[0m13:14:09.495853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110512520>]}
[0m13:14:09.499258 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:14:09.506136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110512760>]}
[0m13:14:09.514375 [info ] [MainThread]: 
[0m13:14:09.520239 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:14:09.529362 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:14:09.531534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:15.897689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:14:15.904383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:17.214568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030cf70>]}
[0m13:14:17.219440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:17.222174 [info ] [MainThread]: 
[0m13:14:17.234103 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m13:14:17.237263 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.daily_totals ............................. [RUN]
[0m13:14:17.240713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.daily_totals)
[0m13:14:17.243518 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m13:14:17.344239 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m13:14:17.351572 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 13:14:17.244854 => 13:14:17.349496
[0m13:14:17.354427 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m13:14:17.625614 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m13:14:17.628953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:14:17.631928 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m13:14:18.806337 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9bc9153a-5d2f-4dc5-963d-12764b4e56d0&page=queryresults
[0m13:14:19.343214 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 13:14:17.356915 => 13:14:19.341288
[0m13:14:19.350890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5cca9dd-51ea-4cb2-b412-c616d2bae7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c4160>]}
[0m13:14:19.354656 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.daily_totals ........................ [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m13:14:19.365762 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m13:14:19.374997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:19.378760 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m13:14:19.382344 [info ] [MainThread]: 
[0m13:14:19.388363 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m13:14:19.397689 [debug] [MainThread]: Command end result
[0m13:14:19.450832 [info ] [MainThread]: 
[0m13:14:19.453386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:19.456508 [info ] [MainThread]: 
[0m13:14:19.460581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:14:19.473006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.737953, "process_user_time": 8.88551, "process_kernel_time": 1.364297, "process_mem_max_rss": "127143936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:14:19.476361 [debug] [MainThread]: Command `cli run` succeeded at 13:14:19.475654 after 15.74 seconds
[0m13:14:19.478578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030c340>]}
[0m13:14:19.480433 [debug] [MainThread]: Flushing usage events
[0m09:29:32.528719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103550be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050469a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501d3d0>]}


============================== 09:29:32.536360 | 9c76f126-5e92-4cee-9037-b4c800a54790 ==============================
[0m09:29:32.536360 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:29:32.537168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:33.431115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c76f126-5e92-4cee-9037-b4c800a54790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050462e0>]}
[0m09:29:33.547126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c76f126-5e92-4cee-9037-b4c800a54790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105054040>]}
[0m09:29:33.548638 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:29:33.575568 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:29:33.682890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:29:33.683460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:29:33.692687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c76f126-5e92-4cee-9037-b4c800a54790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061edfd0>]}
[0m09:29:33.712862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c76f126-5e92-4cee-9037-b4c800a54790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106100130>]}
[0m09:29:33.713539 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:29:33.714139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c76f126-5e92-4cee-9037-b4c800a54790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbec10>]}
[0m09:29:33.716705 [info ] [MainThread]: 
[0m09:29:33.718233 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:29:33.719977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:29:33.720805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:37.612681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now create_ccwj-dbt_analytics)
[0m09:29:37.614322 [debug] [ThreadPool]: Creating schema "database: "ccwj-dbt"
schema: "analytics"
"
[0m09:29:37.628037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:37.628764 [debug] [ThreadPool]: On create_ccwj-dbt_analytics: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "connection_name": "create_ccwj-dbt_analytics"} */
create schema if not exists `ccwj-dbt`.`analytics`
  
[0m09:29:38.026485 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:35eeeb8d-b98b-4d18-a418-47a8a8372961&page=queryresults
[0m09:29:38.027858 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m09:29:38.028578 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:29:38.031482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:38.032121 [debug] [MainThread]: Connection 'create_ccwj-dbt_analytics' was properly closed.
[0m09:29:38.032733 [info ] [MainThread]: 
[0m09:29:38.033696 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m09:29:38.034820 [error] [MainThread]: Encountered an error:
Database Error
  Access Denied: Project ccwj-dbt: User does not have bigquery.jobs.create permission in project ccwj-dbt.
[0m09:29:38.038607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.602066, "process_user_time": 3.459439, "process_kernel_time": 0.588863, "process_mem_max_rss": "124059648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:29:38.039893 [debug] [MainThread]: Command `cli run` failed at 09:29:38.039565 after 5.60 seconds
[0m09:29:38.040734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103550be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ed5b0>]}
[0m09:29:38.041430 [debug] [MainThread]: Flushing usage events
[0m10:00:15.250285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b944c10>]}


============================== 10:00:15.256787 | 44f51cfd-258a-4f48-b430-14b16a33f5b7 ==============================
[0m10:00:15.256787 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:00:15.257633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:15.874369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92e1f0>]}
[0m10:00:15.986220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6eb100>]}
[0m10:00:15.987165 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:00:16.012176 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:00:16.092447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:16.093003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:16.103132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caec0d0>]}
[0m10:00:16.123131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca01100>]}
[0m10:00:16.124042 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:00:16.124785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca01250>]}
[0m10:00:16.127824 [info ] [MainThread]: 
[0m10:00:16.129349 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:00:16.131146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:00:16.131975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:17.505140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:00:17.506403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:17.792483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c818c40>]}
[0m10:00:17.794685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:17.795471 [info ] [MainThread]: 
[0m10:00:17.800963 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m10:00:17.801960 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m10:00:17.803146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m10:00:17.803949 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m10:00:17.817751 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:00:17.821048 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 10:00:17.804399 => 10:00:17.820551
[0m10:00:17.821676 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m10:00:17.869107 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:00:17.871166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:17.872027 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:00:18.333167 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:24134cc9-283d-48a2-9d40-3c8432af93a0&page=queryresults
[0m10:00:18.337554 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:00:18.338832 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table ccwj-dbt:analytics.0417_current was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_current was not found in location US

Location: US
Job ID: 24134cc9-283d-48a2-9d40-3c8432af93a0

[0m10:00:18.340092 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 10:00:17.822023 => 10:00:18.339665
[0m10:00:18.363360 [debug] [Thread-1  ]: Runtime Error in model current (models/groomed/current.sql)
  404 Not found: Table ccwj-dbt:analytics.0417_current was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_current was not found in location US
  
  Location: US
  Job ID: 24134cc9-283d-48a2-9d40-3c8432af93a0
  
[0m10:00:18.364246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44f51cfd-258a-4f48-b430-14b16a33f5b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb69730>]}
[0m10:00:18.365289 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 0.56s]
[0m10:00:18.366891 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m10:00:18.369583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:18.370232 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m10:00:18.370860 [info ] [MainThread]: 
[0m10:00:18.371417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m10:00:18.372933 [debug] [MainThread]: Command end result
[0m10:00:18.388482 [info ] [MainThread]: 
[0m10:00:18.389144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:00:18.390006 [info ] [MainThread]: 
[0m10:00:18.390747 [error] [MainThread]:   Runtime Error in model current (models/groomed/current.sql)
  404 Not found: Table ccwj-dbt:analytics.0417_current was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.0417_current was not found in location US
  
  Location: US
  Job ID: 24134cc9-283d-48a2-9d40-3c8432af93a0
  
[0m10:00:18.391724 [info ] [MainThread]: 
[0m10:00:18.392496 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:00:18.394744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2206976, "process_user_time": 3.55509, "process_kernel_time": 0.396954, "process_mem_max_rss": "128155648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:00:18.396347 [debug] [MainThread]: Command `cli run` failed at 10:00:18.395929 after 3.22 seconds
[0m10:00:18.397229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c891b50>]}
[0m10:00:18.397900 [debug] [MainThread]: Flushing usage events
[0m10:00:33.636244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a42d60>]}


============================== 10:00:33.642603 | fd8924e2-8469-4a27-8f08-8d77a980dc33 ==============================
[0m10:00:33.642603 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:00:33.643791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:34.378229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a42d60>]}
[0m10:00:34.491683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d86a0>]}
[0m10:00:34.493268 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:00:34.516874 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:00:34.602588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:34.603214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:34.611744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bca0d0>]}
[0m10:00:34.629239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b2490>]}
[0m10:00:34.630179 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:00:34.633357 [info ] [MainThread]: 
[0m10:00:34.635038 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:00:34.636773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:00:34.637675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:36.308191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:00:36.309114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:36.566239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a322b0>]}
[0m10:00:36.568267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:36.568966 [info ] [MainThread]: 
[0m10:00:36.573856 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m10:00:36.575022 [info ] [Thread-1  ]: 1 of 6 START seed file analytics.0417_current .................................. [RUN]
[0m10:00:36.576263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m10:00:36.577111 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m10:00:36.578020 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 10:00:36.577596 => 10:00:36.577601
[0m10:00:36.578622 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m10:00:36.625188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:40.341443 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:00:40.727775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:50665c0c-563a-4e5f-8b7a-5d48085ad84f&page=queryresults
[0m10:00:41.118118 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:00:41.144802 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 10:00:36.579128 => 10:00:41.144504
[0m10:00:41.145819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c44a60>]}
[0m10:00:41.146506 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 11[0m in 4.57s]
[0m10:00:41.147274 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m10:00:41.148429 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m10:00:41.149253 [info ] [Thread-3  ]: 2 of 6 START sql view model analytics.current .................................. [RUN]
[0m10:00:41.150394 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m10:00:41.150946 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m10:00:41.161147 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:00:41.162148 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 10:00:41.151324 => 10:00:41.161862
[0m10:00:41.162712 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m10:00:41.187204 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:00:41.188259 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:00:41.188954 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:00:41.754412 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:494b3478-0eed-426d-9c51-982e7bbeb65a&page=queryresults
[0m10:00:42.062760 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 10:00:41.163024 => 10:00:42.062423
[0m10:00:42.063884 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1be80>]}
[0m10:00:42.064752 [info ] [Thread-3  ]: 2 of 6 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m10:00:42.065627 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m10:00:42.066935 [debug] [Thread-2  ]: Began running node model.ccwj.current_position_information
[0m10:00:42.067705 [debug] [Thread-1  ]: Began running node model.ccwj.daily_totals
[0m10:00:42.068327 [info ] [Thread-2  ]: 3 of 6 START sql view model analytics.current_position_information ............. [RUN]
[0m10:00:42.068983 [debug] [Thread-4  ]: Began running node model.ccwj.overall_position_performance
[0m10:00:42.069709 [debug] [Thread-3  ]: Began running node model.ccwj.positions
[0m10:00:42.070376 [info ] [Thread-1  ]: 4 of 6 START sql view model analytics.daily_totals ............................. [RUN]
[0m10:00:42.071556 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_position_information'
[0m10:00:42.072270 [info ] [Thread-4  ]: 5 of 6 START sql view model analytics.overall_position_performance ............. [RUN]
[0m10:00:42.072957 [info ] [Thread-3  ]: 6 of 6 START sql view model analytics.positions ................................ [RUN]
[0m10:00:42.074308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.daily_totals)
[0m10:00:42.074920 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_position_information
[0m10:00:42.075836 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.overall_position_performance'
[0m10:00:42.076643 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.positions)
[0m10:00:42.077194 [debug] [Thread-1  ]: Began compiling node model.ccwj.daily_totals
[0m10:00:42.080945 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m10:00:42.081541 [debug] [Thread-4  ]: Began compiling node model.ccwj.overall_position_performance
[0m10:00:42.082023 [debug] [Thread-3  ]: Began compiling node model.ccwj.positions
[0m10:00:42.087386 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:00:42.091512 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m10:00:42.093739 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (compile): 10:00:42.077532 => 10:00:42.093322
[0m10:00:42.100762 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.positions"
[0m10:00:42.102045 [debug] [Thread-2  ]: Began executing node model.ccwj.current_position_information
[0m10:00:42.102838 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (compile): 10:00:42.082346 => 10:00:42.102523
[0m10:00:42.107319 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m10:00:42.107936 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (compile): 10:00:42.087921 => 10:00:42.107634
[0m10:00:42.108603 [debug] [Thread-1  ]: Began executing node model.ccwj.daily_totals
[0m10:00:42.109284 [debug] [Thread-3  ]: Timing info for model.ccwj.positions (compile): 10:00:42.091981 => 10:00:42.108926
[0m10:00:42.110101 [debug] [Thread-4  ]: Began executing node model.ccwj.overall_position_performance
[0m10:00:42.115316 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:00:42.115984 [debug] [Thread-3  ]: Began executing node model.ccwj.positions
[0m10:00:42.116467 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:00:42.120569 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m10:00:42.125224 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.positions"
[0m10:00:42.126204 [debug] [Thread-2  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m10:00:42.126877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:42.127537 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:00:42.129041 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:00:42.129663 [debug] [Thread-1  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:00:42.130383 [debug] [Thread-4  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m10:00:42.131443 [debug] [Thread-3  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m10:00:42.576183 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6434bf39-afeb-448d-b5f7-7eed4c3503f9&page=queryresults
[0m10:00:42.577496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3343a7ef-8f2c-4e71-8d32-5c92db1e79aa&page=queryresults
[0m10:00:42.579341 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a95f868a-e560-4788-b489-6c4524908483&page=queryresults
[0m10:00:42.582169 [debug] [Thread-4  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m10:00:42.583222 [debug] [Thread-4  ]: BigQuery adapter: 404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US

Location: US
Job ID: 6434bf39-afeb-448d-b5f7-7eed4c3503f9

[0m10:00:42.583983 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:00:42.584972 [debug] [Thread-3  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m10:00:42.586006 [debug] [Thread-4  ]: Timing info for model.ccwj.overall_position_performance (execute): 10:00:42.116794 => 10:00:42.585613
[0m10:00:42.586707 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US

Location: US
Job ID: 3343a7ef-8f2c-4e71-8d32-5c92db1e79aa

[0m10:00:42.587382 [debug] [Thread-3  ]: BigQuery adapter: 404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US

Location: US
Job ID: a95f868a-e560-4788-b489-6c4524908483

[0m10:00:42.589829 [debug] [Thread-1  ]: Timing info for model.ccwj.daily_totals (execute): 10:00:42.110851 => 10:00:42.589252
[0m10:00:42.591032 [debug] [Thread-3  ]: Timing info for model.ccwj.positions (execute): 10:00:42.121132 => 10:00:42.590561
[0m10:00:42.611832 [debug] [Thread-1  ]: Runtime Error in model daily_totals (models/core/daily_totals.sql)
  404 Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US
  
  Location: US
  Job ID: 3343a7ef-8f2c-4e71-8d32-5c92db1e79aa
  
[0m10:00:42.612771 [debug] [Thread-4  ]: Runtime Error in model overall_position_performance (models/intermediate/overall_position_performance.sql)
  404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US
  
  Location: US
  Job ID: 6434bf39-afeb-448d-b5f7-7eed4c3503f9
  
[0m10:00:42.613643 [debug] [Thread-3  ]: Runtime Error in model positions (models/core/positions.sql)
  404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US
  
  Location: US
  Job ID: a95f868a-e560-4788-b489-6c4524908483
  
[0m10:00:42.614217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d94c40>]}
[0m10:00:42.614717 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6c1c0>]}
[0m10:00:42.615201 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3550>]}
[0m10:00:42.615933 [error] [Thread-1  ]: 4 of 6 ERROR creating sql view model analytics.daily_totals .................... [[31mERROR[0m in 0.54s]
[0m10:00:42.616864 [error] [Thread-4  ]: 5 of 6 ERROR creating sql view model analytics.overall_position_performance .... [[31mERROR[0m in 0.54s]
[0m10:00:42.617962 [error] [Thread-3  ]: 6 of 6 ERROR creating sql view model analytics.positions ....................... [[31mERROR[0m in 0.54s]
[0m10:00:42.619122 [debug] [Thread-1  ]: Finished running node model.ccwj.daily_totals
[0m10:00:42.620011 [debug] [Thread-4  ]: Finished running node model.ccwj.overall_position_performance
[0m10:00:42.620698 [debug] [Thread-3  ]: Finished running node model.ccwj.positions
[0m10:00:43.393471 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a9c19734-111b-42bb-9599-326aecf7a00e&page=queryresults
[0m10:00:44.329896 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (execute): 10:00:42.103185 => 10:00:44.329519
[0m10:00:44.331276 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8924e2-8469-4a27-8f08-8d77a980dc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8b130>]}
[0m10:00:44.332221 [info ] [Thread-2  ]: 3 of 6 OK created sql view model analytics.current_position_information ........ [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m10:00:44.333444 [debug] [Thread-2  ]: Finished running node model.ccwj.current_position_information
[0m10:00:44.336056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:44.336612 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:00:44.337075 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m10:00:44.337619 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m10:00:44.338100 [debug] [MainThread]: Connection 'model.ccwj.overall_position_performance' was properly closed.
[0m10:00:44.338788 [info ] [MainThread]: 
[0m10:00:44.339528 [info ] [MainThread]: Finished running 1 seed, 5 view models in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m10:00:44.342025 [debug] [MainThread]: Command end result
[0m10:00:44.361318 [info ] [MainThread]: 
[0m10:00:44.362052 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:00:44.362923 [info ] [MainThread]: 
[0m10:00:44.363592 [error] [MainThread]:   Runtime Error in model daily_totals (models/core/daily_totals.sql)
  404 Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.calendar_dates was not found in location US
  
  Location: US
  Job ID: 3343a7ef-8f2c-4e71-8d32-5c92db1e79aa
  
[0m10:00:44.364283 [info ] [MainThread]: 
[0m10:00:44.365207 [error] [MainThread]:   Runtime Error in model overall_position_performance (models/intermediate/overall_position_performance.sql)
  404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US
  
  Location: US
  Job ID: 6434bf39-afeb-448d-b5f7-7eed4c3503f9
  
[0m10:00:44.365973 [info ] [MainThread]: 
[0m10:00:44.366693 [error] [MainThread]:   Runtime Error in model positions (models/core/positions.sql)
  404 Not found: Table ccwj-dbt:analytics.history was not found in location US; reason: notFound, message: Not found: Table ccwj-dbt:analytics.history was not found in location US
  
  Location: US
  Job ID: a95f868a-e560-4788-b489-6c4524908483
  
[0m10:00:44.367504 [info ] [MainThread]: 
[0m10:00:44.368550 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m10:00:44.372384 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 10.816379, "process_user_time": 3.890779, "process_kernel_time": 0.518004, "process_mem_max_rss": "132448256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:00:44.373523 [debug] [MainThread]: Command `cli build` failed at 10:00:44.373292 after 10.82 seconds
[0m10:00:44.374226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f37e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582abe0>]}
[0m10:00:44.374830 [debug] [MainThread]: Flushing usage events
[0m10:01:21.815241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef88d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a97100>]}


============================== 10:01:21.819930 | 0a0bde7a-1064-4630-8182-94ce0f98a2cd ==============================
[0m10:01:21.819930 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:01:21.820578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:22.353014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ae160>]}
[0m10:01:22.450655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111932f10>]}
[0m10:01:22.451675 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:01:22.472051 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:01:22.526934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:22.527412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:22.535066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c230d0>]}
[0m10:01:22.550034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a09d00>]}
[0m10:01:22.550594 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:01:22.553450 [info ] [MainThread]: 
[0m10:01:22.554897 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:22.557732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:01:22.558448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:24.138311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:01:24.139152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:24.404866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111982d90>]}
[0m10:01:24.406217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:01:24.409413 [info ] [MainThread]: 
[0m10:01:24.413183 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:01:24.413767 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m10:01:24.414458 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m10:01:24.414928 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m10:01:24.415503 [info ] [Thread-1  ]: 1 of 19 START sql view model analytics.calendar_dates .......................... [RUN]
[0m10:01:24.416353 [info ] [Thread-2  ]: 2 of 19 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m10:01:24.417248 [info ] [Thread-3  ]: 3 of 19 START seed file analytics.0417_current ................................. [RUN]
[0m10:01:24.418765 [info ] [Thread-4  ]: 4 of 19 START seed file analytics.0417_history ................................. [RUN]
[0m10:01:24.419956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:01:24.421265 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m10:01:24.422565 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m10:01:24.423592 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:01:24.424085 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:01:24.424524 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m10:01:24.425062 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m10:01:24.425570 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m10:01:24.435757 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:01:24.441084 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m10:01:24.441924 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 10:01:24.441492 => 10:01:24.441498
[0m10:01:24.442746 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 10:01:24.442374 => 10:01:24.442378
[0m10:01:24.444842 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m10:01:24.445655 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m10:01:24.446284 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:01:24.425880 => 10:01:24.445991
[0m10:01:24.446815 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 10:01:24.436234 => 10:01:24.446550
[0m10:01:24.488097 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:01:24.505927 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m10:01:24.540405 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:01:24.672069 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:01:24.678076 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m10:01:24.702739 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:01:24.704198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:01:24.704738 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:01:24.706519 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:01:24.708102 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m10:01:25.154372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3cb20def-923e-447d-b44b-1d24c8cf453f&page=queryresults
[0m10:01:25.181624 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ff2fc2dc-c737-4691-b449-266c09800365&page=queryresults
[0m10:01:25.524879 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:01:24.547605 => 10:01:25.524532
[0m10:01:25.526004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eafc40>]}
[0m10:01:25.526842 [info ] [Thread-1  ]: 1 of 19 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m10:01:25.527739 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:01:25.528391 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m10:01:25.529140 [info ] [Thread-1  ]: 5 of 19 START seed file analytics.cflt_prices .................................. [RUN]
[0m10:01:25.530082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m10:01:25.530631 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:01:25.531276 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:01:25.530984 => 10:01:25.530987
[0m10:01:25.531778 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m10:01:25.543185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:01:27.362984 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 10:01:24.572060 => 10:01:27.362387
[0m10:01:27.364603 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111edc430>]}
[0m10:01:27.365759 [info ] [Thread-2  ]: 2 of 19 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.94s]
[0m10:01:27.366965 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m10:01:27.367996 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:01:27.368702 [info ] [Thread-2  ]: 6 of 19 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m10:01:27.369796 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m10:01:27.370440 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:01:27.386511 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:01:27.387860 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 10:01:27.370843 => 10:01:27.387497
[0m10:01:27.388478 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:01:27.410422 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m10:01:27.411403 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:01:27.411987 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:01:28.075929 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:12b139f9-e9e5-4d68-931d-d3f960620086&page=queryresults
[0m10:01:28.326106 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:01:28.553458 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:01:28.655982 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1b8dcd0c-23f9-479f-8d52-a93ac1a7a209&page=queryresults
[0m10:01:28.662365 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 10:01:27.388875 => 10:01:28.661908
[0m10:01:28.663745 [info ] [Thread-2  ]: 6 of 19 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.29s]
[0m10:01:28.664681 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m10:01:28.665522 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m10:01:28.666205 [info ] [Thread-2  ]: 7 of 19 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m10:01:28.667158 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m10:01:28.667707 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m10:01:28.671984 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m10:01:28.674771 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 10:01:28.668048 => 10:01:28.674361
[0m10:01:28.675420 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m10:01:28.680729 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m10:01:28.681938 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:01:28.682720 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m10:01:28.897266 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fab3d7de-d6d5-4de5-95ae-4b7ad9bc4d94&page=queryresults
[0m10:01:29.043081 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:01:29.074709 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:01:29.078728 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 10:01:24.447086 => 10:01:29.078382
[0m10:01:29.081400 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ceae50>]}
[0m10:01:29.082401 [info ] [Thread-3  ]: 3 of 19 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 11[0m in 4.66s]
[0m10:01:29.083806 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m10:01:29.085016 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m10:01:29.085723 [info ] [Thread-3  ]: 8 of 19 START sql view model analytics.current ................................. [RUN]
[0m10:01:29.086782 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current)
[0m10:01:29.087394 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m10:01:29.091942 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:01:29.093039 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 10:01:29.087745 => 10:01:29.092706
[0m10:01:29.093547 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m10:01:29.101787 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:01:29.102993 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:01:29.103758 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:01:29.225450 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:01:29.235190 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 10:01:24.448379 => 10:01:29.234830
[0m10:01:29.236334 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd9850>]}
[0m10:01:29.237135 [info ] [Thread-4  ]: 4 of 19 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 2460[0m in 4.81s]
[0m10:01:29.238106 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m10:01:29.239094 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m10:01:29.239856 [info ] [Thread-4  ]: 9 of 19 START sql view model analytics.history ................................. [RUN]
[0m10:01:29.240912 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m10:01:29.241492 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m10:01:29.246144 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:01:29.247308 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 10:01:29.241858 => 10:01:29.246968
[0m10:01:29.247877 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m10:01:29.252594 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:01:29.253606 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:01:29.254288 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when amount LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(amount, ')', ''), '($', ''))
       when amount LIKE '$%' THEN REPLACE(REPLACE(amount, ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else amount
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol = 'CFLT'
order by date desc;


[0m10:01:29.327618 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6bc0c219-c26d-446d-91e2-a8a5b0fa71fe&page=queryresults
[0m10:01:29.418858 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b871f341-5b2d-428c-9668-242e66f9cecc&page=queryresults
[0m10:01:29.625944 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d8f7f4de-2a97-4dd5-a105-1cba331fa661&page=queryresults
[0m10:01:29.761253 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 10:01:28.675822 => 10:01:29.760791
[0m10:01:29.762593 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e4f70>]}
[0m10:01:29.763529 [info ] [Thread-2  ]: 7 of 19 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m10:01:29.764536 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m10:01:29.765553 [debug] [Thread-2  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:01:29.766230 [info ] [Thread-2  ]: 10 of 19 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m10:01:29.767158 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m10:01:29.767709 [debug] [Thread-2  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:01:29.777057 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:01:29.778162 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 10:01:29.768051 => 10:01:29.777829
[0m10:01:29.778680 [debug] [Thread-2  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:01:29.782249 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m10:01:29.784077 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:01:29.784812 [debug] [Thread-2  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m10:01:29.809973 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c1fe58c7-3bf8-4481-b8a6-3fd498a038b0&page=queryresults
[0m10:01:29.968098 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 10:01:29.093866 => 10:01:29.967729
[0m10:01:29.969304 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d53c40>]}
[0m10:01:29.970394 [info ] [Thread-3  ]: 8 of 19 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m10:01:29.971800 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m10:01:29.972572 [debug] [Thread-3  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:01:29.973307 [info ] [Thread-3  ]: 11 of 19 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m10:01:29.974503 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m10:01:29.975286 [debug] [Thread-3  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:01:29.986016 [debug] [Thread-3  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:01:29.987280 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 10:01:29.975690 => 10:01:29.986917
[0m10:01:29.987877 [debug] [Thread-3  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:01:29.991919 [debug] [Thread-3  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m10:01:29.993051 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:01:29.993764 [debug] [Thread-3  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:01:30.210191 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 10:01:29.248241 => 10:01:30.209739
[0m10:01:30.211704 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a3550>]}
[0m10:01:30.212639 [info ] [Thread-4  ]: 9 of 19 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m10:01:30.213639 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m10:01:30.214360 [debug] [Thread-4  ]: Began running node model.ccwj.current_position_information
[0m10:01:30.215466 [info ] [Thread-4  ]: 12 of 19 START sql view model analytics.current_position_information ........... [RUN]
[0m10:01:30.216582 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_position_information)
[0m10:01:30.217210 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_position_information
[0m10:01:30.222090 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m10:01:30.224968 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (compile): 10:01:30.217605 => 10:01:30.224530
[0m10:01:30.226225 [debug] [Thread-4  ]: Began executing node model.ccwj.current_position_information
[0m10:01:30.233456 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m10:01:30.235204 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:01:30.236481 [debug] [Thread-4  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m10:01:30.368767 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:01:30.375875 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:01:25.532115 => 10:01:30.375446
[0m10:01:30.377119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d49fa0>]}
[0m10:01:30.377971 [info ] [Thread-1  ]: 5 of 19 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 82[0m in 4.85s]
[0m10:01:30.378947 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m10:01:30.379676 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_symbol_dates
[0m10:01:30.380565 [info ] [Thread-1  ]: 13 of 19 START sql view model analytics.calendar_symbol_dates .................. [RUN]
[0m10:01:30.382228 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.calendar_symbol_dates)
[0m10:01:30.382967 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m10:01:30.390804 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m10:01:30.393562 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 10:01:30.383512 => 10:01:30.393133
[0m10:01:30.394407 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m10:01:30.401162 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m10:01:30.402367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:01:30.403125 [debug] [Thread-1  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`history`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m10:01:30.473723 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:eb26e8f5-639b-4082-96e4-6697e260e693&page=queryresults
[0m10:01:30.678450 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ba551414-608c-4055-bd1e-fec102886673&page=queryresults
[0m10:01:30.793166 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4881e523-15ad-4591-85f3-16c1f24594dd&page=queryresults
[0m10:01:31.030608 [debug] [Thread-2  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 10:01:29.779006 => 10:01:31.030022
[0m10:01:31.033983 [info ] [Thread-2  ]: 10 of 19 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.27s]
[0m10:01:31.035667 [debug] [Thread-2  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m10:01:31.036693 [debug] [Thread-2  ]: Began running node model.ccwj.overall_position_performance
[0m10:01:31.037634 [info ] [Thread-2  ]: 14 of 19 START sql view model analytics.overall_position_performance ........... [RUN]
[0m10:01:31.038753 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.overall_position_performance)
[0m10:01:31.039391 [debug] [Thread-2  ]: Began compiling node model.ccwj.overall_position_performance
[0m10:01:31.044484 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m10:01:31.048982 [debug] [Thread-2  ]: Timing info for model.ccwj.overall_position_performance (compile): 10:01:31.039852 => 10:01:31.048244
[0m10:01:31.050861 [debug] [Thread-2  ]: Began executing node model.ccwj.overall_position_performance
[0m10:01:31.135880 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:497870ac-a6a0-4abb-88c5-2585a739d789&page=queryresults
[0m10:01:31.146977 [debug] [Thread-4  ]: Timing info for model.ccwj.current_position_information (execute): 10:01:30.226962 => 10:01:31.146608
[0m10:01:31.150458 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d53d30>]}
[0m10:01:31.154500 [info ] [Thread-4  ]: 12 of 19 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m10:01:31.155581 [debug] [Thread-4  ]: Finished running node model.ccwj.current_position_information
[0m10:01:31.158092 [debug] [Thread-4  ]: Began running node model.ccwj.positions
[0m10:01:31.161395 [info ] [Thread-4  ]: 15 of 19 START sql view model analytics.positions .............................. [RUN]
[0m10:01:31.169711 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m10:01:31.170786 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.positions)
[0m10:01:31.171662 [debug] [Thread-4  ]: Began compiling node model.ccwj.positions
[0m10:01:31.177127 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.positions"
[0m10:01:31.178159 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:01:31.178951 [debug] [Thread-2  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m10:01:31.181148 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (compile): 10:01:31.172054 => 10:01:31.180763
[0m10:01:31.182664 [debug] [Thread-4  ]: Began executing node model.ccwj.positions
[0m10:01:31.187856 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.positions"
[0m10:01:31.189156 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:01:31.189957 [debug] [Thread-4  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m10:01:31.212744 [debug] [Thread-3  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 10:01:29.988274 => 10:01:31.212158
[0m10:01:31.214362 [info ] [Thread-3  ]: 11 of 19 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.24s]
[0m10:01:31.215608 [debug] [Thread-3  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m10:01:31.216405 [debug] [Thread-3  ]: Began running node model.ccwj.daily_totals
[0m10:01:31.217251 [info ] [Thread-3  ]: 16 of 19 START sql view model analytics.daily_totals ........................... [RUN]
[0m10:01:31.218382 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.daily_totals)
[0m10:01:31.219037 [debug] [Thread-3  ]: Began compiling node model.ccwj.daily_totals
[0m10:01:31.226808 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m10:01:31.228232 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (compile): 10:01:31.219453 => 10:01:31.227881
[0m10:01:31.228864 [debug] [Thread-3  ]: Began executing node model.ccwj.daily_totals
[0m10:01:31.233628 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m10:01:31.234661 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:01:31.235588 [debug] [Thread-3  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m10:01:31.473819 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 10:01:30.395075 => 10:01:31.473356
[0m10:01:31.475399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112159e20>]}
[0m10:01:31.476520 [info ] [Thread-1  ]: 13 of 19 OK created sql view model analytics.calendar_symbol_dates ............. [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m10:01:31.477519 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m10:01:31.478531 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m10:01:31.479280 [info ] [Thread-1  ]: 17 of 19 START sql view model analytics.historical_equity_held ................. [RUN]
[0m10:01:31.480428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.historical_equity_held)
[0m10:01:31.481087 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m10:01:31.486696 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m10:01:31.490663 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 10:01:31.481478 => 10:01:31.490232
[0m10:01:31.491309 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m10:01:31.497875 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m10:01:31.499103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:01:31.500039 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m10:01:31.688488 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2f6a09cc-287f-43fb-a9cd-0be9f5bdca0f&page=queryresults
[0m10:01:31.722070 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5deab232-4253-40ef-8784-89b193f81ad9&page=queryresults
[0m10:01:31.817765 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3cde0e58-33c6-440a-a66b-8fae929b14ee&page=queryresults
[0m10:01:31.983246 [debug] [Thread-2  ]: Timing info for model.ccwj.overall_position_performance (execute): 10:01:31.051779 => 10:01:31.982745
[0m10:01:31.985033 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e4f70>]}
[0m10:01:31.986350 [info ] [Thread-2  ]: 14 of 19 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m10:01:31.988085 [debug] [Thread-2  ]: Finished running node model.ccwj.overall_position_performance
[0m10:01:31.988874 [debug] [Thread-2  ]: Began running node model.ccwj.historical_options_held
[0m10:01:31.990719 [info ] [Thread-2  ]: 18 of 19 START sql view model analytics.historical_options_held ................ [RUN]
[0m10:01:31.992665 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.overall_position_performance, now model.ccwj.historical_options_held)
[0m10:01:31.993666 [debug] [Thread-2  ]: Began compiling node model.ccwj.historical_options_held
[0m10:01:31.998638 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m10:01:32.003398 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_options_held (compile): 10:01:31.994109 => 10:01:32.002648
[0m10:01:32.004658 [debug] [Thread-2  ]: Began executing node model.ccwj.historical_options_held
[0m10:01:32.010848 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m10:01:32.012090 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:01:32.012910 [debug] [Thread-2  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m10:01:32.032083 [debug] [Thread-4  ]: Timing info for model.ccwj.positions (execute): 10:01:31.183245 => 10:01:32.031544
[0m10:01:32.033658 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112140be0>]}
[0m10:01:32.034773 [info ] [Thread-4  ]: 15 of 19 OK created sql view model analytics.positions ......................... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m10:01:32.035653 [debug] [Thread-4  ]: Finished running node model.ccwj.positions
[0m10:01:32.128126 [debug] [Thread-3  ]: Timing info for model.ccwj.daily_totals (execute): 10:01:31.229254 => 10:01:32.127670
[0m10:01:32.129733 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120982b0>]}
[0m10:01:32.130688 [info ] [Thread-3  ]: 16 of 19 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m10:01:32.131801 [debug] [Thread-3  ]: Finished running node model.ccwj.daily_totals
[0m10:01:32.265389 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:21f39bb9-302a-4ec3-b3b0-8e9660b1c9fa&page=queryresults
[0m10:01:32.584927 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 10:01:31.491686 => 10:01:32.584201
[0m10:01:32.586438 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cea310>]}
[0m10:01:32.587572 [info ] [Thread-1  ]: 17 of 19 OK created sql view model analytics.historical_equity_held ............ [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m10:01:32.588753 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m10:01:32.619311 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b9d7e385-d91e-4d17-98b0-215da6fcee29&page=queryresults
[0m10:01:33.296256 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_options_held (execute): 10:01:32.005239 => 10:01:33.295895
[0m10:01:33.297533 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e4f70>]}
[0m10:01:33.298396 [info ] [Thread-2  ]: 18 of 19 OK created sql view model analytics.historical_options_held ........... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m10:01:33.299343 [debug] [Thread-2  ]: Finished running node model.ccwj.historical_options_held
[0m10:01:33.300436 [debug] [Thread-4  ]: Began running node model.ccwj.historical_positions_held
[0m10:01:33.301268 [info ] [Thread-4  ]: 19 of 19 START sql view model analytics.historical_positions_held .............. [RUN]
[0m10:01:33.302378 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.positions, now model.ccwj.historical_positions_held)
[0m10:01:33.303061 [debug] [Thread-4  ]: Began compiling node model.ccwj.historical_positions_held
[0m10:01:33.310080 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.historical_positions_held"
[0m10:01:33.312390 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_positions_held (compile): 10:01:33.303459 => 10:01:33.311966
[0m10:01:33.313019 [debug] [Thread-4  ]: Began executing node model.ccwj.historical_positions_held
[0m10:01:33.319717 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.historical_positions_held"
[0m10:01:33.320913 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:01:33.321749 [debug] [Thread-4  ]: On model.ccwj.historical_positions_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_positions_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_positions_held`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Options' as equity_type,
    historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)
UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Stock' as equity_type,
    historical_equity_held.total_gain_or_loss as total,

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)

UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Total' as equity_type,
    historical_equity_held.total_gain_or_loss + historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day);


[0m10:01:33.992874 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c6762987-68b3-4d25-8bcc-5cc942c00cd1&page=queryresults
[0m10:01:34.331109 [debug] [Thread-4  ]: Timing info for model.ccwj.historical_positions_held (execute): 10:01:33.313399 => 10:01:34.330642
[0m10:01:34.332666 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a0bde7a-1064-4630-8182-94ce0f98a2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eadd30>]}
[0m10:01:34.333820 [info ] [Thread-4  ]: 19 of 19 OK created sql view model analytics.historical_positions_held ......... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m10:01:34.335114 [debug] [Thread-4  ]: Finished running node model.ccwj.historical_positions_held
[0m10:01:34.337882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:34.338500 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m10:01:34.339071 [debug] [MainThread]: Connection 'model.ccwj.historical_options_held' was properly closed.
[0m10:01:34.339623 [debug] [MainThread]: Connection 'model.ccwj.daily_totals' was properly closed.
[0m10:01:34.340236 [debug] [MainThread]: Connection 'model.ccwj.historical_positions_held' was properly closed.
[0m10:01:34.340968 [info ] [MainThread]: 
[0m10:01:34.341584 [info ] [MainThread]: Finished running 12 view models, 1 table model, 3 tests, 3 seeds in 0 hours 0 minutes and 11.79 seconds (11.79s).
[0m10:01:34.346831 [debug] [MainThread]: Command end result
[0m10:01:34.370635 [info ] [MainThread]: 
[0m10:01:34.371324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:01:34.371927 [info ] [MainThread]: 
[0m10:01:34.372468 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m10:01:34.374891 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.627833, "process_user_time": 4.341822, "process_kernel_time": 0.414478, "process_mem_max_rss": "142258176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:01:34.375711 [debug] [MainThread]: Command `dbt build` succeeded at 10:01:34.375530 after 12.63 seconds
[0m10:01:34.376243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef88d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111932f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7e0a0>]}
[0m10:01:34.376933 [debug] [MainThread]: Flushing usage events
[0m10:30:46.373321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f864370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111329610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135ed00>]}


============================== 10:30:46.379420 | fc6c5ed6-34e7-451e-ae79-4fdc6f775f24 ==============================
[0m10:30:46.379420 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:30:46.380213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:47.186314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111329340>]}
[0m10:30:47.291803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f4d00>]}
[0m10:30:47.293343 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:30:47.315567 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:30:47.370322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:47.370798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:47.378267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fef40>]}
[0m10:30:47.398754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c2a30>]}
[0m10:30:47.399919 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:30:47.401037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f6160>]}
[0m10:30:47.404524 [info ] [MainThread]: 
[0m10:30:47.405978 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:30:47.407613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:30:47.408351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:54.112421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:30:54.114510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:55.141872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122290d0>]}
[0m10:30:55.143447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:55.144145 [info ] [MainThread]: 
[0m10:30:55.149543 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m10:30:55.150412 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m10:30:55.151261 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m10:30:55.151985 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m10:30:55.153208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m10:30:55.154043 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m10:30:55.155056 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m10:30:55.155908 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m10:30:55.157065 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:30:55.158144 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m10:30:55.159253 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 10:30:55.158581 => 10:30:55.158584
[0m10:30:55.159877 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m10:30:55.160445 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:30:55.161048 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m10:30:55.161888 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 10:30:55.161535 => 10:30:55.161539
[0m10:30:55.162705 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:30:55.162319 => 10:30:55.162323
[0m10:30:55.169677 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m10:30:55.188346 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m10:30:55.201381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:30:55.213759 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:30:55.291213 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:30:58.868457 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:30:58.871283 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:30:59.154665 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1dc7e7bd-4a9c-4b51-8a3f-a9de18f45799&page=queryresults
[0m10:30:59.173797 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7adc2c58-a789-4a55-8a29-2126c275712f&page=queryresults
[0m10:30:59.489547 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:30:59.512354 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 10:30:55.163106 => 10:30:59.512084
[0m10:30:59.513248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257cc10>]}
[0m10:30:59.513867 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 11[0m in 4.36s]
[0m10:30:59.514789 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m10:30:59.636413 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:30:59.645672 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:30:55.203160 => 10:30:59.645214
[0m10:30:59.647038 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b2520>]}
[0m10:30:59.647867 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 193[0m in 4.49s]
[0m10:30:59.648856 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m10:31:02.565991 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:31:02.857417 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:71502c09-7d63-4612-9ed7-229836beac81&page=queryresults
[0m10:31:03.829544 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:31:03.833733 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 10:30:55.201670 => 10:31:03.833389
[0m10:31:03.835161 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc6c5ed6-34e7-451e-ae79-4fdc6f775f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121bf880>]}
[0m10:31:03.836001 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 2460[0m in 8.68s]
[0m10:31:03.836901 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m10:31:03.839262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:03.839761 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m10:31:03.840211 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m10:31:03.840649 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m10:31:03.841343 [info ] [MainThread]: 
[0m10:31:03.841905 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 16.44 seconds (16.44s).
[0m10:31:03.843423 [debug] [MainThread]: Command end result
[0m10:31:03.857668 [info ] [MainThread]: 
[0m10:31:03.858391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:03.859031 [info ] [MainThread]: 
[0m10:31:03.859591 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:31:03.863226 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.568762, "process_user_time": 3.574094, "process_kernel_time": 0.4926, "process_mem_max_rss": "132968448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:31:03.864194 [debug] [MainThread]: Command `dbt seed` succeeded at 10:31:03.864001 after 17.57 seconds
[0m10:31:03.864819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f864370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112229760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ca130>]}
[0m10:31:03.865628 [debug] [MainThread]: Flushing usage events
[0m11:40:33.506032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108498d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109faf370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f8f4f0>]}


============================== 11:40:33.512772 | 08fab6ff-052f-483e-b154-1b4961a9f7d3 ==============================
[0m11:40:33.512772 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:40:33.513918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:34.262734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7a1f0>]}
[0m11:40:34.376034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf3dc0>]}
[0m11:40:34.377444 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:40:34.401285 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:40:34.483521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:34.484263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:34.492477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1370d0>]}
[0m11:40:34.512658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af1f5b0>]}
[0m11:40:34.513345 [info ] [MainThread]: Found 13 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:40:34.515506 [info ] [MainThread]: 
[0m11:40:34.516719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:40:34.518171 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:40:34.518706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:36.270646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:40:36.271737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:36.625409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae516a0>]}
[0m11:40:36.627051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:36.627726 [info ] [MainThread]: 
[0m11:40:36.632709 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_history
[0m11:40:36.633559 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_history .................................. [RUN]
[0m11:40:36.634969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_history)
[0m11:40:36.635693 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_history
[0m11:40:36.636521 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (compile): 11:40:36.636148 => 11:40:36.636154
[0m11:40:36.637081 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_history
[0m11:40:36.687230 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (execute): 11:40:36.637433 => 11:40:36.686860
[0m11:40:36.698562 [debug] [Thread-1  ]: Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:40:36.699621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08fab6ff-052f-483e-b154-1b4961a9f7d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae51be0>]}
[0m11:40:36.700529 [error] [Thread-1  ]: 1 of 2 ERROR loading seed file analytics.0417_history .......................... [[31mERROR[0m in 0.07s]
[0m11:40:36.701665 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_history
[0m11:40:36.703324 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m11:40:36.703944 [info ] [Thread-3  ]: 2 of 2 SKIP relation analytics.history ......................................... [[33mSKIP[0m]
[0m11:40:36.704518 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m11:40:36.706965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:36.707516 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m11:40:36.708270 [info ] [MainThread]: 
[0m11:40:36.708803 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m11:40:36.709994 [debug] [MainThread]: Command end result
[0m11:40:36.723780 [info ] [MainThread]: 
[0m11:40:36.724882 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:40:36.725458 [info ] [MainThread]: 
[0m11:40:36.726310 [error] [MainThread]:   Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:40:36.727338 [info ] [MainThread]: 
[0m11:40:36.728119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:40:36.731152 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.305571, "process_user_time": 3.520772, "process_kernel_time": 0.473302, "process_mem_max_rss": "128634880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:40:36.732115 [debug] [MainThread]: Command `cli build` failed at 11:40:36.731805 after 3.31 seconds
[0m11:40:36.732815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108498d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b267580>]}
[0m11:40:36.733641 [debug] [MainThread]: Flushing usage events
[0m11:51:42.964219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109243850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109231820>]}


============================== 11:51:42.970891 | 7c264b5f-77ed-4ca9-86eb-27e577361fba ==============================
[0m11:51:42.970891 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:51:42.971662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:43.811965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a056730>]}
[0m11:51:43.914402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd9910>]}
[0m11:51:43.915567 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:51:43.936532 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:51:43.990025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:43.990514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:43.998023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cb0d0>]}
[0m11:51:44.013611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d7070>]}
[0m11:51:44.014196 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:51:44.014805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06d040>]}
[0m11:51:44.017023 [info ] [MainThread]: 
[0m11:51:44.018469 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:44.020370 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:51:44.021236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:45.817760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:51:45.819079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:46.104948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1bbe20>]}
[0m11:51:46.106461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:46.107129 [info ] [MainThread]: 
[0m11:51:46.112703 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:51:46.113466 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m11:51:46.114358 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m11:51:46.115109 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m11:51:46.115762 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m11:51:46.116902 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:51:46.117613 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m11:51:46.118763 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:51:46.119415 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:51:46.120460 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m11:51:46.121099 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m11:51:46.122144 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:51:46.121555 => 11:51:46.121565
[0m11:51:46.122766 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:51:46.123470 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 11:51:46.123142 => 11:51:46.123146
[0m11:51:46.124040 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:51:46.124797 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:51:46.124487 => 11:51:46.124490
[0m11:51:46.125363 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m11:51:46.144234 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m11:51:46.177957 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 11:51:46.158126 => 11:51:46.177631
[0m11:51:46.197394 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:51:46.202822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:46.213978 [debug] [Thread-2  ]: Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:51:46.214703 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a495fd0>]}
[0m11:51:46.215346 [error] [Thread-2  ]: 2 of 3 ERROR loading seed file analytics.0417_history .......................... [[31mERROR[0m in 0.10s]
[0m11:51:46.216065 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m11:51:48.724307 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m11:51:48.727264 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2472 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2474 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2476 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2478 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2480 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2482 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2484 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2486 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2488 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2490 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2492 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2494 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2496 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2498 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2500 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2502 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2504 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2506 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2508 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2510 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2512 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2514 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2516 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2518 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2520 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2522 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2524 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2526 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2528 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2530 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2532 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2534 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2536 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2538 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2540 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2542 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2544 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2546 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2548 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2550 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2552 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2554 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2556 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2558 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2560 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2562 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2564 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2566 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2568 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2570 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2572 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2574 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2576 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2578 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2580 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2582 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2584 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2586 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2588 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2590 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2592 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2594 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2596 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2598 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2600 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2602 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2604 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2606 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2608 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2610 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2612 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2614 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2616 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2618 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2620 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2622 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2624 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2626 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2628 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2630 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2632 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2634 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2636 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2638 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2640 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2642 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2644 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2646 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2648 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:51:48.729690 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:51:46.125737 => 11:51:48.729281
[0m11:51:48.735678 [debug] [Thread-1  ]: Runtime Error in seed 0417_current (seeds/0417_current.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2472 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2474 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2476 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2478 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2480 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2482 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2484 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2486 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2488 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2490 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2492 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2494 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2496 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2498 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2500 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2502 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2504 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2506 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2508 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2510 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2512 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2514 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2516 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2518 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2520 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2522 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2524 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2526 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2528 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2530 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2532 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2534 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2536 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2538 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2540 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2542 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2544 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2546 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2548 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2550 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2552 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2554 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2556 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2558 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2560 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2562 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2564 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2566 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2568 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2570 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2572 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2574 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2576 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2578 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2580 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2582 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2584 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2586 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2588 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2590 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2592 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2594 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2596 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2598 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2600 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2602 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2604 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2606 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2608 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2610 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2612 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2614 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2616 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2618 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2620 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2622 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2624 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2626 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2628 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2630 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2632 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2634 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2636 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2638 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2640 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2642 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2644 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2646 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2648 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:51:48.738481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a48beb0>]}
[0m11:51:48.740712 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file analytics.0417_current .......................... [[31mERROR[0m in 2.62s]
[0m11:51:48.742888 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:51:49.903329 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:51:50.195625 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7b04355f-ddee-468e-871f-023c466501b6&page=queryresults
[0m11:51:50.785992 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:51:50.809887 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:51:46.169308 => 11:51:50.809577
[0m11:51:50.810855 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c264b5f-77ed-4ca9-86eb-27e577361fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a061430>]}
[0m11:51:50.811538 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 193[0m in 4.69s]
[0m11:51:50.812307 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m11:51:50.814289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:50.814721 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:51:50.815114 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m11:51:50.815498 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m11:51:50.815933 [info ] [MainThread]: 
[0m11:51:50.816404 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m11:51:50.818679 [debug] [MainThread]: Command end result
[0m11:51:50.830837 [info ] [MainThread]: 
[0m11:51:50.831558 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:51:50.832025 [info ] [MainThread]: 
[0m11:51:50.832556 [error] [MainThread]:   Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:51:50.832976 [info ] [MainThread]: 
[0m11:51:50.834421 [error] [MainThread]:   Runtime Error in seed 0417_current (seeds/0417_current.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2472 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2474 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2476 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2478 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2480 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2482 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2484 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2486 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2488 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2490 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2492 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2494 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2496 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2498 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2500 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2502 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2504 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2506 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2508 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2510 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2512 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2514 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2516 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2518 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2520 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2522 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2524 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2526 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2528 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2530 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2532 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2534 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2536 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2538 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2540 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2542 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2544 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2546 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2548 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2550 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2552 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2554 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2556 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2558 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2560 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2562 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2564 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2566 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2568 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2570 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2572 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2574 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2576 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2578 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2580 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2582 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2584 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2586 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2588 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2590 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2592 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2594 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2596 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2598 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2600 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2602 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2604 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2606 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2608 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2610 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2612 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2614 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2616 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2618 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2620 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2622 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2624 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2626 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2628 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2630 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2632 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2634 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2636 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2638 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2640 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2642 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2644 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2646 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2648 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:51:50.837080 [info ] [MainThread]: 
[0m11:51:50.837633 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m11:51:50.839987 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 7.958951, "process_user_time": 3.467949, "process_kernel_time": 0.492908, "process_mem_max_rss": "130633728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:50.840767 [debug] [MainThread]: Command `dbt seed` failed at 11:51:50.840606 after 7.96 seconds
[0m11:51:50.841278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd9910>]}
[0m11:51:50.841727 [debug] [MainThread]: Flushing usage events
[0m11:52:44.329053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111190400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c54550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7f9a0>]}


============================== 11:52:44.334318 | 471295f1-81da-46dd-8861-c39e2d24d1a5 ==============================
[0m11:52:44.334318 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:52:44.335302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --select 0417_current', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:44.923336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111957760>]}
[0m11:52:45.045005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a32040>]}
[0m11:52:45.045967 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:52:45.071041 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:52:45.142243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:52:45.142759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:52:45.152528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e250d0>]}
[0m11:52:45.173530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d33160>]}
[0m11:52:45.174853 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:52:45.175836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf7100>]}
[0m11:52:45.178406 [info ] [MainThread]: 
[0m11:52:45.179538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:45.180874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:52:45.181798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:46.486677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:52:46.487936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:46.783387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bdebe0>]}
[0m11:52:46.784935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:52:46.785593 [info ] [MainThread]: 
[0m11:52:46.789307 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:52:46.790197 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.0417_current .................................. [RUN]
[0m11:52:46.791440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:52:46.792164 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:52:46.792996 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:52:46.792609 => 11:52:46.792613
[0m11:52:46.793583 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:52:46.876779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:49.129219 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m11:52:49.132708 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2272 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2274 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2276 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2278 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2280 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2282 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2284 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2286 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2288 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2290 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2292 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2294 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2296 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2298 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2300 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2302 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2304 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2306 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2308 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2310 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2312 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2314 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2316 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2318 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2320 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2322 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2324 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2326 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2328 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2330 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2332 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2334 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2336 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2338 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2340 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2342 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2344 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2346 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2348 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2350 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2352 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2354 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2356 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2358 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2360 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2362 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2364 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2366 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2368 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2370 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2372 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2374 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2376 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2378 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2380 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2382 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2384 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2386 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2388 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2390 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2392 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2394 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2396 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2398 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2400 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2402 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2404 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2406 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2408 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2410 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2412 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2414 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2416 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2418 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2420 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2422 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2424 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2426 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2428 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2430 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2432 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2434 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2436 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2438 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2440 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2442 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2444 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2446 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2448 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:52:49.135625 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:52:46.793968 => 11:52:49.135165
[0m11:52:49.141819 [debug] [Thread-1  ]: Runtime Error in seed 0417_current (seeds/0417_current.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2272 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2274 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2276 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2278 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2280 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2282 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2284 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2286 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2288 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2290 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2292 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2294 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2296 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2298 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2300 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2302 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2304 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2306 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2308 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2310 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2312 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2314 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2316 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2318 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2320 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2322 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2324 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2326 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2328 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2330 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2332 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2334 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2336 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2338 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2340 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2342 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2344 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2346 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2348 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2350 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2352 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2354 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2356 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2358 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2360 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2362 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2364 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2366 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2368 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2370 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2372 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2374 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2376 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2378 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2380 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2382 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2384 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2386 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2388 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2390 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2392 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2394 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2396 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2398 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2400 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2402 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2404 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2406 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2408 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2410 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2412 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2414 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2416 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2418 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2420 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2422 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2424 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2426 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2428 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2430 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2432 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2434 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2436 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2438 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2440 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2442 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2444 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2446 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2448 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:52:49.144018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471295f1-81da-46dd-8861-c39e2d24d1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea4970>]}
[0m11:52:49.146057 [error] [Thread-1  ]: 1 of 1 ERROR loading seed file analytics.0417_current .......................... [[31mERROR[0m in 2.35s]
[0m11:52:49.148164 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:52:49.150576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:49.151051 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:52:49.151533 [info ] [MainThread]: 
[0m11:52:49.152066 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m11:52:49.154281 [debug] [MainThread]: Command end result
[0m11:52:49.166587 [info ] [MainThread]: 
[0m11:52:49.167150 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:52:49.167783 [info ] [MainThread]: 
[0m11:52:49.169545 [error] [MainThread]:   Runtime Error in seed 0417_current (seeds/0417_current.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 22; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 22; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 24 byte_offset_to_start_of_line: 2272 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 25 byte_offset_to_start_of_line: 2274 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 26 byte_offset_to_start_of_line: 2276 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 27 byte_offset_to_start_of_line: 2278 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 28 byte_offset_to_start_of_line: 2280 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 29 byte_offset_to_start_of_line: 2282 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 30 byte_offset_to_start_of_line: 2284 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 31 byte_offset_to_start_of_line: 2286 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 32 byte_offset_to_start_of_line: 2288 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 33 byte_offset_to_start_of_line: 2290 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 34 byte_offset_to_start_of_line: 2292 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 35 byte_offset_to_start_of_line: 2294 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 36 byte_offset_to_start_of_line: 2296 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 37 byte_offset_to_start_of_line: 2298 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 38 byte_offset_to_start_of_line: 2300 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 39 byte_offset_to_start_of_line: 2302 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 40 byte_offset_to_start_of_line: 2304 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 41 byte_offset_to_start_of_line: 2306 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 42 byte_offset_to_start_of_line: 2308 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 43 byte_offset_to_start_of_line: 2310 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 44 byte_offset_to_start_of_line: 2312 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 45 byte_offset_to_start_of_line: 2314 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 46 byte_offset_to_start_of_line: 2316 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 47 byte_offset_to_start_of_line: 2318 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 48 byte_offset_to_start_of_line: 2320 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 49 byte_offset_to_start_of_line: 2322 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 50 byte_offset_to_start_of_line: 2324 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 51 byte_offset_to_start_of_line: 2326 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 52 byte_offset_to_start_of_line: 2328 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 53 byte_offset_to_start_of_line: 2330 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 54 byte_offset_to_start_of_line: 2332 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 55 byte_offset_to_start_of_line: 2334 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 56 byte_offset_to_start_of_line: 2336 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 57 byte_offset_to_start_of_line: 2338 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 58 byte_offset_to_start_of_line: 2340 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 59 byte_offset_to_start_of_line: 2342 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 60 byte_offset_to_start_of_line: 2344 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 61 byte_offset_to_start_of_line: 2346 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 62 byte_offset_to_start_of_line: 2348 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 63 byte_offset_to_start_of_line: 2350 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 64 byte_offset_to_start_of_line: 2352 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 65 byte_offset_to_start_of_line: 2354 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 66 byte_offset_to_start_of_line: 2356 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 67 byte_offset_to_start_of_line: 2358 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 68 byte_offset_to_start_of_line: 2360 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 69 byte_offset_to_start_of_line: 2362 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 70 byte_offset_to_start_of_line: 2364 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 71 byte_offset_to_start_of_line: 2366 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 72 byte_offset_to_start_of_line: 2368 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 73 byte_offset_to_start_of_line: 2370 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 74 byte_offset_to_start_of_line: 2372 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 75 byte_offset_to_start_of_line: 2374 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 76 byte_offset_to_start_of_line: 2376 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 77 byte_offset_to_start_of_line: 2378 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 78 byte_offset_to_start_of_line: 2380 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 79 byte_offset_to_start_of_line: 2382 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 80 byte_offset_to_start_of_line: 2384 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 81 byte_offset_to_start_of_line: 2386 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 82 byte_offset_to_start_of_line: 2388 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 83 byte_offset_to_start_of_line: 2390 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 84 byte_offset_to_start_of_line: 2392 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 85 byte_offset_to_start_of_line: 2394 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 86 byte_offset_to_start_of_line: 2396 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 87 byte_offset_to_start_of_line: 2398 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 88 byte_offset_to_start_of_line: 2400 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 89 byte_offset_to_start_of_line: 2402 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 90 byte_offset_to_start_of_line: 2404 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 91 byte_offset_to_start_of_line: 2406 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 92 byte_offset_to_start_of_line: 2408 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 93 byte_offset_to_start_of_line: 2410 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 94 byte_offset_to_start_of_line: 2412 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 95 byte_offset_to_start_of_line: 2414 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 96 byte_offset_to_start_of_line: 2416 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 97 byte_offset_to_start_of_line: 2418 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 98 byte_offset_to_start_of_line: 2420 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 99 byte_offset_to_start_of_line: 2422 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 100 byte_offset_to_start_of_line: 2424 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 101 byte_offset_to_start_of_line: 2426 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 102 byte_offset_to_start_of_line: 2428 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 103 byte_offset_to_start_of_line: 2430 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 104 byte_offset_to_start_of_line: 2432 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 105 byte_offset_to_start_of_line: 2434 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 106 byte_offset_to_start_of_line: 2436 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 107 byte_offset_to_start_of_line: 2438 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 108 byte_offset_to_start_of_line: 2440 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 109 byte_offset_to_start_of_line: 2442 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 110 byte_offset_to_start_of_line: 2444 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 111 byte_offset_to_start_of_line: 2446 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 112 byte_offset_to_start_of_line: 2448 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 113 byte_offset_to_start_of_line: 2450 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 114 byte_offset_to_start_of_line: 2452 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 115 byte_offset_to_start_of_line: 2454 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 116 byte_offset_to_start_of_line: 2456 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 117 byte_offset_to_start_of_line: 2458 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 118 byte_offset_to_start_of_line: 2460 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 119 byte_offset_to_start_of_line: 2462 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 120 byte_offset_to_start_of_line: 2464 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 121 byte_offset_to_start_of_line: 2466 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 122 byte_offset_to_start_of_line: 2468 column_index: 29 column_name: "margin_requirement" column_type: STRING
  Error while reading data, error message: CSV table references column position 29, but line contains only 1 columns.; line_number: 123 byte_offset_to_start_of_line: 2470 column_index: 29 column_name: "margin_requirement" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m11:52:49.173074 [info ] [MainThread]: 
[0m11:52:49.174489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:52:49.177345 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 4.9201884, "process_user_time": 3.352239, "process_kernel_time": 0.354401, "process_mem_max_rss": "128823296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:52:49.178578 [debug] [MainThread]: Command `dbt seed` failed at 11:52:49.178272 after 4.92 seconds
[0m11:52:49.179571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111190400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b56430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7ea90>]}
[0m11:52:49.180224 [debug] [MainThread]: Flushing usage events
[0m11:54:15.021244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102765f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104228580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104253460>]}


============================== 11:54:15.027431 | c3a039b9-8abe-488c-8a29-9d8ac47dd2ad ==============================
[0m11:54:15.027431 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:54:15.028233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --select 0417_current', 'send_anonymous_usage_stats': 'True'}
[0m11:54:15.834322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104253250>]}
[0m11:54:15.943692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d5a00>]}
[0m11:54:15.955953 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:54:15.981614 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:54:16.039556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:54:16.040072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:54:16.048101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f9f40>]}
[0m11:54:16.064817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105308220>]}
[0m11:54:16.065417 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:54:16.066020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105308370>]}
[0m11:54:16.067793 [info ] [MainThread]: 
[0m11:54:16.068755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:54:16.069966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:54:16.070499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:17.726882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:54:17.727969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:18.009094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105052550>]}
[0m11:54:18.010648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:18.011307 [info ] [MainThread]: 
[0m11:54:18.015898 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:54:18.016730 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.0417_current .................................. [RUN]
[0m11:54:18.017880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:54:18.018526 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:54:18.019316 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:54:18.018979 => 11:54:18.018982
[0m11:54:18.019815 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:54:18.060932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:54:21.640669 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:54:21.979996 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bef54b83-1dd9-4936-8b14-5ffa193016e4&page=queryresults
[0m11:54:22.302215 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:54:22.328477 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:54:18.020132 => 11:54:22.328185
[0m11:54:22.329426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a039b9-8abe-488c-8a29-9d8ac47dd2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105478a60>]}
[0m11:54:22.330139 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.31s]
[0m11:54:22.330897 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:54:22.332883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:22.333279 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:54:22.333676 [info ] [MainThread]: 
[0m11:54:22.334114 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.27 seconds (6.27s).
[0m11:54:22.334893 [debug] [MainThread]: Command end result
[0m11:54:22.349616 [info ] [MainThread]: 
[0m11:54:22.350184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:22.350660 [info ] [MainThread]: 
[0m11:54:22.351180 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:22.353361 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.4077306, "process_user_time": 3.474202, "process_kernel_time": 0.387196, "process_mem_max_rss": "129564672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:22.354122 [debug] [MainThread]: Command `dbt seed` succeeded at 11:54:22.353964 after 7.41 seconds
[0m11:54:22.354620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102765f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105103b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e4730>]}
[0m11:54:22.355081 [debug] [MainThread]: Flushing usage events
[0m11:56:34.176593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104436f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f43790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f30c40>]}


============================== 11:56:34.182523 | c76948a2-538e-4422-83b9-40ead2d9907f ==============================
[0m11:56:34.182523 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:56:34.183323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m11:56:35.035719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbcd90>]}
[0m11:56:35.138191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce6cd0>]}
[0m11:56:35.139863 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:56:35.162105 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:56:35.217697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:35.218181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:35.226108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cb0d0>]}
[0m11:56:35.242721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd7040>]}
[0m11:56:35.243405 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:56:35.243967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d72280>]}
[0m11:56:35.246249 [info ] [MainThread]: 
[0m11:56:35.247664 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:56:35.249197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:56:35.249931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:36.820148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:56:36.821181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:37.088084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e29610>]}
[0m11:56:37.089717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:37.090417 [info ] [MainThread]: 
[0m11:56:37.094930 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:56:37.095656 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m11:56:37.096334 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m11:56:37.097203 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m11:56:37.098026 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m11:56:37.098783 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m11:56:37.099874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:56:37.101203 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:56:37.102386 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m11:56:37.103131 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:56:37.104127 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m11:56:37.104838 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:56:37.105879 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:56:37.105493 => 11:56:37.105497
[0m11:56:37.106634 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 11:56:37.106291 => 11:56:37.106295
[0m11:56:37.107498 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:56:37.107047 => 11:56:37.107051
[0m11:56:37.108154 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:56:37.108817 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m11:56:37.109457 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m11:56:37.180122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:37.182873 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:56:37.206127 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 11:56:37.134981 => 11:56:37.205780
[0m11:56:37.217508 [debug] [Thread-2  ]: Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:56:37.218473 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189250>]}
[0m11:56:37.219116 [error] [Thread-2  ]: 2 of 3 ERROR loading seed file analytics.0417_history .......................... [[31mERROR[0m in 0.12s]
[0m11:56:37.219974 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m11:56:40.666800 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:56:40.735326 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:56:41.006829 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e6c9ed86-f0be-479d-a2da-05ee4adce46f&page=queryresults
[0m11:56:41.043947 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3269d208-596b-4b9d-8a7f-17599c5cc5e2&page=queryresults
[0m11:56:41.349047 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:56:41.369176 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:56:37.110216 => 11:56:41.368878
[0m11:56:41.370116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714ca00>]}
[0m11:56:41.370781 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.27s]
[0m11:56:41.371529 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:56:41.526574 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:56:41.534704 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:56:37.146358 => 11:56:41.534230
[0m11:56:41.536053 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76948a2-538e-4422-83b9-40ead2d9907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731aeb0>]}
[0m11:56:41.536888 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 193[0m in 4.43s]
[0m11:56:41.537972 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m11:56:41.540608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:41.541291 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:56:41.541808 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m11:56:41.542351 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m11:56:41.542939 [info ] [MainThread]: 
[0m11:56:41.543701 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m11:56:41.545452 [debug] [MainThread]: Command end result
[0m11:56:41.559013 [info ] [MainThread]: 
[0m11:56:41.559789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:56:41.560375 [info ] [MainThread]: 
[0m11:56:41.560995 [error] [MainThread]:   Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 87 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:56:41.561596 [info ] [MainThread]: 
[0m11:56:41.562195 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:56:41.564448 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 7.457815, "process_user_time": 3.555893, "process_kernel_time": 0.508039, "process_mem_max_rss": "130609152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:56:41.565614 [debug] [MainThread]: Command `dbt seed` failed at 11:56:41.565204 after 7.46 seconds
[0m11:56:41.566468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104436f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce6cd0>]}
[0m11:56:41.567091 [debug] [MainThread]: Flushing usage events
[0m11:58:57.214381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e26580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e489a0>]}


============================== 11:58:57.219838 | 0bb7a452-2c39-4fa2-a727-26fb0c0bebec ==============================
[0m11:58:57.219838 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:58:57.220517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m11:58:57.993664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e66970>]}
[0m11:58:58.101071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acf92b0>]}
[0m11:58:58.103430 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:58:58.129869 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:58:58.191420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:58.191903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:58.200350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afef0d0>]}
[0m11:58:58.217369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefb070>]}
[0m11:58:58.218135 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:58:58.218788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefb1c0>]}
[0m11:58:58.221807 [info ] [MainThread]: 
[0m11:58:58.223118 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:58.224525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:58:58.225152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:00.023940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:59:00.025274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:00.318351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad47a00>]}
[0m11:59:00.319772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:00.320397 [info ] [MainThread]: 
[0m11:59:00.326499 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:59:00.327282 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m11:59:00.327919 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m11:59:00.328418 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m11:59:00.329279 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:59:00.330351 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m11:59:00.331620 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m11:59:00.332527 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:59:00.333933 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:59:00.335141 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m11:59:00.336435 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:59:00.335892 => 11:59:00.335898
[0m11:59:00.337136 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m11:59:00.337998 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:59:00.338627 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:59:00.339328 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 11:59:00.339030 => 11:59:00.339033
[0m11:59:00.339979 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:59:00.339650 => 11:59:00.339653
[0m11:59:00.364001 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m11:59:00.365831 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m11:59:00.386036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:00.402328 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:59:00.453069 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 11:59:00.378623 => 11:59:00.452628
[0m11:59:00.463317 [debug] [Thread-2  ]: Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 318 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:59:00.464381 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe1f70>]}
[0m11:59:00.465350 [error] [Thread-2  ]: 2 of 3 ERROR loading seed file analytics.0417_history .......................... [[31mERROR[0m in 0.13s]
[0m11:59:00.466628 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m11:59:04.038965 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:59:04.226182 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:59:04.326780 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:99f27d46-74ab-4d9b-906a-33538ca24214&page=queryresults
[0m11:59:04.521127 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d2acaaa7-3da6-49e3-a522-e9d1c06f737d&page=queryresults
[0m11:59:04.670711 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:59:04.690719 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:59:00.387969 => 11:59:04.690421
[0m11:59:04.691776 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a43a0>]}
[0m11:59:04.692496 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 193[0m in 4.36s]
[0m11:59:04.693280 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m11:59:04.878141 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:59:04.883182 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:59:00.340409 => 11:59:04.882812
[0m11:59:04.884480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb7a452-2c39-4fa2-a727-26fb0c0bebec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b072ca0>]}
[0m11:59:04.885340 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.56s]
[0m11:59:04.886346 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:59:04.888899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:04.889606 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:59:04.890134 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m11:59:04.890978 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m11:59:04.891608 [info ] [MainThread]: 
[0m11:59:04.892422 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m11:59:04.894194 [debug] [MainThread]: Command end result
[0m11:59:04.938333 [info ] [MainThread]: 
[0m11:59:04.939470 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:04.940444 [info ] [MainThread]: 
[0m11:59:04.940931 [error] [MainThread]:   Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 318 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m11:59:04.941690 [info ] [MainThread]: 
[0m11:59:04.942771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:59:04.950237 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 7.809533, "process_user_time": 3.617227, "process_kernel_time": 0.486281, "process_mem_max_rss": "130379776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:59:04.951577 [debug] [MainThread]: Command `dbt seed` failed at 11:59:04.951176 after 7.81 seconds
[0m11:59:04.952673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd2760>]}
[0m11:59:04.953288 [debug] [MainThread]: Flushing usage events
[0m12:00:27.565055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110914370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d9d00>]}


============================== 12:00:27.574184 | 45ceb1e3-7581-44f5-88d6-e859b95198bd ==============================
[0m12:00:27.574184 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:00:27.575182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m12:00:28.457533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112476190>]}
[0m12:00:28.637539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238d3a0>]}
[0m12:00:28.638993 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:00:28.660346 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:00:28.728271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:28.728801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:28.743383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357af10>]}
[0m12:00:28.762911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11348fd00>]}
[0m12:00:28.763652 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:00:28.764247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134720d0>]}
[0m12:00:28.767252 [info ] [MainThread]: 
[0m12:00:28.789898 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:00:28.792514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:00:28.793389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:30.862350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:00:30.863648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:31.202253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132d3970>]}
[0m12:00:31.203757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:31.204492 [info ] [MainThread]: 
[0m12:00:31.209280 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:00:31.209970 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m12:00:31.210591 [debug] [Thread-3  ]: Began running node seed.ccwj.cflt_prices
[0m12:00:31.211433 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m12:00:31.212212 [info ] [Thread-2  ]: 2 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m12:00:31.212989 [info ] [Thread-3  ]: 3 of 3 START seed file analytics.cflt_prices ................................... [RUN]
[0m12:00:31.214091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:00:31.215192 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:00:31.216239 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m12:00:31.216859 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:00:31.217717 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m12:00:31.218312 [debug] [Thread-3  ]: Began compiling node seed.ccwj.cflt_prices
[0m12:00:31.219072 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:00:31.218710 => 12:00:31.218714
[0m12:00:31.219729 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 12:00:31.219429 => 12:00:31.219433
[0m12:00:31.220376 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (compile): 12:00:31.220081 => 12:00:31.220084
[0m12:00:31.221014 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:00:31.221598 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m12:00:31.222245 [debug] [Thread-3  ]: Began executing node seed.ccwj.cflt_prices
[0m12:00:31.270890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:00:31.291392 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:00:31.474046 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:00:35.059435 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:00:35.062595 [debug] [Thread-3  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m12:00:35.351469 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7fecd824-b3ae-4fbe-af50-b7eaf00b0fc1&page=queryresults
[0m12:00:35.477929 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ac083a90-7732-416c-a7c0-18b313c7d932&page=queryresults
[0m12:00:35.650909 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:00:35.667698 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:00:31.222683 => 12:00:35.667437
[0m12:00:35.668556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f49a0>]}
[0m12:00:35.669164 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.45s]
[0m12:00:35.669926 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:00:35.795314 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m12:00:35.801770 [debug] [Thread-3  ]: Timing info for seed.ccwj.cflt_prices (execute): 12:00:31.264864 => 12:00:35.801375
[0m12:00:35.802999 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113654ee0>]}
[0m12:00:35.803837 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 193[0m in 4.59s]
[0m12:00:35.804829 [debug] [Thread-3  ]: Finished running node seed.ccwj.cflt_prices
[0m12:00:36.251967 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:00:36.836384 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c3cfdee7-0f72-4d44-82c1-cb4917077522&page=queryresults
[0m12:00:37.179859 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:00:37.187812 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 12:00:31.241809 => 12:00:37.187108
[0m12:00:37.190067 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45ceb1e3-7581-44f5-88d6-e859b95198bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113620fa0>]}
[0m12:00:37.191447 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 5.98s]
[0m12:00:37.192906 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m12:00:37.197390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:37.198447 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:00:37.199258 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:00:37.199908 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m12:00:37.200507 [info ] [MainThread]: 
[0m12:00:37.201126 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m12:00:37.203211 [debug] [MainThread]: Command end result
[0m12:00:37.225417 [info ] [MainThread]: 
[0m12:00:37.226554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:37.227347 [info ] [MainThread]: 
[0m12:00:37.228073 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:00:37.231097 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 9.746069, "process_user_time": 3.779393, "process_kernel_time": 0.529966, "process_mem_max_rss": "132907008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:00:37.232416 [debug] [MainThread]: Command `dbt seed` succeeded at 12:00:37.232104 after 9.75 seconds
[0m12:00:37.233319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110914370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113654ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355b1f0>]}
[0m12:00:37.234150 [debug] [MainThread]: Flushing usage events
[0m12:01:40.113587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e3d60>]}


============================== 12:01:40.119353 | bb66fd09-afd5-4d3f-8465-690555c0cdf8 ==============================
[0m12:01:40.119353 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:01:40.120202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:01:40.743499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e06a400>]}
[0m12:01:40.860954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e25bbb0>]}
[0m12:01:40.862126 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:01:40.885181 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:01:40.944842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:40.945342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:40.953121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4720d0>]}
[0m12:01:40.968707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38d730>]}
[0m12:01:40.969286 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:01:40.969739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f4880>]}
[0m12:01:40.971677 [info ] [MainThread]: 
[0m12:01:40.973034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:40.975356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:01:40.975989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:42.577359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:01:42.578233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:42.921789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d92b0>]}
[0m12:01:42.924084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:42.925191 [info ] [MainThread]: 
[0m12:01:42.936918 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:01:42.938118 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:01:42.940657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:01:42.941949 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:01:42.957355 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:01:42.961270 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:01:42.942560 => 12:01:42.960726
[0m12:01:42.962041 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:01:43.011378 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:01:43.012608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:01:43.013505 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:01:43.559269 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3b51475f-4201-4b46-b3c9-de04e1a85f05&page=queryresults
[0m12:01:43.889190 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]; reason: invalidQuery, location: query, message: No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]')
[0m12:01:44.891434 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0764586b-7a7e-4a41-a176-ca35fae1b8dc&page=queryresults
[0m12:01:45.235017 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0764586b-7a7e-4a41-a176-ca35fae1b8dc&page=queryresults
[0m12:01:45.236662 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:01:42.962421 => 12:01:45.236010
[0m12:01:45.258739 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:01:45.259796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb66fd09-afd5-4d3f-8465-690555c0cdf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e597f10>]}
[0m12:01:45.260939 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 2.32s]
[0m12:01:45.262116 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:01:45.264655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:45.265353 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:01:45.265935 [info ] [MainThread]: 
[0m12:01:45.266482 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m12:01:45.267612 [debug] [MainThread]: Command end result
[0m12:01:45.283706 [info ] [MainThread]: 
[0m12:01:45.284621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:01:45.285359 [info ] [MainThread]: 
[0m12:01:45.286002 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:01:45.286821 [info ] [MainThread]: 
[0m12:01:45.287578 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:01:45.289847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2518277, "process_user_time": 3.511411, "process_kernel_time": 0.436411, "process_mem_max_rss": "129495040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:01:45.291735 [debug] [MainThread]: Command `cli run` failed at 12:01:45.291290 after 5.25 seconds
[0m12:01:45.292588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38d610>]}
[0m12:01:45.293268 [debug] [MainThread]: Flushing usage events
[0m12:02:01.022540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027a0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104298bb0>]}


============================== 12:02:01.027604 | b7ea9323-bbd4-46d9-a437-81c3a4bad6e8 ==============================
[0m12:02:01.027604 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:02:01.028321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:01.660033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b86a0>]}
[0m12:02:01.789789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a3a00>]}
[0m12:02:01.790765 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:02:01.816824 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:02:01.882846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:01.883386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:01.894010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054310d0>]}
[0m12:02:01.914655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534a190>]}
[0m12:02:01.915342 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:02:01.915893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534a3d0>]}
[0m12:02:01.918524 [info ] [MainThread]: 
[0m12:02:01.919632 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:01.920953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:02:01.921773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:05.959605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:02:05.960708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:06.269460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518ecd0>]}
[0m12:02:06.271022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:06.272004 [info ] [MainThread]: 
[0m12:02:06.275566 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:02:06.276393 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:02:06.277465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:02:06.278066 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:02:06.289835 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:02:06.290885 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:02:06.278444 => 12:02:06.290576
[0m12:02:06.291362 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:02:06.338982 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:02:06.340497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:02:06.341336 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when price_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(price_change_dollar, ')', ''), '($', ''))
       when price_change_dollar LIKE '$%' THEN REPLACE(REPLACE(price_change_dollar, ')', ''), '$', '')
       else price_change_dollar
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
        CAST(REGEXP_REPLACE(case 
       when market_value LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(market_value, ')', ''), '($', ''))
       when market_value LIKE '$%' THEN REPLACE(REPLACE(market_value, ')', ''), '$', '')
       else market_value
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when day_change_dollar LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(day_change_dollar, ')', ''), '($', ''))
       when day_change_dollar LIKE '$%' THEN REPLACE(REPLACE(day_change_dollar, ')', ''), '$', '')
       else day_change_dollar
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cost_bases LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cost_bases, ')', ''), '($', ''))
       when cost_bases LIKE '$%' THEN REPLACE(REPLACE(cost_bases, ')', ''), '$', '')
       else cost_bases
    end, r'\$|,', '') as FLOAT64) as cost_bases,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when gain_or_loss_dollat LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '($', ''))
       when gain_or_loss_dollat LIKE '$%' THEN REPLACE(REPLACE(gain_or_loss_dollat, ')', ''), '$', '')
       else gain_or_loss_dollat
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:02:06.829298 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d2bff1f7-3ab1-45d5-bf4b-afb37383ea65&page=queryresults
[0m12:02:07.461969 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]; reason: invalidQuery, location: query, message: No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]')
[0m12:02:08.486514 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a72c0deb-0aab-418c-8ddc-19ecaec7457c&page=queryresults
[0m12:02:08.758763 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a72c0deb-0aab-418c-8ddc-19ecaec7457c&page=queryresults
[0m12:02:08.760272 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:02:06.291645 => 12:02:08.759771
[0m12:02:08.767729 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:02:08.768544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7ea9323-bbd4-46d9-a437-81c3a4bad6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555ca90>]}
[0m12:02:08.769433 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 2.49s]
[0m12:02:08.770523 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:02:08.773357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:08.773925 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:02:08.774551 [info ] [MainThread]: 
[0m12:02:08.775154 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m12:02:08.776202 [debug] [MainThread]: Command end result
[0m12:02:08.790425 [info ] [MainThread]: 
[0m12:02:08.791202 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:08.791865 [info ] [MainThread]: 
[0m12:02:08.792533 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  No matching signature for operator LIKE for argument types: FLOAT64, STRING. Supported signatures: STRING LIKE STRING; BYTES LIKE BYTES at [18:13]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m12:02:08.793303 [info ] [MainThread]: 
[0m12:02:08.793969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:02:08.795816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.8503766, "process_user_time": 3.465313, "process_kernel_time": 0.376441, "process_mem_max_rss": "128782336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:08.796608 [debug] [MainThread]: Command `cli run` failed at 12:02:08.796417 after 7.85 seconds
[0m12:02:08.797864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027a0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105210880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a3a00>]}
[0m12:02:08.798882 [debug] [MainThread]: Flushing usage events
[0m12:02:14.063729 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:11:15.339256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fabc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faece20>]}


============================== 12:11:15.345906 | 3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac ==============================
[0m12:11:15.345906 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:11:15.346640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:16.082978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110901d90>]}
[0m12:11:16.215607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110888df0>]}
[0m12:11:16.217682 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:11:16.242656 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:11:16.306773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:16.307458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:16.317334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7a0d0>]}
[0m12:11:16.335396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b8f100>]}
[0m12:11:16.336021 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:11:16.336627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b8f250>]}
[0m12:11:16.338845 [info ] [MainThread]: 
[0m12:11:16.340339 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:16.342123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:11:16.342947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:18.277522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:11:18.278615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:18.591839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ac0a0>]}
[0m12:11:18.593428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:18.594324 [info ] [MainThread]: 
[0m12:11:18.599973 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:11:18.600823 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m12:11:18.602314 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m12:11:18.602985 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:11:18.616201 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:11:18.617638 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:11:18.603352 => 12:11:18.617206
[0m12:11:18.618393 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:11:18.668698 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:11:18.669755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:11:18.670485 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:11:19.125189 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ccf95ea5-3acc-4774-81c7-ea8b6a6b2ae5&page=queryresults
[0m12:11:19.734344 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:11:18.619063 => 12:11:19.734030
[0m12:11:19.735416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ac1cec9-33f8-4fc7-a3ef-8bc5ff16c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d13e50>]}
[0m12:11:19.736202 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m12:11:19.737668 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:11:19.740172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:19.740698 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:11:19.741169 [info ] [MainThread]: 
[0m12:11:19.741707 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m12:11:19.743395 [debug] [MainThread]: Command end result
[0m12:11:19.758042 [info ] [MainThread]: 
[0m12:11:19.758672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:19.759144 [info ] [MainThread]: 
[0m12:11:19.759989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:11:19.763221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.507028, "process_user_time": 3.722705, "process_kernel_time": 0.409843, "process_mem_max_rss": "128069632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:11:19.764049 [debug] [MainThread]: Command `cli run` succeeded at 12:11:19.763874 after 4.51 seconds
[0m12:11:19.764684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a4bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110932220>]}
[0m12:11:19.765380 [debug] [MainThread]: Flushing usage events
[0m12:11:23.276255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a478700>]}


============================== 12:11:23.281134 | 22795145-70a1-428a-b1af-c4c9007ec43f ==============================
[0m12:11:23.281134 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:11:23.282037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:11:23.976622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2866a0>]}
[0m12:11:24.125045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43f070>]}
[0m12:11:24.126487 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:11:24.167518 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:11:24.242862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:24.243466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:24.253948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ff0d0>]}
[0m12:11:24.294705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b517280>]}
[0m12:11:24.296080 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:11:24.298479 [info ] [MainThread]: 
[0m12:11:24.300336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:24.302602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:11:24.303491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:26.097227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:11:26.098421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:26.376685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b358c40>]}
[0m12:11:26.378157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:26.378787 [info ] [MainThread]: 
[0m12:11:26.382598 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:11:26.383326 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m12:11:26.384324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:11:26.385129 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:11:26.385907 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:11:26.385569 => 12:11:26.385577
[0m12:11:26.386413 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:11:26.424474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:11:30.150789 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:11:30.463899 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c0754bd4-3c25-4fbf-8041-7240d4d51a9d&page=queryresults
[0m12:11:30.833514 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:11:30.855092 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:11:26.386732 => 12:11:30.854806
[0m12:11:30.860822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b680a30>]}
[0m12:11:30.861656 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.48s]
[0m12:11:30.862622 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:11:30.863644 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m12:11:30.864331 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.current .................................. [RUN]
[0m12:11:30.865339 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m12:11:30.865873 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m12:11:30.876205 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:11:30.877606 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 12:11:30.866243 => 12:11:30.877046
[0m12:11:30.878340 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m12:11:30.906425 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:11:30.907381 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:11:30.908031 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollat,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:11:31.488164 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f79245fc-bc39-409b-aeb6-c3186bdd36f3&page=queryresults
[0m12:11:31.812950 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 12:11:30.878666 => 12:11:31.812622
[0m12:11:31.814066 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b751c40>]}
[0m12:11:31.814903 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m12:11:31.815781 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m12:11:31.816836 [debug] [Thread-2  ]: Began running node model.ccwj.current_position_information
[0m12:11:31.817578 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.current_position_information ............. [RUN]
[0m12:11:31.818902 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_position_information'
[0m12:11:31.819735 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_position_information
[0m12:11:31.824304 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m12:11:31.827946 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (compile): 12:11:31.820230 => 12:11:31.827546
[0m12:11:31.828574 [debug] [Thread-2  ]: Began executing node model.ccwj.current_position_information
[0m12:11:31.833371 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m12:11:31.835121 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:11:31.835816 [debug] [Thread-2  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_bases,
   gain_or_loss_dollat,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m12:11:32.332096 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ba194253-fd48-4422-a751-2696c2a5fbd7&page=queryresults
[0m12:11:32.594667 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: cost_bases; Did you mean cost_basis? at [12:4]; reason: invalidQuery, location: query, message: Unrecognized name: cost_bases; Did you mean cost_basis? at [12:4]')
[0m12:11:33.940161 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6a80645b-e03b-4c7d-854d-7db9665a436e&page=queryresults
[0m12:11:34.238978 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6a80645b-e03b-4c7d-854d-7db9665a436e&page=queryresults
[0m12:11:34.240905 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (execute): 12:11:31.828905 => 12:11:34.240267
[0m12:11:34.257513 [debug] [Thread-2  ]: Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Unrecognized name: cost_bases; Did you mean cost_basis? at [12:4]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m12:11:34.258349 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22795145-70a1-428a-b1af-c4c9007ec43f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b757040>]}
[0m12:11:34.259282 [error] [Thread-2  ]: 3 of 3 ERROR creating sql view model analytics.current_position_information .... [[31mERROR[0m in 2.44s]
[0m12:11:34.260457 [debug] [Thread-2  ]: Finished running node model.ccwj.current_position_information
[0m12:11:34.262914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:34.263467 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:11:34.263921 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:11:34.264420 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m12:11:34.264971 [info ] [MainThread]: 
[0m12:11:34.265623 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m12:11:34.267615 [debug] [MainThread]: Command end result
[0m12:11:34.288752 [info ] [MainThread]: 
[0m12:11:34.289473 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:11:34.289986 [info ] [MainThread]: 
[0m12:11:34.290485 [error] [MainThread]:   Database Error in model current_position_information (models/intermediate/current_position_information.sql)
  Unrecognized name: cost_bases; Did you mean cost_basis? at [12:4]
  compiled Code at target/run/ccwj/models/intermediate/current_position_information.sql
[0m12:11:34.291005 [info ] [MainThread]: 
[0m12:11:34.292022 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:11:34.294847 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.095656, "process_user_time": 3.741824, "process_kernel_time": 0.393216, "process_mem_max_rss": "131485696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:11:34.295938 [debug] [MainThread]: Command `cli build` failed at 12:11:34.295702 after 11.10 seconds
[0m12:11:34.296559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b8430>]}
[0m12:11:34.297254 [debug] [MainThread]: Flushing usage events
[0m12:16:02.300920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f49ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f944f0>]}


============================== 12:16:02.308074 | b0e93025-a952-41d7-b241-93ce7e2ddba2 ==============================
[0m12:16:02.308074 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:16:02.309042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:16:03.043980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f7a640>]}
[0m12:16:03.146191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d42760>]}
[0m12:16:03.147775 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:16:03.169634 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m12:16:03.224499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:03.224988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:03.233162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213c0d0>]}
[0m12:16:03.250749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112056880>]}
[0m12:16:03.251433 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:16:03.253539 [info ] [MainThread]: 
[0m12:16:03.255145 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:03.257347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:16:03.258130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:04.888190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:16:04.889263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:05.170885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111efea30>]}
[0m12:16:05.172364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:05.173043 [info ] [MainThread]: 
[0m12:16:05.177574 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m12:16:05.178395 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m12:16:05.179447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m12:16:05.180181 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m12:16:05.180949 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 12:16:05.180595 => 12:16:05.180603
[0m12:16:05.181481 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m12:16:05.219311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:08.902423 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:16:09.213354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8293ce5f-6e25-44c9-9759-0ed08e8bc483&page=queryresults
[0m12:16:09.517501 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:16:09.536087 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 12:16:05.181825 => 12:16:09.535821
[0m12:16:09.536965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121bae80>]}
[0m12:16:09.537664 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.36s]
[0m12:16:09.538419 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m12:16:09.539759 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m12:16:09.540445 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.current .................................. [RUN]
[0m12:16:09.541507 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m12:16:09.541958 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m12:16:09.551458 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:16:09.552664 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 12:16:09.542233 => 12:16:09.552285
[0m12:16:09.553219 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m12:16:09.577846 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:16:09.578883 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:16:09.579992 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:16:10.011662 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8b97853e-5aca-42ed-bd3a-4b6f7ea15af9&page=queryresults
[0m12:16:10.366870 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 12:16:09.553523 => 12:16:10.366491
[0m12:16:10.368134 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11228ffd0>]}
[0m12:16:10.369384 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m12:16:10.370556 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m12:16:10.371802 [debug] [Thread-2  ]: Began running node model.ccwj.current_position_information
[0m12:16:10.373098 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.current_position_information ............. [RUN]
[0m12:16:10.374750 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_position_information'
[0m12:16:10.375414 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_position_information
[0m12:16:10.379957 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m12:16:10.381138 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (compile): 12:16:10.375797 => 12:16:10.380789
[0m12:16:10.381709 [debug] [Thread-2  ]: Began executing node model.ccwj.current_position_information
[0m12:16:10.386837 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m12:16:10.388256 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:16:10.388995 [debug] [Thread-2  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_basis,
   gain_or_loss_dollar,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m12:16:10.877497 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7a19a20b-dac1-4c1a-a5b9-5a1fc0df6230&page=queryresults
[0m12:16:11.210170 [debug] [Thread-2  ]: Timing info for model.ccwj.current_position_information (execute): 12:16:10.382068 => 12:16:11.209714
[0m12:16:11.211570 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0e93025-a952-41d7-b241-93ce7e2ddba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e8040>]}
[0m12:16:11.212494 [info ] [Thread-2  ]: 3 of 3 OK created sql view model analytics.current_position_information ........ [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m12:16:11.213537 [debug] [Thread-2  ]: Finished running node model.ccwj.current_position_information
[0m12:16:11.216140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:11.216709 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m12:16:11.217202 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m12:16:11.217679 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m12:16:11.218243 [info ] [MainThread]: 
[0m12:16:11.218857 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m12:16:11.220670 [debug] [MainThread]: Command end result
[0m12:16:11.242282 [info ] [MainThread]: 
[0m12:16:11.243140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:11.243820 [info ] [MainThread]: 
[0m12:16:11.244738 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:16:11.247602 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.026329, "process_user_time": 3.559652, "process_kernel_time": 0.454918, "process_mem_max_rss": "130670592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:11.248875 [debug] [MainThread]: Command `cli build` succeeded at 12:16:11.248453 after 9.03 seconds
[0m12:16:11.249703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f49ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d42760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e46eb0>]}
[0m12:16:11.250452 [debug] [MainThread]: Flushing usage events
[0m09:24:22.147307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd8d30>]}


============================== 09:24:22.154401 | 51d33ad3-61d6-477c-82e3-01344a8517fe ==============================
[0m09:24:22.154401 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:24:22.155285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:24:22.900818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a6760>]}
[0m09:24:23.014803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8cf40>]}
[0m09:24:23.016453 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:24:23.040362 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:24:23.119562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:23.120052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:23.129230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae710d0>]}
[0m09:24:23.147083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad86340>]}
[0m09:24:23.147779 [info ] [MainThread]: Found 13 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:24:23.148334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac5a580>]}
[0m09:24:23.151251 [info ] [MainThread]: 
[0m09:24:23.153248 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:24:23.155315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:24:23.155971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:24.810139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:24:24.811409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:25.102031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac50c70>]}
[0m09:24:25.103538 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:25.104306 [info ] [MainThread]: 
[0m09:24:25.109644 [debug] [Thread-1  ]: Began running node model.ccwj.current_position_information
[0m09:24:25.110564 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_position_information ............. [RUN]
[0m09:24:25.112024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_position_information)
[0m09:24:25.112734 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_position_information
[0m09:24:25.125523 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m09:24:25.129513 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (compile): 09:24:25.113278 => 09:24:25.129010
[0m09:24:25.130148 [debug] [Thread-1  ]: Began executing node model.ccwj.current_position_information
[0m09:24:25.175593 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m09:24:25.176918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:24:25.177508 [debug] [Thread-1  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_basis,
   gain_or_loss_dollar,
   security_type,
   margin_requirement 
from `ccwj-dbt`.`analytics`.`current`;


[0m09:24:25.800207 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f016130a-0064-424c-80f8-ba81ffdb6f06&page=queryresults
[0m09:24:26.211794 [debug] [Thread-1  ]: Timing info for model.ccwj.current_position_information (execute): 09:24:25.130560 => 09:24:26.211481
[0m09:24:26.212869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51d33ad3-61d6-477c-82e3-01344a8517fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af08eb0>]}
[0m09:24:26.213675 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_position_information ........ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m09:24:26.214525 [debug] [Thread-1  ]: Finished running node model.ccwj.current_position_information
[0m09:24:26.216886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:26.217724 [debug] [MainThread]: Connection 'model.ccwj.current_position_information' was properly closed.
[0m09:24:26.218410 [info ] [MainThread]: 
[0m09:24:26.219480 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m09:24:26.220831 [debug] [MainThread]: Command end result
[0m09:24:26.237072 [info ] [MainThread]: 
[0m09:24:26.237846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:26.238476 [info ] [MainThread]: 
[0m09:24:26.239217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:24:26.242573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.178161, "process_user_time": 3.515049, "process_kernel_time": 0.484218, "process_mem_max_rss": "127934464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:24:26.243549 [debug] [MainThread]: Command `cli run` succeeded at 09:24:26.243272 after 4.18 seconds
[0m09:24:26.244170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7f910>]}
[0m09:24:26.244759 [debug] [MainThread]: Flushing usage events
[0m11:30:41.019733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e88f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108962f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898f310>]}


============================== 11:30:41.025393 | ddf2c428-93bd-45ca-84db-949cde036a62 ==============================
[0m11:30:41.025393 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:30:41.026443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:30:41.621779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109718490>]}
[0m11:30:41.733704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971dbe0>]}
[0m11:30:41.735685 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:30:41.757239 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:30:41.816154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:41.816682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:41.825731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b290d0>]}
[0m11:30:41.846458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a312b0>]}
[0m11:30:41.847213 [info ] [MainThread]: Found 16 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:30:41.850116 [info ] [MainThread]: 
[0m11:30:41.851517 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:30:41.853408 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:30:41.854163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:43.385550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:30:43.386535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:43.692049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098753a0>]}
[0m11:30:43.693454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:30:43.694090 [info ] [MainThread]: 
[0m11:30:43.698640 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:30:43.699485 [info ] [Thread-1  ]: 1 of 4 START seed file analytics.0417_current .................................. [RUN]
[0m11:30:43.700777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:30:43.701572 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:30:43.702498 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:30:43.702004 => 11:30:43.702009
[0m11:30:43.703185 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:30:43.741180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:47.443540 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:30:47.917966 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8786f9a5-470a-4c80-a4f9-eeb3bb044778&page=queryresults
[0m11:30:48.372324 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:30:48.391300 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:30:43.703541 => 11:30:48.391014
[0m11:30:48.392403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba6f40>]}
[0m11:30:48.393174 [info ] [Thread-1  ]: 1 of 4 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.69s]
[0m11:30:48.394579 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:30:48.395928 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m11:30:48.396712 [info ] [Thread-3  ]: 2 of 4 START sql view model analytics.current .................................. [RUN]
[0m11:30:48.397897 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m11:30:48.398572 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m11:30:48.409144 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:30:48.410569 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 11:30:48.398987 => 11:30:48.410263
[0m11:30:48.411039 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m11:30:48.435052 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:30:48.436093 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:30:48.436791 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:30:49.016510 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:18ceeee1-c138-43e7-8682-c872d2efd501&page=queryresults
[0m11:30:49.413100 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 11:30:48.411379 => 11:30:49.412702
[0m11:30:49.414451 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7cfd0>]}
[0m11:30:49.415451 [info ] [Thread-3  ]: 2 of 4 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m11:30:49.416802 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m11:30:49.417912 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_holdings
[0m11:30:49.418719 [info ] [Thread-2  ]: 3 of 4 START sql view model analytics.current_equity_holdings .................. [RUN]
[0m11:30:49.419932 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_equity_holdings'
[0m11:30:49.420857 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_holdings
[0m11:30:49.426599 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_holdings"
[0m11:30:49.428731 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (compile): 11:30:49.421544 => 11:30:49.428279
[0m11:30:49.429450 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_holdings
[0m11:30:49.434956 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_holdings"
[0m11:30:49.436136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:30:49.436883 [debug] [Thread-2  ]: On model.ccwj.current_equity_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   quantity as equity_quantity,
   price as equity_price,
   market_value as equity_market_value,
   cost_basis as equity_cost_basis,
   gain_or_loss_dollar as equity_gain_or_loss_dollar,
   security_type,
   margin_requirement as equity_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Equity';


[0m11:30:49.955331 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ddfd2b0d-9121-471e-b648-e8866daee8b1&page=queryresults
[0m11:30:50.321848 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (execute): 11:30:49.429819 => 11:30:50.321204
[0m11:30:50.323372 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdafa0>]}
[0m11:30:50.324499 [info ] [Thread-2  ]: 3 of 4 OK created sql view model analytics.current_equity_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:30:50.325565 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_holdings
[0m11:30:50.326775 [debug] [Thread-4  ]: Began running node model.ccwj.current_holdings_strategy
[0m11:30:50.327575 [info ] [Thread-4  ]: 4 of 4 START sql view model analytics.current_holdings_strategy ................ [RUN]
[0m11:30:50.328977 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current_holdings_strategy'
[0m11:30:50.329665 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m11:30:50.336385 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m11:30:50.337635 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 11:30:50.330138 => 11:30:50.337277
[0m11:30:50.338231 [debug] [Thread-4  ]: Began executing node model.ccwj.current_holdings_strategy
[0m11:30:50.344024 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m11:30:50.345145 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:30:50.345974 [debug] [Thread-4  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.current_symbols 
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` on symbol

)

select * 
from holdings_strategy

;


[0m11:30:50.950388 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:908a6a0b-078f-489f-a57c-78cfaebf27f0&page=queryresults
[0m11:30:51.320593 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name symbol is ambiguous at [15:66]; reason: invalidQuery, location: query, message: Column name symbol is ambiguous at [15:66]')
[0m11:30:52.355109 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:02314237-d8ae-4e74-ad53-12b44cd2547d&page=queryresults
[0m11:30:52.694358 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:02314237-d8ae-4e74-ad53-12b44cd2547d&page=queryresults
[0m11:30:52.696961 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 11:30:50.338788 => 11:30:52.696234
[0m11:30:52.719128 [debug] [Thread-4  ]: Database Error in model current_holdings_strategy (models/intermediate/current_holdings_strategy.sql)
  Column name symbol is ambiguous at [15:66]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_strategy.sql
[0m11:30:52.719982 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf2c428-93bd-45ca-84db-949cde036a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6ce20>]}
[0m11:30:52.721053 [error] [Thread-4  ]: 4 of 4 ERROR creating sql view model analytics.current_holdings_strategy ....... [[31mERROR[0m in 2.39s]
[0m11:30:52.722780 [debug] [Thread-4  ]: Finished running node model.ccwj.current_holdings_strategy
[0m11:30:52.725371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:52.725971 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:30:52.726464 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m11:30:52.726926 [debug] [MainThread]: Connection 'model.ccwj.current_equity_holdings' was properly closed.
[0m11:30:52.727387 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m11:30:52.728149 [info ] [MainThread]: 
[0m11:30:52.728804 [info ] [MainThread]: Finished running 1 seed, 3 view models in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m11:30:52.730712 [debug] [MainThread]: Command end result
[0m11:30:52.749141 [info ] [MainThread]: 
[0m11:30:52.749852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:30:52.750370 [info ] [MainThread]: 
[0m11:30:52.750896 [error] [MainThread]:   Database Error in model current_holdings_strategy (models/intermediate/current_holdings_strategy.sql)
  Column name symbol is ambiguous at [15:66]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_strategy.sql
[0m11:30:52.751435 [info ] [MainThread]: 
[0m11:30:52.752480 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m11:30:52.755982 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.817968, "process_user_time": 3.579076, "process_kernel_time": 0.379083, "process_mem_max_rss": "131616768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:52.756914 [debug] [MainThread]: Command `cli build` failed at 11:30:52.756703 after 11.82 seconds
[0m11:30:52.757525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e88f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cc490>]}
[0m11:30:52.758091 [debug] [MainThread]: Flushing usage events
[0m11:33:31.587409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107861d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109378370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093584f0>]}


============================== 11:33:31.592791 | 8b668828-43c8-4f82-98a7-18bbd56f4333 ==============================
[0m11:33:31.592791 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:33:31.593479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:32.205120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f8520>]}
[0m11:33:32.319334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e8fd0>]}
[0m11:33:32.321216 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:33:32.342672 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:33:32.413740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:32.418304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:32.428426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5090d0>]}
[0m11:33:32.447918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a413730>]}
[0m11:33:32.448604 [info ] [MainThread]: Found 16 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:33:32.451544 [info ] [MainThread]: 
[0m11:33:32.452863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:33:32.454898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:33:32.455972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:33.724703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:33:33.725794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:34.067319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d1d60>]}
[0m11:33:34.068961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:33:34.069641 [info ] [MainThread]: 
[0m11:33:34.073994 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:33:34.075035 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m11:33:34.076478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:33:34.077343 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:33:34.078580 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:33:34.077808 => 11:33:34.077814
[0m11:33:34.079299 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:33:34.124667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:37.948570 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:33:38.204570 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:caa9c0ba-ba96-42e3-ac9a-de4202a4d050&page=queryresults
[0m11:33:38.900635 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:33:38.921880 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:33:34.079683 => 11:33:38.921472
[0m11:33:38.923528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a587dc0>]}
[0m11:33:38.924302 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.85s]
[0m11:33:38.925332 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:33:38.926452 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m11:33:38.927239 [info ] [Thread-3  ]: 2 of 5 START sql view model analytics.current .................................. [RUN]
[0m11:33:38.928498 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m11:33:38.929423 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m11:33:38.940514 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:33:38.941684 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 11:33:38.929958 => 11:33:38.941328
[0m11:33:38.942189 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m11:33:38.967796 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:33:38.969065 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:33:38.970013 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:33:39.506198 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a458e5bb-2294-4157-ae05-3b9a7cec733b&page=queryresults
[0m11:33:39.922160 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 11:33:38.942515 => 11:33:39.921783
[0m11:33:39.923503 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a679c40>]}
[0m11:33:39.924520 [info ] [Thread-3  ]: 2 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m11:33:39.925490 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m11:33:39.926566 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_holdings
[0m11:33:39.927351 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_holdings
[0m11:33:39.928169 [info ] [Thread-2  ]: 3 of 5 START sql view model analytics.current_equity_holdings .................. [RUN]
[0m11:33:39.929170 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.current_option_holdings .................. [RUN]
[0m11:33:39.930606 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_equity_holdings'
[0m11:33:39.931808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current_option_holdings)
[0m11:33:39.932466 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_holdings
[0m11:33:39.933089 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_holdings
[0m11:33:39.937734 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_holdings"
[0m11:33:39.942090 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_holdings"
[0m11:33:39.943479 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (compile): 11:33:39.933479 => 11:33:39.943097
[0m11:33:39.944078 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_holdings
[0m11:33:39.950113 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (compile): 11:33:39.938227 => 11:33:39.949724
[0m11:33:39.952056 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_holdings"
[0m11:33:39.952710 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_holdings
[0m11:33:39.958860 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_holdings"
[0m11:33:39.959968 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:33:39.960757 [debug] [Thread-2  ]: On model.ccwj.current_equity_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   quantity as equity_quantity,
   price as equity_price,
   market_value as equity_market_value,
   cost_basis as equity_cost_basis,
   gain_or_loss_dollar as equity_gain_or_loss_dollar,
   security_type,
   margin_requirement as equity_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Equity';


[0m11:33:39.962635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:39.963385 [debug] [Thread-1  ]: On model.ccwj.current_option_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   quantity as option_quantity,
   price as option_price,
   market_value as option_market_value,
   cost_basis as option_cost_basis,
   gain_or_loss_dollar as option_gain_or_loss_dollar,
   security_type,
   margin_requirement as option_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Option';


[0m11:33:40.533572 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1ab2ab4e-6ee7-4654-a9bb-868d2c94916a&page=queryresults
[0m11:33:40.547977 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4c5b6d34-b70e-4fbf-b16b-a619d4850a93&page=queryresults
[0m11:33:40.877060 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (execute): 11:33:39.953504 => 11:33:40.876604
[0m11:33:40.879038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59abb0>]}
[0m11:33:40.883274 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (execute): 11:33:39.944496 => 11:33:40.882907
[0m11:33:40.884193 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.current_option_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m11:33:40.885360 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a684190>]}
[0m11:33:40.886352 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_holdings
[0m11:33:40.887249 [info ] [Thread-2  ]: 3 of 5 OK created sql view model analytics.current_equity_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m11:33:40.888502 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_holdings
[0m11:33:40.889550 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_strategy
[0m11:33:40.890361 [info ] [Thread-3  ]: 5 of 5 START sql view model analytics.current_holdings_strategy ................ [RUN]
[0m11:33:40.891459 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_holdings_strategy)
[0m11:33:40.892104 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m11:33:40.897374 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m11:33:40.898572 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 11:33:40.892489 => 11:33:40.898218
[0m11:33:40.899150 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_strategy
[0m11:33:40.904278 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m11:33:40.905403 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:33:40.906162 [debug] [Thread-3  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` 
      on current_holdings.symbol = current_equity_holdings.symbol
   left join `ccwj-dbt`.`analytics`.`current_option_holdings` 
      on current_holdings.symbol = current_option_holdings.symbol

)

select * 
from holdings_strategy

;


[0m11:33:41.452360 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:83399297-4012-4a40-b78b-87e5f955b149&page=queryresults
[0m11:33:42.310066 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 11:33:40.899507 => 11:33:42.309674
[0m11:33:42.311689 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b668828-43c8-4f82-98a7-18bbd56f4333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a666310>]}
[0m11:33:42.312776 [info ] [Thread-3  ]: 5 of 5 OK created sql view model analytics.current_holdings_strategy ........... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m11:33:42.314192 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_strategy
[0m11:33:42.317100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:42.317714 [debug] [MainThread]: Connection 'model.ccwj.current_option_holdings' was properly closed.
[0m11:33:42.318191 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m11:33:42.318730 [debug] [MainThread]: Connection 'model.ccwj.current_equity_holdings' was properly closed.
[0m11:33:42.319295 [info ] [MainThread]: 
[0m11:33:42.319959 [info ] [MainThread]: Finished running 1 seed, 4 view models in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m11:33:42.322317 [debug] [MainThread]: Command end result
[0m11:33:42.338718 [info ] [MainThread]: 
[0m11:33:42.339784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:42.340983 [info ] [MainThread]: 
[0m11:33:42.341775 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:33:42.345554 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.837949, "process_user_time": 3.695082, "process_kernel_time": 0.383137, "process_mem_max_rss": "130949120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:42.346873 [debug] [MainThread]: Command `cli build` succeeded at 11:33:42.346621 after 10.84 seconds
[0m11:33:42.347812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107861d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d0f70>]}
[0m11:33:42.348479 [debug] [MainThread]: Flushing usage events
[0m11:40:06.986650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2aaa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e2a90>]}


============================== 11:40:06.992002 | 89ea081c-53e5-44c8-b0db-0d3ef45106eb ==============================
[0m11:40:06.992002 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:40:06.993115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:07.649397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2c75e0>]}
[0m11:40:07.762131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09f550>]}
[0m11:40:07.764430 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:40:07.787250 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m11:40:07.854117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:07.854755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:07.864052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4850d0>]}
[0m11:40:07.882427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38e370>]}
[0m11:40:07.883055 [info ] [MainThread]: Found 16 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:40:07.883530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38e4c0>]}
[0m11:40:07.885424 [info ] [MainThread]: 
[0m11:40:07.886816 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:40:07.888376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:40:07.888936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:09.535618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:40:09.536571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:09.855235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d7160>]}
[0m11:40:09.856660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:09.857239 [info ] [MainThread]: 
[0m11:40:09.862789 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_strategy
[0m11:40:09.863845 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_strategy ................ [RUN]
[0m11:40:09.865395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_strategy)
[0m11:40:09.866308 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m11:40:09.879298 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m11:40:09.880728 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 11:40:09.866798 => 11:40:09.880291
[0m11:40:09.881310 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_strategy
[0m11:40:09.926936 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m11:40:09.928189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:40:09.928825 [debug] [Thread-1  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   case 
      when current_option_holdings.option_quantity*-100 = current_equity_holdings.equity_quantity then 'Covered Call'
      when current_option_holdings.option_quantity is null and current_equity_holdings.equity_quantity is not null then 'Buy and Hold'
      else 'Other'
   end as strategy 
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` 
      on current_holdings.symbol = current_equity_holdings.symbol
   left join `ccwj-dbt`.`analytics`.`current_option_holdings` 
      on current_holdings.symbol = current_option_holdings.symbol

)

select *
from holdings_strategy

;


[0m11:40:10.617254 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:05f9c9fb-e985-40db-ae5c-0075b4afa938&page=queryresults
[0m11:40:11.235570 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 11:40:09.881648 => 11:40:11.235258
[0m11:40:11.236731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ea081c-53e5-44c8-b0db-0d3ef45106eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e597160>]}
[0m11:40:11.237614 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_strategy ........... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m11:40:11.238673 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_strategy
[0m11:40:11.241021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:11.241526 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m11:40:11.241985 [info ] [MainThread]: 
[0m11:40:11.242502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m11:40:11.243694 [debug] [MainThread]: Command end result
[0m11:40:11.256710 [info ] [MainThread]: 
[0m11:40:11.257373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:11.258047 [info ] [MainThread]: 
[0m11:40:11.258763 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:40:11.261450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3540187, "process_user_time": 3.400473, "process_kernel_time": 0.388877, "process_mem_max_rss": "128311296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:40:11.262246 [debug] [MainThread]: Command `cli run` succeeded at 11:40:11.262072 after 4.35 seconds
[0m11:40:11.262851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e38e430>]}
[0m11:40:11.263578 [debug] [MainThread]: Flushing usage events
[0m09:28:46.573890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107154370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b700>]}


============================== 09:28:46.579514 | 4d304960-3457-4148-85df-0594c805c037 ==============================
[0m09:28:46.579514 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:28:46.580442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:28:47.189334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be1f10>]}
[0m09:28:47.302110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099eb820>]}
[0m09:28:47.304398 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:28:47.326413 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:28:47.386894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:47.387418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:47.396982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbf0d0>]}
[0m09:28:47.418229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd1370>]}
[0m09:28:47.419160 [info ] [MainThread]: Found 17 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:28:47.422132 [info ] [MainThread]: 
[0m09:28:47.423527 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:28:47.425153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:28:47.426060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:48.818624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:28:48.819717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:49.117445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abe160>]}
[0m09:28:49.118932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:28:49.119688 [info ] [MainThread]: 
[0m09:28:49.125868 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m09:28:49.126679 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m09:28:49.127419 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m09:28:49.128480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m09:28:49.129303 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m09:28:49.130082 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m09:28:49.131331 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:28:49.132185 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 09:28:49.131809 => 09:28:49.131814
[0m09:28:49.132785 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m09:28:49.133375 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m09:28:49.134012 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 09:28:49.133726 => 09:28:49.133730
[0m09:28:49.164632 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m09:28:49.213352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:28:49.303905 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:28:53.060026 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:28:53.343227 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:28:53.387495 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e5280b71-41db-4469-9dcf-7fb29150b2b7&page=queryresults
[0m09:28:53.631046 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f07990f5-fa44-4977-8bf9-ebf67bc88725&page=queryresults
[0m09:28:53.737366 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:28:53.757696 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 09:28:49.134339 => 09:28:53.757414
[0m09:28:53.758798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e40c10>]}
[0m09:28:53.759576 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.63s]
[0m09:28:53.760342 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m09:28:53.761219 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m09:28:53.761823 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.current .................................. [RUN]
[0m09:28:53.763134 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m09:28:53.763806 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m09:28:53.774273 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:28:53.776052 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 09:28:53.764111 => 09:28:53.775621
[0m09:28:53.776818 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m09:28:53.804927 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:28:53.809693 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:28:53.810852 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:28:53.957412 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:28:53.963554 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 09:28:49.165165 => 09:28:53.963096
[0m09:28:53.964733 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4f8b0>]}
[0m09:28:53.965474 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.83s]
[0m09:28:53.966338 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m09:28:53.967222 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m09:28:53.967904 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.history .................................. [RUN]
[0m09:28:53.968987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m09:28:53.969648 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m09:28:53.974366 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:28:53.976442 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 09:28:53.970009 => 09:28:53.976062
[0m09:28:53.977082 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m09:28:53.981828 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:28:53.983530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:28:53.984222 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON')
order by date desc;


[0m09:28:54.333916 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6b11d3ae-223e-47c8-ab90-a7ee54f19cf2&page=queryresults
[0m09:28:54.439030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6e811c26-bffd-4f20-9466-c2844f618380&page=queryresults
[0m09:28:54.632485 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 09:28:53.777185 => 09:28:54.632119
[0m09:28:54.633974 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a148d90>]}
[0m09:28:54.635089 [info ] [Thread-4  ]: 3 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m09:28:54.636180 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m09:28:54.757009 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 09:28:53.977458 => 09:28:54.756663
[0m09:28:54.758270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e40c10>]}
[0m09:28:54.759136 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m09:28:54.760070 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m09:28:54.761249 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_timeline
[0m09:28:54.762038 [info ] [Thread-2  ]: 5 of 5 START sql view model analytics.current_holdings_timeline ................ [RUN]
[0m09:28:54.763347 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current_holdings_timeline)
[0m09:28:54.764025 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_timeline
[0m09:28:54.769699 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_timeline"
[0m09:28:54.772394 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_timeline (compile): 09:28:54.764421 => 09:28:54.771963
[0m09:28:54.773035 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_timeline
[0m09:28:54.782276 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_timeline"
[0m09:28:54.783785 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:28:54.784623 [debug] [Thread-2  ]: On model.ccwj.current_holdings_timeline: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_timeline"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_timeline`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   min(case when security_type = 'Equity' then date end) as first_stock_purchase_date,
   min(case when security_type = 'Option' then date end) as first_option_purchase_date,
   max(case when security_type = 'Equity' then date end) as last_stock_purchase_date,
   max(case when security_type = 'Option' then date end) as last_option_purchase_date,
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`history` 
      on history.symbol = current_equity_holdings.symbol
group by 1
)

select *
from holdings_strategy;


[0m09:28:55.374221 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9c3f25dd-c6c5-4272-a65c-6c0dab908b1f&page=queryresults
[0m09:28:55.623802 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: current_equity_holdings at [20:27]; reason: invalidQuery, location: query, message: Unrecognized name: current_equity_holdings at [20:27]')
[0m09:28:56.419646 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:04cec003-1279-4cd2-99e3-bfcb85050706&page=queryresults
[0m09:28:56.731746 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:04cec003-1279-4cd2-99e3-bfcb85050706&page=queryresults
[0m09:28:56.732900 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_timeline (execute): 09:28:54.773415 => 09:28:56.732464
[0m09:28:56.758798 [debug] [Thread-2  ]: Database Error in model current_holdings_timeline (models/intermediate/current_holdings_timeline.sql)
  Unrecognized name: current_equity_holdings at [20:27]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_timeline.sql
[0m09:28:56.766809 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d304960-3457-4148-85df-0594c805c037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a16d0a0>]}
[0m09:28:56.768379 [error] [Thread-2  ]: 5 of 5 ERROR creating sql view model analytics.current_holdings_timeline ....... [[31mERROR[0m in 2.00s]
[0m09:28:56.770929 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_timeline
[0m09:28:56.798246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:56.799008 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:28:56.799978 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_timeline' was properly closed.
[0m09:28:56.800658 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:28:56.801538 [info ] [MainThread]: 
[0m09:28:56.817304 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m09:28:56.821595 [debug] [MainThread]: Command end result
[0m09:28:56.849518 [info ] [MainThread]: 
[0m09:28:56.850583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:28:56.852473 [info ] [MainThread]: 
[0m09:28:56.854052 [error] [MainThread]:   Database Error in model current_holdings_timeline (models/intermediate/current_holdings_timeline.sql)
  Unrecognized name: current_equity_holdings at [20:27]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_timeline.sql
[0m09:28:56.855046 [info ] [MainThread]: 
[0m09:28:56.856045 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:28:56.859336 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 10.369956, "process_user_time": 3.816081, "process_kernel_time": 0.391031, "process_mem_max_rss": "134991872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:28:56.860623 [debug] [MainThread]: Command `cli build` failed at 09:28:56.860191 after 10.37 seconds
[0m09:28:56.861737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107154370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b25970>]}
[0m09:28:56.864200 [debug] [MainThread]: Flushing usage events
[0m09:33:37.555001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645ee20>]}


============================== 09:33:37.562532 | 0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e ==============================
[0m09:33:37.562532 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:33:37.563595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:33:38.544569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641c820>]}
[0m09:33:38.659193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e5cd0>]}
[0m09:33:38.660708 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:33:38.683277 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:33:38.743004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:38.743505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:38.754131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f80d0>]}
[0m09:33:38.771875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107512ac0>]}
[0m09:33:38.772472 [info ] [MainThread]: Found 17 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:33:38.772997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107512b20>]}
[0m09:33:38.775364 [info ] [MainThread]: 
[0m09:33:38.777326 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:38.779179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:33:38.779825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:40.909942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:33:40.911183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:41.211699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107349c40>]}
[0m09:33:41.213348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:41.214424 [info ] [MainThread]: 
[0m09:33:41.220510 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_timeline
[0m09:33:41.221371 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_timeline ................ [RUN]
[0m09:33:41.222536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_timeline)
[0m09:33:41.223217 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_timeline
[0m09:33:41.237883 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_timeline"
[0m09:33:41.239228 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (compile): 09:33:41.223606 => 09:33:41.238773
[0m09:33:41.240041 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_timeline
[0m09:33:41.290294 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_timeline"
[0m09:33:41.291239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:33:41.291909 [debug] [Thread-1  ]: On model.ccwj.current_holdings_timeline: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_timeline"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_timeline`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   min(case when security_type = 'Equity' then date end) as first_stock_purchase_date,
   min(case when security_type = 'Option' then date end) as first_option_purchase_date,
   max(case when security_type = 'Equity' then date end) as last_stock_purchase_date,
   max(case when security_type = 'Option' then date end) as last_option_purchase_date,
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`history` 
      on history.symbol = history.symbol
group by 1
)

select *
from holdings_strategy;


[0m09:33:41.904326 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1a30ffb0-9649-41eb-bbf7-10fb35da367c&page=queryresults
[0m09:33:42.252178 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (execute): 09:33:41.240704 => 09:33:42.251788
[0m09:33:42.253337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ee7ecc2-bad0-4b56-bc32-3e2f61453e9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076780d0>]}
[0m09:33:42.254248 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_timeline ........... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m09:33:42.255641 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_timeline
[0m09:33:42.258166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:42.258641 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_timeline' was properly closed.
[0m09:33:42.259079 [info ] [MainThread]: 
[0m09:33:42.259675 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m09:33:42.260938 [debug] [MainThread]: Command end result
[0m09:33:42.275016 [info ] [MainThread]: 
[0m09:33:42.275749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:42.276225 [info ] [MainThread]: 
[0m09:33:42.276993 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:33:42.279590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.804646, "process_user_time": 3.654982, "process_kernel_time": 0.532701, "process_mem_max_rss": "128172032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:33:42.280617 [debug] [MainThread]: Command `cli run` succeeded at 09:33:42.280391 after 4.81 seconds
[0m09:33:42.281524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e5cd0>]}
[0m09:33:42.282352 [debug] [MainThread]: Flushing usage events
[0m09:42:40.074010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e954370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042b700>]}


============================== 09:42:40.080598 | 69f0ad3b-a6a2-421a-854f-ecf7bd97953a ==============================
[0m09:42:40.080598 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:42:40.081727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:42:40.821058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e1f10>]}
[0m09:42:40.933035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bfe80>]}
[0m09:42:40.934383 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:42:40.958634 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:42:41.014858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:42:41.015385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:42:41.024085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115bf0d0>]}
[0m09:42:41.044536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d0490>]}
[0m09:42:41.045263 [info ] [MainThread]: Found 17 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:42:41.047809 [info ] [MainThread]: 
[0m09:42:41.049016 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:42:41.050621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:42:41.051129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:42.673631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:42:42.674893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:42.952350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ab7f0>]}
[0m09:42:42.953829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:42.954412 [info ] [MainThread]: 
[0m09:42:42.959633 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m09:42:42.960592 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m09:42:42.961530 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m09:42:42.962646 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m09:42:42.963985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m09:42:42.965286 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m09:42:42.966039 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m09:42:42.966601 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m09:42:42.967353 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 09:42:42.966991 => 09:42:42.966995
[0m09:42:42.968013 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 09:42:42.967709 => 09:42:42.967712
[0m09:42:42.968592 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m09:42:42.969166 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m09:42:43.016770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:42:43.099989 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:42:46.857818 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m09:42:46.859294 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m09:42:47.137943 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e329940e-1292-445e-b59a-9ae9e1838427&page=queryresults
[0m09:42:47.212403 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ee4ec037-8640-4566-9081-406f24d7425e&page=queryresults
[0m09:42:47.451373 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m09:42:47.473194 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 09:42:42.981415 => 09:42:47.472912
[0m09:42:47.474122 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169d940>]}
[0m09:42:47.474777 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.51s]
[0m09:42:47.475547 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m09:42:47.476527 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m09:42:47.477241 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.history .................................. [RUN]
[0m09:42:47.478421 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m09:42:47.479059 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m09:42:47.488804 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m09:42:47.490482 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 09:42:47.479494 => 09:42:47.490060
[0m09:42:47.491130 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m09:42:47.515515 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m09:42:47.517059 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:42:47.517769 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0])) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m09:42:47.566720 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m09:42:47.574286 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 09:42:42.969511 => 09:42:47.573915
[0m09:42:47.575409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111640e80>]}
[0m09:42:47.576173 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 22[0m in 4.61s]
[0m09:42:47.577285 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m09:42:47.578248 [debug] [Thread-2  ]: Began running node model.ccwj.current
[0m09:42:47.578949 [info ] [Thread-2  ]: 4 of 5 START sql view model analytics.current .................................. [RUN]
[0m09:42:47.580022 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current)
[0m09:42:47.580538 [debug] [Thread-2  ]: Began compiling node model.ccwj.current
[0m09:42:47.584736 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current"
[0m09:42:47.587125 [debug] [Thread-2  ]: Timing info for model.ccwj.current (compile): 09:42:47.580834 => 09:42:47.586740
[0m09:42:47.587816 [debug] [Thread-2  ]: Began executing node model.ccwj.current
[0m09:42:47.592350 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current"
[0m09:42:47.593332 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:42:47.594099 [debug] [Thread-2  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m09:42:47.898066 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a946c8f9-4320-45c2-90a4-856b2bf5db0a&page=queryresults
[0m09:42:47.953714 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0df4d5ba-8d20-4bd4-a17d-24df4abf6e68&page=queryresults
[0m09:42:48.205969 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 09:42:47.491456 => 09:42:48.205711
[0m09:42:48.206921 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111931fd0>]}
[0m09:42:48.207572 [info ] [Thread-4  ]: 3 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m09:42:48.208376 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m09:42:48.537952 [debug] [Thread-2  ]: Timing info for model.ccwj.current (execute): 09:42:47.588248 => 09:42:48.537685
[0m09:42:48.538929 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111966ac0>]}
[0m09:42:48.539619 [info ] [Thread-2  ]: 4 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m09:42:48.540418 [debug] [Thread-2  ]: Finished running node model.ccwj.current
[0m09:42:48.541491 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_timeline
[0m09:42:48.542211 [info ] [Thread-1  ]: 5 of 5 START sql view model analytics.current_holdings_timeline ................ [RUN]
[0m09:42:48.543428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current_holdings_timeline)
[0m09:42:48.544019 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_timeline
[0m09:42:48.548663 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_timeline"
[0m09:42:48.550871 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (compile): 09:42:48.544355 => 09:42:48.550539
[0m09:42:48.551331 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_timeline
[0m09:42:48.556585 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_timeline"
[0m09:42:48.557556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:42:48.558161 [debug] [Thread-1  ]: On model.ccwj.current_holdings_timeline: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_timeline"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_timeline`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   min(case when history.security_type = 'Equity' then date end) as first_stock_purchase_date,
   min(case when history.security_type = 'Option' then date end) as first_option_purchase_date,
   max(case when history.security_type = 'Equity' then date end) as last_stock_purchase_date,
   max(case when history.security_type = 'Option' then date end) as last_option_purchase_date,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1
)

, final as (
select 
   holdings_strategy.*,
   least(first_stock_purchase_date,first_option_purchase_date) as first_holdings_purchase_date
from holdings_strategy
)
select *
from final;


[0m09:42:49.167701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3a386984-2a4d-407f-9b4c-f4e0da631c31&page=queryresults
[0m09:42:50.310554 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (execute): 09:42:48.551602 => 09:42:50.309972
[0m09:42:50.312135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f0ad3b-a6a2-421a-854f-ecf7bd97953a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119495e0>]}
[0m09:42:50.313277 [info ] [Thread-1  ]: 5 of 5 OK created sql view model analytics.current_holdings_timeline ........... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m09:42:50.314520 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_timeline
[0m09:42:50.317217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:50.317829 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_timeline' was properly closed.
[0m09:42:50.318344 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m09:42:50.318852 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m09:42:50.319401 [info ] [MainThread]: 
[0m09:42:50.320088 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m09:42:50.322907 [debug] [MainThread]: Command end result
[0m09:42:50.338893 [info ] [MainThread]: 
[0m09:42:50.339568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:50.340363 [info ] [MainThread]: 
[0m09:42:50.341147 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:42:50.344636 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.349158, "process_user_time": 3.796063, "process_kernel_time": 0.45103, "process_mem_max_rss": "133976064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:42:50.345824 [debug] [MainThread]: Command `cli build` succeeded at 09:42:50.345577 after 10.35 seconds
[0m09:42:50.346668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e954370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ab7f0>]}
[0m09:42:50.347351 [debug] [MainThread]: Flushing usage events
[0m09:58:57.599180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3a04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e77820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eaefa0>]}


============================== 09:58:57.605193 | a6243fba-3f93-4b97-8eb2-d661cd64b098 ==============================
[0m09:58:57.605193 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:58:57.606216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:58.253315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f23340>]}
[0m09:58:58.372767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d42610>]}
[0m09:58:58.374647 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:58:58.400162 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:58:58.506197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:58.506733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:58.516489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120440d0>]}
[0m09:58:58.535152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11201b970>]}
[0m09:58:58.535744 [info ] [MainThread]: Found 18 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:58:58.536206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11201b9d0>]}
[0m09:58:58.538463 [info ] [MainThread]: 
[0m09:58:58.539707 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:58:58.541073 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:58:58.541939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:59.904095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:58:59.905031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:00.188998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d44e80>]}
[0m09:59:00.190316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:00.190855 [info ] [MainThread]: 
[0m09:59:00.195874 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:59:00.197010 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_dates ........................... [RUN]
[0m09:59:00.198297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:59:00.198872 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:59:00.209780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:59:00.213178 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:59:00.199372 => 09:59:00.212343
[0m09:59:00.213857 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:59:00.264701 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:59:00.266870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:00.267520 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2010-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:59:00.693038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:403045b3-9f4f-47f4-a87f-03c1bc70d291&page=queryresults
[0m09:59:01.019938 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:59:00.214167 => 09:59:01.019654
[0m09:59:01.021337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6243fba-3f93-4b97-8eb2-d661cd64b098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e66340>]}
[0m09:59:01.022377 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m09:59:01.023509 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:59:01.025935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:01.026544 [debug] [MainThread]: Connection 'model.ccwj.calendar_dates' was properly closed.
[0m09:59:01.027168 [info ] [MainThread]: 
[0m09:59:01.027631 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m09:59:01.028641 [debug] [MainThread]: Command end result
[0m09:59:01.042449 [info ] [MainThread]: 
[0m09:59:01.043317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:01.043759 [info ] [MainThread]: 
[0m09:59:01.044216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:01.046693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.542568, "process_user_time": 3.700361, "process_kernel_time": 0.382904, "process_mem_max_rss": "128643072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:01.047705 [debug] [MainThread]: Command `cli run` succeeded at 09:59:01.047429 after 3.54 seconds
[0m09:59:01.048793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3a04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d42610>]}
[0m09:59:01.049970 [debug] [MainThread]: Flushing usage events
[0m09:59:33.159497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a2dc0>]}


============================== 09:59:33.165018 | bec0e468-fbe7-4f62-a60a-4df42279baf8 ==============================
[0m09:59:33.165018 [info ] [MainThread]: Running with dbt=1.7.12
[0m09:59:33.165845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:33.824255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806ac40>]}
[0m09:59:33.954677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f55be0>]}
[0m09:59:33.956778 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m09:59:33.983096 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m09:59:34.056224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:34.056861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:34.067671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109250fd0>]}
[0m09:59:34.086059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921b670>]}
[0m09:59:34.086706 [info ] [MainThread]: Found 18 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m09:59:34.087193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109224070>]}
[0m09:59:34.089435 [info ] [MainThread]: 
[0m09:59:34.090800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:59:34.092204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m09:59:34.092803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:35.772903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m09:59:35.773707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:36.036857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902c6d0>]}
[0m09:59:36.038139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:36.038678 [info ] [MainThread]: 
[0m09:59:36.042372 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m09:59:36.043113 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_dates ........................... [RUN]
[0m09:59:36.044234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m09:59:36.044808 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m09:59:36.055815 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m09:59:36.056951 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 09:59:36.045219 => 09:59:36.056612
[0m09:59:36.057571 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m09:59:36.107597 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m09:59:36.108711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:36.109435 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m09:59:36.557626 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ebea381b-5ba1-4ffc-ae4a-b4a798521ff0&page=queryresults
[0m09:59:36.904782 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 09:59:36.057968 => 09:59:36.904253
[0m09:59:36.906530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec0e468-fbe7-4f62-a60a-4df42279baf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dfd90>]}
[0m09:59:36.908150 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m09:59:36.910551 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m09:59:36.913429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:36.913930 [debug] [MainThread]: Connection 'model.ccwj.calendar_dates' was properly closed.
[0m09:59:36.914882 [info ] [MainThread]: 
[0m09:59:36.915961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m09:59:36.918403 [debug] [MainThread]: Command end result
[0m09:59:36.945213 [info ] [MainThread]: 
[0m09:59:36.946230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:36.947402 [info ] [MainThread]: 
[0m09:59:36.948437 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:36.953008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8716967, "process_user_time": 3.69877, "process_kernel_time": 0.369486, "process_mem_max_rss": "127963136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:36.954699 [debug] [MainThread]: Command `cli run` succeeded at 09:59:36.954301 after 3.87 seconds
[0m09:59:36.955867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092241f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902c8b0>]}
[0m09:59:36.957616 [debug] [MainThread]: Flushing usage events
[0m10:01:42.379011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f81d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f71dc0>]}


============================== 10:01:42.385744 | 075c9763-71ba-4d91-b0f0-650de16f7504 ==============================
[0m10:01:42.385744 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:01:42.386732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:42.992923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8f730>]}
[0m10:01:43.101396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d08b50>]}
[0m10:01:43.103420 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:01:43.127941 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m10:01:43.188103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:43.188611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:43.197941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11311ed90>]}
[0m10:01:43.215697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130eeb80>]}
[0m10:01:43.216321 [info ] [MainThread]: Found 18 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:01:43.216808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130eec70>]}
[0m10:01:43.219790 [info ] [MainThread]: 
[0m10:01:43.221214 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:01:43.223054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:01:43.223836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:44.837961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:01:44.839157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:45.247447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e66e80>]}
[0m10:01:45.249180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:01:45.250194 [info ] [MainThread]: 
[0m10:01:45.255153 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m10:01:45.255999 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.history .................................. [RUN]
[0m10:01:45.257150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.history)
[0m10:01:45.257779 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m10:01:45.270377 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:01:45.271701 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 10:01:45.258155 => 10:01:45.271288
[0m10:01:45.272288 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m10:01:45.319785 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:01:45.320820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:01:45.321513 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m10:01:45.921841 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b100c7ba-19d4-4bc3-8e7a-7d442ebff7f8&page=queryresults
[0m10:01:46.351681 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 10:01:45.272629 => 10:01:46.351381
[0m10:01:46.352703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075c9763-71ba-4d91-b0f0-650de16f7504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b1d00>]}
[0m10:01:46.353477 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m10:01:46.354259 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m10:01:46.356530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:46.357046 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:01:46.357520 [info ] [MainThread]: 
[0m10:01:46.358182 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m10:01:46.359107 [debug] [MainThread]: Command end result
[0m10:01:46.379213 [info ] [MainThread]: 
[0m10:01:46.379940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:01:46.380534 [info ] [MainThread]: 
[0m10:01:46.381041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:01:46.398922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.095822, "process_user_time": 3.599357, "process_kernel_time": 0.383901, "process_mem_max_rss": "128249856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:01:46.399926 [debug] [MainThread]: Command `cli run` succeeded at 10:01:46.399725 after 4.10 seconds
[0m10:01:46.400502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113233ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e66e80>]}
[0m10:01:46.401025 [debug] [MainThread]: Flushing usage events
[0m15:09:32.552673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118694f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113340820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113377fa0>]}


============================== 15:09:32.559543 | 50a52711-32e0-4637-a46c-4f40e2cfc3ff ==============================
[0m15:09:32.559543 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:09:32.560316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:33.377978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332e790>]}
[0m15:09:33.497250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d9100>]}
[0m15:09:33.498931 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:09:33.522116 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m15:09:33.622454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:33.623104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:33.632809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450d0d0>]}
[0m15:09:33.651048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e4a90>]}
[0m15:09:33.651649 [info ] [MainThread]: Found 18 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:09:33.652527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e4af0>]}
[0m15:09:33.654987 [info ] [MainThread]: 
[0m15:09:33.656535 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:33.658277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:09:33.659094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:35.427353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:09:35.428291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:35.866477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11420cf10>]}
[0m15:09:35.867740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:35.868342 [info ] [MainThread]: 
[0m15:09:35.873992 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_earnings
[0m15:09:35.874767 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_earnings ................ [RUN]
[0m15:09:35.875709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_earnings)
[0m15:09:35.876290 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_earnings
[0m15:09:35.890800 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_earnings"
[0m15:09:35.892815 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_earnings (compile): 15:09:35.876621 => 15:09:35.892282
[0m15:09:35.893655 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_earnings
[0m15:09:36.009939 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_earnings"
[0m15:09:36.012495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:36.014918 [debug] [Thread-1  ]: On model.ccwj.current_holdings_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2
)
, holdings_earnings_current_value as (
select 
   current_holdings.symbol,
   c.security_type,
   sum(market_value) as current_market_value
from current_holdings
   join `ccwj-dbt`.`analytics`.`current` as c using (symbol)
group by 1,2
)
, final as (
select 
   symbol,
   security_type,
   gain_or_loss,
from holdings_earnings_historical 
UNION ALL 
select 
   symbol,
   security_type,
   current_market_value,
from holdings_earnings_current_value
)
select 
   symbol,
   security_type,
   sum(gain_or_loss) as current_position_overall_gain_or_loss 
from final 
group by 1,2;


[0m15:09:36.593334 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d8f59f4-9851-4579-85bd-c49d471b2846&page=queryresults
[0m15:09:36.968455 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_earnings (execute): 15:09:35.894444 => 15:09:36.968142
[0m15:09:36.970023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50a52711-32e0-4637-a46c-4f40e2cfc3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11458d1c0>]}
[0m15:09:36.971203 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_earnings ........... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m15:09:36.972377 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_earnings
[0m15:09:36.974522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:36.975012 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_earnings' was properly closed.
[0m15:09:36.975534 [info ] [MainThread]: 
[0m15:09:36.976514 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m15:09:36.977509 [debug] [MainThread]: Command end result
[0m15:09:36.993011 [info ] [MainThread]: 
[0m15:09:36.993689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:36.994420 [info ] [MainThread]: 
[0m15:09:36.995423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:36.999593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5354877, "process_user_time": 3.628889, "process_kernel_time": 0.529456, "process_mem_max_rss": "128253952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:37.000457 [debug] [MainThread]: Command `cli run` succeeded at 15:09:37.000268 after 4.54 seconds
[0m15:09:37.001533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118694f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410b940>]}
[0m15:09:37.002577 [debug] [MainThread]: Flushing usage events
[0m13:01:05.721095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d44fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef66370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef464f0>]}


============================== 13:01:05.727546 | 57102bf9-316f-4f38-85e6-cc7de61c5ab1 ==============================
[0m13:01:05.727546 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:01:05.728623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:06.394234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd746a0>]}
[0m13:01:06.513444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed5a00>]}
[0m13:01:06.514816 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:01:06.538109 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:01:06.599524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:06.600021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:06.610562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fe0d0>]}
[0m13:01:06.633727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d7190>]}
[0m13:01:06.634454 [info ] [MainThread]: Found 19 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:01:06.636738 [info ] [MainThread]: 
[0m13:01:06.637811 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:06.639375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:01:06.639847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:08.040574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:01:08.041651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:08.354635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100cb400>]}
[0m13:01:08.356212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:08.356858 [info ] [MainThread]: 
[0m13:01:08.362165 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m13:01:08.363638 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m13:01:08.364465 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m13:01:08.365440 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m13:01:08.366840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m13:01:08.368215 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:01:08.369179 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m13:01:08.370144 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m13:01:08.371025 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 13:01:08.370564 => 13:01:08.370569
[0m13:01:08.371799 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 13:01:08.371471 => 13:01:08.371476
[0m13:01:08.372513 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m13:01:08.373372 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m13:01:08.429702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:08.525116 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:01:12.246467 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:01:12.568998 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4192be35-ab31-41c9-9cef-3995fa133dcc&page=queryresults
[0m13:01:12.644861 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:01:12.909632 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:01:12.935966 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 13:01:08.373817 => 13:01:12.935573
[0m13:01:12.937376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110181880>]}
[0m13:01:12.938309 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.57s]
[0m13:01:12.939614 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m13:01:12.940554 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m13:01:12.941467 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.current .................................. [RUN]
[0m13:01:12.942597 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m13:01:12.943189 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m13:01:12.955191 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:01:12.956028 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3e517f3d-ddb5-4a3e-9488-5b3af32fc41c&page=queryresults
[0m13:01:12.958641 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 13:01:12.943521 => 13:01:12.958306
[0m13:01:12.959210 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m13:01:12.984362 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:01:12.985314 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:01:12.986190 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:01:13.317917 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:01:13.322929 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 13:01:08.396282 => 13:01:13.322583
[0m13:01:13.324375 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c3e80>]}
[0m13:01:13.325234 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.96s]
[0m13:01:13.326407 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m13:01:13.327390 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m13:01:13.328113 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.history .................................. [RUN]
[0m13:01:13.329584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:01:13.330286 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m13:01:13.336112 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:01:13.338470 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 13:01:13.330993 => 13:01:13.337947
[0m13:01:13.339263 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m13:01:13.345330 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:01:13.346386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:13.347197 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:01:13.553688 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:15d12fe1-576c-43d7-913c-e0e34a6166d9&page=queryresults
[0m13:01:13.826010 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7bd4733d-7ba1-4b20-9f11-3ad4dfaf9ea2&page=queryresults
[0m13:01:14.101120 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 13:01:12.959911 => 13:01:14.100567
[0m13:01:14.102346 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046dfd0>]}
[0m13:01:14.103375 [info ] [Thread-4  ]: 3 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m13:01:14.104451 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m13:01:14.266468 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 13:01:13.339850 => 13:01:14.266155
[0m13:01:14.267807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ee580>]}
[0m13:01:14.268808 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m13:01:14.270577 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m13:01:14.272760 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m13:01:14.273869 [info ] [Thread-2  ]: 5 of 5 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m13:01:14.275237 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current_holdings_historical_earnings)
[0m13:01:14.275948 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m13:01:14.280548 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m13:01:14.283086 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 13:01:14.276295 => 13:01:14.282272
[0m13:01:14.283890 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m13:01:14.290568 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m13:01:14.291595 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:01:14.292231 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
select * 
from holdings_earnings_historical;


[0m13:01:14.870702 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0ebd7e48-f515-413c-8d91-65d10bfa39d2&page=queryresults
[0m13:01:15.206485 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 13:01:14.284404 => 13:01:15.206106
[0m13:01:15.207963 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57102bf9-316f-4f38-85e6-cc7de61c5ab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b8400>]}
[0m13:01:15.209088 [info ] [Thread-2  ]: 5 of 5 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m13:01:15.210336 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m13:01:15.212786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:15.213336 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:01:15.213788 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m13:01:15.214521 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m13:01:15.215167 [info ] [MainThread]: 
[0m13:01:15.215774 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m13:01:15.218264 [debug] [MainThread]: Command end result
[0m13:01:15.234759 [info ] [MainThread]: 
[0m13:01:15.235605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:15.236553 [info ] [MainThread]: 
[0m13:01:15.237380 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:01:15.240656 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.618471, "process_user_time": 4.024815, "process_kernel_time": 0.451603, "process_mem_max_rss": "134021120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:15.241666 [debug] [MainThread]: Command `cli build` succeeded at 13:01:15.241449 after 9.62 seconds
[0m13:01:15.242256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d44fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fda54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d7190>]}
[0m13:01:15.242806 [debug] [MainThread]: Flushing usage events
[0m13:01:20.554407 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:08:26.647225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf8ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea61850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea8f8e0>]}


============================== 13:08:26.653760 | a589f0e4-a555-405a-b9a2-3b8d5a7f4005 ==============================
[0m13:08:26.653760 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:08:26.654533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:27.437553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea61130>]}
[0m13:08:27.556884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8c4340>]}
[0m13:08:27.558624 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:08:27.582847 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:08:27.660280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:27.660991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:27.671531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc300d0>]}
[0m13:08:27.692572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc084f0>]}
[0m13:08:27.693386 [info ] [MainThread]: Found 19 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:08:27.695993 [info ] [MainThread]: 
[0m13:08:27.697329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:27.699680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:08:27.700502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:29.378591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:08:29.379518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:29.667329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbfa820>]}
[0m13:08:29.668697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:29.669278 [info ] [MainThread]: 
[0m13:08:29.673441 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m13:08:29.674115 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m13:08:29.675002 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m13:08:29.675728 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m13:08:29.677150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m13:08:29.678222 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:08:29.678796 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m13:08:29.679304 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m13:08:29.679995 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 13:08:29.679680 => 13:08:29.679684
[0m13:08:29.680597 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 13:08:29.680309 => 13:08:29.680312
[0m13:08:29.681436 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m13:08:29.682121 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m13:08:29.736048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:29.781413 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 13:08:29.701649 => 13:08:29.781012
[0m13:08:29.793852 [debug] [Thread-2  ]: Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 89 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m13:08:29.795219 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc20310>]}
[0m13:08:29.796023 [error] [Thread-2  ]: 2 of 5 ERROR loading seed file analytics.0417_history .......................... [[31mERROR[0m in 0.12s]
[0m13:08:29.797360 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m13:08:29.798321 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m13:08:29.798940 [info ] [Thread-4  ]: 3 of 5 SKIP relation analytics.history ......................................... [[33mSKIP[0m]
[0m13:08:29.799769 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m13:08:33.412429 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:08:33.858018 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:02d2939e-42b2-478c-b981-c3db216bb175&page=queryresults
[0m13:08:34.183339 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:08:34.206122 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 13:08:29.682528 => 13:08:34.205699
[0m13:08:34.207358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcb3d90>]}
[0m13:08:34.208353 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.53s]
[0m13:08:34.209600 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m13:08:34.211535 [debug] [Thread-2  ]: Began running node model.ccwj.current
[0m13:08:34.212606 [info ] [Thread-2  ]: 4 of 5 START sql view model analytics.current .................................. [RUN]
[0m13:08:34.214234 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current)
[0m13:08:34.215216 [debug] [Thread-2  ]: Began compiling node model.ccwj.current
[0m13:08:34.229925 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:08:34.231588 [debug] [Thread-2  ]: Timing info for model.ccwj.current (compile): 13:08:34.215871 => 13:08:34.231140
[0m13:08:34.232320 [debug] [Thread-2  ]: Began executing node model.ccwj.current
[0m13:08:34.268560 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:08:34.270310 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:08:34.271614 [debug] [Thread-2  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:08:34.778746 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:87b6d3ea-7f03-4d6e-a220-ddfa887447ad&page=queryresults
[0m13:08:35.122609 [debug] [Thread-2  ]: Timing info for model.ccwj.current (execute): 13:08:34.232811 => 13:08:35.122252
[0m13:08:35.123773 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a589f0e4-a555-405a-b9a2-3b8d5a7f4005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd3df40>]}
[0m13:08:35.124608 [info ] [Thread-2  ]: 4 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m13:08:35.125509 [debug] [Thread-2  ]: Finished running node model.ccwj.current
[0m13:08:35.126660 [debug] [Thread-4  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m13:08:35.127442 [info ] [Thread-4  ]: 5 of 5 SKIP relation analytics.current_equity_historical_earnings .............. [[33mSKIP[0m]
[0m13:08:35.128389 [debug] [Thread-4  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m13:08:35.130618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:35.131273 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m13:08:35.131764 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m13:08:35.132314 [info ] [MainThread]: 
[0m13:08:35.132977 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m13:08:35.134627 [debug] [MainThread]: Command end result
[0m13:08:35.154580 [info ] [MainThread]: 
[0m13:08:35.155279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:08:35.155981 [info ] [MainThread]: 
[0m13:08:35.156994 [error] [MainThread]:   Compilation Error in seed 0417_history (seeds/0417_history.csv)
  Row 89 has 10 values, but Table only has 9 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed 0417_history (seeds/0417_history.csv)
[0m13:08:35.157697 [info ] [MainThread]: 
[0m13:08:35.158350 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m13:08:35.162233 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.597217, "process_user_time": 3.870742, "process_kernel_time": 0.52418, "process_mem_max_rss": "129773568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:08:35.163253 [debug] [MainThread]: Command `cli build` failed at 13:08:35.162932 after 8.60 seconds
[0m13:08:35.164206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf8ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea937f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8c4340>]}
[0m13:08:35.164852 [debug] [MainThread]: Flushing usage events
[0m13:09:36.856317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7b4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7944f0>]}


============================== 13:09:36.863409 | 0314658c-a2c0-4074-85aa-89ef2520304e ==============================
[0m13:09:36.863409 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:09:36.864628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:09:37.581658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7455e0>]}
[0m13:09:37.769926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04ac10>]}
[0m13:09:37.770848 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:09:37.793379 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:09:37.857128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:37.857680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:37.866690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f94c0d0>]}
[0m13:09:37.884754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9253a0>]}
[0m13:09:37.885471 [info ] [MainThread]: Found 19 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:09:37.887940 [info ] [MainThread]: 
[0m13:09:37.889192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:37.890661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:09:37.891209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:39.840885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:09:39.842183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:40.361260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f917fa0>]}
[0m13:09:40.363197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:40.363803 [info ] [MainThread]: 
[0m13:09:40.368081 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m13:09:40.368796 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_history
[0m13:09:40.369675 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m13:09:40.370717 [info ] [Thread-2  ]: 2 of 5 START seed file analytics.0417_history .................................. [RUN]
[0m13:09:40.371775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m13:09:40.372775 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:09:40.373486 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m13:09:40.374062 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_history
[0m13:09:40.375397 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 13:09:40.374665 => 13:09:40.374672
[0m13:09:40.376944 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (compile): 13:09:40.376093 => 13:09:40.376099
[0m13:09:40.377866 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m13:09:40.378439 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_history
[0m13:09:40.438032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:09:40.533520 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:09:44.296598 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:09:44.499902 [debug] [Thread-2  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:09:44.580364 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1f21ff22-8008-44a2-9ea1-012d167eeece&page=queryresults
[0m13:09:44.798809 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e9adc169-e1dd-4a69-8b57-77967b9a0aeb&page=queryresults
[0m13:09:44.987487 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:09:45.013317 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 13:09:40.378865 => 13:09:45.012946
[0m13:09:45.014583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d0cd0>]}
[0m13:09:45.015394 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.64s]
[0m13:09:45.016878 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m13:09:45.018129 [debug] [Thread-4  ]: Began running node model.ccwj.current
[0m13:09:45.018849 [info ] [Thread-4  ]: 3 of 5 START sql view model analytics.current .................................. [RUN]
[0m13:09:45.020023 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m13:09:45.020629 [debug] [Thread-4  ]: Began compiling node model.ccwj.current
[0m13:09:45.032471 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:09:45.034465 [debug] [Thread-4  ]: Timing info for model.ccwj.current (compile): 13:09:45.021288 => 13:09:45.033806
[0m13:09:45.035342 [debug] [Thread-4  ]: Began executing node model.ccwj.current
[0m13:09:45.074879 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:09:45.076848 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:09:45.077948 [debug] [Thread-4  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:09:45.160338 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:09:45.165013 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_history (execute): 13:09:40.402428 => 13:09:45.164696
[0m13:09:45.166243 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9fa880>]}
[0m13:09:45.167328 [info ] [Thread-2  ]: 2 of 5 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.79s]
[0m13:09:45.168731 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_history
[0m13:09:45.169643 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m13:09:45.170289 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.history .................................. [RUN]
[0m13:09:45.171412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:09:45.172199 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m13:09:45.178092 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:09:45.180588 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 13:09:45.172971 => 13:09:45.179212
[0m13:09:45.181578 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m13:09:45.186772 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:09:45.188326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:09:45.189765 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:09:45.599051 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a90a2e81-df91-41e2-bdbf-b232284d8612&page=queryresults
[0m13:09:45.621825 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7be8bf24-8807-4979-ac19-dbf05440194b&page=queryresults
[0m13:09:45.912393 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 13:09:45.182234 => 13:09:45.911904
[0m13:09:45.914530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcf70d0>]}
[0m13:09:45.916270 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m13:09:45.917650 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m13:09:45.942394 [debug] [Thread-4  ]: Timing info for model.ccwj.current (execute): 13:09:45.035756 => 13:09:45.941700
[0m13:09:45.944172 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9fa880>]}
[0m13:09:45.945787 [info ] [Thread-4  ]: 3 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m13:09:45.947501 [debug] [Thread-4  ]: Finished running node model.ccwj.current
[0m13:09:45.948789 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m13:09:45.949573 [info ] [Thread-2  ]: 5 of 5 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m13:09:45.950646 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current_equity_historical_earnings)
[0m13:09:45.951395 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m13:09:45.957078 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m13:09:45.959017 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 13:09:45.952033 => 13:09:45.958594
[0m13:09:45.959812 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m13:09:45.971091 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m13:09:45.972224 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:09:45.972901 [debug] [Thread-2  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
select * 
from holdings_earnings_historical
where security_type = 'Equity';


[0m13:09:46.455646 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c3e10e4e-ba91-4176-9706-0d06f599ac1c&page=queryresults
[0m13:09:47.028171 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 13:09:45.960875 => 13:09:47.027610
[0m13:09:47.030214 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0314658c-a2c0-4074-85aa-89ef2520304e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b5cd0>]}
[0m13:09:47.052743 [info ] [Thread-2  ]: 5 of 5 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m13:09:47.058235 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m13:09:47.081836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:47.082338 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:09:47.082722 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m13:09:47.083090 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m13:09:47.083556 [info ] [MainThread]: 
[0m13:09:47.084001 [info ] [MainThread]: Finished running 2 seeds, 3 view models in 0 hours 0 minutes and 9.20 seconds (9.20s).
[0m13:09:47.085757 [debug] [MainThread]: Command end result
[0m13:09:47.111657 [info ] [MainThread]: 
[0m13:09:47.112917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:47.113967 [info ] [MainThread]: 
[0m13:09:47.115218 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:09:47.119068 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.342949, "process_user_time": 4.098292, "process_kernel_time": 0.439793, "process_mem_max_rss": "133500928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:09:47.120487 [debug] [MainThread]: Command `cli build` succeeded at 13:09:47.120016 after 10.34 seconds
[0m13:09:47.121756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f749df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e9220>]}
[0m13:09:47.123193 [debug] [MainThread]: Flushing usage events
[0m13:40:31.466712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c082400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db44550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db6f9a0>]}


============================== 13:40:31.475336 | 3a19ac84-9145-4e12-b04e-dd9aed150971 ==============================
[0m13:40:31.475336 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:40:31.476432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --select cflt_prices', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:40:32.677202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db58460>]}
[0m13:40:32.830071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e359bb0>]}
[0m13:40:32.831606 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:40:32.866137 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m13:40:33.013297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:33.013985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:33.026164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed250d0>]}
[0m13:40:33.054463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb67430>]}
[0m13:40:33.055334 [info ] [MainThread]: Found 19 models, 3 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:40:33.056006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb67820>]}
[0m13:40:33.058545 [info ] [MainThread]: 
[0m13:40:33.059976 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:40:33.062069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:40:33.063196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:35.097645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:40:35.098696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:35.401210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf1f70>]}
[0m13:40:35.403298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:35.404507 [info ] [MainThread]: 
[0m13:40:35.410064 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m13:40:35.411158 [info ] [Thread-1  ]: 1 of 1 START seed file analytics.cflt_prices ................................... [RUN]
[0m13:40:35.412613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.cflt_prices)
[0m13:40:35.413303 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:40:35.414145 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:40:35.413704 => 13:40:35.413709
[0m13:40:35.414756 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m13:40:35.483237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:39.004913 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:40:39.553411 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b12e2634-9be9-469b-af06-920c2764f5f8&page=queryresults
[0m13:40:39.863075 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:40:39.884390 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:40:35.415139 => 13:40:39.884064
[0m13:40:39.885454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a19ac84-9145-4e12-b04e-dd9aed150971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb67820>]}
[0m13:40:39.886209 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 198[0m in 4.47s]
[0m13:40:39.887048 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m13:40:39.889568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:39.890056 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m13:40:39.890532 [info ] [MainThread]: 
[0m13:40:39.891050 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.83 seconds (6.83s).
[0m13:40:39.892116 [debug] [MainThread]: Command end result
[0m13:40:39.907200 [info ] [MainThread]: 
[0m13:40:39.908114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:39.908915 [info ] [MainThread]: 
[0m13:40:39.909855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:40:39.912950 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.561422, "process_user_time": 5.207615, "process_kernel_time": 0.701125, "process_mem_max_rss": "129691648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:40:39.914166 [debug] [MainThread]: Command `dbt seed` succeeded at 13:40:39.913904 after 8.56 seconds
[0m13:40:39.914916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c082400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db58460>]}
[0m13:40:39.915745 [debug] [MainThread]: Flushing usage events
[0m13:44:36.464671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b8ca0>]}


============================== 13:44:36.473002 | d35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2 ==============================
[0m13:44:36.473002 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:44:36.474289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:37.385795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962f430>]}
[0m13:44:37.561950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a417e80>]}
[0m13:44:37.563633 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:44:37.599698 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:44:37.630156 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:44:37.631518 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:44:37.632573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4525b0>]}
[0m13:44:40.066988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad30d0>]}
[0m13:44:40.092913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a691ee0>]}
[0m13:44:40.093962 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:44:40.097213 [info ] [MainThread]: 
[0m13:44:40.098829 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:44:40.101155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:44:40.101965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:41.733298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:44:41.734748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:42.001240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad3fa0>]}
[0m13:44:42.003006 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:42.003788 [info ] [MainThread]: 
[0m13:44:42.008729 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m13:44:42.009432 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m13:44:42.011458 [info ] [Thread-1  ]: 1 of 8 START sql view model analytics.calendar_dates ........................... [RUN]
[0m13:44:42.014978 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m13:44:42.017785 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m13:44:42.018622 [info ] [Thread-2  ]: 2 of 8 START seed file analytics.0417_current .................................. [RUN]
[0m13:44:42.020282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m13:44:42.021317 [info ] [Thread-4  ]: 4 of 8 START seed file analytics.cflt_prices ................................... [RUN]
[0m13:44:42.022776 [info ] [Thread-3  ]: 3 of 8 START seed file analytics.0417_history .................................. [RUN]
[0m13:44:42.024518 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m13:44:42.025370 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m13:44:42.027174 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m13:44:42.029115 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:44:42.029898 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m13:44:42.047769 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:44:42.050975 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m13:44:42.052232 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m13:44:42.053326 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 13:44:42.052771 => 13:44:42.052777
[0m13:44:42.054455 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:44:42.053969 => 13:44:42.053974
[0m13:44:42.056666 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 13:44:42.055942 => 13:44:42.055949
[0m13:44:42.058375 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m13:44:42.059854 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m13:44:42.062093 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m13:44:42.064649 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 13:44:42.030348 => 13:44:42.063933
[0m13:44:42.163709 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m13:44:42.187984 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:44:42.200529 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:44:42.312393 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m13:44:42.335785 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:44:42.338046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:44:42.338887 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m13:44:42.767024 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e7c6fe83-e705-48bc-8cbf-a82c63046fbd&page=queryresults
[0m13:44:43.171676 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 13:44:42.201047 => 13:44:43.171290
[0m13:44:43.173021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac016d0>]}
[0m13:44:43.174063 [info ] [Thread-1  ]: 1 of 8 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m13:44:43.175471 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m13:44:45.981936 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:44:46.036224 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:44:46.240519 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:44:46.270194 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cc055325-d3d4-4dcc-81f9-ec29adff1166&page=queryresults
[0m13:44:46.367205 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bab2ff2d-535b-4fbf-a722-49e0068b3d91&page=queryresults
[0m13:44:46.511361 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ec379400-8dd2-4771-9338-2718338191bb&page=queryresults
[0m13:44:46.621145 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:44:46.627964 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 13:44:42.065552 => 13:44:46.627603
[0m13:44:46.629376 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad38b0>]}
[0m13:44:46.630270 [info ] [Thread-2  ]: 2 of 8 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.61s]
[0m13:44:46.631180 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m13:44:46.632059 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m13:44:46.632772 [info ] [Thread-1  ]: 5 of 8 START sql view model analytics.current .................................. [RUN]
[0m13:44:46.634194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m13:44:46.634869 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m13:44:46.640802 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:44:46.642743 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 13:44:46.635689 => 13:44:46.642337
[0m13:44:46.643370 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m13:44:46.648641 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:44:46.649824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:44:46.650711 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:44:46.696767 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:44:46.700673 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:44:42.076310 => 13:44:46.700339
[0m13:44:46.701787 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93e730>]}
[0m13:44:46.702551 [info ] [Thread-4  ]: 4 of 8 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 198[0m in 4.68s]
[0m13:44:46.703867 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m13:44:46.813586 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:44:46.819161 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 13:44:42.127159 => 13:44:46.818792
[0m13:44:46.820382 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac25eb0>]}
[0m13:44:46.821192 [info ] [Thread-3  ]: 3 of 8 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.79s]
[0m13:44:46.822147 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m13:44:46.823151 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m13:44:46.823873 [info ] [Thread-2  ]: 6 of 8 START sql view model analytics.history .................................. [RUN]
[0m13:44:46.825209 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:44:46.826255 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m13:44:46.832227 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:44:46.833666 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 13:44:46.826774 => 13:44:46.833152
[0m13:44:46.834409 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m13:44:46.840381 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:44:46.842230 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:44:46.843090 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:44:47.054354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2d7a21b9-a7a1-4e33-918c-eb8cc7662bf2&page=queryresults
[0m13:44:47.314615 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dbf6e193-2e11-439d-956b-82dc9af25719&page=queryresults
[0m13:44:47.388614 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 13:44:46.643743 => 13:44:47.388079
[0m13:44:47.390316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adeb100>]}
[0m13:44:47.391353 [info ] [Thread-1  ]: 5 of 8 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m13:44:47.392600 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m13:44:47.393577 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:44:47.394297 [info ] [Thread-3  ]: 7 of 8 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m13:44:47.395346 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m13:44:47.395974 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:44:47.401990 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:44:47.405644 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:44:47.396410 => 13:44:47.405234
[0m13:44:47.406539 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:44:47.415135 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:44:47.416700 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:44:47.417498 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m13:44:47.634034 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 13:44:46.834804 => 13:44:47.633628
[0m13:44:47.635327 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1bee0>]}
[0m13:44:47.636299 [info ] [Thread-2  ]: 6 of 8 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m13:44:47.637311 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m13:44:48.028751 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0c41fc67-e66e-443f-a49d-b54c26756af7&page=queryresults
[0m13:44:48.367471 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:44:47.407065 => 13:44:48.367021
[0m13:44:48.368858 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af49c40>]}
[0m13:44:48.369824 [info ] [Thread-3  ]: 7 of 8 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m13:44:48.370947 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:44:48.372152 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m13:44:48.372968 [info ] [Thread-1  ]: 8 of 8 START sql view model analytics.historical_equity_held ................... [RUN]
[0m13:44:48.374380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.historical_equity_held)
[0m13:44:48.375173 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m13:44:48.381269 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m13:44:48.386565 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 13:44:48.375658 => 13:44:48.386054
[0m13:44:48.387368 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m13:44:48.392893 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m13:44:48.394686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:44:48.395577 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m13:44:49.055487 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7ed44608-26b3-421c-ba9e-d3c4df6cbe1d&page=queryresults
[0m13:44:49.398770 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 13:44:48.387879 => 13:44:49.398099
[0m13:44:49.400423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd35d9fdd-5dfb-4d09-9a2a-53e9cbe8cec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af23dc0>]}
[0m13:44:49.401371 [info ] [Thread-1  ]: 8 of 8 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:44:49.402560 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m13:44:49.405049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:49.405612 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m13:44:49.406080 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:44:49.406536 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m13:44:49.407052 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m13:44:49.407831 [info ] [MainThread]: 
[0m13:44:49.408669 [info ] [MainThread]: Finished running 5 view models, 3 seeds in 0 hours 0 minutes and 9.31 seconds (9.31s).
[0m13:44:49.411532 [debug] [MainThread]: Command end result
[0m13:44:49.430150 [info ] [MainThread]: 
[0m13:44:49.430974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:49.431849 [info ] [MainThread]: 
[0m13:44:49.432826 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:44:49.437050 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.081678, "process_user_time": 7.988074, "process_kernel_time": 0.700582, "process_mem_max_rss": "146751488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:49.438097 [debug] [MainThread]: Command `cli build` succeeded at 13:44:49.437757 after 13.08 seconds
[0m13:44:49.439281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadba90>]}
[0m13:44:49.440234 [debug] [MainThread]: Flushing usage events
[0m14:15:17.591855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b293b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2c7e80>]}


============================== 14:15:17.598718 | 0eab7865-be91-407a-ada8-38575a9df887 ==============================
[0m14:15:17.598718 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:15:17.600011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:18.368445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba78940>]}
[0m14:15:18.524494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c074550>]}
[0m14:15:18.525948 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:15:18.555434 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:15:18.578896 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:15:18.579647 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:15:18.580369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c05b3d0>]}
[0m14:15:20.802885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e40d0>]}
[0m14:15:20.826962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c525310>]}
[0m14:15:20.827804 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:15:20.831386 [info ] [MainThread]: 
[0m14:15:20.832826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:15:20.834985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:15:20.835657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:22.353850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:15:22.354915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:22.625371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e4ac0>]}
[0m14:15:22.626855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:22.627499 [info ] [MainThread]: 
[0m14:15:22.634332 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:15:22.635152 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:15:22.637040 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:15:22.637981 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:15:22.640943 [info ] [Thread-2  ]: 2 of 8 START seed file analytics.0417_current .................................. [RUN]
[0m14:15:22.635940 [info ] [Thread-1  ]: 1 of 8 START sql view model analytics.calendar_dates ........................... [RUN]
[0m14:15:22.644852 [info ] [Thread-3  ]: 3 of 8 START seed file analytics.0417_history .................................. [RUN]
[0m14:15:22.645736 [info ] [Thread-4  ]: 4 of 8 START seed file analytics.cflt_prices ................................... [RUN]
[0m14:15:22.647199 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:15:22.648544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:15:22.650413 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:15:22.652042 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:15:22.653101 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:15:22.653981 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:15:22.655145 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:15:22.656080 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:15:22.657182 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:15:22.656656 => 14:15:22.656662
[0m14:15:22.670042 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:15:22.670982 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:15:22.670562 => 14:15:22.670567
[0m14:15:22.672010 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:15:22.671516 => 14:15:22.671520
[0m14:15:22.672759 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:15:22.673811 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:15:22.674797 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:15:22.681023 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:15:22.657621 => 14:15:22.680590
[0m14:15:22.738160 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:15:22.758716 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:15:22.774761 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:15:22.858570 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:15:22.911783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:15:22.924749 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:15:22.938020 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:15:23.368520 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:50c8e1df-4eb7-4b6b-be09-859459dc6817&page=queryresults
[0m14:15:23.802536 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:15:22.759120 => 14:15:23.802094
[0m14:15:23.804090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c627a00>]}
[0m14:15:23.805259 [info ] [Thread-1  ]: 1 of 8 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m14:15:23.806528 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:15:26.374841 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:15:26.418944 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:15:26.660976 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f7ab3ceb-4c10-42ea-a5f2-cf1c7333c0d6&page=queryresults
[0m14:15:26.717208 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:74dd9b09-9758-40f4-90e7-1347e1dd0778&page=queryresults
[0m14:15:26.999682 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:15:27.003928 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:15:22.715675 => 14:15:27.003388
[0m14:15:27.005097 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9090a0>]}
[0m14:15:27.005834 [info ] [Thread-4  ]: 4 of 8 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 198[0m in 4.35s]
[0m14:15:27.006715 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:15:27.008764 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:15:27.035209 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:15:27.040491 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:15:22.675352 => 14:15:27.040149
[0m14:15:27.043069 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7e48e0>]}
[0m14:15:27.043963 [info ] [Thread-2  ]: 2 of 8 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.40s]
[0m14:15:27.044966 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:15:27.046430 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:15:27.047264 [info ] [Thread-1  ]: 5 of 8 START sql view model analytics.current .................................. [RUN]
[0m14:15:27.049420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:15:27.050074 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:15:27.057285 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:15:27.058745 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:15:27.050460 => 14:15:27.058390
[0m14:15:27.059308 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:15:27.066172 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:15:27.067840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:15:27.069226 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:15:27.277649 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d4c3f35a-054d-41b2-baa9-f5155c9f90ed&page=queryresults
[0m14:15:27.623320 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:15:27.628230 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:15:22.698953 => 14:15:27.627796
[0m14:15:27.629621 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a0d30>]}
[0m14:15:27.630531 [info ] [Thread-3  ]: 3 of 8 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.98s]
[0m14:15:27.631699 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:15:27.632584 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m14:15:27.633294 [info ] [Thread-2  ]: 6 of 8 START sql view model analytics.history .................................. [RUN]
[0m14:15:27.634481 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m14:15:27.635490 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m14:15:27.641185 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:15:27.642882 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 14:15:27.635925 => 14:15:27.642464
[0m14:15:27.643623 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m14:15:27.649374 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:15:27.650776 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:15:27.651768 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:15:27.656181 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ca343eba-9c9d-4679-8eb1-dc2a5b383616&page=queryresults
[0m14:15:27.962468 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:15:27.059659 => 14:15:27.961931
[0m14:15:27.964552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc60130>]}
[0m14:15:27.965839 [info ] [Thread-1  ]: 5 of 8 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m14:15:27.967227 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:15:27.968535 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:15:27.969367 [info ] [Thread-3  ]: 7 of 8 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m14:15:27.970706 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m14:15:27.971449 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:15:27.977140 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:15:27.979583 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:15:27.971836 => 14:15:27.979137
[0m14:15:27.980218 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:15:27.989228 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:15:27.990804 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:15:27.991691 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:15:28.146552 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:35e03c92-1342-4644-a0c8-9162eabf40ff&page=queryresults
[0m14:15:28.474940 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 14:15:27.644009 => 14:15:28.474583
[0m14:15:28.476221 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c90cc70>]}
[0m14:15:28.477114 [info ] [Thread-2  ]: 6 of 8 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m14:15:28.478772 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m14:15:28.544425 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:17b989c8-0044-41c7-8378-b242e787ca82&page=queryresults
[0m14:15:28.873221 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:15:27.980596 => 14:15:28.872858
[0m14:15:28.874517 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a7a90>]}
[0m14:15:28.875419 [info ] [Thread-3  ]: 7 of 8 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m14:15:28.876529 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:15:28.877804 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:15:28.878715 [info ] [Thread-1  ]: 8 of 8 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m14:15:28.880020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m14:15:28.880713 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:15:28.887848 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:15:28.892594 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:15:28.881107 => 14:15:28.892152
[0m14:15:28.893380 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:15:28.902413 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:15:28.904707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:15:28.906010 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close 
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select *
from final 
where 1=1
   and day BETWEEN '2022-01-01' and '2024-10-31'
order by day desc;


[0m14:15:29.608460 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a1e17ffb-dc26-46e6-9b6b-b8b87bdc2dae&page=queryresults
[0m14:15:29.937050 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:15:28.894271 => 14:15:29.936621
[0m14:15:29.938825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eab7865-be91-407a-ada8-38575a9df887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc383d0>]}
[0m14:15:29.939843 [info ] [Thread-1  ]: 8 of 8 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:15:29.940984 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:15:29.943736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:29.944368 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:15:29.945078 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m14:15:29.945614 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m14:15:29.946141 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m14:15:29.946808 [info ] [MainThread]: 
[0m14:15:29.948032 [info ] [MainThread]: Finished running 5 view models, 3 seeds in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m14:15:29.951438 [debug] [MainThread]: Command end result
[0m14:15:29.970848 [info ] [MainThread]: 
[0m14:15:29.971724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:29.972924 [info ] [MainThread]: 
[0m14:15:29.974731 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:15:29.979634 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.495064, "process_user_time": 7.299089, "process_kernel_time": 0.557855, "process_mem_max_rss": "146698240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:15:29.980681 [debug] [MainThread]: Command `cli build` succeeded at 14:15:29.980449 after 12.50 seconds
[0m14:15:29.981404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba78940>]}
[0m14:15:29.982077 [debug] [MainThread]: Flushing usage events
[0m14:21:51.649204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053321c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e21c10>]}


============================== 14:21:51.658290 | 57749636-e624-4413-8355-7063777743ea ==============================
[0m14:21:51.658290 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:21:51.659593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:52.704627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c52400>]}
[0m14:21:52.883235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f52b0>]}
[0m14:21:52.885294 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:21:52.937551 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:21:52.979313 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:21:52.980882 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:21:52.982197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dab280>]}
[0m14:21:55.620029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835c0d0>]}
[0m14:21:55.643936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dabaf0>]}
[0m14:21:55.645050 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:21:55.646095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d99f70>]}
[0m14:21:55.648582 [info ] [MainThread]: 
[0m14:21:55.649995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:21:55.651694 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:21:55.652534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:58.340154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:21:58.342462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:58.657004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835c760>]}
[0m14:21:58.660368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:58.662054 [info ] [MainThread]: 
[0m14:21:58.678044 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:21:58.680424 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m14:21:58.683043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_equity_historical_earnings)
[0m14:21:58.685397 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:21:58.754663 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:21:58.760331 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:21:58.686661 => 14:21:58.759029
[0m14:21:58.762107 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:21:58.875704 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:21:58.879370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:58.881612 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
order by day desc;


[0m14:21:59.479697 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8d2ee6bf-96d4-44b6-8551-226fe4c44933&page=queryresults
[0m14:21:59.878864 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:21:58.763218 => 14:21:59.878127
[0m14:21:59.881526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57749636-e624-4413-8355-7063777743ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108485730>]}
[0m14:21:59.883735 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m14:21:59.886360 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:21:59.890944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:59.892229 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:21:59.894542 [info ] [MainThread]: 
[0m14:21:59.896438 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m14:21:59.899083 [debug] [MainThread]: Command end result
[0m14:21:59.941392 [info ] [MainThread]: 
[0m14:21:59.944230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:59.952052 [info ] [MainThread]: 
[0m14:21:59.953271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:21:59.976690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.44196, "process_user_time": 7.477409, "process_kernel_time": 0.688744, "process_mem_max_rss": "136695808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:59.978332 [debug] [MainThread]: Command `cli run` succeeded at 14:21:59.977706 after 8.44 seconds
[0m14:21:59.980600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053321c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dabc70>]}
[0m14:21:59.981599 [debug] [MainThread]: Flushing usage events
[0m14:29:59.477795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d85fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f325d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36fb20>]}


============================== 14:29:59.490879 | 5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c ==============================
[0m14:29:59.490879 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:29:59.492871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:01.050573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36f730>]}
[0m14:30:01.306038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3258e0>]}
[0m14:30:01.307877 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:30:01.361732 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:30:01.416309 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:30:01.418320 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:30:01.419803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101e2730>]}
[0m14:30:04.269902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088a0d0>]}
[0m14:30:04.292283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110771760>]}
[0m14:30:04.293235 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:30:04.294176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e4fa0>]}
[0m14:30:04.297536 [info ] [MainThread]: 
[0m14:30:04.299644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:04.301344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:30:04.301998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:05.766905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:30:05.767964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:06.039494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089aa30>]}
[0m14:30:06.040911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:06.041514 [info ] [MainThread]: 
[0m14:30:06.047257 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:30:06.048201 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m14:30:06.049350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_equity_historical_earnings)
[0m14:30:06.050020 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:30:06.073650 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:30:06.075901 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:30:06.050431 => 14:30:06.075319
[0m14:30:06.076656 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:30:06.126084 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:30:06.127381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:30:06.128284 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:30:06.755004 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8154a9a5-5f5c-4e80-8268-dd0376fa78f5&page=queryresults
[0m14:30:07.144525 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:30:06.077112 => 14:30:07.143806
[0m14:30:07.146843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e12b682-d2ab-4ca8-ba12-7eadb9e94d4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a16e80>]}
[0m14:30:07.148432 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m14:30:07.151547 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:30:07.154676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:07.155455 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:30:07.156188 [info ] [MainThread]: 
[0m14:30:07.156818 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m14:30:07.158356 [debug] [MainThread]: Command end result
[0m14:30:07.275412 [info ] [MainThread]: 
[0m14:30:07.276359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:07.277158 [info ] [MainThread]: 
[0m14:30:07.288008 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:30:07.294330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.013023, "process_user_time": 9.398023, "process_kernel_time": 0.893248, "process_mem_max_rss": "136634368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:30:07.296491 [debug] [MainThread]: Command `cli run` succeeded at 14:30:07.295939 after 8.02 seconds
[0m14:30:07.298590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d85fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36f730>]}
[0m14:30:07.300001 [debug] [MainThread]: Flushing usage events
[0m14:36:13.207094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ae7f0>]}


============================== 14:36:13.214682 | 5c3d48a9-a154-48ba-847e-a7554ab90234 ==============================
[0m14:36:13.214682 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:36:13.215794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:14.081509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108977160>]}
[0m14:36:14.254501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991e130>]}
[0m14:36:14.256123 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:36:14.290547 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:36:14.321417 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:36:14.322888 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:36:14.323900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c8b50>]}
[0m14:36:16.782627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eca0d0>]}
[0m14:36:16.805685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109847460>]}
[0m14:36:16.806875 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:36:16.807601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099074f0>]}
[0m14:36:16.809941 [info ] [MainThread]: 
[0m14:36:16.811355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:16.813011 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:36:16.813910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:18.400827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:36:18.401905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:18.664068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecabb0>]}
[0m14:36:18.665596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:18.666218 [info ] [MainThread]: 
[0m14:36:18.671584 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_holdings
[0m14:36:18.673350 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_option_holdings .................. [RUN]
[0m14:36:18.675011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_option_holdings)
[0m14:36:18.675928 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_holdings
[0m14:36:18.699825 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_holdings"
[0m14:36:18.703575 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (compile): 14:36:18.676418 => 14:36:18.703068
[0m14:36:18.704267 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_holdings
[0m14:36:18.754882 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_holdings"
[0m14:36:18.757810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:36:18.758654 [debug] [Thread-1  ]: On model.ccwj.current_option_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   cast(quantity as int) as option_quantity,
   price as option_price,
   market_value as option_market_value,
   cost_basis as option_cost_basis,
   gain_or_loss_dollar as option_gain_or_loss_dollar,
   security_type,
   margin_requirement as option_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Option';


[0m14:36:19.385569 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0230353e-782e-4d50-8360-52cca567c6ad&page=queryresults
[0m14:36:19.750962 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (execute): 14:36:18.704681 => 14:36:19.750597
[0m14:36:19.752441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3d48a9-a154-48ba-847e-a7554ab90234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb8df0>]}
[0m14:36:19.753690 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_option_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m14:36:19.754828 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_holdings
[0m14:36:19.757307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:19.757847 [debug] [MainThread]: Connection 'model.ccwj.current_option_holdings' was properly closed.
[0m14:36:19.758436 [info ] [MainThread]: 
[0m14:36:19.759011 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m14:36:19.760175 [debug] [MainThread]: Command end result
[0m14:36:19.779163 [info ] [MainThread]: 
[0m14:36:19.779903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:19.780537 [info ] [MainThread]: 
[0m14:36:19.781196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:36:19.785066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6955833, "process_user_time": 7.39264, "process_kernel_time": 0.566128, "process_mem_max_rss": "136183808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:19.786899 [debug] [MainThread]: Command `cli run` succeeded at 14:36:19.786213 after 6.70 seconds
[0m14:36:19.788262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109874f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d38460>]}
[0m14:36:19.789218 [debug] [MainThread]: Flushing usage events
[0m14:36:24.374507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb4ca0>]}


============================== 14:36:24.384695 | 92a3bace-602d-4fa5-aaea-fafea63a8ad9 ==============================
[0m14:36:24.384695 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:36:24.385701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:25.725332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02beb0>]}
[0m14:36:25.986574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd6f490>]}
[0m14:36:25.987908 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:36:26.027062 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:36:26.199405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:26.200260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:26.215986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c14b0d0>]}
[0m14:36:26.247007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c121b80>]}
[0m14:36:26.247984 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:36:26.251181 [info ] [MainThread]: 
[0m14:36:26.252661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:26.255322 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:36:26.257054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:28.115120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:36:28.116268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:28.392561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c121370>]}
[0m14:36:28.394834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:28.395846 [info ] [MainThread]: 
[0m14:36:28.419779 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m14:36:28.420776 [info ] [Thread-1  ]: 1 of 5 START seed file analytics.0417_current .................................. [RUN]
[0m14:36:28.422284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m14:36:28.423163 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m14:36:28.424321 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 14:36:28.423852 => 14:36:28.423858
[0m14:36:28.425212 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m14:36:28.492960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:36:32.262289 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:36:32.572753 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6d4b7a00-ece2-48ee-a6dd-42589d5e0534&page=queryresults
[0m14:36:32.874987 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:36:32.899187 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 14:36:28.425723 => 14:36:32.898587
[0m14:36:32.900899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d0b80>]}
[0m14:36:32.901742 [info ] [Thread-1  ]: 1 of 5 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.48s]
[0m14:36:32.903033 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m14:36:32.904393 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m14:36:32.905784 [info ] [Thread-3  ]: 2 of 5 START sql view model analytics.current .................................. [RUN]
[0m14:36:32.907743 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m14:36:32.908861 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m14:36:32.924361 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:36:32.926537 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 14:36:32.909441 => 14:36:32.926087
[0m14:36:32.927169 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m14:36:32.959563 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:36:32.960916 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:36:32.962173 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:36:33.416085 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4b91eb71-e1b6-4ea2-9675-3f11379486e1&page=queryresults
[0m14:36:33.733253 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 14:36:32.927531 => 14:36:33.732885
[0m14:36:33.734757 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bf970>]}
[0m14:36:33.735964 [info ] [Thread-3  ]: 2 of 5 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:36:33.737239 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m14:36:33.738649 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_holdings
[0m14:36:33.739279 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_holdings
[0m14:36:33.740112 [info ] [Thread-2  ]: 3 of 5 START sql view model analytics.current_equity_holdings .................. [RUN]
[0m14:36:33.740897 [info ] [Thread-1  ]: 4 of 5 START sql view model analytics.current_option_holdings .................. [RUN]
[0m14:36:33.742195 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_equity_holdings'
[0m14:36:33.743205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current_option_holdings)
[0m14:36:33.743814 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_holdings
[0m14:36:33.744499 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_holdings
[0m14:36:33.749475 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_holdings"
[0m14:36:33.753711 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_holdings"
[0m14:36:33.756145 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (compile): 14:36:33.749978 => 14:36:33.755641
[0m14:36:33.756926 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_holdings
[0m14:36:33.759708 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (compile): 14:36:33.744878 => 14:36:33.759219
[0m14:36:33.768257 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_holdings"
[0m14:36:33.769149 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_holdings
[0m14:36:33.775938 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_holdings"
[0m14:36:33.777069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:36:33.777964 [debug] [Thread-1  ]: On model.ccwj.current_option_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   cast(quantity as int) as option_quantity,
   price as option_price,
   market_value as option_market_value,
   cost_basis as option_cost_basis,
   gain_or_loss_dollar as option_gain_or_loss_dollar,
   security_type,
   margin_requirement as option_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Option';


[0m14:36:33.780181 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:36:33.780981 [debug] [Thread-2  ]: On model.ccwj.current_equity_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   cast(quantity as int) as equity_quantity,
   price as equity_price,
   market_value as equity_market_value,
   cost_basis as equity_cost_basis,
   gain_or_loss_dollar as equity_gain_or_loss_dollar,
   security_type,
   margin_requirement as equity_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Equity';


[0m14:36:34.336097 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5df33bfc-8f96-456a-b93a-39043a1a7bc8&page=queryresults
[0m14:36:34.340302 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c1770552-ddfd-45f1-b084-25397476b600&page=queryresults
[0m14:36:34.670992 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_holdings (execute): 14:36:33.757503 => 14:36:34.670533
[0m14:36:34.672577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2556d0>]}
[0m14:36:34.673519 [info ] [Thread-1  ]: 4 of 5 OK created sql view model analytics.current_option_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m14:36:34.674940 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_holdings
[0m14:36:34.680547 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_holdings (execute): 14:36:33.770132 => 14:36:34.680174
[0m14:36:34.681834 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e8c10>]}
[0m14:36:34.682833 [info ] [Thread-2  ]: 3 of 5 OK created sql view model analytics.current_equity_holdings ............. [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:36:34.684049 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_holdings
[0m14:36:34.685159 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_strategy
[0m14:36:34.685958 [info ] [Thread-3  ]: 5 of 5 START sql view model analytics.current_holdings_strategy ................ [RUN]
[0m14:36:34.687213 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_holdings_strategy)
[0m14:36:34.687872 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m14:36:34.693342 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m14:36:34.696213 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 14:36:34.688246 => 14:36:34.695723
[0m14:36:34.696885 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_strategy
[0m14:36:34.702197 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m14:36:34.703965 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:36:34.705034 [debug] [Thread-3  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
where symbol not in ('Cash','Account')
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   coalesce(current_option_holdings.option_quantity,0) as option_quantity,
   coalesce(current_equity_holdings.equity_quantity,0) as equity_quantity,
   case 
      when current_option_holdings.option_quantity*-100 = current_equity_holdings.equity_quantity then 'Covered Call'
      when current_option_holdings.option_quantity is null and current_equity_holdings.equity_quantity is not null then 'Buy and Hold'
      else 'Other'
   end as strategy 
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` 
      on current_holdings.symbol = current_equity_holdings.symbol
   left join `ccwj-dbt`.`analytics`.`current_option_holdings` 
      on current_holdings.symbol = current_option_holdings.symbol

)

select *
from holdings_strategy;


[0m14:36:35.228182 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a90b03aa-c333-426c-b924-f635e930b793&page=queryresults
[0m14:36:35.543815 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 14:36:34.697264 => 14:36:35.543426
[0m14:36:35.545268 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3bace-602d-4fa5-aaea-fafea63a8ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1b9c40>]}
[0m14:36:35.546216 [info ] [Thread-3  ]: 5 of 5 OK created sql view model analytics.current_holdings_strategy ........... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m14:36:35.547376 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_strategy
[0m14:36:35.550185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:35.550744 [debug] [MainThread]: Connection 'model.ccwj.current_option_holdings' was properly closed.
[0m14:36:35.551211 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m14:36:35.551664 [debug] [MainThread]: Connection 'model.ccwj.current_equity_holdings' was properly closed.
[0m14:36:35.552212 [info ] [MainThread]: 
[0m14:36:35.552769 [info ] [MainThread]: Finished running 1 seed, 4 view models in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m14:36:35.554891 [debug] [MainThread]: Command end result
[0m14:36:35.579808 [info ] [MainThread]: 
[0m14:36:35.580691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:35.581356 [info ] [MainThread]: 
[0m14:36:35.582062 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:36:35.584281 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.341577, "process_user_time": 5.212218, "process_kernel_time": 0.550276, "process_mem_max_rss": "130342912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:35.585180 [debug] [MainThread]: Command `cli build` succeeded at 14:36:35.584971 after 11.34 seconds
[0m14:36:35.585816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c119f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be466a0>]}
[0m14:36:35.586613 [debug] [MainThread]: Flushing usage events
[0m14:37:31.455143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f361d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e757c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e66eb0>]}


============================== 14:37:31.465231 | 845284c6-8bf6-4007-a4dc-ea8fd6094a43 ==============================
[0m14:37:31.465231 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:37:31.466529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:37:32.660533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2eee0>]}
[0m14:37:32.835994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbb160>]}
[0m14:37:32.838023 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:37:32.869687 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:37:32.901774 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:37:32.903405 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:37:32.904738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d82250>]}
[0m14:37:35.718617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123950d0>]}
[0m14:37:35.746130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f54ca0>]}
[0m14:37:35.746978 [info ] [MainThread]: Found 19 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:37:35.747622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f54f70>]}
[0m14:37:35.749857 [info ] [MainThread]: 
[0m14:37:35.751323 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:37:35.755740 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:37:35.756956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:38.162989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:37:38.164052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:38.420266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112395e50>]}
[0m14:37:38.422127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:38.423074 [info ] [MainThread]: 
[0m14:37:38.428180 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_strategy
[0m14:37:38.429093 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_strategy ................ [RUN]
[0m14:37:38.430563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_strategy)
[0m14:37:38.431330 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m14:37:38.458427 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m14:37:38.461126 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 14:37:38.431801 => 14:37:38.460115
[0m14:37:38.461919 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_strategy
[0m14:37:38.515850 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m14:37:38.517101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:37:38.518033 [debug] [Thread-1  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
where symbol not in ('Cash','Account')
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   coalesce(current_option_holdings.option_quantity,0) as option_quantity,
   coalesce(current_equity_holdings.equity_quantity,0) as equity_quantity,
   case 
      when current_option_holdings.option_quantity*-100 = current_equity_holdings.equity_quantity then 'Covered Call'
      when current_option_holdings.option_quantity is null and current_equity_holdings.equity_quantity is not null then 'Buy and Hold'
      else 'Other'
   end as strategy 
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` 
      on current_holdings.symbol = current_equity_holdings.symbol
   left join `ccwj-dbt`.`analytics`.`current_option_holdings` 
      on current_holdings.symbol = current_option_holdings.symbol

)

select *
from holdings_strategy;


[0m14:37:39.004953 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8530e9a0-0201-4306-9177-9c42e390e0ff&page=queryresults
[0m14:37:39.354109 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 14:37:38.462394 => 14:37:39.353468
[0m14:37:39.355521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845284c6-8bf6-4007-a4dc-ea8fd6094a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bddf0>]}
[0m14:37:39.356643 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_strategy ........... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m14:37:39.357664 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_strategy
[0m14:37:39.360179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:39.360707 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m14:37:39.361228 [info ] [MainThread]: 
[0m14:37:39.361795 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m14:37:39.363058 [debug] [MainThread]: Command end result
[0m14:37:39.382203 [info ] [MainThread]: 
[0m14:37:39.383015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:39.383626 [info ] [MainThread]: 
[0m14:37:39.384247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:37:39.387021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.085051, "process_user_time": 7.393589, "process_kernel_time": 0.732594, "process_mem_max_rss": "136343552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:39.388685 [debug] [MainThread]: Command `cli run` succeeded at 14:37:39.388222 after 8.09 seconds
[0m14:37:39.389749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f361d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11246adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f54ca0>]}
[0m14:37:39.391005 [debug] [MainThread]: Flushing usage events
[0m15:08:29.922358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8071c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2cddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d317a00>]}


============================== 15:08:29.930944 | 528ab6d6-e6ff-4e40-a381-8e578e438cce ==============================
[0m15:08:29.930944 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:08:29.932243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:30.915610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '528ab6d6-e6ff-4e40-a381-8e578e438cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e125730>]}
[0m15:08:31.072041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '528ab6d6-e6ff-4e40-a381-8e578e438cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac8d60>]}
[0m15:08:31.074121 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:08:31.104677 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m15:08:31.127443 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:08:31.128240 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m15:08:31.129200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '528ab6d6-e6ff-4e40-a381-8e578e438cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c4d30>]}
[0m15:08:33.324011 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ccwj.history' (models/groomed/history.sql) depends on a node named '0417_history' which was not found
[0m15:08:33.328114 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 3.519117, "process_user_time": 6.379935, "process_kernel_time": 0.582547, "process_mem_max_rss": "126013440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:33.329260 [debug] [MainThread]: Command `cli build` failed at 15:08:33.328900 after 3.52 seconds
[0m15:08:33.330017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8071c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e62dee0>]}
[0m15:08:33.330886 [debug] [MainThread]: Flushing usage events
[0m15:09:27.626260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffeba00>]}


============================== 15:09:27.634219 | 1b062c11-45f2-41b4-b889-d53d9bd3ef8b ==============================
[0m15:09:27.634219 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:09:27.635196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:09:28.551837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dfa730>]}
[0m15:09:28.705301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dcbe20>]}
[0m15:09:28.707320 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:09:28.737569 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m15:09:28.760827 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:09:28.761823 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m15:09:28.762750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcb070>]}
[0m15:09:31.060002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111531e50>]}
[0m15:09:31.170804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e51250>]}
[0m15:09:31.172894 [info ] [MainThread]: Found 21 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:09:31.177228 [info ] [MainThread]: 
[0m15:09:31.178766 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:31.180944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:09:31.181766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:34.402010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:09:34.403125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:34.716354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115315b0>]}
[0m15:09:34.717787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:34.718486 [info ] [MainThread]: 
[0m15:09:34.723435 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m15:09:34.724136 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m15:09:34.725615 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m15:09:34.726395 [info ] [Thread-1  ]: 1 of 8 START sql view model analytics.calendar_dates ........................... [RUN]
[0m15:09:34.729302 [info ] [Thread-2  ]: 2 of 8 START seed file analytics.0417_current .................................. [RUN]
[0m15:09:34.732408 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m15:09:34.733290 [info ] [Thread-4  ]: 4 of 8 START seed file analytics.cflt_prices ................................... [RUN]
[0m15:09:34.734487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m15:09:34.735674 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m15:09:34.736406 [info ] [Thread-3  ]: 3 of 8 START seed file analytics.0417_history .................................. [RUN]
[0m15:09:34.737559 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m15:09:34.738271 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m15:09:34.739737 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m15:09:34.741361 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m15:09:34.742465 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m15:09:34.754415 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m15:09:34.755207 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 15:09:34.754829 => 15:09:34.754833
[0m15:09:34.755837 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m15:09:34.756696 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 15:09:34.756295 => 15:09:34.756316
[0m15:09:34.758455 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m15:09:34.759775 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 15:09:34.759197 => 15:09:34.759203
[0m15:09:34.760614 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m15:09:34.773186 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 15:09:34.743142 => 15:09:34.772694
[0m15:09:34.788876 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m15:09:34.812025 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m15:09:34.811356 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:09:34.822757 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:09:34.886459 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m15:09:34.910185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:34.923090 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m15:09:34.978966 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:09:35.461994 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c2878b68-7698-4e93-b0dd-3e1219431f1e&page=queryresults
[0m15:09:35.837138 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 15:09:34.827595 => 15:09:35.836783
[0m15:09:35.838450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11154cf10>]}
[0m15:09:35.839621 [info ] [Thread-1  ]: 1 of 8 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:09:35.840761 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m15:09:38.440554 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m15:09:38.488032 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m15:09:38.742378 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:397dc120-0db5-4888-8536-d5eebcbb8c6d&page=queryresults
[0m15:09:38.779486 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ae140b73-1791-4020-9050-ed51e5cf5b73&page=queryresults
[0m15:09:38.854990 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m15:09:39.065928 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m15:09:39.070562 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 15:09:34.761215 => 15:09:39.070196
[0m15:09:39.071748 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f2970>]}
[0m15:09:39.072577 [info ] [Thread-2  ]: 2 of 8 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.34s]
[0m15:09:39.073602 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m15:09:39.074747 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m15:09:39.075546 [info ] [Thread-1  ]: 5 of 8 START sql view model analytics.current .................................. [RUN]
[0m15:09:39.076868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m15:09:39.077564 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m15:09:39.087163 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m15:09:39.089308 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 15:09:39.078122 => 15:09:39.088906
[0m15:09:39.090047 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m15:09:39.096210 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m15:09:39.097437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:39.098640 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m15:09:39.114018 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f36c8f1e-c2b4-4d19-abe8-4134c2c761fe&page=queryresults
[0m15:09:39.171450 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m15:09:39.177997 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 15:09:34.795235 => 15:09:39.177613
[0m15:09:39.179218 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e515e0>]}
[0m15:09:39.180078 [info ] [Thread-4  ]: 4 of 8 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 198[0m in 4.44s]
[0m15:09:39.181248 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m15:09:39.411391 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m15:09:39.429056 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 15:09:34.823193 => 15:09:39.428478
[0m15:09:39.430584 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111544e20>]}
[0m15:09:39.431585 [info ] [Thread-3  ]: 3 of 8 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 4.69s]
[0m15:09:39.432744 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m15:09:39.433733 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m15:09:39.434732 [info ] [Thread-2  ]: 6 of 8 START sql view model analytics.history .................................. [RUN]
[0m15:09:39.436320 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m15:09:39.437100 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m15:09:39.442429 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m15:09:39.443833 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 15:09:39.437604 => 15:09:39.443330
[0m15:09:39.444493 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m15:09:39.449946 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m15:09:39.451095 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:09:39.451959 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m15:09:39.517904 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cd434d1a-3288-48e9-944e-424c66aa9754&page=queryresults
[0m15:09:39.842631 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 15:09:39.090611 => 15:09:39.842133
[0m15:09:39.843974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193d730>]}
[0m15:09:39.844919 [info ] [Thread-1  ]: 5 of 8 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m15:09:39.845944 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m15:09:39.846980 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m15:09:39.847738 [info ] [Thread-3  ]: 7 of 8 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m15:09:39.848910 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m15:09:39.849648 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m15:09:39.855550 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m15:09:39.858281 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 15:09:39.850309 => 15:09:39.857860
[0m15:09:39.858924 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m15:09:39.864575 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m15:09:39.865782 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:09:39.866531 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m15:09:39.945944 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c43501c3-d679-4dcf-b434-a749bc402c7a&page=queryresults
[0m15:09:40.257816 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 15:09:39.444892 => 15:09:40.257373
[0m15:09:40.259062 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111817280>]}
[0m15:09:40.260168 [info ] [Thread-2  ]: 6 of 8 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m15:09:40.261423 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m15:09:40.413941 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c2c8b273-5d70-4ce6-9885-8c30170e3baa&page=queryresults
[0m15:09:40.738939 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 15:09:39.859312 => 15:09:40.738546
[0m15:09:40.740153 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11195f190>]}
[0m15:09:40.741127 [info ] [Thread-3  ]: 7 of 8 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m15:09:40.742382 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m15:09:40.743825 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_historical_earnings
[0m15:09:40.744787 [info ] [Thread-1  ]: 8 of 8 START sql view model analytics.current_option_historical_earnings ....... [RUN]
[0m15:09:40.746019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_option_historical_earnings)
[0m15:09:40.746692 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m15:09:40.757122 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m15:09:40.758382 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 15:09:40.747118 => 15:09:40.757997
[0m15:09:40.759101 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m15:09:40.764921 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m15:09:40.766169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:40.767060 [debug] [Thread-1  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Option'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m15:09:41.250083 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3a91bab2-a9fb-4090-a4b3-54ce4cdbec28&page=queryresults
[0m15:09:41.616889 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 15:09:40.759573 => 15:09:41.616539
[0m15:09:41.618075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b062c11-45f2-41b4-b889-d53d9bd3ef8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111976af0>]}
[0m15:09:41.618965 [info ] [Thread-1  ]: 8 of 8 OK created sql view model analytics.current_option_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m15:09:41.619978 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m15:09:41.622579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:41.623293 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m15:09:41.623864 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m15:09:41.624341 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m15:09:41.624860 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m15:09:41.625467 [info ] [MainThread]: 
[0m15:09:41.626129 [info ] [MainThread]: Finished running 5 view models, 3 seeds in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m15:09:41.629287 [debug] [MainThread]: Command end result
[0m15:09:41.646384 [info ] [MainThread]: 
[0m15:09:41.647077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:41.647637 [info ] [MainThread]: 
[0m15:09:41.648302 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:09:41.651597 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.125267, "process_user_time": 7.36618, "process_kernel_time": 0.672035, "process_mem_max_rss": "144556032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:41.652912 [debug] [MainThread]: Command `cli build` succeeded at 15:09:41.652603 after 14.13 seconds
[0m15:09:41.653978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e51700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11151ea30>]}
[0m15:09:41.654750 [debug] [MainThread]: Flushing usage events
[0m15:10:48.745010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d4cd0>]}


============================== 15:10:48.754181 | 8626c68e-bc87-4064-bf55-d6b31d946f61 ==============================
[0m15:10:48.754181 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:10:48.755282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:49.739863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a16d0>]}
[0m15:10:49.906544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105680310>]}
[0m15:10:49.908467 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:10:49.937544 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m15:10:50.067945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:50.068763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:50.082087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8a0d0>]}
[0m15:10:50.111424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b0550>]}
[0m15:10:50.112305 [info ] [MainThread]: Found 21 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:10:50.115192 [info ] [MainThread]: 
[0m15:10:50.116740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:10:50.118954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:10:50.119916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:52.087291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:10:52.088385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:52.387203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056aa730>]}
[0m15:10:52.388968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:52.389872 [info ] [MainThread]: 
[0m15:10:52.394173 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_history
[0m15:10:52.395111 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m15:10:52.396478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_history)
[0m15:10:52.397261 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_history
[0m15:10:52.398136 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (compile): 15:10:52.397734 => 15:10:52.397739
[0m15:10:52.398765 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_history
[0m15:10:52.565789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:56.731329 [debug] [Thread-1  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m15:10:57.226160 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d77d978a-b4c4-46da-9fdf-52099007378f&page=queryresults
[0m15:10:57.652750 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m15:10:57.675265 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (execute): 15:10:52.399447 => 15:10:57.674912
[0m15:10:57.676723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0f9a0>]}
[0m15:10:57.677675 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 5.28s]
[0m15:10:57.678812 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_history
[0m15:10:57.680499 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m15:10:57.681415 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.history .................................. [RUN]
[0m15:10:57.682966 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m15:10:57.683674 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m15:10:57.698531 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m15:10:57.699853 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 15:10:57.684067 => 15:10:57.699411
[0m15:10:57.700476 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m15:10:57.732719 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m15:10:57.733939 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:10:57.734732 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m15:10:58.221724 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a86231db-edef-443c-8cc0-81295149e1a4&page=queryresults
[0m15:10:58.549962 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 15:10:57.700852 => 15:10:58.549571
[0m15:10:58.551478 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc6f70>]}
[0m15:10:58.552503 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m15:10:58.553557 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m15:10:58.554748 [debug] [Thread-2  ]: Began running node model.ccwj.test
[0m15:10:58.555599 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.test ..................................... [RUN]
[0m15:10:58.556873 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.test'
[0m15:10:58.557545 [debug] [Thread-2  ]: Began compiling node model.ccwj.test
[0m15:10:58.563110 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.test"
[0m15:10:58.564501 [debug] [Thread-2  ]: Timing info for model.ccwj.test (compile): 15:10:58.557949 => 15:10:58.564102
[0m15:10:58.565119 [debug] [Thread-2  ]: Began executing node model.ccwj.test
[0m15:10:58.570690 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.test"
[0m15:10:58.571820 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:10:58.572850 [debug] [Thread-2  ]: On model.ccwj.test: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.test"} */


  create or replace view `ccwj-dbt`.`analytics`.`test`
  OPTIONS()
  as select distinct action
from `ccwj-dbt`.`analytics`.`history`;


[0m15:10:59.107049 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a6c0fe93-27d4-41ea-8290-b910949c3f1a&page=queryresults
[0m15:10:59.436749 [debug] [Thread-2  ]: Timing info for model.ccwj.test (execute): 15:10:58.565589 => 15:10:59.436383
[0m15:10:59.438221 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8626c68e-bc87-4064-bf55-d6b31d946f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e01fd0>]}
[0m15:10:59.440372 [info ] [Thread-2  ]: 3 of 3 OK created sql view model analytics.test ................................ [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m15:10:59.442856 [debug] [Thread-2  ]: Finished running node model.ccwj.test
[0m15:10:59.447717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:59.448684 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m15:10:59.449413 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m15:10:59.450223 [debug] [MainThread]: Connection 'model.ccwj.test' was properly closed.
[0m15:10:59.451325 [info ] [MainThread]: 
[0m15:10:59.452555 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m15:10:59.455960 [debug] [MainThread]: Command end result
[0m15:10:59.482778 [info ] [MainThread]: 
[0m15:10:59.483809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:59.484681 [info ] [MainThread]: 
[0m15:10:59.485353 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:10:59.488008 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.850749, "process_user_time": 5.055401, "process_kernel_time": 0.58485, "process_mem_max_rss": "132001792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:59.488954 [debug] [MainThread]: Command `cli build` succeeded at 15:10:59.488738 after 10.85 seconds
[0m15:10:59.489607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105680310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a16d0>]}
[0m15:10:59.490423 [debug] [MainThread]: Flushing usage events
[0m15:11:34.845045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117aa7f0>]}


============================== 15:11:34.854594 | 35c4ef4b-b222-43ef-8609-7709f468cde4 ==============================
[0m15:11:34.854594 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:11:34.855674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:11:35.913128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bba30>]}
[0m15:11:36.109660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261d6a0>]}
[0m15:11:36.111491 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:11:36.148955 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m15:11:36.246680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:36.247654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:36.263383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129490d0>]}
[0m15:11:36.291431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11278c430>]}
[0m15:11:36.292530 [info ] [MainThread]: Found 21 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:11:36.293533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11278cb80>]}
[0m15:11:36.296594 [info ] [MainThread]: 
[0m15:11:36.298326 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:11:36.300401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:11:36.301910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:39.033387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:11:39.034978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:39.294097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112915fd0>]}
[0m15:11:39.295818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:39.296560 [info ] [MainThread]: 
[0m15:11:39.302500 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m15:11:39.303720 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m15:11:39.305708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_equity_historical_earnings)
[0m15:11:39.306605 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m15:11:39.325790 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m15:11:39.329312 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 15:11:39.307094 => 15:11:39.328688
[0m15:11:39.330210 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m15:11:39.397403 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m15:11:39.398988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:11:39.400139 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m15:11:40.028674 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:506035fc-70f0-4fcb-8b8b-e08fcf6d2efc&page=queryresults
[0m15:11:40.374342 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 15:11:39.330737 => 15:11:40.373935
[0m15:11:40.375827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35c4ef4b-b222-43ef-8609-7709f468cde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fb4c0>]}
[0m15:11:40.376867 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m15:11:40.378070 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m15:11:40.382130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:40.383301 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m15:11:40.383993 [info ] [MainThread]: 
[0m15:11:40.384919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m15:11:40.386132 [debug] [MainThread]: Command end result
[0m15:11:40.407534 [info ] [MainThread]: 
[0m15:11:40.409289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:40.410625 [info ] [MainThread]: 
[0m15:11:40.411804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:11:40.416013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6826034, "process_user_time": 4.874588, "process_kernel_time": 0.605036, "process_mem_max_rss": "129069056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:40.417018 [debug] [MainThread]: Command `cli run` succeeded at 15:11:40.416797 after 5.68 seconds
[0m15:11:40.417926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112517430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bba30>]}
[0m15:11:40.418708 [debug] [MainThread]: Flushing usage events
[0m14:11:24.327778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf8f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfbed60>]}


============================== 14:11:24.339657 | ab7bf309-6ccc-4934-a9a5-465cbd76adda ==============================
[0m14:11:24.339657 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:11:24.341327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:25.487606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7d700>]}
[0m14:11:25.661345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd7bfa0>]}
[0m14:11:25.663227 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:11:25.699591 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:11:25.729257 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:11:25.730601 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:11:25.731537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf66ac0>]}
[0m14:11:30.531102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a30d0>]}
[0m14:11:30.582447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b8070>]}
[0m14:11:30.584131 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:11:30.585738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1500a0>]}
[0m14:11:30.589928 [info ] [MainThread]: 
[0m14:11:30.592755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:30.595478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:11:30.597087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:34.710962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:11:34.714096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:35.127442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a3c40>]}
[0m14:11:35.136915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:35.142588 [info ] [MainThread]: 
[0m14:11:35.191132 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:11:35.192956 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m14:11:35.197049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_earnings)
[0m14:11:35.198729 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:11:35.274643 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:11:35.279983 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:11:35.199801 => 14:11:35.278739
[0m14:11:35.282110 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:11:35.526695 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:11:35.530646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:35.532532 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`;


[0m14:11:36.441662 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c2ec544b-35cb-4d86-b277-f86dc1324f45&page=queryresults
[0m14:11:36.996105 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:11:35.283415 => 14:11:36.995673
[0m14:11:37.004206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab7bf309-6ccc-4934-a9a5-465cbd76adda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65db50>]}
[0m14:11:37.024837 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m14:11:37.027556 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:11:37.032837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:37.034249 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:11:37.035744 [info ] [MainThread]: 
[0m14:11:37.036935 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m14:11:37.039037 [debug] [MainThread]: Command end result
[0m14:11:37.100214 [info ] [MainThread]: 
[0m14:11:37.104571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:37.106495 [info ] [MainThread]: 
[0m14:11:37.107958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:37.116180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.935279, "process_user_time": 8.527192, "process_kernel_time": 0.86463, "process_mem_max_rss": "136798208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:37.118019 [debug] [MainThread]: Command `cli run` succeeded at 14:11:37.117619 after 12.94 seconds
[0m14:11:37.123766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b8070>]}
[0m14:11:37.124961 [debug] [MainThread]: Flushing usage events
[0m14:13:42.261315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef4a00>]}


============================== 14:13:42.270964 | 68850c0e-9d60-4bdb-8c4a-23867af1e118 ==============================
[0m14:13:42.270964 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:13:42.272395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:43.387663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaa3a0>]}
[0m14:13:43.564538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae922e0>]}
[0m14:13:43.566465 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:13:43.599764 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:13:43.629457 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:13:43.630711 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:13:43.631821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb8310>]}
[0m14:13:46.014722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c8f40>]}
[0m14:13:46.040163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be88bb0>]}
[0m14:13:46.041061 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:13:46.044407 [info ] [MainThread]: 
[0m14:13:46.045884 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:13:46.048208 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:13:46.049029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:48.084299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:13:48.085502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:48.382869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c83a0>]}
[0m14:13:48.385178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:13:48.386231 [info ] [MainThread]: 
[0m14:13:48.391393 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:13:48.392107 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:13:48.392934 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:13:48.393627 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:13:48.394475 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:13:48.395612 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:13:48.396581 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:13:48.397485 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:13:48.398764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:13:48.400032 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:13:48.401761 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:13:48.403756 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:13:48.405128 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:13:48.405930 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:13:48.406586 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:13:48.407212 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:13:48.421259 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:13:48.422244 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:13:48.421808 => 14:13:48.421815
[0m14:13:48.423236 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:13:48.422832 => 14:13:48.422837
[0m14:13:48.424428 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:13:48.423866 => 14:13:48.423872
[0m14:13:48.425635 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:13:48.426746 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:13:48.427726 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:13:48.433935 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:13:48.407644 => 14:13:48.433473
[0m14:13:48.509813 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:13:48.552612 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:13:48.576676 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:13:48.675400 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:13:48.681781 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:13:48.687267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:48.688096 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:13:49.117833 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9cda7d52-9d43-4e00-9048-f49223699c84&page=queryresults
[0m14:13:49.484642 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:13:48.602069 => 14:13:49.484256
[0m14:13:49.485940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7789d0>]}
[0m14:13:49.486908 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m14:13:49.488003 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:13:52.249371 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:13:52.271070 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:13:52.349367 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:13:52.564815 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:844cfb19-70ae-44d3-9228-a2ffa2a7dced&page=queryresults
[0m14:13:52.621612 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f69547b1-abbd-4dab-8df9-2ea63ba2a2a2&page=queryresults
[0m14:13:52.627738 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a11969b7-1ac3-43ae-a784-40846ee4ddd6&page=queryresults
[0m14:13:52.908631 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:13:52.913801 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:13:48.510295 => 14:13:52.913469
[0m14:13:52.914846 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c56e280>]}
[0m14:13:52.915605 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 198[0m in 4.51s]
[0m14:13:52.916618 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:13:52.980517 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:13:52.986487 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:13:48.428217 => 14:13:52.986088
[0m14:13:52.988580 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5989a0>]}
[0m14:13:52.989507 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.59s]
[0m14:13:52.991128 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:13:52.993428 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:13:52.994647 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:13:52.995414 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:13:52.996863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:13:52.997684 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:13:53.006738 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:13:48.451832 => 14:13:53.006378
[0m14:13:53.008477 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:13:53.009727 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3db4c0>]}
[0m14:13:53.010721 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.61s]
[0m14:13:53.012289 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:13:53.013205 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:13:52.998246 => 14:13:53.012851
[0m14:13:53.014177 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m14:13:53.015048 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:13:53.016288 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:13:53.024940 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:13:53.026624 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m14:13:53.027883 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m14:13:53.038912 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:13:53.039929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:53.041377 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:13:53.044170 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 14:13:53.028616 => 14:13:53.043544
[0m14:13:53.045809 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m14:13:53.055495 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:13:53.056905 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:13:53.057687 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:13:53.537961 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:edb8e16f-fa10-4885-82e6-48e3244f21df&page=queryresults
[0m14:13:53.568957 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6fd78e06-67c5-469c-abe5-4ce68bd87ba6&page=queryresults
[0m14:13:53.870693 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 14:13:53.046607 => 14:13:53.870064
[0m14:13:53.871979 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c772f70>]}
[0m14:13:53.872905 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:13:53.874248 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m14:13:53.979158 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:13:53.017557 => 14:13:53.978605
[0m14:13:53.980648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b4c70>]}
[0m14:13:53.981738 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:13:53.982838 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:13:53.984208 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:13:53.985488 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:13:53.987018 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m14:13:53.987696 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:13:53.992537 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:13:53.996611 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:13:53.988069 => 14:13:53.996183
[0m14:13:53.997248 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:13:54.005809 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:13:54.007310 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:13:54.008105 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:13:54.615864 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3335d44d-0885-46b3-ad55-c6a406826a17&page=queryresults
[0m14:13:54.935745 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:13:53.997621 => 14:13:54.935296
[0m14:13:54.937577 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8524f0>]}
[0m14:13:54.938564 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m14:13:54.939676 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:13:54.941061 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:13:54.941898 [info ] [Thread-2  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:13:54.942806 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:13:54.944058 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_equity_historical_earnings)
[0m14:13:54.945168 [info ] [Thread-1  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:13:54.945982 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:13:54.947072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_option_historical_earnings)
[0m14:13:54.953837 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:13:54.954516 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:13:54.959710 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:13:54.960857 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:13:54.947544 => 14:13:54.960487
[0m14:13:54.961651 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:13:54.955064 => 14:13:54.961233
[0m14:13:54.962563 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:13:54.963561 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:13:54.970021 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:13:54.976387 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:13:54.977750 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:13:54.978374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:54.979147 [debug] [Thread-2  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
   

   and calendar_symbol_dates.symbol = 'CFLT'
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:13:54.980056 [debug] [Thread-1  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m14:13:55.594639 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5c3618ea-7d1a-4d07-b582-480aa5e76433&page=queryresults
[0m14:13:55.652362 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8c8723e5-5c61-4ccd-9587-a369168bf8de&page=queryresults
[0m14:13:55.905184 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:13:54.964189 => 14:13:55.904591
[0m14:13:55.906625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c855d30>]}
[0m14:13:55.907594 [info ] [Thread-2  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:13:55.909064 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:13:55.976398 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:13:54.970502 => 14:13:55.975951
[0m14:13:55.977885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84d280>]}
[0m14:13:55.978811 [info ] [Thread-1  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m14:13:55.979852 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:13:55.981052 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:13:55.981935 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m14:13:55.983281 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m14:13:55.984215 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:13:55.989770 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:13:55.991405 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:13:55.984845 => 14:13:55.991020
[0m14:13:55.992014 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:13:56.002345 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:13:56.003548 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:13:56.004304 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`;


[0m14:13:56.633032 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:703ae4e0-7934-424b-ae02-f920139208c1&page=queryresults
[0m14:13:56.954829 [debug] [Thread-3  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name historical_equity_holdings not found inside current_option_historical_earnings at [18:40]; reason: invalidQuery, location: query, message: Name historical_equity_holdings not found inside current_option_historical_earnings at [18:40]')
[0m14:13:57.801934 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6c82b784-9d90-4ab7-b841-2d899ecd5c00&page=queryresults
[0m14:13:58.125121 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6c82b784-9d90-4ab7-b841-2d899ecd5c00&page=queryresults
[0m14:13:58.126632 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:13:55.992375 => 14:13:58.126118
[0m14:13:58.147362 [debug] [Thread-3  ]: Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name historical_equity_holdings not found inside current_option_historical_earnings at [18:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m14:13:58.148289 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68850c0e-9d60-4bdb-8c4a-23867af1e118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c82e6a0>]}
[0m14:13:58.149280 [error] [Thread-3  ]: 10 of 10 ERROR creating sql view model analytics.current_holdings_historical_earnings  [[31mERROR[0m in 2.17s]
[0m14:13:58.150804 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:13:58.153451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:58.154006 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:13:58.154518 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:13:58.155023 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:13:58.155843 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m14:13:58.156864 [info ] [MainThread]: 
[0m14:13:58.157734 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 12.11 seconds (12.11s).
[0m14:13:58.161827 [debug] [MainThread]: Command end result
[0m14:13:58.180396 [info ] [MainThread]: 
[0m14:13:58.181372 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:13:58.182090 [info ] [MainThread]: 
[0m14:13:58.182699 [error] [MainThread]:   Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name historical_equity_holdings not found inside current_option_historical_earnings at [18:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m14:13:58.183636 [info ] [MainThread]: 
[0m14:13:58.184672 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m14:13:58.189553 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 16.209246, "process_user_time": 8.001081, "process_kernel_time": 0.778035, "process_mem_max_rss": "148873216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:13:58.190576 [debug] [MainThread]: Command `cli build` failed at 14:13:58.190362 after 16.21 seconds
[0m14:13:58.191224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3db3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c83d0>]}
[0m14:13:58.191811 [debug] [MainThread]: Flushing usage events
[0m14:14:22.043141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033324f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e417f0>]}


============================== 14:14:22.052752 | 7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a ==============================
[0m14:14:22.052752 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:14:22.054478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:23.159858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df8d90>]}
[0m14:14:23.340557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bae670>]}
[0m14:14:23.342126 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:14:23.378590 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:14:23.405807 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:23.406687 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:14:23.407718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7bb50>]}
[0m14:14:25.912526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631d0d0>]}
[0m14:14:25.935586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2afd0>]}
[0m14:14:25.936409 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:14:25.937095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faad00>]}
[0m14:14:25.939392 [info ] [MainThread]: 
[0m14:14:25.940837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:14:25.942936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:14:25.944165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:27.779773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:14:27.782158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:28.047081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631dbe0>]}
[0m14:14:28.048704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:28.049618 [info ] [MainThread]: 
[0m14:14:28.053790 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:14:28.054848 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m14:14:28.056182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_earnings)
[0m14:14:28.056969 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:14:28.077210 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:14:28.079647 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:14:28.057424 => 14:14:28.079057
[0m14:14:28.080431 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:14:28.141614 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:14:28.143347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:14:28.144582 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`;


[0m14:14:28.771755 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c9ec2a62-fe22-4557-8a2e-a82cc5622834&page=queryresults
[0m14:14:29.123985 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:14:28.080905 => 14:14:29.123566
[0m14:14:29.125381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc5dc5e-d84c-49fc-8a86-60c7c5c9b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d8af0>]}
[0m14:14:29.126455 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:14:29.127937 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:14:29.131075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:29.131772 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:14:29.132393 [info ] [MainThread]: 
[0m14:14:29.133048 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m14:14:29.134523 [debug] [MainThread]: Command end result
[0m14:14:29.161260 [info ] [MainThread]: 
[0m14:14:29.162029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:29.162757 [info ] [MainThread]: 
[0m14:14:29.163648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:14:29.166026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.258291, "process_user_time": 7.853748, "process_kernel_time": 0.60715, "process_mem_max_rss": "136822784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:29.167244 [debug] [MainThread]: Command `cli run` succeeded at 14:14:29.166977 after 7.26 seconds
[0m14:14:29.168225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033324f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f211c0>]}
[0m14:14:29.169074 [debug] [MainThread]: Flushing usage events
[0m14:22:36.138855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107461d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074aab20>]}


============================== 14:22:36.146884 | 0f23cee1-b0d1-4a2a-9ebd-f84b488eb693 ==============================
[0m14:22:36.146884 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:22:36.148187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:37.051792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074617f0>]}
[0m14:22:37.218770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822b490>]}
[0m14:22:37.220713 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:22:37.251266 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:22:37.277461 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:22:37.278325 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:22:37.279209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828a4f0>]}
[0m14:22:39.980384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897fdc0>]}
[0m14:22:40.007153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858a070>]}
[0m14:22:40.008049 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:22:40.008788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858aca0>]}
[0m14:22:40.011729 [info ] [MainThread]: 
[0m14:22:40.013550 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:40.015465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:22:40.016319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.838896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:22:41.840144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:42.111869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899aee0>]}
[0m14:22:42.114060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:42.115714 [info ] [MainThread]: 
[0m14:22:42.120824 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:22:42.122084 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m14:22:42.124028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_earnings)
[0m14:22:42.125421 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:22:42.147556 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:22:42.150608 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:22:42.126175 => 14:22:42.149614
[0m14:22:42.151627 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:22:42.218577 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:22:42.220195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:22:42.221240 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:22:42.791957 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d3f4483-217a-428a-98b8-c90d0f9f2ea4&page=queryresults
[0m14:22:43.120867 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:22:42.152634 => 14:22:43.120373
[0m14:22:43.122318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f23cee1-b0d1-4a2a-9ebd-f84b488eb693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac4b80>]}
[0m14:22:43.123385 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m14:22:43.125162 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:22:43.127976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:43.128578 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:22:43.129152 [info ] [MainThread]: 
[0m14:22:43.129789 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m14:22:43.131412 [debug] [MainThread]: Command end result
[0m14:22:43.159185 [info ] [MainThread]: 
[0m14:22:43.160422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:43.161453 [info ] [MainThread]: 
[0m14:22:43.162443 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:22:43.166818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1239395, "process_user_time": 7.304883, "process_kernel_time": 0.590923, "process_mem_max_rss": "136462336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:43.167968 [debug] [MainThread]: Command `cli run` succeeded at 14:22:43.167662 after 7.13 seconds
[0m14:22:43.168972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858a160>]}
[0m14:22:43.170076 [debug] [MainThread]: Flushing usage events
[0m14:32:12.955668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac7ca0>]}


============================== 14:32:12.964544 | 52ecc6e8-723d-447b-a685-65e1274f272e ==============================
[0m14:32:12.964544 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:32:12.965945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:32:13.951139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7ddf0>]}
[0m14:32:14.104579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108740a0>]}
[0m14:32:14.106041 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:32:14.133559 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:32:14.156430 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:32:14.157250 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:32:14.157932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095b460>]}
[0m14:32:16.428010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9f0d0>]}
[0m14:32:16.455417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba5220>]}
[0m14:32:16.456496 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:32:16.459258 [info ] [MainThread]: 
[0m14:32:16.460777 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:16.462494 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:32:16.463226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:18.498202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:32:18.499788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:18.776676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f9fdc0>]}
[0m14:32:18.778543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:18.779728 [info ] [MainThread]: 
[0m14:32:18.785796 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:32:18.786833 [info ] [Thread-1  ]: 1 of 2 START sql view model analytics.current_option_historical_earnings ....... [RUN]
[0m14:32:18.788930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_option_historical_earnings)
[0m14:32:18.789856 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:32:18.805962 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:32:18.808096 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:32:18.790320 => 14:32:18.807635
[0m14:32:18.808762 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:32:18.862492 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:32:18.863759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:32:18.864697 [debug] [Thread-1  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m14:32:19.515372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d962951c-ea7b-4b78-9678-e35e19573dd7&page=queryresults
[0m14:32:19.860566 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:32:18.809176 => 14:32:19.860192
[0m14:32:19.861858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117e7f0>]}
[0m14:32:19.862805 [info ] [Thread-1  ]: 1 of 2 OK created sql view model analytics.current_option_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:32:19.863859 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:32:19.865132 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:32:19.866208 [info ] [Thread-3  ]: 2 of 2 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m14:32:19.868277 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current_holdings_historical_earnings'
[0m14:32:19.869350 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:32:19.874667 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:32:19.876965 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:32:19.869845 => 14:32:19.876522
[0m14:32:19.877622 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:32:19.887186 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:32:19.888514 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:32:19.889326 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:32:20.444683 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6006d453-be90-4a92-886a-65faff1d43a7&page=queryresults
[0m14:32:20.800946 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:32:19.878110 => 14:32:20.800573
[0m14:32:20.802346 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ecc6e8-723d-447b-a685-65e1274f272e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111176550>]}
[0m14:32:20.803470 [info ] [Thread-3  ]: 2 of 2 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:32:20.805021 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:32:20.807643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:20.808167 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:32:20.808620 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:32:20.809134 [info ] [MainThread]: 
[0m14:32:20.809681 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m14:32:20.811275 [debug] [MainThread]: Command end result
[0m14:32:20.833511 [info ] [MainThread]: 
[0m14:32:20.834383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:20.835225 [info ] [MainThread]: 
[0m14:32:20.836049 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:32:20.839602 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.9901714, "process_user_time": 6.825386, "process_kernel_time": 0.641268, "process_mem_max_rss": "137183232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:32:20.840826 [debug] [MainThread]: Command `cli build` succeeded at 14:32:20.840491 after 7.99 seconds
[0m14:32:20.841594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111051bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba52b0>]}
[0m14:32:20.842193 [debug] [MainThread]: Flushing usage events
[0m14:40:41.285923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f39ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e61ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eabca0>]}


============================== 14:40:41.294469 | d2f220d7-0bdd-43a8-8cf8-b159170d1680 ==============================
[0m14:40:41.294469 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:40:41.295491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:40:42.321663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e61df0>]}
[0m14:40:42.485625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf02e0>]}
[0m14:40:42.487429 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:40:42.516000 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:40:42.541873 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:40:42.542680 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:40:42.543436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db51c0>]}
[0m14:40:44.860024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123869a0>]}
[0m14:40:44.886757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8eca0>]}
[0m14:40:44.887715 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:40:44.890961 [info ] [MainThread]: 
[0m14:40:44.892499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:40:44.894852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:40:44.895643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:46.941351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:40:46.942458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:47.229864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123863a0>]}
[0m14:40:47.231440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:47.232157 [info ] [MainThread]: 
[0m14:40:47.237220 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:40:47.238151 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:40:47.239072 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:40:47.240016 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:40:47.241178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:40:47.241884 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:40:47.242804 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:40:47.243671 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:40:47.244626 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:40:47.245440 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:40:47.246753 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:40:47.247903 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:40:47.261202 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:40:47.265281 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:40:47.266461 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:40:47.267622 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:40:47.268292 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:40:47.270642 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:40:47.269568 => 14:40:47.269576
[0m14:40:47.272657 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:40:47.271729 => 14:40:47.271737
[0m14:40:47.274109 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:40:47.248367 => 14:40:47.273550
[0m14:40:47.275327 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:40:47.274682 => 14:40:47.274688
[0m14:40:47.276253 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:40:47.277027 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:40:47.277683 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:40:47.278312 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:40:47.387195 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:40:47.449755 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:40:47.470258 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:40:47.502103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:40:47.513838 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:40:47.522450 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:40:47.926304 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e3e47962-25d7-46b6-a1bf-5bcc4d9f13ac&page=queryresults
[0m14:40:48.545300 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:40:47.311802 => 14:40:48.544894
[0m14:40:48.546857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c0400>]}
[0m14:40:48.548055 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m14:40:48.549861 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:40:51.222743 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:40:51.303717 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:40:51.447640 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:40:51.519924 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:201ab2a2-764a-4772-852e-643e78db1522&page=queryresults
[0m14:40:51.603273 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2c4c8976-4cf1-43cf-a847-afba1fd367f9&page=queryresults
[0m14:40:51.725879 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c4c35e94-6c86-4f6d-a99c-41c45b7fb27a&page=queryresults
[0m14:40:51.806786 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:40:51.812196 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:40:47.372082 => 14:40:51.811855
[0m14:40:51.813330 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112668d30>]}
[0m14:40:51.814109 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 397[0m in 4.55s]
[0m14:40:51.815171 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:40:51.926813 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:40:51.932892 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:40:47.306501 => 14:40:51.932443
[0m14:40:51.934048 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cddc0>]}
[0m14:40:51.934880 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.69s]
[0m14:40:51.936210 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:40:51.937601 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m14:40:51.938399 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:40:51.940222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.history)
[0m14:40:51.941017 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m14:40:51.945756 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:40:51.946899 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 14:40:51.941419 => 14:40:51.946561
[0m14:40:51.947456 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m14:40:51.952561 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:40:51.953628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:40:51.954458 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:40:52.047409 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:40:52.051538 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:40:47.278721 => 14:40:52.051163
[0m14:40:52.052556 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254eb80>]}
[0m14:40:52.053278 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.81s]
[0m14:40:52.054179 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:40:52.055247 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m14:40:52.055981 [info ] [Thread-3  ]: 6 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:40:52.058097 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current)
[0m14:40:52.058790 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m14:40:52.064088 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:40:52.065887 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 14:40:52.059167 => 14:40:52.065480
[0m14:40:52.066651 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m14:40:52.071699 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:40:52.073001 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:40:52.074250 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:40:52.413701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:51b53707-465e-4557-b770-01b5652a5127&page=queryresults
[0m14:40:52.469216 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a09a5e3c-9f46-489f-af75-ce1a2ad3b4fe&page=queryresults
[0m14:40:52.727718 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 14:40:51.947805 => 14:40:52.727240
[0m14:40:52.729278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112800bb0>]}
[0m14:40:52.730246 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m14:40:52.731302 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m14:40:52.796081 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 14:40:52.067077 => 14:40:52.795605
[0m14:40:52.797456 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cddc0>]}
[0m14:40:52.798370 [info ] [Thread-3  ]: 6 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m14:40:52.799479 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m14:40:52.800776 [debug] [Thread-2  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:40:52.801665 [info ] [Thread-2  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:40:52.802733 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.calendar_symbol_dates)
[0m14:40:52.803410 [debug] [Thread-2  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:40:52.810327 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:40:52.813731 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:40:52.803794 => 14:40:52.813327
[0m14:40:52.814342 [debug] [Thread-2  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:40:52.819618 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:40:52.820691 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:40:52.821388 [debug] [Thread-2  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:40:53.474402 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2b5f999c-e68f-41e4-992d-693da5daebf7&page=queryresults
[0m14:40:53.785148 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:40:52.814708 => 14:40:53.784775
[0m14:40:53.786771 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112636a30>]}
[0m14:40:53.787763 [info ] [Thread-2  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:40:53.789300 [debug] [Thread-2  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:40:53.790506 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:40:53.791400 [debug] [Thread-3  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:40:53.792254 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:40:53.793683 [info ] [Thread-3  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:40:53.795063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_equity_historical_earnings)
[0m14:40:53.796061 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_option_historical_earnings)
[0m14:40:53.796691 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:40:53.797260 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:40:53.803427 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:40:53.808780 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:40:53.812527 [debug] [Thread-3  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:40:53.803815 => 14:40:53.811953
[0m14:40:53.813405 [debug] [Thread-3  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:40:53.820014 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:40:53.797637 => 14:40:53.819533
[0m14:40:53.820543 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:40:53.821255 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:40:53.827511 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:40:53.828636 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:40:53.829779 [debug] [Thread-3  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from option_history  
where symbol = 'ONON';


[0m14:40:53.832093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:40:53.833359 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:40:54.498556 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bca09bbb-8bc1-4aba-b280-d6868d66fa35&page=queryresults
[0m14:40:54.501842 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fa7d33e8-9e8b-4ae4-a0d0-b57ddc54e6a6&page=queryresults
[0m14:40:54.802374 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:40:53.821804 => 14:40:54.802000
[0m14:40:54.803786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112450820>]}
[0m14:40:54.805421 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m14:40:54.807206 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:40:54.811418 [debug] [Thread-3  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:40:53.814096 => 14:40:54.811064
[0m14:40:54.813243 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c8af0>]}
[0m14:40:54.814366 [info ] [Thread-3  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m14:40:54.816332 [debug] [Thread-3  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:40:54.818386 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:40:54.819657 [info ] [Thread-2  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m14:40:54.821747 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m14:40:54.822637 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:40:54.832709 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:40:54.835684 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:40:54.823061 => 14:40:54.835125
[0m14:40:54.836355 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:40:54.843763 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:40:54.845712 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:40:54.846694 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:40:55.353025 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9188a18-f16f-4cfe-bb42-b27a71cb849d&page=queryresults
[0m14:40:55.602584 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name day not found inside current_option_historical_earnings at [17:40]; reason: invalidQuery, location: query, message: Name day not found inside current_option_historical_earnings at [17:40]')
[0m14:40:57.134095 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a57b8c85-5706-4386-bc2f-3c4c2f10e3de&page=queryresults
[0m14:40:57.415755 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a57b8c85-5706-4386-bc2f-3c4c2f10e3de&page=queryresults
[0m14:40:57.418219 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:40:54.836837 => 14:40:57.417277
[0m14:40:57.440448 [debug] [Thread-2  ]: Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name day not found inside current_option_historical_earnings at [17:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m14:40:57.441351 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f220d7-0bdd-43a8-8cf8-b159170d1680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112504850>]}
[0m14:40:57.442697 [error] [Thread-2  ]: 10 of 10 ERROR creating sql view model analytics.current_holdings_historical_earnings  [[31mERROR[0m in 2.62s]
[0m14:40:57.444668 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:40:57.447831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:57.448409 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:40:57.448880 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:40:57.449346 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:40:57.449814 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m14:40:57.450389 [info ] [MainThread]: 
[0m14:40:57.450966 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m14:40:57.454047 [debug] [MainThread]: Command end result
[0m14:40:57.477605 [info ] [MainThread]: 
[0m14:40:57.478588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:40:57.479585 [info ] [MainThread]: 
[0m14:40:57.480255 [error] [MainThread]:   Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name day not found inside current_option_historical_earnings at [17:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m14:40:57.480886 [info ] [MainThread]: 
[0m14:40:57.481931 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m14:40:57.487465 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 16.3117, "process_user_time": 7.734461, "process_kernel_time": 0.743554, "process_mem_max_rss": "149622784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:40:57.488599 [debug] [MainThread]: Command `cli build` failed at 14:40:57.488371 after 16.31 seconds
[0m14:40:57.489294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f39ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112845dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f3970>]}
[0m14:40:57.490192 [debug] [MainThread]: Flushing usage events
[0m14:41:34.098586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c737370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e242df0>]}


============================== 14:41:34.131191 | b5cd9143-ab49-467b-b8b2-5e72a001fb2d ==============================
[0m14:41:34.131191 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:41:34.144833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:36.338465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f8730>]}
[0m14:41:36.666537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc2310>]}
[0m14:41:36.669123 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:41:36.819980 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:41:36.875459 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:41:36.876866 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:41:36.878265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f029e80>]}
[0m14:41:40.774504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f71e9a0>]}
[0m14:41:40.803150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f50d0a0>]}
[0m14:41:40.804044 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:41:40.807539 [info ] [MainThread]: 
[0m14:41:40.809079 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:41:40.811907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:41:40.813247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:42.749138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:41:42.750431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:43.000457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f71e3a0>]}
[0m14:41:43.001939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:43.002571 [info ] [MainThread]: 
[0m14:41:43.007258 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:41:43.007974 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:41:43.008877 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:41:43.009725 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:41:43.010478 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:41:43.011445 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:41:43.012285 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:41:43.013609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:41:43.014471 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:41:43.015783 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:41:43.017038 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:41:43.017836 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:41:43.018946 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:41:43.019573 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:41:43.020173 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:41:43.033535 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:41:43.034260 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:41:43.035095 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:41:43.034713 => 14:41:43.034718
[0m14:41:43.035823 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:41:43.035487 => 14:41:43.035490
[0m14:41:43.036945 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:41:43.036451 => 14:41:43.036456
[0m14:41:43.039492 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:41:43.020606 => 14:41:43.038097
[0m14:41:43.040680 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:41:43.041918 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:41:43.042963 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:41:43.043717 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:41:43.114029 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:41:43.171844 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:41:43.202024 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:41:43.209769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:43.222061 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:41:43.280671 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:41:43.688296 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b1b8d613-91b6-448a-a8f3-de603318cfd0&page=queryresults
[0m14:41:44.054558 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:41:43.103232 => 14:41:44.054215
[0m14:41:44.055983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f729040>]}
[0m14:41:44.057449 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m14:41:44.058546 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:41:46.734809 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:41:46.815339 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:41:47.028308 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a4b89660-4705-419b-8470-69ffb0ee0f22&page=queryresults
[0m14:41:47.055507 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:67f67b89-b1a2-42b4-95a9-7bb7d919e89f&page=queryresults
[0m14:41:47.370277 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:41:47.372947 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:41:47.377452 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:41:43.079790 => 14:41:47.377083
[0m14:41:47.378692 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa53bb0>]}
[0m14:41:47.382010 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:41:43.044310 => 14:41:47.381681
[0m14:41:47.382886 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 397[0m in 4.36s]
[0m14:41:47.384268 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8e4d00>]}
[0m14:41:47.385469 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:41:47.386369 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.37s]
[0m14:41:47.388156 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:41:47.389246 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:41:47.390141 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:41:47.391285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:41:47.391948 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:41:47.397212 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:41:47.398837 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:41:47.392334 => 14:41:47.398305
[0m14:41:47.399610 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:41:47.405631 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:41:47.407203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:47.408334 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:41:47.836921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4eaf11ca-42fc-4994-b20b-5dc0483facb1&page=queryresults
[0m14:41:48.194927 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:41:47.400025 => 14:41:48.194552
[0m14:41:48.196448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f997640>]}
[0m14:41:48.197697 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m14:41:48.199292 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:41:48.200485 [debug] [Thread-2  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:41:48.201361 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:41:48.202661 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.calendar_symbol_dates)
[0m14:41:48.203388 [debug] [Thread-2  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:41:48.209244 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:41:48.210570 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:41:48.203805 => 14:41:48.210170
[0m14:41:48.211822 [debug] [Thread-2  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:41:48.218274 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:41:48.219753 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:41:48.220788 [debug] [Thread-2  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:41:48.264181 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:41:48.561234 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c26b3a1c-7389-4509-b578-78673a8b6b37&page=queryresults
[0m14:41:48.709589 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5f87b8ce-122a-4fb1-92d1-53a4c7acff59&page=queryresults
[0m14:41:48.860696 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:41:48.866920 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:41:43.067682 => 14:41:48.866162
[0m14:41:48.868658 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f855ee0>]}
[0m14:41:48.869792 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 5.85s]
[0m14:41:48.870872 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:41:48.871907 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m14:41:48.872684 [info ] [Thread-1  ]: 7 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:41:48.874534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.history)
[0m14:41:48.875315 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m14:41:48.881438 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:41:48.882774 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 14:41:48.875739 => 14:41:48.882375
[0m14:41:48.883438 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m14:41:48.895554 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:41:48.897871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:48.898789 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:41:49.030497 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:41:48.212309 => 14:41:49.030111
[0m14:41:49.031820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb9cee0>]}
[0m14:41:49.032755 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:41:49.033771 [debug] [Thread-2  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:41:49.334080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6cc037c3-c9ee-408e-b3fa-3dc74a8ec56d&page=queryresults
[0m14:41:49.633763 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 14:41:48.883845 => 14:41:49.633397
[0m14:41:49.635378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9aa820>]}
[0m14:41:49.636456 [info ] [Thread-1  ]: 7 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m14:41:49.637783 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m14:41:49.640178 [debug] [Thread-3  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:41:49.641210 [info ] [Thread-3  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:41:49.641995 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:41:49.643347 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current_equity_historical_earnings)
[0m14:41:49.644232 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:41:49.645048 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:41:49.646327 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m14:41:49.653580 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:41:49.654577 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:41:49.661083 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:41:49.663147 [debug] [Thread-3  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:41:49.646812 => 14:41:49.662313
[0m14:41:49.664603 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:41:49.655120 => 14:41:49.663901
[0m14:41:49.667573 [debug] [Thread-3  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:41:49.668845 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:41:49.675545 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:41:49.682380 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:41:49.683927 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:41:49.684620 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:41:49.685533 [debug] [Thread-3  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:41:49.686599 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m14:41:50.274588 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1a1446a3-156f-4141-a55f-10fe7ef6f590&page=queryresults
[0m14:41:50.275547 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3c4ae62c-71b9-40e4-a3d0-25eb478ec73a&page=queryresults
[0m14:41:50.570939 [debug] [Thread-3  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:41:49.669647 => 14:41:50.570567
[0m14:41:50.572329 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba8760>]}
[0m14:41:50.573529 [info ] [Thread-3  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m14:41:50.574833 [debug] [Thread-3  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:41:50.580742 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:41:49.676112 => 14:41:50.580383
[0m14:41:50.582018 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f71e3a0>]}
[0m14:41:50.583056 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:41:50.584558 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:41:50.586082 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:41:50.586997 [info ] [Thread-1  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m14:41:50.588136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_holdings_historical_earnings)
[0m14:41:50.588815 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:41:50.595730 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:41:50.597966 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:41:50.589541 => 14:41:50.597414
[0m14:41:50.598683 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:41:50.604244 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:41:50.605451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:50.606371 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:41:51.226489 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8797b110-f6fb-46d6-b211-e0a02da98312&page=queryresults
[0m14:41:51.533418 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:41:50.599112 => 14:41:51.532972
[0m14:41:51.534981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5cd9143-ab49-467b-b8b2-5e72a001fb2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe9df0>]}
[0m14:41:51.536054 [info ] [Thread-1  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m14:41:51.537405 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:41:51.540325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:51.540898 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:41:51.541360 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m14:41:51.541805 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:41:51.542243 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:41:51.542792 [info ] [MainThread]: 
[0m14:41:51.543367 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m14:41:51.547205 [debug] [MainThread]: Command end result
[0m14:41:51.564249 [info ] [MainThread]: 
[0m14:41:51.565026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:51.565644 [info ] [MainThread]: 
[0m14:41:51.566558 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:41:51.570078 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.880314, "process_user_time": 9.816741, "process_kernel_time": 0.911607, "process_mem_max_rss": "148135936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:51.571825 [debug] [MainThread]: Command `cli build` succeeded at 14:41:51.571333 after 17.88 seconds
[0m14:41:51.573458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c737370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb92040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f731e50>]}
[0m14:41:51.574410 [debug] [MainThread]: Flushing usage events
[0m14:43:41.819256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb4a00>]}


============================== 14:43:41.827441 | 6e499312-822f-4e3d-9855-f4d0dafc4c62 ==============================
[0m14:43:41.827441 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:43:41.828470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:43:42.629077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6a3a0>]}
[0m14:43:42.795824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed47d60>]}
[0m14:43:42.797191 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:43:42.829117 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:43:42.852911 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:43:42.853693 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:43:42.854763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede23a0>]}
[0m14:43:45.182988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f48f0d0>]}
[0m14:43:45.207619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26d790>]}
[0m14:43:45.208728 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:43:45.212333 [info ] [MainThread]: 
[0m14:43:45.213733 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:45.216118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:43:45.216893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:46.884541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:43:46.885595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:47.173330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f48fbe0>]}
[0m14:43:47.174877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:47.175522 [info ] [MainThread]: 
[0m14:43:47.179166 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:43:47.179985 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:43:47.180896 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:43:47.182091 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:43:47.183072 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:43:47.183943 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:43:47.185540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:43:47.186456 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:43:47.187399 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:43:47.189148 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:43:47.189907 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:43:47.191058 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:43:47.192210 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:43:47.192870 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:43:47.206293 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:43:47.207135 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:43:47.207849 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:43:47.208810 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:43:47.208387 => 14:43:47.208392
[0m14:43:47.209901 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:43:47.209499 => 14:43:47.209504
[0m14:43:47.210708 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:43:47.210349 => 14:43:47.210353
[0m14:43:47.211509 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:43:47.212433 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:43:47.193325 => 14:43:47.212020
[0m14:43:47.213215 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:43:47.213950 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:43:47.239217 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:43:47.362301 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:43:47.364133 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:43:47.390914 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:43:47.443660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:47.450991 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:43:47.474016 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:43:47.877264 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3d9a55dd-c510-4128-abb8-ec45ff0eeeff&page=queryresults
[0m14:43:48.233596 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:43:47.253679 => 14:43:48.233122
[0m14:43:48.235190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f490340>]}
[0m14:43:48.236342 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:43:48.237865 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:43:50.943927 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:43:50.976123 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:43:51.212011 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e4f0c4cb-ae83-4d2e-8759-09a4904d52c1&page=queryresults
[0m14:43:51.244293 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2e8d2933-914a-4df1-88f2-8453ba8aecb4&page=queryresults
[0m14:43:51.493330 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:43:51.527162 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:43:51.531583 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:43:47.248487 => 14:43:51.531224
[0m14:43:51.532837 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5cc4f0>]}
[0m14:43:51.533711 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 397[0m in 4.34s]
[0m14:43:51.534808 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:43:51.677943 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:43:51.682961 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:43:47.214542 => 14:43:51.682605
[0m14:43:51.684218 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f657c70>]}
[0m14:43:51.685040 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.50s]
[0m14:43:51.686555 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:43:51.688093 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:43:51.689478 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:43:51.691011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:43:51.691791 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:43:51.697321 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:43:51.698605 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:43:51.692219 => 14:43:51.698170
[0m14:43:51.699228 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:43:51.704591 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:43:51.705991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:51.706986 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:43:51.758976 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ce820972-6ce7-4010-884b-a6fa70ed6d04&page=queryresults
[0m14:43:52.051007 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:43:52.055805 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:43:47.243761 => 14:43:52.055427
[0m14:43:52.057081 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5d5df0>]}
[0m14:43:52.057978 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.87s]
[0m14:43:52.059010 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:43:52.059948 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m14:43:52.060769 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:43:52.061939 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m14:43:52.062832 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m14:43:52.069140 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:43:52.070619 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 14:43:52.063522 => 14:43:52.070036
[0m14:43:52.071420 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m14:43:52.077508 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:43:52.078658 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:43:52.079645 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:43:52.105993 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b0ff8a6b-f8d8-46e6-9028-21b42bf35bba&page=queryresults
[0m14:43:52.454662 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:43:51.699608 => 14:43:52.454229
[0m14:43:52.456069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f55a910>]}
[0m14:43:52.457056 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m14:43:52.458101 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:43:52.459117 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:43:52.459839 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:43:52.460957 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m14:43:52.461611 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:43:52.467026 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:43:52.468236 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:43:52.461993 => 14:43:52.467864
[0m14:43:52.468824 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:43:52.476103 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:43:52.477228 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:43:52.478009 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:43:52.508242 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c8c5d645-860b-4bde-8f98-ab13a7bb54b2&page=queryresults
[0m14:43:52.831798 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 14:43:52.071846 => 14:43:52.831394
[0m14:43:52.833289 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f925040>]}
[0m14:43:52.834388 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m14:43:52.835670 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m14:43:53.080691 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3a9e9167-263e-49da-8c99-484b861f7746&page=queryresults
[0m14:43:53.402386 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:43:52.469231 => 14:43:53.402017
[0m14:43:53.403705 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f931100>]}
[0m14:43:53.404762 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:43:53.406006 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:43:53.407381 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:43:53.408220 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:43:53.408901 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:43:53.409705 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:43:53.410955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m14:43:53.412069 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m14:43:53.412713 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:43:53.413295 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:43:53.419492 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:43:53.424564 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:43:53.426113 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:43:53.419970 => 14:43:53.425693
[0m14:43:53.426863 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:43:53.413673 => 14:43:53.426504
[0m14:43:53.427427 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:43:53.428023 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:43:53.433952 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:43:53.440392 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:43:53.441732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:53.442380 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:43:53.443175 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:43:53.444139 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m14:43:54.027970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ceeb3792-9136-484a-8caa-d8faef117644&page=queryresults
[0m14:43:54.037860 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:da248b16-05cf-4524-b550-4a17ad0c739f&page=queryresults
[0m14:43:54.303388 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:43:53.434487 => 14:43:54.302939
[0m14:43:54.305268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f749460>]}
[0m14:43:54.306373 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m14:43:54.307756 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:43:54.348503 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:43:53.428407 => 14:43:54.348148
[0m14:43:54.349821 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f948340>]}
[0m14:43:54.350754 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:43:54.351820 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:43:54.353268 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:43:54.354428 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m14:43:54.355975 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m14:43:54.356731 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:43:54.362006 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:43:54.363366 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:43:54.357173 => 14:43:54.362891
[0m14:43:54.364056 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:43:54.374733 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:43:54.376573 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:43:54.377571 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:43:55.034732 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bb4cc846-ddc3-4967-b3a3-5f9f41d5d98c&page=queryresults
[0m14:43:55.339697 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:43:54.364431 => 14:43:55.339315
[0m14:43:55.341022 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e499312-822f-4e3d-9855-f4d0dafc4c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f94b5e0>]}
[0m14:43:55.342019 [info ] [Thread-3  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m14:43:55.343235 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:43:55.345950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:55.346513 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:43:55.346990 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m14:43:55.347446 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:43:55.347903 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:43:55.348456 [info ] [MainThread]: 
[0m14:43:55.349020 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m14:43:55.352111 [debug] [MainThread]: Command end result
[0m14:43:55.373564 [info ] [MainThread]: 
[0m14:43:55.374264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:55.374902 [info ] [MainThread]: 
[0m14:43:55.375622 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:43:55.377868 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.660469, "process_user_time": 7.500968, "process_kernel_time": 0.57575, "process_mem_max_rss": "147947520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:55.378756 [debug] [MainThread]: Command `cli build` succeeded at 14:43:55.378545 after 13.66 seconds
[0m14:43:55.379412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f042190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee33ee0>]}
[0m14:43:55.380731 [debug] [MainThread]: Flushing usage events
[0m14:47:59.402762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3984f0>]}


============================== 14:47:59.411251 | b5126cb8-139c-44e5-bcf8-49f2f1720bfc ==============================
[0m14:47:59.411251 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:47:59.412500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:00.403875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c6730>]}
[0m14:48:00.568086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d14d310>]}
[0m14:48:00.569667 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:48:00.602134 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:48:00.635995 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:48:00.637164 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:48:00.638354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d266ac0>]}
[0m14:48:03.024271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88cd60>]}
[0m14:48:03.051078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d33a0>]}
[0m14:48:03.052044 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:48:03.055410 [info ] [MainThread]: 
[0m14:48:03.057015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:48:03.059420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:48:03.060210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:05.174916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:48:05.176090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:05.463469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88c3a0>]}
[0m14:48:05.464905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:05.465541 [info ] [MainThread]: 
[0m14:48:05.471229 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:48:05.471927 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:48:05.472773 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:48:05.473469 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:48:05.474334 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:48:05.475227 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:48:05.476308 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:48:05.477586 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:48:05.479039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:48:05.480272 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:48:05.481430 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:48:05.482674 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:48:05.483482 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:48:05.484131 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:48:05.484857 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:48:05.485552 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:48:05.498481 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:48:05.499370 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:48:05.498976 => 14:48:05.498981
[0m14:48:05.500279 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:48:05.499913 => 14:48:05.499918
[0m14:48:05.501315 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:48:05.500799 => 14:48:05.500803
[0m14:48:05.503106 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:48:05.504063 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:48:05.504958 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:48:05.517504 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:48:05.486123 => 14:48:05.516880
[0m14:48:05.553733 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:48:05.625460 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:48:05.655460 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:48:05.698396 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:48:05.736082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:48:05.736974 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:48:05.742818 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:48:06.111608 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:550cfb4c-a2f9-4a08-b6a5-79a97ddf3727&page=queryresults
[0m14:48:06.455334 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:48:05.554287 => 14:48:06.454980
[0m14:48:06.456545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95f880>]}
[0m14:48:06.457508 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:48:06.458708 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:48:09.210182 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:48:09.224239 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:48:09.481189 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e4808cf5-cd8d-4e18-bbbc-69d664d03302&page=queryresults
[0m14:48:09.536999 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5767d536-826d-4924-9ebf-de406642a589&page=queryresults
[0m14:48:09.734603 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:48:09.803980 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:48:09.809281 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:48:05.505474 => 14:48:09.808612
[0m14:48:09.810768 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5c6d0>]}
[0m14:48:09.811799 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.33s]
[0m14:48:09.812880 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:48:09.813824 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:48:09.814622 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:48:09.815938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:48:09.816629 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:48:09.822127 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:48:09.823350 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:48:09.817088 => 14:48:09.822989
[0m14:48:09.823943 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:48:09.829082 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:48:09.830238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:48:09.831525 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:48:09.862564 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:48:09.868606 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:48:05.541644 => 14:48:09.868251
[0m14:48:09.870000 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c5550>]}
[0m14:48:09.871164 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 597[0m in 4.39s]
[0m14:48:09.872434 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:48:09.975814 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:24543acf-a763-432d-a1d7-6f1290d0c115&page=queryresults
[0m14:48:10.283210 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:48:10.288119 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:48:05.529695 => 14:48:10.287748
[0m14:48:10.290166 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cae80>]}
[0m14:48:10.291108 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.81s]
[0m14:48:10.292035 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c120d5dd-903f-4681-aa93-1e2679e75172&page=queryresults
[0m14:48:10.292926 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:48:10.295765 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m14:48:10.296885 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:48:10.298401 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m14:48:10.299150 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m14:48:10.304608 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:48:10.305855 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 14:48:10.299638 => 14:48:10.305492
[0m14:48:10.306443 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m14:48:10.311857 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:48:10.313314 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:48:10.314304 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:48:10.575176 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:48:09.824308 => 14:48:10.574806
[0m14:48:10.576515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1faf0>]}
[0m14:48:10.577445 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m14:48:10.578487 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:48:10.579420 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:48:10.580169 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:48:10.581266 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m14:48:10.581904 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:48:10.586967 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:48:10.590221 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:48:10.582420 => 14:48:10.589763
[0m14:48:10.590899 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:48:10.598790 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:48:10.600168 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:48:10.600964 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:48:10.695107 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:98a7de27-2f8a-4039-aff3-07e30e8061fc&page=queryresults
[0m14:48:11.030275 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 14:48:10.306815 => 14:48:11.029903
[0m14:48:11.031754 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd22bb0>]}
[0m14:48:11.033006 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m14:48:11.034343 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m14:48:11.124884 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dd3f3c79-18dd-4a04-8e7c-3b88895184f1&page=queryresults
[0m14:48:11.432664 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:48:10.591283 => 14:48:11.432290
[0m14:48:11.434050 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba7c70>]}
[0m14:48:11.435064 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:48:11.436921 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:48:11.438127 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:48:11.438910 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:48:11.439582 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:48:11.440520 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:48:11.441967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m14:48:11.443147 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m14:48:11.444077 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:48:11.444731 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:48:11.451606 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:48:11.456891 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:48:11.458683 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:48:11.445117 => 14:48:11.458275
[0m14:48:11.459510 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:48:11.452102 => 14:48:11.459078
[0m14:48:11.460090 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:48:11.460690 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:48:11.466775 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:48:11.473467 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:48:11.474733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:48:11.475606 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:48:11.476563 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:48:11.477556 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m14:48:12.037450 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2406de67-5786-4223-a941-132ca1fae3d3&page=queryresults
[0m14:48:12.038592 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6ecb0ebf-c1a4-47b4-83d7-c7c70717d524&page=queryresults
[0m14:48:12.322695 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:48:11.467276 => 14:48:12.322224
[0m14:48:12.324284 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95f910>]}
[0m14:48:12.325436 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m14:48:12.326894 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:48:12.344359 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator * for argument types: INT64, STRING. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [71:4]; reason: invalidQuery, location: query, message: No matching signature for operator * for argument types: INT64, STRING. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [71:4]')
[0m14:48:12.822910 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ba882f6f-0ccb-4900-ae30-1db2ad721f31&page=queryresults
[0m14:48:13.113434 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ba882f6f-0ccb-4900-ae30-1db2ad721f31&page=queryresults
[0m14:48:13.115508 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:48:11.461081 => 14:48:13.114605
[0m14:48:13.136144 [debug] [Thread-1  ]: Database Error in model current_equity_historical_earnings (models/intermediate/current_equity_historical_earnings.sql)
  No matching signature for operator * for argument types: INT64, STRING. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [71:4]
  compiled Code at target/run/ccwj/models/intermediate/current_equity_historical_earnings.sql
[0m14:48:13.137140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5126cb8-139c-44e5-bcf8-49f2f1720bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da42fa0>]}
[0m14:48:13.138168 [error] [Thread-1  ]: 8 of 10 ERROR creating sql view model analytics.current_equity_historical_earnings  [[31mERROR[0m in 1.70s]
[0m14:48:13.139155 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:48:13.140392 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:48:13.141331 [info ] [Thread-3  ]: 10 of 10 SKIP relation analytics.current_holdings_historical_earnings .......... [[33mSKIP[0m]
[0m14:48:13.142772 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:48:13.145757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:13.146357 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:48:13.146843 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m14:48:13.147318 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m14:48:13.147790 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:48:13.148369 [info ] [MainThread]: 
[0m14:48:13.149024 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 10.09 seconds (10.09s).
[0m14:48:13.152483 [debug] [MainThread]: Command end result
[0m14:48:13.182053 [info ] [MainThread]: 
[0m14:48:13.183100 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:48:13.183803 [info ] [MainThread]: 
[0m14:48:13.184496 [error] [MainThread]:   Database Error in model current_equity_historical_earnings (models/intermediate/current_equity_historical_earnings.sql)
  No matching signature for operator * for argument types: INT64, STRING. Supported signatures: INT64 * INT64; FLOAT64 * FLOAT64; NUMERIC * NUMERIC; BIGNUMERIC * BIGNUMERIC; INTERVAL * INT64; INT64 * INTERVAL at [71:4]
  compiled Code at target/run/ccwj/models/intermediate/current_equity_historical_earnings.sql
[0m14:48:13.185184 [info ] [MainThread]: 
[0m14:48:13.185989 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m14:48:13.189897 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 13.893555, "process_user_time": 7.600939, "process_kernel_time": 0.703842, "process_mem_max_rss": "148910080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:48:13.190991 [debug] [MainThread]: Command `cli build` failed at 14:48:13.190721 after 13.89 seconds
[0m14:48:13.191842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd59f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d676a90>]}
[0m14:48:13.192706 [debug] [MainThread]: Flushing usage events
[0m14:48:50.528194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108feba00>]}


============================== 14:48:50.535127 | 18cbfc01-58d8-479f-80ed-3ac878722270 ==============================
[0m14:48:50.535127 [info ] [MainThread]: Running with dbt=1.7.12
[0m14:48:50.536650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:51.340778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa13a0>]}
[0m14:48:51.494619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f882e0>]}
[0m14:48:51.495970 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:48:51.525156 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m14:48:51.549586 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:48:51.550633 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m14:48:51.551395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eaf310>]}
[0m14:48:54.085027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c1f40>]}
[0m14:48:54.114989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7f610>]}
[0m14:48:54.115902 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m14:48:54.119811 [info ] [MainThread]: 
[0m14:48:54.122032 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:48:54.126196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m14:48:54.127083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:56.183032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m14:48:56.184210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:56.453055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c13a0>]}
[0m14:48:56.455510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:56.457032 [info ] [MainThread]: 
[0m14:48:56.461222 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m14:48:56.462413 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m14:48:56.463344 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m14:48:56.464205 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m14:48:56.465684 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m14:48:56.466893 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m14:48:56.468362 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m14:48:56.470368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m14:48:56.471960 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m14:48:56.472995 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m14:48:56.474488 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m14:48:56.475285 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m14:48:56.476009 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m14:48:56.477330 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m14:48:56.478110 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m14:48:56.492644 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m14:48:56.493848 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 14:48:56.493132 => 14:48:56.493138
[0m14:48:56.495876 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m14:48:56.497934 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 14:48:56.497114 => 14:48:56.497128
[0m14:48:56.499253 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m14:48:56.500487 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 14:48:56.500021 => 14:48:56.500028
[0m14:48:56.501382 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 14:48:56.478601 => 14:48:56.500955
[0m14:48:56.502018 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m14:48:56.520194 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m14:48:56.538150 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m14:48:56.572661 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:48:56.694200 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:48:56.701536 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m14:48:56.774787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:48:56.787408 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m14:48:56.793733 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:48:57.187853 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:12d1b53b-5fb1-44ec-8154-102e4f87c613&page=queryresults
[0m14:48:57.495773 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 14:48:56.585383 => 14:48:57.495279
[0m14:48:57.497320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d40d0>]}
[0m14:48:57.498465 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m14:48:57.499539 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m14:49:00.165076 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m14:49:00.347516 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m14:49:00.450899 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a7112682-5d34-407a-ad7c-49f6b442966a&page=queryresults
[0m14:49:00.762430 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m14:49:00.766712 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 14:48:56.502803 => 14:49:00.766346
[0m14:49:00.767852 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a68dc40>]}
[0m14:49:00.768661 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.30s]
[0m14:49:00.769700 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m14:49:00.770674 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m14:49:00.771483 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m14:49:00.772719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m14:49:00.773374 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m14:49:00.779396 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m14:49:00.780693 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 14:49:00.773759 => 14:49:00.780303
[0m14:49:00.781401 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m14:49:00.787265 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m14:49:00.788561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:00.789935 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m14:49:00.803541 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f3cd67cf-c4f5-45e3-b8bc-b3305af1d529&page=queryresults
[0m14:49:00.818327 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m14:49:01.118021 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:46641f07-edf8-43ed-ae29-51ae46d8d0be&page=queryresults
[0m14:49:01.152104 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m14:49:01.156484 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 14:48:56.557768 => 14:49:01.156136
[0m14:49:01.157660 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a629820>]}
[0m14:49:01.158450 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 596[0m in 4.68s]
[0m14:49:01.159500 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m14:49:01.204937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d3604273-7b6a-4716-b3b1-bde2565881f6&page=queryresults
[0m14:49:01.384572 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m14:49:01.389756 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 14:48:56.547596 => 14:49:01.389365
[0m14:49:01.391160 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61aee0>]}
[0m14:49:01.392187 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.92s]
[0m14:49:01.393315 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m14:49:01.394287 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m14:49:01.395024 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m14:49:01.396328 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m14:49:01.397052 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m14:49:01.403060 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m14:49:01.404388 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 14:49:01.397495 => 14:49:01.403959
[0m14:49:01.405005 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m14:49:01.411673 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m14:49:01.412927 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m14:49:01.413864 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m14:49:01.731526 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 14:49:00.781902 => 14:49:01.731172
[0m14:49:01.732972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73e6d0>]}
[0m14:49:01.734113 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:49:01.736678 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m14:49:01.738793 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m14:49:01.739782 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m14:49:01.740942 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m14:49:01.741612 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m14:49:01.747513 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m14:49:01.749852 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 14:49:01.742109 => 14:49:01.749082
[0m14:49:01.750781 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m14:49:01.758458 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m14:49:01.760457 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:49:01.762079 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m14:49:01.866538 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:38c92917-20ee-46ce-97d6-088d5d108ec5&page=queryresults
[0m14:49:02.275239 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 14:49:01.405372 => 14:49:02.274886
[0m14:49:02.276525 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96f850>]}
[0m14:49:02.277417 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m14:49:02.278390 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m14:49:02.373368 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ce52743e-39d1-4a80-8209-feccd5773776&page=queryresults
[0m14:49:02.695517 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 14:49:01.751542 => 14:49:02.695129
[0m14:49:02.696876 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a963d60>]}
[0m14:49:02.697796 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:49:02.698929 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m14:49:02.700233 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m14:49:02.700926 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m14:49:02.701613 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m14:49:02.702641 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m14:49:02.704280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m14:49:02.705363 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m14:49:02.706012 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m14:49:02.707445 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m14:49:02.714603 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m14:49:02.721782 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m14:49:02.724024 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 14:49:02.715341 => 14:49:02.723558
[0m14:49:02.724761 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m14:49:02.725588 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 14:49:02.708159 => 14:49:02.725186
[0m14:49:02.731353 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m14:49:02.732298 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m14:49:02.733650 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m14:49:02.741222 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m14:49:02.742188 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m14:49:02.744677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:49:02.746554 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m14:49:03.345220 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:252e3d5a-b60e-4e4e-993b-e9b34fed24b8&page=queryresults
[0m14:49:03.346540 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bf61377c-dd26-4dd0-b2e5-c348e59b45b4&page=queryresults
[0m14:49:03.689887 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 14:49:02.734233 => 14:49:03.689520
[0m14:49:03.691732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a991fd0>]}
[0m14:49:03.693295 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m14:49:03.695795 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m14:49:03.701583 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 14:49:02.726219 => 14:49:03.701173
[0m14:49:03.702889 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6787c0>]}
[0m14:49:03.704281 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m14:49:03.705685 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m14:49:03.707089 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m14:49:03.708339 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m14:49:03.710420 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m14:49:03.711441 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m14:49:03.717743 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m14:49:03.720104 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 14:49:03.712145 => 14:49:03.719664
[0m14:49:03.721066 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m14:49:03.734507 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m14:49:03.736440 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m14:49:03.737695 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m14:49:04.220643 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2d2189a4-068d-46d5-b2a5-2f708d4793c5&page=queryresults
[0m14:49:04.628820 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 14:49:03.721974 => 14:49:04.628340
[0m14:49:04.647009 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18cbfc01-58d8-479f-80ed-3ac878722270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b5eb0>]}
[0m14:49:04.669697 [info ] [Thread-3  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:49:04.691702 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m14:49:04.695393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:04.713325 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m14:49:04.713940 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m14:49:04.714411 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m14:49:04.714870 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m14:49:04.715544 [info ] [MainThread]: 
[0m14:49:04.716125 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 10.59 seconds (10.59s).
[0m14:49:04.719953 [debug] [MainThread]: Command end result
[0m14:49:04.741235 [info ] [MainThread]: 
[0m14:49:04.742245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:04.743169 [info ] [MainThread]: 
[0m14:49:04.743899 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:49:04.746370 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.323138, "process_user_time": 8.147661, "process_kernel_time": 0.627461, "process_mem_max_rss": "147988480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:49:04.747910 [debug] [MainThread]: Command `cli build` succeeded at 14:49:04.747454 after 14.32 seconds
[0m14:49:04.749268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f289a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7f610>]}
[0m14:49:04.750110 [debug] [MainThread]: Flushing usage events
[0m15:36:05.515750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d807370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e74f0>]}


============================== 15:36:05.526637 | 844b4e44-40ef-4467-8fb8-6a2995b27253 ==============================
[0m15:36:05.526637 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:36:05.528738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:36:06.614451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6133d0>]}
[0m15:36:06.839325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e777df0>]}
[0m15:36:06.841022 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:36:06.879755 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m15:36:07.120650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:07.121417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:07.136514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a90d0>]}
[0m15:36:07.174233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c04f0>]}
[0m15:36:07.175341 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:36:07.179639 [info ] [MainThread]: 
[0m15:36:07.181810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:07.185418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:36:07.186473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:09.719061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:36:09.720264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:10.117666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e777f40>]}
[0m15:36:10.119497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:10.120258 [info ] [MainThread]: 
[0m15:36:10.125477 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m15:36:10.126364 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m15:36:10.127620 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m15:36:10.129685 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m15:36:10.128679 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m15:36:10.131051 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m15:36:10.132207 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m15:36:10.133679 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m15:36:10.135655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m15:36:10.138235 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m15:36:10.140981 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m15:36:10.142459 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m15:36:10.143246 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m15:36:10.143983 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m15:36:10.144687 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m15:36:10.145642 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m15:36:10.163361 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 15:36:10.162432 => 15:36:10.162444
[0m15:36:10.167466 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 15:36:10.166420 => 15:36:10.166426
[0m15:36:10.171731 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 15:36:10.171080 => 15:36:10.171089
[0m15:36:10.178484 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m15:36:10.179311 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m15:36:10.180078 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m15:36:10.180804 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m15:36:10.210190 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 15:36:10.146346 => 15:36:10.209383
[0m15:36:10.275755 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:36:10.292559 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m15:36:10.376613 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:36:10.464808 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:36:10.473547 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m15:36:10.478988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:10.480811 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m15:36:10.929004 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8fa93c78-8236-40c0-8efd-4774f4b0d14c&page=queryresults
[0m15:36:11.304979 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 15:36:10.383625 => 15:36:11.304579
[0m15:36:11.306504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e973b50>]}
[0m15:36:11.307888 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m15:36:11.309228 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m15:36:14.018956 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m15:36:14.020953 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m15:36:14.318690 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8589536c-361c-429d-8775-0775c9214fb2&page=queryresults
[0m15:36:14.331783 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa629689-e80f-4f77-8f4f-57b1fd463ab8&page=queryresults
[0m15:36:14.668436 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m15:36:14.672492 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m15:36:14.677294 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 15:36:10.181496 => 15:36:14.676788
[0m15:36:14.679160 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea4d850>]}
[0m15:36:14.680181 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.54s]
[0m15:36:14.685247 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 15:36:10.231482 => 15:36:14.684861
[0m15:36:14.686472 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m15:36:14.688178 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e973d30>]}
[0m15:36:14.689751 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m15:36:14.690879 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 596[0m in 4.55s]
[0m15:36:14.692037 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m15:36:14.693380 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m15:36:14.694962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m15:36:14.696009 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m15:36:14.703412 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m15:36:14.705932 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 15:36:14.696590 => 15:36:14.704914
[0m15:36:14.706825 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m15:36:14.714247 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m15:36:14.715559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:14.717417 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m15:36:15.335639 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3025d57e-46e5-4e24-91fb-2accdaf0c595&page=queryresults
[0m15:36:15.931081 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 15:36:14.707457 => 15:36:15.930676
[0m15:36:15.932917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98de20>]}
[0m15:36:15.934032 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m15:36:15.935395 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m15:36:15.936743 [debug] [Thread-2  ]: Began running node model.ccwj.calendar_symbol_dates
[0m15:36:15.937909 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m15:36:15.939543 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.calendar_symbol_dates)
[0m15:36:15.940429 [debug] [Thread-2  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m15:36:15.946692 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m15:36:15.951150 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 15:36:15.940932 => 15:36:15.950474
[0m15:36:15.952035 [debug] [Thread-2  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m15:36:15.959689 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m15:36:15.960920 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:36:15.961897 [debug] [Thread-2  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m15:36:16.459986 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:970cc416-6418-4640-a9b3-26745882cc35&page=queryresults
[0m15:36:16.714865 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 15:36:15.952503 => 15:36:16.714468
[0m15:36:16.716475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98de20>]}
[0m15:36:16.717908 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m15:36:16.720090 [debug] [Thread-2  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m15:36:22.152484 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m15:36:22.445322 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2cfc8e77-f0f7-4cf2-88a1-224c3d769c82&page=queryresults
[0m15:36:22.989417 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m15:36:22.994353 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 15:36:10.210754 => 15:36:22.993805
[0m15:36:22.995991 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea1afd0>]}
[0m15:36:22.997129 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 12.86s]
[0m15:36:22.998759 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m15:36:23.000691 [debug] [Thread-1  ]: Began running node model.ccwj.history
[0m15:36:23.002221 [info ] [Thread-1  ]: 7 of 10 START sql view model analytics.history ................................. [RUN]
[0m15:36:23.004260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.history)
[0m15:36:23.005202 [debug] [Thread-1  ]: Began compiling node model.ccwj.history
[0m15:36:23.011739 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.history"
[0m15:36:23.013109 [debug] [Thread-1  ]: Timing info for model.ccwj.history (compile): 15:36:23.005875 => 15:36:23.012692
[0m15:36:23.013779 [debug] [Thread-1  ]: Began executing node model.ccwj.history
[0m15:36:23.026967 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.history"
[0m15:36:23.028632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:23.030160 [debug] [Thread-1  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m15:36:23.525247 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c82f55d4-0db8-4964-8e0f-0bbe125e23aa&page=queryresults
[0m15:36:23.863886 [debug] [Thread-1  ]: Timing info for model.ccwj.history (execute): 15:36:23.014191 => 15:36:23.863483
[0m15:36:23.865186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ededeb0>]}
[0m15:36:23.866383 [info ] [Thread-1  ]: 7 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m15:36:23.867830 [debug] [Thread-1  ]: Finished running node model.ccwj.history
[0m15:36:23.869173 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m15:36:23.869943 [debug] [Thread-3  ]: Began running node model.ccwj.current_option_historical_earnings
[0m15:36:23.870870 [info ] [Thread-2  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m15:36:23.872094 [info ] [Thread-3  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m15:36:23.873813 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_equity_historical_earnings)
[0m15:36:23.875178 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.current_option_historical_earnings)
[0m15:36:23.876001 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m15:36:23.876770 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m15:36:23.886371 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m15:36:23.895077 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m15:36:23.898999 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 15:36:23.877399 => 15:36:23.898212
[0m15:36:23.901154 [debug] [Thread-3  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 15:36:23.887337 => 15:36:23.899862
[0m15:36:23.902682 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m15:36:23.903929 [debug] [Thread-3  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m15:36:23.913389 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m15:36:23.921792 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m15:36:23.923502 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m15:36:23.924612 [debug] [Thread-2  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m15:36:23.925561 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m15:36:23.928715 [debug] [Thread-3  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m15:36:24.547964 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e5e4944a-cb24-44a9-a9b6-090d2315745e&page=queryresults
[0m15:36:24.550334 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ae743726-ca41-4ba6-b97c-6a71b97423a6&page=queryresults
[0m15:36:24.880520 [debug] [Thread-3  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 15:36:23.914009 => 15:36:24.880092
[0m15:36:24.882782 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede0580>]}
[0m15:36:24.884606 [info ] [Thread-3  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:36:24.886161 [debug] [Thread-3  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m15:36:24.898333 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 15:36:23.904557 => 15:36:24.897757
[0m15:36:24.900322 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede4a90>]}
[0m15:36:24.901548 [info ] [Thread-2  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m15:36:24.903095 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m15:36:24.904847 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m15:36:24.906555 [info ] [Thread-1  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m15:36:24.908103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_holdings_historical_earnings)
[0m15:36:24.909106 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m15:36:24.917581 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m15:36:24.919596 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 15:36:24.909980 => 15:36:24.919104
[0m15:36:24.920440 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m15:36:24.929149 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m15:36:24.931333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:24.932677 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m15:36:25.423639 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2b2cb712-eb28-4d66-b346-9c980f685764&page=queryresults
[0m15:36:25.755178 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 15:36:24.920950 => 15:36:25.754765
[0m15:36:25.757199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844b4e44-40ef-4467-8fb8-6a2995b27253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee21d90>]}
[0m15:36:25.758640 [info ] [Thread-1  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m15:36:25.761170 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m15:36:25.764885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:25.765539 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m15:36:25.766084 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m15:36:25.767453 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m15:36:25.768567 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m15:36:25.769317 [info ] [MainThread]: 
[0m15:36:25.770119 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 18.59 seconds (18.59s).
[0m15:36:25.775482 [debug] [MainThread]: Command end result
[0m15:36:25.811120 [info ] [MainThread]: 
[0m15:36:25.812422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:25.813563 [info ] [MainThread]: 
[0m15:36:25.814905 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m15:36:25.821006 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 20.441631, "process_user_time": 7.121736, "process_kernel_time": 0.946162, "process_mem_max_rss": "138391552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:36:25.822715 [debug] [MainThread]: Command `cli build` succeeded at 15:36:25.822264 after 20.44 seconds
[0m15:36:25.824111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e73aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a8c10>]}
[0m15:36:25.825393 [debug] [MainThread]: Flushing usage events
[0m15:36:45.105693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddeb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcb4f0>]}


============================== 15:36:45.118384 | bd76c58b-a231-4949-98fd-277e82564aba ==============================
[0m15:36:45.118384 [info ] [MainThread]: Running with dbt=1.7.12
[0m15:36:45.120956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/ccwj/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:36:46.413279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddb0640>]}
[0m15:36:46.615681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb79760>]}
[0m15:36:46.617222 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:36:46.660022 [debug] [MainThread]: checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653, vars: {}, profile: , target: , version: 1.7.12
[0m15:36:46.836687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:46.837557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:46.853754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef8d0d0>]}
[0m15:36:46.886299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda49a0>]}
[0m15:36:46.888018 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m15:36:46.893558 [info ] [MainThread]: 
[0m15:36:46.895940 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:46.899279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m15:36:46.900761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:49.395166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m15:36:49.396289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:49.648947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef57b20>]}
[0m15:36:49.651701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:49.652886 [info ] [MainThread]: 
[0m15:36:49.658141 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m15:36:49.659321 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m15:36:49.661092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_earnings)
[0m15:36:49.662056 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m15:36:49.692866 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m15:36:49.694730 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 15:36:49.662696 => 15:36:49.694240
[0m15:36:49.695439 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m15:36:49.767138 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m15:36:49.768882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:49.771285 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m15:36:50.463914 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1f81d526-31fc-4a3e-9375-ff9589d0a390&page=queryresults
[0m15:36:50.810393 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 15:36:49.695866 => 15:36:50.809774
[0m15:36:50.812009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd76c58b-a231-4949-98fd-277e82564aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f059f40>]}
[0m15:36:50.813164 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m15:36:50.814457 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m15:36:50.817631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:50.818280 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m15:36:50.818915 [info ] [MainThread]: 
[0m15:36:50.819834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m15:36:50.821989 [debug] [MainThread]: Command end result
[0m15:36:50.849819 [info ] [MainThread]: 
[0m15:36:50.851204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:50.852514 [info ] [MainThread]: 
[0m15:36:50.853757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:36:50.858118 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.8830633, "process_user_time": 6.105785, "process_kernel_time": 0.842904, "process_mem_max_rss": "128204800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:36:50.859266 [debug] [MainThread]: Command `cli build` succeeded at 15:36:50.858974 after 5.88 seconds
[0m15:36:50.860157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddb0640>]}
[0m15:36:50.861382 [debug] [MainThread]: Flushing usage events
[0m08:43:56.192977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101eb7f0>]}


============================== 08:43:56.202604 | 65e30f86-2435-493e-af34-e0192e7dd723 ==============================
[0m08:43:56.202604 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:43:56.203862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:43:57.293990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110262eb0>]}
[0m08:43:57.487824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6c190>]}
[0m08:43:57.489438 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:43:57.526403 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m08:43:57.554437 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:43:57.555375 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m08:43:57.556643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11111aeb0>]}
[0m08:44:00.609043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c40d0>]}
[0m08:44:00.645086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c8220>]}
[0m08:44:00.646007 [info ] [MainThread]: Found 22 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:44:00.649550 [info ] [MainThread]: 
[0m08:44:00.651423 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:44:00.655188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:44:00.656264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:02.810257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:44:02.811840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:03.209218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c4be0>]}
[0m08:44:03.210786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:03.211566 [info ] [MainThread]: 
[0m08:44:03.217255 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m08:44:03.218046 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m08:44:03.219020 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m08:44:03.219798 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m08:44:03.220742 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m08:44:03.221893 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m08:44:03.223123 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m08:44:03.224513 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m08:44:03.226254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m08:44:03.227754 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m08:44:03.229324 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m08:44:03.231494 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m08:44:03.232559 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m08:44:03.233461 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m08:44:03.234362 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m08:44:03.235101 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m08:44:03.252062 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m08:44:03.253642 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 08:44:03.253159 => 08:44:03.253167
[0m08:44:03.254668 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 08:44:03.254139 => 08:44:03.254144
[0m08:44:03.255955 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 08:44:03.255499 => 08:44:03.255505
[0m08:44:03.256905 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m08:44:03.257628 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m08:44:03.258337 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m08:44:03.270223 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 08:44:03.235603 => 08:44:03.269707
[0m08:44:03.311121 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m08:44:03.339295 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:44:03.426606 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:44:03.460592 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m08:44:03.533787 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:44:03.535046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:44:03.538492 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m08:44:03.985252 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:285648ad-fdc9-4c85-be24-402b0cee5b36&page=queryresults
[0m08:44:04.468430 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 08:44:03.358384 => 08:44:04.468020
[0m08:44:04.469779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119daee0>]}
[0m08:44:04.470807 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m08:44:04.472391 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m08:44:07.111905 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m08:44:07.122390 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m08:44:07.373422 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6229caab-b601-4aee-98ef-33b3151d9b86&page=queryresults
[0m08:44:07.416115 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:005095f5-8eba-4387-9c24-133f7465ca7b&page=queryresults
[0m08:44:07.499049 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m08:44:07.712070 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m08:44:07.715363 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m08:44:07.720401 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 08:44:03.258838 => 08:44:07.720026
[0m08:44:07.721737 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188db80>]}
[0m08:44:07.725346 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 08:44:03.293591 => 08:44:07.724981
[0m08:44:07.726347 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.49s]
[0m08:44:07.727797 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111801340>]}
[0m08:44:07.728947 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m08:44:07.729829 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 596[0m in 4.50s]
[0m08:44:07.731291 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m08:44:07.732602 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m08:44:07.734012 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m08:44:07.735706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m08:44:07.736393 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m08:44:07.742732 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m08:44:07.745778 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 08:44:07.736856 => 08:44:07.745032
[0m08:44:07.746497 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m08:44:07.752934 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m08:44:07.755194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:44:07.756417 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m08:44:07.804677 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d6a48bf1-5169-4f66-bffb-046d5b34b7ed&page=queryresults
[0m08:44:08.147942 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m08:44:08.152164 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 08:44:03.287877 => 08:44:08.151800
[0m08:44:08.153376 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11180ce80>]}
[0m08:44:08.154326 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.92s]
[0m08:44:08.155804 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m08:44:08.156855 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m08:44:08.157754 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m08:44:08.159338 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m08:44:08.160208 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m08:44:08.165350 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m08:44:08.167163 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 08:44:08.160661 => 08:44:08.166730
[0m08:44:08.167816 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m08:44:08.174073 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m08:44:08.175274 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:44:08.176128 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m08:44:08.347712 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fc52e307-c95d-4681-858a-0a00c3649136&page=queryresults
[0m08:44:08.620708 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:18ea18a9-7f42-46a7-b983-4d84308b79d8&page=queryresults
[0m08:44:08.673328 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 08:44:07.747118 => 08:44:08.672937
[0m08:44:08.674558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111801340>]}
[0m08:44:08.675556 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m08:44:08.676851 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m08:44:08.678089 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m08:44:08.679379 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m08:44:08.680806 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m08:44:08.681603 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m08:44:08.688553 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m08:44:08.692873 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 08:44:08.682091 => 08:44:08.692408
[0m08:44:08.693549 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m08:44:08.700366 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m08:44:08.701851 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:44:08.703058 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m08:44:08.990921 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 08:44:08.168215 => 08:44:08.990537
[0m08:44:08.992174 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2f6a0>]}
[0m08:44:08.993134 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m08:44:08.994312 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m08:44:09.341831 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9201dddb-fe5e-4aaf-82c5-2df8cd7e31ea&page=queryresults
[0m08:44:09.679107 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 08:44:08.693944 => 08:44:09.678714
[0m08:44:09.680597 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111801340>]}
[0m08:44:09.681626 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m08:44:09.682775 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m08:44:09.684085 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m08:44:09.684793 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m08:44:09.685764 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m08:44:09.686981 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m08:44:09.688756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m08:44:09.690041 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m08:44:09.690822 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m08:44:09.691533 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m08:44:09.700177 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m08:44:09.707692 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m08:44:09.710246 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 08:44:09.700749 => 08:44:09.709696
[0m08:44:09.711417 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m08:44:09.712813 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 08:44:09.692062 => 08:44:09.712198
[0m08:44:09.721003 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m08:44:09.722424 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m08:44:09.728678 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m08:44:09.730135 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:44:09.732361 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m08:44:09.733866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:44:09.736640 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m08:44:10.366650 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ef1a3291-78df-4267-83a2-2bca11e4e569&page=queryresults
[0m08:44:10.367588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9c2e3422-e647-475e-aefa-bbdb6ed81351&page=queryresults
[0m08:44:10.713051 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 08:44:09.713255 => 08:44:10.712641
[0m08:44:10.714623 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b487c0>]}
[0m08:44:10.716053 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m08:44:10.718027 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m08:44:10.724717 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 08:44:09.723156 => 08:44:10.724322
[0m08:44:10.726020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111767910>]}
[0m08:44:10.727046 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m08:44:10.728429 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m08:44:10.729707 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m08:44:10.730824 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m08:44:10.732542 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m08:44:10.733502 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m08:44:10.747054 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m08:44:10.750182 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 08:44:10.733974 => 08:44:10.749384
[0m08:44:10.751490 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m08:44:10.759515 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m08:44:10.761408 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:44:10.762745 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m08:44:11.391576 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3718582b-4f5d-49d2-92e0-26169d66ce8a&page=queryresults
[0m08:44:11.733144 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 08:44:10.752057 => 08:44:11.732734
[0m08:44:11.734630 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65e30f86-2435-493e-af34-e0192e7dd723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b38220>]}
[0m08:44:11.735801 [info ] [Thread-3  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m08:44:11.737350 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m08:44:11.740356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:11.740979 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m08:44:11.741525 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m08:44:11.742048 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m08:44:11.742804 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m08:44:11.743941 [info ] [MainThread]: 
[0m08:44:11.745566 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 11.09 seconds (11.09s).
[0m08:44:11.751492 [debug] [MainThread]: Command end result
[0m08:44:11.775425 [info ] [MainThread]: 
[0m08:44:11.776356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:11.777284 [info ] [MainThread]: 
[0m08:44:11.778391 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:44:11.782203 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.717443, "process_user_time": 8.825471, "process_kernel_time": 0.840087, "process_mem_max_rss": "147611648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:44:11.784189 [debug] [MainThread]: Command `cli build` succeeded at 08:44:11.783693 after 15.72 seconds
[0m08:44:11.786017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6dc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c61c0>]}
[0m08:44:11.787164 [debug] [MainThread]: Flushing usage events
[0m08:47:13.487166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137bd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113807a30>]}


============================== 08:47:13.495425 | a7b69c8a-78a0-4e3e-8fd4-f61118417a57 ==============================
[0m08:47:13.495425 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:47:13.496797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m08:47:14.434819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137bd0d0>]}
[0m08:47:14.621615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c1070>]}
[0m08:47:14.623268 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:47:14.658943 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m08:47:14.695958 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:47:14.697112 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m08:47:14.698479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114710f70>]}
[0m08:47:17.365036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ce30d0>]}
[0m08:47:17.396199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11479a6a0>]}
[0m08:47:17.397176 [info ] [MainThread]: Found 23 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:47:17.400607 [info ] [MainThread]: 
[0m08:47:17.402169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:47:17.404736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:47:17.405687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:19.522898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:47:19.524601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:19.817127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ce3610>]}
[0m08:47:19.820837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:47:19.822554 [info ] [MainThread]: 
[0m08:47:19.831545 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m08:47:19.833813 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_current .................................. [RUN]
[0m08:47:19.836883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m08:47:19.838865 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m08:47:19.841260 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 08:47:19.840038 => 08:47:19.840053
[0m08:47:19.842700 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m08:47:19.950249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:47:23.787695 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m08:47:24.115492 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e81f6ed1-bd30-40aa-ac17-c918528c3ee2&page=queryresults
[0m08:47:24.461074 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m08:47:24.490255 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 08:47:19.843853 => 08:47:24.489590
[0m08:47:24.491897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e83a30>]}
[0m08:47:24.493086 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.66s]
[0m08:47:24.494495 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m08:47:24.496210 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m08:47:24.497666 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.current .................................. [RUN]
[0m08:47:24.499312 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m08:47:24.500319 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m08:47:24.521360 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m08:47:24.523673 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 08:47:24.500924 => 08:47:24.522948
[0m08:47:24.524872 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m08:47:24.580084 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m08:47:24.581377 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:47:24.582777 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m08:47:25.030815 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c7c81d7f-c7d7-4d6f-8bcf-7bbe27c10a6a&page=queryresults
[0m08:47:25.350957 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 08:47:24.525596 => 08:47:25.350541
[0m08:47:25.352322 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e28040>]}
[0m08:47:25.353507 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m08:47:25.355395 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m08:47:25.356739 [debug] [Thread-2  ]: Began running node model.ccwj.current_account_earnings
[0m08:47:25.357839 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.current_account_earnings ................. [RUN]
[0m08:47:25.359365 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_account_earnings'
[0m08:47:25.360220 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_account_earnings
[0m08:47:25.365649 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_account_earnings"
[0m08:47:25.367838 [debug] [Thread-2  ]: Timing info for model.ccwj.current_account_earnings (compile): 08:47:25.360705 => 08:47:25.367395
[0m08:47:25.368523 [debug] [Thread-2  ]: Began executing node model.ccwj.current_account_earnings
[0m08:47:25.375835 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_account_earnings"
[0m08:47:25.377199 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:47:25.378396 [debug] [Thread-2  ]: On model.ccwj.current_account_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_account_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_account_earnings`
  OPTIONS()
  as select 
    *
from `ccwj-dbt`.`analytics`.`current`
where symbol like 'Account%';


[0m08:47:26.148996 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e1f16a76-5db2-406d-9f28-0b9b3a4154cf&page=queryresults
[0m08:47:26.480122 [debug] [Thread-2  ]: Timing info for model.ccwj.current_account_earnings (execute): 08:47:25.368941 => 08:47:26.479327
[0m08:47:26.482364 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b69c8a-78a0-4e3e-8fd4-f61118417a57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ed2e50>]}
[0m08:47:26.484093 [info ] [Thread-2  ]: 3 of 3 OK created sql view model analytics.current_account_earnings ............ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m08:47:26.486226 [debug] [Thread-2  ]: Finished running node model.ccwj.current_account_earnings
[0m08:47:26.491411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:26.492810 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m08:47:26.493814 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m08:47:26.494641 [debug] [MainThread]: Connection 'model.ccwj.current_account_earnings' was properly closed.
[0m08:47:26.495601 [info ] [MainThread]: 
[0m08:47:26.496531 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m08:47:26.499309 [debug] [MainThread]: Command end result
[0m08:47:26.533859 [info ] [MainThread]: 
[0m08:47:26.534740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:26.535789 [info ] [MainThread]: 
[0m08:47:26.537171 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:47:26.542418 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.175106, "process_user_time": 8.196781, "process_kernel_time": 0.694986, "process_mem_max_rss": "138035200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:47:26.544412 [debug] [MainThread]: Command `cli build` succeeded at 08:47:26.543820 after 13.18 seconds
[0m08:47:26.545290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cfc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b42700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114760af0>]}
[0m08:47:26.546004 [debug] [MainThread]: Flushing usage events
[0m08:49:13.253495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce7da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea6130>]}


============================== 08:49:13.262794 | 8f54963d-bca8-404c-9a4e-aaf0a2397062 ==============================
[0m08:49:13.262794 [info ] [MainThread]: Running with dbt=1.7.12
[0m08:49:13.264006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:49:14.632228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8a6a0>]}
[0m08:49:14.924365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd670d0>]}
[0m08:49:14.926236 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:49:14.993120 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m08:49:15.028543 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:49:15.030246 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m08:49:15.032059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde4160>]}
[0m08:49:18.221919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e396e50>]}
[0m08:49:18.250675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca62e0>]}
[0m08:49:18.251600 [info ] [MainThread]: Found 23 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m08:49:18.252334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a1c10>]}
[0m08:49:18.256767 [info ] [MainThread]: 
[0m08:49:18.259587 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:49:18.261861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m08:49:18.262846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:21.323659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m08:49:21.325827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:21.783003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3b7e80>]}
[0m08:49:21.785320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:49:21.786820 [info ] [MainThread]: 
[0m08:49:21.794388 [debug] [Thread-1  ]: Began running node model.ccwj.current_account_earnings
[0m08:49:21.796811 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_account_earnings ................. [RUN]
[0m08:49:21.799338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_account_earnings)
[0m08:49:21.801138 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_account_earnings
[0m08:49:21.833445 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_account_earnings"
[0m08:49:21.837332 [debug] [Thread-1  ]: Timing info for model.ccwj.current_account_earnings (compile): 08:49:21.802198 => 08:49:21.836346
[0m08:49:21.839033 [debug] [Thread-1  ]: Began executing node model.ccwj.current_account_earnings
[0m08:49:21.929337 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_account_earnings"
[0m08:49:21.931770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:49:21.932914 [debug] [Thread-1  ]: On model.ccwj.current_account_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_account_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_account_earnings`
  OPTIONS()
  as select 
    *
from `ccwj-dbt`.`analytics`.`current`
where symbol like 'Account%';


[0m08:49:22.507035 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0345df8f-20f7-4d10-8dfb-56c7ef8c4381&page=queryresults
[0m08:49:22.918081 [debug] [Thread-1  ]: Timing info for model.ccwj.current_account_earnings (execute): 08:49:21.839757 => 08:49:22.917561
[0m08:49:22.920214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f54963d-bca8-404c-9a4e-aaf0a2397062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4dccd0>]}
[0m08:49:22.922294 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_account_earnings ............ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m08:49:22.924550 [debug] [Thread-1  ]: Finished running node model.ccwj.current_account_earnings
[0m08:49:22.934543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:22.935393 [debug] [MainThread]: Connection 'model.ccwj.current_account_earnings' was properly closed.
[0m08:49:22.936500 [info ] [MainThread]: 
[0m08:49:22.937996 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m08:49:22.940096 [debug] [MainThread]: Command end result
[0m08:49:23.000168 [info ] [MainThread]: 
[0m08:49:23.001985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:23.003430 [info ] [MainThread]: 
[0m08:49:23.004847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:49:23.011123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.875711, "process_user_time": 8.902937, "process_kernel_time": 0.921911, "process_mem_max_rss": "136314880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:49:23.012906 [debug] [MainThread]: Command `cli run` succeeded at 08:49:23.012433 after 9.88 seconds
[0m08:49:23.014305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfacd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8a6a0>]}
[0m08:49:23.015109 [debug] [MainThread]: Flushing usage events
[0m10:24:06.912723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103760a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105225550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526ff70>]}


============================== 10:24:06.920480 | 77e8111f-5f10-4fae-bac2-9f9bcec90cbc ==============================
[0m10:24:06.920480 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:24:06.921903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:24:07.905614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607c730>]}
[0m10:24:08.344477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106002310>]}
[0m10:24:08.345815 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:24:08.385698 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m10:24:08.415976 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:24:08.417043 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m10:24:08.418030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ee4c0>]}
[0m10:24:11.188640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067490d0>]}
[0m10:24:11.215470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e51f0>]}
[0m10:24:11.216508 [info ] [MainThread]: Found 23 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:24:11.217567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5280>]}
[0m10:24:11.220824 [info ] [MainThread]: 
[0m10:24:11.222474 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:24:11.224680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:24:11.225562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:13.170521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:24:13.171754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:13.495209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675dd90>]}
[0m10:24:13.497348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:13.498267 [info ] [MainThread]: 
[0m10:24:13.504858 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m10:24:13.506148 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m10:24:13.507711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_equity_historical_earnings)
[0m10:24:13.508558 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m10:24:13.533013 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m10:24:13.536520 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 10:24:13.509046 => 10:24:13.535783
[0m10:24:13.537877 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m10:24:13.612892 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m10:24:13.614888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:24:13.616494 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_held,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m10:24:14.532014 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ea4b6c81-ef82-41e0-bd8a-7521b53dd089&page=queryresults
[0m10:24:14.884690 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 10:24:13.538982 => 10:24:14.883461
[0m10:24:14.890131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77e8111f-5f10-4fae-bac2-9f9bcec90cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908b80>]}
[0m10:24:14.891743 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m10:24:14.893898 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m10:24:14.899078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:14.900020 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m10:24:14.901103 [info ] [MainThread]: 
[0m10:24:14.902010 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m10:24:14.903770 [debug] [MainThread]: Command end result
[0m10:24:14.972841 [info ] [MainThread]: 
[0m10:24:14.973821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:14.974860 [info ] [MainThread]: 
[0m10:24:14.975959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:24:14.988009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.196735, "process_user_time": 8.580782, "process_kernel_time": 0.757819, "process_mem_max_rss": "136597504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:24:14.990612 [debug] [MainThread]: Command `cli run` succeeded at 10:24:14.990001 after 8.20 seconds
[0m10:24:14.991727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103760a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a58b0>]}
[0m10:24:14.992947 [debug] [MainThread]: Flushing usage events
[0m10:28:24.950891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b47f0>]}


============================== 10:28:24.960133 | d92d373b-c1c7-4a42-9eb9-93f0e66814b4 ==============================
[0m10:28:24.960133 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:28:24.961574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:28:25.855136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5bf4c0>]}
[0m10:28:26.035154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c53a6a0>]}
[0m10:28:26.037052 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:28:26.070181 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m10:28:26.097344 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:28:26.098605 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m10:28:26.099676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e77f0>]}
[0m10:28:28.720323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8c0d0>]}
[0m10:28:28.747187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c942550>]}
[0m10:28:28.748049 [info ] [MainThread]: Found 23 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:28:28.751446 [info ] [MainThread]: 
[0m10:28:28.753021 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:28:28.757240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:28:28.758362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:30.572561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:28:30.591350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:30.917779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8c550>]}
[0m10:28:30.919540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:30.920587 [info ] [MainThread]: 
[0m10:28:30.925202 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m10:28:30.926030 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m10:28:30.926993 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m10:28:30.927794 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m10:28:30.928735 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m10:28:30.930235 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m10:28:30.931629 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m10:28:30.932982 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m10:28:30.934652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m10:28:30.936762 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m10:28:30.938857 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m10:28:30.940693 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m10:28:30.941763 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m10:28:30.942751 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m10:28:30.943655 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m10:28:30.944743 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m10:28:30.963013 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 10:28:30.962052 => 10:28:30.962063
[0m10:28:30.968248 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m10:28:30.970279 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 10:28:30.969369 => 10:28:30.969389
[0m10:28:30.972068 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 10:28:30.971239 => 10:28:30.971247
[0m10:28:30.973189 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m10:28:30.974918 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m10:28:30.976252 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m10:28:30.982852 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 10:28:30.945435 => 10:28:30.982292
[0m10:28:31.037506 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m10:28:31.052027 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m10:28:31.164233 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m10:28:31.202015 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m10:28:31.260572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:28:31.266642 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:28:31.267520 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m10:28:31.731277 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b44048ac-8b93-4a74-a15d-b7e9c551c66d&page=queryresults
[0m10:28:32.100964 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 10:28:31.058622 => 10:28:32.100148
[0m10:28:32.102559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf59fd0>]}
[0m10:28:32.103716 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m10:28:32.105405 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m10:28:34.754889 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m10:28:34.829791 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m10:28:35.053747 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:087cfa93-b11a-4dbe-ac9c-cd8cbb68181c&page=queryresults
[0m10:28:35.095364 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5e31da04-462c-42c4-8e13-9d78f1c49601&page=queryresults
[0m10:28:35.153658 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m10:28:35.393892 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m10:28:35.397314 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m10:28:35.402272 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 10:28:30.976962 => 10:28:35.401898
[0m10:28:35.403599 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce57fa0>]}
[0m10:28:35.407261 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 10:28:31.018253 => 10:28:35.406890
[0m10:28:35.408267 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.47s]
[0m10:28:35.410372 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc4940>]}
[0m10:28:35.411638 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m10:28:35.412538 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 596[0m in 4.47s]
[0m10:28:35.414025 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m10:28:35.415109 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m10:28:35.415952 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m10:28:35.417544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m10:28:35.418264 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m10:28:35.425677 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m10:28:35.427902 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 10:28:35.418691 => 10:28:35.427143
[0m10:28:35.429016 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m10:28:35.436706 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m10:28:35.438058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:28:35.439737 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m10:28:35.454817 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cb9065dc-3305-49c8-9e13-30b21b259f36&page=queryresults
[0m10:28:35.778042 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m10:28:35.783310 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 10:28:31.011648 => 10:28:35.782910
[0m10:28:35.784801 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd59ee0>]}
[0m10:28:35.785739 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.85s]
[0m10:28:35.786996 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m10:28:35.788064 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m10:28:35.788891 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m10:28:35.790257 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m10:28:35.791121 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m10:28:35.797832 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m10:28:35.799414 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 10:28:35.791586 => 10:28:35.798874
[0m10:28:35.800740 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m10:28:35.808415 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m10:28:35.809923 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m10:28:35.811018 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m10:28:35.868381 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9c2491c5-ae30-4bea-98d3-153712de831f&page=queryresults
[0m10:28:36.191367 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 10:28:35.429596 => 10:28:36.190888
[0m10:28:36.192758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc4940>]}
[0m10:28:36.194043 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m10:28:36.195349 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m10:28:36.196497 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m10:28:36.197320 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m10:28:36.198691 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m10:28:36.199423 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m10:28:36.205173 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m10:28:36.208366 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 10:28:36.199848 => 10:28:36.207901
[0m10:28:36.209076 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m10:28:36.215892 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m10:28:36.217326 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:28:36.218315 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m10:28:36.292089 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a5cc425e-2abc-4be3-bdff-98b6388870e7&page=queryresults
[0m10:28:36.614454 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 10:28:35.801505 => 10:28:36.614069
[0m10:28:36.615752 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd43d0>]}
[0m10:28:36.616724 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m10:28:36.618221 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m10:28:36.796305 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:27bdb007-004d-4446-8423-d156a302453d&page=queryresults
[0m10:28:37.110172 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 10:28:36.209505 => 10:28:37.109504
[0m10:28:37.112289 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d129160>]}
[0m10:28:37.114086 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m10:28:37.116150 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m10:28:37.117765 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m10:28:37.118575 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m10:28:37.119616 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m10:28:37.121017 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m10:28:37.123004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m10:28:37.124482 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m10:28:37.125326 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m10:28:37.126109 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m10:28:37.135839 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m10:28:37.144855 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m10:28:37.147193 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 10:28:37.126732 => 10:28:37.146432
[0m10:28:37.148756 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m10:28:37.150176 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 10:28:37.136774 => 10:28:37.149434
[0m10:28:37.161480 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m10:28:37.162733 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m10:28:37.172435 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m10:28:37.173354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:28:37.174395 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_quantity,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m10:28:37.175560 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m10:28:37.177650 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as options_quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m10:28:37.807990 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4e676f13-7bcd-4d64-ae26-fac9383792b6&page=queryresults
[0m10:28:37.809074 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:59dd0e96-2b53-4d9f-8065-fd34ecdfcb57&page=queryresults
[0m10:28:38.129734 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 10:28:37.163781 => 10:28:38.129344
[0m10:28:38.131083 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d174fd0>]}
[0m10:28:38.132082 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m10:28:38.133390 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m10:28:38.176037 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 10:28:37.151217 => 10:28:38.175608
[0m10:28:38.177410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d16bd30>]}
[0m10:28:38.178421 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m10:28:38.179898 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m10:28:38.181656 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m10:28:38.183035 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m10:28:38.184953 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_earnings)
[0m10:28:38.185755 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m10:28:38.191769 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m10:28:38.194583 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 10:28:38.186185 => 10:28:38.194100
[0m10:28:38.195351 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m10:28:38.201958 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m10:28:38.203361 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m10:28:38.204450 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.equity_shares_quantity as security_quantity,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.optoins_quantity as security_quantity,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m10:28:38.870316 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a1c7f53a-3452-4c2d-b818-ab2413afa6ae&page=queryresults
[0m10:28:39.116434 [debug] [Thread-3  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name optoins_quantity not found inside current_option_historical_earnings at [20:40]; reason: invalidQuery, location: query, message: Name optoins_quantity not found inside current_option_historical_earnings at [20:40]')
[0m10:28:39.643773 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cb82e2be-5869-43e6-aadc-4edf8fa52476&page=queryresults
[0m10:28:39.930428 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cb82e2be-5869-43e6-aadc-4edf8fa52476&page=queryresults
[0m10:28:39.931911 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 10:28:38.195795 => 10:28:39.931305
[0m10:28:39.979080 [debug] [Thread-3  ]: Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name optoins_quantity not found inside current_option_historical_earnings at [20:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m10:28:39.980585 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd92d373b-c1c7-4a42-9eb9-93f0e66814b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d152040>]}
[0m10:28:39.981926 [error] [Thread-3  ]: 10 of 10 ERROR creating sql view model analytics.current_holdings_historical_earnings  [[31mERROR[0m in 1.80s]
[0m10:28:39.983768 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m10:28:39.986651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:39.987237 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m10:28:39.987754 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m10:28:39.988347 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m10:28:39.989052 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m10:28:39.989734 [info ] [MainThread]: 
[0m10:28:39.990532 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m10:28:39.997347 [debug] [MainThread]: Command end result
[0m10:28:40.028411 [info ] [MainThread]: 
[0m10:28:40.029187 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:40.030244 [info ] [MainThread]: 
[0m10:28:40.031181 [error] [MainThread]:   Database Error in model current_holdings_historical_earnings (models/intermediate/current_holdings_historical_earnings.sql)
  Name optoins_quantity not found inside current_option_historical_earnings at [20:40]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_earnings.sql
[0m10:28:40.032266 [info ] [MainThread]: 
[0m10:28:40.033955 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m10:28:40.038536 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 15.201107, "process_user_time": 8.490048, "process_kernel_time": 0.688212, "process_mem_max_rss": "148926464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:28:40.040377 [debug] [MainThread]: Command `cli build` failed at 10:28:40.039984 after 15.20 seconds
[0m10:28:40.041612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8c2b0>]}
[0m10:28:40.042781 [debug] [MainThread]: Flushing usage events
[0m10:29:17.805166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550e460>]}


============================== 10:29:17.813518 | 63db4b82-99d0-4e90-a47a-325b6784d983 ==============================
[0m10:29:17.813518 [info ] [MainThread]: Running with dbt=1.7.12
[0m10:29:17.815282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:18.858969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cd760>]}
[0m10:29:19.090898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105514a00>]}
[0m10:29:19.093429 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m10:29:19.135995 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m10:29:19.170041 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:19.171770 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m10:29:19.173176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106453070>]}
[0m10:29:23.131094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ef0d0>]}
[0m10:29:23.158708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106638d60>]}
[0m10:29:23.160040 [info ] [MainThread]: Found 23 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m10:29:23.161361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fc220>]}
[0m10:29:23.164632 [info ] [MainThread]: 
[0m10:29:23.166283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:29:23.168252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m10:29:23.169110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:25.138448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m10:29:25.139620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:25.409025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a69c10>]}
[0m10:29:25.410725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:25.411661 [info ] [MainThread]: 
[0m10:29:25.417313 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m10:29:25.418493 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_earnings ..... [RUN]
[0m10:29:25.419857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_earnings)
[0m10:29:25.420662 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m10:29:25.441202 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m10:29:25.444550 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 10:29:25.421156 => 10:29:25.443952
[0m10:29:25.445380 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m10:29:25.539309 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m10:29:25.541252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:29:25.542239 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.equity_shares_quantity as security_quantity,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.options_quantity as security_quantity,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m10:29:26.154186 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:603daa61-ee83-4b3c-b523-1c7bda719034&page=queryresults
[0m10:29:26.479275 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 10:29:25.445836 => 10:29:26.478881
[0m10:29:26.480564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63db4b82-99d0-4e90-a47a-325b6784d983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b29d30>]}
[0m10:29:26.481562 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m10:29:26.483174 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m10:29:26.486191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:26.486822 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m10:29:26.487407 [info ] [MainThread]: 
[0m10:29:26.488237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m10:29:26.489685 [debug] [MainThread]: Command end result
[0m10:29:26.517739 [info ] [MainThread]: 
[0m10:29:26.518611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:26.519630 [info ] [MainThread]: 
[0m10:29:26.520833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:26.524303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.849436, "process_user_time": 8.623953, "process_kernel_time": 0.690337, "process_mem_max_rss": "136966144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:29:26.525860 [debug] [MainThread]: Command `cli run` succeeded at 10:29:26.525573 after 8.85 seconds
[0m10:29:26.526591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067092e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fc130>]}
[0m10:29:26.527250 [debug] [MainThread]: Flushing usage events
[0m13:33:06.877461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d711a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ca550>]}


============================== 13:33:06.889434 | 25268ca6-a566-4323-8564-f4887833b77e ==============================
[0m13:33:06.889434 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:33:06.891102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:07.890147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1af670>]}
[0m13:33:08.075074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f99d910>]}
[0m13:33:08.076422 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:33:08.112721 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:33:08.145058 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:33:08.146452 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:33:08.147673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11005b6d0>]}
[0m13:33:10.941426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c40d0>]}
[0m13:33:10.969280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ec6a0>]}
[0m13:33:10.970248 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:33:10.971182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110018c40>]}
[0m13:33:10.974356 [info ] [MainThread]: 
[0m13:33:10.976027 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:10.977866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:33:10.978841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:13.685210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:33:13.688954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:14.167757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11070ba90>]}
[0m13:33:14.170349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:14.171560 [info ] [MainThread]: 
[0m13:33:14.178816 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:33:14.180497 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m13:33:14.182452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_symbol_dates)
[0m13:33:14.183695 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:33:14.206082 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:33:14.210234 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:33:14.184237 => 13:33:14.209401
[0m13:33:14.211541 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:33:14.272416 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:33:14.273743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:14.274597 [debug] [Thread-1  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m13:33:14.845145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f4ceccbf-9037-4c12-ab88-ca35c8bdd86f&page=queryresults
[0m13:33:15.222185 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:33:14.212206 => 13:33:15.221770
[0m13:33:15.223870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25268ca6-a566-4323-8564-f4887833b77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885b20>]}
[0m13:33:15.225217 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m13:33:15.227010 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:33:15.230022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:15.230688 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m13:33:15.231298 [info ] [MainThread]: 
[0m13:33:15.232156 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m13:33:15.233650 [debug] [MainThread]: Command end result
[0m13:33:15.260772 [info ] [MainThread]: 
[0m13:33:15.261599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:15.262367 [info ] [MainThread]: 
[0m13:33:15.263473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:33:15.268435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.56018, "process_user_time": 8.79562, "process_kernel_time": 0.968955, "process_mem_max_rss": "136503296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:33:15.269503 [debug] [MainThread]: Command `cli run` succeeded at 13:33:15.269259 after 8.56 seconds
[0m13:33:15.270241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d711a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110772640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110018070>]}
[0m13:33:15.271387 [debug] [MainThread]: Flushing usage events
[0m13:34:06.923792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b67eb0>]}


============================== 13:34:06.930842 | f8c69c91-d3fd-41c3-b786-457695afc4cd ==============================
[0m13:34:06.930842 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:34:06.932025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:07.832990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1c910>]}
[0m13:34:08.009282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fdca0>]}
[0m13:34:08.010588 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:34:08.048124 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:34:08.081301 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:34:08.082456 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:34:08.083608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ecb50>]}
[0m13:34:10.718337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070400d0>]}
[0m13:34:10.746678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4db80>]}
[0m13:34:10.747549 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:34:10.751852 [info ] [MainThread]: 
[0m13:34:10.753616 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:10.756426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:34:10.757245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:12.898616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:34:12.899876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:13.219601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070405b0>]}
[0m13:34:13.221415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:13.222208 [info ] [MainThread]: 
[0m13:34:13.226167 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m13:34:13.226969 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m13:34:13.228045 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m13:34:13.229038 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m13:34:13.230474 [info ] [Thread-1  ]: 1 of 9 START sql view model analytics.calendar_dates ........................... [RUN]
[0m13:34:13.231870 [info ] [Thread-2  ]: 2 of 9 START seed file analytics.0417_current .................................. [RUN]
[0m13:34:13.233322 [info ] [Thread-3  ]: 3 of 9 START seed file analytics.0417_history .................................. [RUN]
[0m13:34:13.236937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m13:34:13.234912 [info ] [Thread-4  ]: 4 of 9 START seed file analytics.cflt_prices ................................... [RUN]
[0m13:34:13.240117 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m13:34:13.242106 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:34:13.243508 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m13:34:13.245699 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m13:34:13.246663 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m13:34:13.247663 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m13:34:13.264899 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m13:34:13.265687 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:34:13.266668 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 13:34:13.266193 => 13:34:13.266199
[0m13:34:13.267896 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 13:34:13.267176 => 13:34:13.267181
[0m13:34:13.269595 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:34:13.268753 => 13:34:13.268762
[0m13:34:13.270950 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m13:34:13.272244 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 13:34:13.248311 => 13:34:13.271666
[0m13:34:13.273246 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m13:34:13.274115 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m13:34:13.295648 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m13:34:13.374707 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:34:13.467678 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m13:34:13.507283 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:34:13.541371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:13.561137 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m13:34:13.603523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:34:14.054831 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:687fae12-e8b8-44ea-bb6f-0b14aa9b54da&page=queryresults
[0m13:34:14.417144 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 13:34:13.343280 => 13:34:14.416718
[0m13:34:14.418964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719ddc0>]}
[0m13:34:14.420160 [info ] [Thread-1  ]: 1 of 9 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m13:34:14.421479 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m13:34:17.101456 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:34:17.379301 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:611be9d7-9e38-4da9-a119-8e49ebda7d3e&page=queryresults
[0m13:34:17.408956 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:34:17.548422 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:34:17.722994 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:34:17.723988 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6f555b02-dc4d-42cc-a17a-7d8812ec29e6&page=queryresults
[0m13:34:17.729701 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 13:34:13.274848 => 13:34:17.729343
[0m13:34:17.731029 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720cfa0>]}
[0m13:34:17.732611 [info ] [Thread-2  ]: 2 of 9 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.49s]
[0m13:34:17.734061 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m13:34:17.735094 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m13:34:17.735978 [info ] [Thread-1  ]: 5 of 9 START sql view model analytics.current .................................. [RUN]
[0m13:34:17.737633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m13:34:17.738750 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m13:34:17.745797 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:34:17.747618 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 13:34:17.739636 => 13:34:17.747204
[0m13:34:17.748912 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m13:34:17.761412 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:34:17.765551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:17.767742 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:34:17.865352 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:839ca51b-3b91-4653-9a78-7233233e7b88&page=queryresults
[0m13:34:18.054281 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:34:18.063543 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:34:13.318098 => 13:34:18.062927
[0m13:34:18.065633 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704e4f0>]}
[0m13:34:18.067217 [info ] [Thread-4  ]: 4 of 9 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 596[0m in 4.82s]
[0m13:34:18.069468 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m13:34:18.374738 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cbb75163-a8ad-484f-ae7c-afca5ba61194&page=queryresults
[0m13:34:18.518291 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:34:18.523182 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 13:34:13.306987 => 13:34:18.522742
[0m13:34:18.524689 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710ddf0>]}
[0m13:34:18.525696 [info ] [Thread-3  ]: 3 of 9 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 5.28s]
[0m13:34:18.527157 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m13:34:18.528337 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m13:34:18.529226 [info ] [Thread-2  ]: 6 of 9 START sql view model analytics.history .................................. [RUN]
[0m13:34:18.530885 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:34:18.531820 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m13:34:18.538369 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:34:18.540370 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 13:34:18.532335 => 13:34:18.539704
[0m13:34:18.541659 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m13:34:18.557404 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:34:18.561151 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:34:18.562778 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:34:18.727376 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 13:34:17.749796 => 13:34:18.726977
[0m13:34:18.728702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710d6d0>]}
[0m13:34:18.729704 [info ] [Thread-1  ]: 5 of 9 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m13:34:18.730900 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m13:34:18.732056 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:34:18.732904 [info ] [Thread-3  ]: 7 of 9 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m13:34:18.734288 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m13:34:18.735075 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:34:18.751009 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:34:18.753477 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:34:18.735567 => 13:34:18.752748
[0m13:34:18.754724 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:34:18.762048 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:34:18.763613 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:34:18.764598 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)

select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols;


[0m13:34:19.048125 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0bf0520e-52d4-4a15-8484-b903c87dbb08&page=queryresults
[0m13:34:19.351994 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dec36a96-816d-479a-87de-2e7b358405ad&page=queryresults
[0m13:34:19.369837 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 13:34:18.542753 => 13:34:19.369437
[0m13:34:19.371142 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e7790>]}
[0m13:34:19.372136 [info ] [Thread-2  ]: 6 of 9 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m13:34:19.373413 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m13:34:19.693145 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:34:18.755231 => 13:34:19.692197
[0m13:34:19.694686 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711a760>]}
[0m13:34:19.696297 [info ] [Thread-3  ]: 7 of 9 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m13:34:19.698114 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:34:19.699766 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m13:34:19.700840 [info ] [Thread-1  ]: 8 of 9 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m13:34:19.702506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m13:34:19.703369 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m13:34:19.711482 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m13:34:19.714156 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 13:34:19.703893 => 13:34:19.713649
[0m13:34:19.714881 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m13:34:19.722007 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m13:34:19.724461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:19.725868 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_quantity,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m13:34:20.402172 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:74417c08-3a1b-410b-85d9-e6a4f7cea588&page=queryresults
[0m13:34:20.726592 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 13:34:19.715477 => 13:34:20.726195
[0m13:34:20.728073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fd4c0>]}
[0m13:34:20.729191 [info ] [Thread-1  ]: 8 of 9 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:34:20.730571 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m13:34:20.731774 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:34:20.732847 [info ] [Thread-2  ]: 9 of 9 START sql view model analytics.current_holdings_historical_strategy_and_earnings  [RUN]
[0m13:34:20.734329 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_holdings_historical_strategy_and_earnings)
[0m13:34:20.735095 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:34:20.743214 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:34:20.745680 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (compile): 13:34:20.735618 => 13:34:20.744780
[0m13:34:20.747143 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:34:20.756727 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:34:20.758000 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:34:20.758853 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_strategy_and_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy_and_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy_and_earnings`
  OPTIONS()
  as select 
    *
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
 left join `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
    on current_equity_historical_earnings.day = calendar_symbol_dates.day 
        and current_equity_historical_earnings.day = calendar_symbol_dates.symbol 

where calendar_symbol_dates.symbol = 'CFLT';


[0m13:34:21.423836 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c60f98ba-4068-4622-8e58-d95d10237476&page=queryresults
[0m13:34:21.697196 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator = for argument types: DATE, STRING. Supported signature: ANY = ANY at [11:13]; reason: invalidQuery, location: query, message: No matching signature for operator = for argument types: DATE, STRING. Supported signature: ANY = ANY at [11:13]')
[0m13:34:22.249502 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:60a2135a-65b1-40bd-ab72-604ada6fdaaa&page=queryresults
[0m13:34:22.501928 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:60a2135a-65b1-40bd-ab72-604ada6fdaaa&page=queryresults
[0m13:34:22.503540 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (execute): 13:34:20.747827 => 13:34:22.502869
[0m13:34:22.517929 [debug] [Thread-2  ]: Database Error in model current_holdings_historical_strategy_and_earnings (models/intermediate/current_holdings_historical_strategy_and_earnings.sql)
  No matching signature for operator = for argument types: DATE, STRING. Supported signature: ANY = ANY at [11:13]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_strategy_and_earnings.sql
[0m13:34:22.519245 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c69c91-d3fd-41c3-b786-457695afc4cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073931f0>]}
[0m13:34:22.524050 [error] [Thread-2  ]: 9 of 9 ERROR creating sql view model analytics.current_holdings_historical_strategy_and_earnings  [[31mERROR[0m in 1.79s]
[0m13:34:22.525990 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:34:22.554994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:22.556018 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m13:34:22.556845 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy_and_earnings' was properly closed.
[0m13:34:22.557623 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m13:34:22.558388 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m13:34:22.559362 [info ] [MainThread]: 
[0m13:34:22.560350 [info ] [MainThread]: Finished running 6 view models, 3 seeds in 0 hours 0 minutes and 11.81 seconds (11.81s).
[0m13:34:22.567648 [debug] [MainThread]: Command end result
[0m13:34:22.641554 [info ] [MainThread]: 
[0m13:34:22.643402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:34:22.645443 [info ] [MainThread]: 
[0m13:34:22.647109 [error] [MainThread]:   Database Error in model current_holdings_historical_strategy_and_earnings (models/intermediate/current_holdings_historical_strategy_and_earnings.sql)
  No matching signature for operator = for argument types: DATE, STRING. Supported signature: ANY = ANY at [11:13]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_strategy_and_earnings.sql
[0m13:34:22.649381 [info ] [MainThread]: 
[0m13:34:22.650763 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:34:22.658699 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 15.832795, "process_user_time": 8.341915, "process_kernel_time": 0.672398, "process_mem_max_rss": "147316736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:34:22.660569 [debug] [MainThread]: Command `cli build` failed at 13:34:22.660140 after 15.83 seconds
[0m13:34:22.662037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b38e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1c910>]}
[0m13:34:22.663094 [debug] [MainThread]: Flushing usage events
[0m13:36:48.394817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10309b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b767c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bab8b0>]}


============================== 13:36:48.403620 | f80f4f59-4af4-41cf-8f1f-03349e6d2ade ==============================
[0m13:36:48.403620 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:36:48.405057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:49.296847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b76f10>]}
[0m13:36:49.476349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a8400>]}
[0m13:36:49.477861 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:36:49.516870 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:36:49.544744 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:36:49.545990 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:36:49.546870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aeb1f0>]}
[0m13:36:52.263132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060830d0>]}
[0m13:36:52.291577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c97d00>]}
[0m13:36:52.292642 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:36:52.296088 [info ] [MainThread]: 
[0m13:36:52.297694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:36:52.300610 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:36:52.301488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:54.106739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:36:54.108523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:54.417318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106083eb0>]}
[0m13:36:54.419656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:54.421358 [info ] [MainThread]: 
[0m13:36:54.428123 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m13:36:54.428890 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m13:36:54.430026 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m13:36:54.431110 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m13:36:54.432820 [info ] [Thread-1  ]: 1 of 9 START sql view model analytics.calendar_dates ........................... [RUN]
[0m13:36:54.434779 [info ] [Thread-2  ]: 2 of 9 START seed file analytics.0417_current .................................. [RUN]
[0m13:36:54.436342 [info ] [Thread-3  ]: 3 of 9 START seed file analytics.0417_history .................................. [RUN]
[0m13:36:54.437891 [info ] [Thread-4  ]: 4 of 9 START seed file analytics.cflt_prices ................................... [RUN]
[0m13:36:54.440230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m13:36:54.442853 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m13:36:54.446670 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:36:54.450145 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m13:36:54.452101 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m13:36:54.453609 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m13:36:54.455256 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m13:36:54.456655 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:36:54.475826 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 13:36:54.474867 => 13:36:54.474879
[0m13:36:54.487545 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m13:36:54.489122 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 13:36:54.488459 => 13:36:54.488467
[0m13:36:54.491018 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:36:54.490358 => 13:36:54.490364
[0m13:36:54.492172 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m13:36:54.493613 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m13:36:54.494908 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m13:36:54.496012 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 13:36:54.457596 => 13:36:54.495410
[0m13:36:54.590556 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m13:36:54.661423 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:36:54.852536 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:36:54.898419 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m13:36:54.948589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:54.950837 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m13:36:54.989740 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:36:55.404402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cdf6028c-3177-4fdf-96c0-568cd8dd34a3&page=queryresults
[0m13:36:55.798798 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 13:36:54.653004 => 13:36:55.798108
[0m13:36:55.801490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a3b80>]}
[0m13:36:55.802914 [info ] [Thread-1  ]: 1 of 9 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m13:36:55.804672 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m13:36:58.435046 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:36:58.735079 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e7c03b04-eb7d-45a0-839f-0c2198d8639a&page=queryresults
[0m13:36:59.080199 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:36:59.095395 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:36:59.102268 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 13:36:54.496433 => 13:36:59.101833
[0m13:36:59.103622 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062518e0>]}
[0m13:36:59.104566 [info ] [Thread-2  ]: 2 of 9 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.66s]
[0m13:36:59.105721 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m13:36:59.106854 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m13:36:59.107791 [info ] [Thread-1  ]: 5 of 9 START sql view model analytics.current .................................. [RUN]
[0m13:36:59.109497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m13:36:59.110448 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m13:36:59.116102 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:36:59.117699 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 13:36:59.110902 => 13:36:59.117078
[0m13:36:59.118894 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m13:36:59.126532 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:36:59.128134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:59.129599 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:36:59.557864 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bf0fa788-4df7-4a49-a224-dca066f4ea90&page=queryresults
[0m13:36:59.592204 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7272fca5-a4c5-4c9e-b270-4d07938296fb&page=queryresults
[0m13:36:59.874794 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:36:59.878951 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 13:36:54.527204 => 13:36:59.878561
[0m13:36:59.880473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c8820>]}
[0m13:36:59.881594 [info ] [Thread-3  ]: 3 of 9 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1869[0m in 5.44s]
[0m13:36:59.883059 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m13:36:59.884753 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m13:36:59.886092 [info ] [Thread-2  ]: 6 of 9 START sql view model analytics.history .................................. [RUN]
[0m13:36:59.888090 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:36:59.888836 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m13:36:59.895172 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:36:59.897307 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 13:36:59.889354 => 13:36:59.896791
[0m13:36:59.898066 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m13:36:59.905034 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:36:59.906249 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:36:59.907207 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:36:59.947294 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 13:36:59.119698 => 13:36:59.946924
[0m13:36:59.948719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106210520>]}
[0m13:36:59.949882 [info ] [Thread-1  ]: 5 of 9 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m13:36:59.951478 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m13:36:59.952613 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:36:59.953409 [info ] [Thread-3  ]: 7 of 9 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m13:36:59.954683 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m13:36:59.955387 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:36:59.966507 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:36:59.967810 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:36:59.955803 => 13:36:59.967400
[0m13:36:59.968460 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:36:59.974036 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:36:59.975492 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:36:59.976862 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, final as (
select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols 
) 
select * 
from final 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m13:37:00.395754 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:60f2fd10-c41c-4e81-a21b-30d0ed3cc498&page=queryresults
[0m13:37:00.527193 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:52711387-d8ae-40b7-8d09-362c9eebe441&page=queryresults
[0m13:37:00.834282 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:36:59.968865 => 13:37:00.833923
[0m13:37:00.835529 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cda00>]}
[0m13:37:00.836472 [info ] [Thread-3  ]: 7 of 9 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m13:37:00.837782 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:37:00.953714 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 13:36:59.898799 => 13:37:00.953357
[0m13:37:00.955046 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b4610>]}
[0m13:37:00.955960 [info ] [Thread-2  ]: 6 of 9 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m13:37:00.957517 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m13:37:05.313511 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:37:05.572792 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:157fd689-a496-4c77-b578-54c617765180&page=queryresults
[0m13:37:05.880791 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:37:05.886028 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:36:54.559604 => 13:37:05.885620
[0m13:37:05.887906 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062057f0>]}
[0m13:37:05.888848 [info ] [Thread-4  ]: 4 of 9 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 596[0m in 11.44s]
[0m13:37:05.890158 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m13:37:05.892140 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m13:37:05.893216 [info ] [Thread-1  ]: 8 of 9 START sql view model analytics.current_equity_historical_earnings ....... [RUN]
[0m13:37:05.894545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m13:37:05.895422 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m13:37:05.903484 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m13:37:05.904919 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 13:37:05.895899 => 13:37:05.904508
[0m13:37:05.905571 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m13:37:05.911985 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m13:37:05.913121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:05.914034 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_quantity,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m13:37:06.572739 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7351a023-2dcf-461e-8a61-1d76febc1440&page=queryresults
[0m13:37:06.872528 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 13:37:05.906125 => 13:37:06.872146
[0m13:37:06.873756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106097bb0>]}
[0m13:37:06.874684 [info ] [Thread-1  ]: 8 of 9 OK created sql view model analytics.current_equity_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m13:37:06.876284 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m13:37:06.877719 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:37:06.878915 [info ] [Thread-2  ]: 9 of 9 START sql view model analytics.current_holdings_historical_strategy_and_earnings  [RUN]
[0m13:37:06.880343 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now model.ccwj.current_holdings_historical_strategy_and_earnings)
[0m13:37:06.881103 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:37:06.886724 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:37:06.888074 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (compile): 13:37:06.881575 => 13:37:06.887663
[0m13:37:06.888735 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:37:06.894443 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:37:06.895793 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:37:06.896625 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_strategy_and_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy_and_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy_and_earnings`
  OPTIONS()
  as select 
    *
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
 left join `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
    on current_equity_historical_earnings.day = calendar_symbol_dates.day 
        and current_equity_historical_earnings.symbol = calendar_symbol_dates.symbol 

where calendar_symbol_dates.symbol = 'CFLT';


[0m13:37:07.514937 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ce9c0838-6dfc-4fc5-a9ac-5b9767d44725&page=queryresults
[0m13:37:07.789013 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW has columns with duplicate name day at [6:6]; reason: invalidQuery, location: query, message: CREATE VIEW has columns with duplicate name day at [6:6]')
[0m13:37:09.048321 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:40885241-d36d-432d-b537-4dd34953c0fd&page=queryresults
[0m13:37:09.339590 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:40885241-d36d-432d-b537-4dd34953c0fd&page=queryresults
[0m13:37:09.341043 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (execute): 13:37:06.889132 => 13:37:09.340429
[0m13:37:09.358893 [debug] [Thread-2  ]: Database Error in model current_holdings_historical_strategy_and_earnings (models/intermediate/current_holdings_historical_strategy_and_earnings.sql)
  CREATE VIEW has columns with duplicate name day at [6:6]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_strategy_and_earnings.sql
[0m13:37:09.359705 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80f4f59-4af4-41cf-8f1f-03349e6d2ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106156a60>]}
[0m13:37:09.360659 [error] [Thread-2  ]: 9 of 9 ERROR creating sql view model analytics.current_holdings_historical_strategy_and_earnings  [[31mERROR[0m in 2.48s]
[0m13:37:09.362955 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:37:09.366404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:09.367028 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m13:37:09.367533 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy_and_earnings' was properly closed.
[0m13:37:09.368021 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m13:37:09.368606 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m13:37:09.369554 [info ] [MainThread]: 
[0m13:37:09.370312 [info ] [MainThread]: Finished running 6 view models, 3 seeds in 0 hours 0 minutes and 17.07 seconds (17.07s).
[0m13:37:09.374056 [debug] [MainThread]: Command end result
[0m13:37:09.403018 [info ] [MainThread]: 
[0m13:37:09.403936 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:09.404927 [info ] [MainThread]: 
[0m13:37:09.406211 [error] [MainThread]:   Database Error in model current_holdings_historical_strategy_and_earnings (models/intermediate/current_holdings_historical_strategy_and_earnings.sql)
  CREATE VIEW has columns with duplicate name day at [6:6]
  compiled Code at target/run/ccwj/models/intermediate/current_holdings_historical_strategy_and_earnings.sql
[0m13:37:09.407108 [info ] [MainThread]: 
[0m13:37:09.407891 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:37:09.411670 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 21.141668, "process_user_time": 8.59692, "process_kernel_time": 0.768276, "process_mem_max_rss": "147722240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:37:09.412672 [debug] [MainThread]: Command `cli build` failed at 13:37:09.412436 after 21.14 seconds
[0m13:37:09.413411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10309b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c97d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a8400>]}
[0m13:37:09.414141 [debug] [MainThread]: Flushing usage events
[0m13:54:07.820917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af767c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afac8b0>]}


============================== 13:54:07.829534 | dfb30ce1-67db-4fdf-a3d2-5886696530cd ==============================
[0m13:54:07.829534 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:54:07.830725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:54:08.956553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b022e80>]}
[0m13:54:09.130172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b777eb0>]}
[0m13:54:09.132051 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:54:09.166454 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:54:09.196310 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:54:09.197431 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:54:09.198640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef6400>]}
[0m13:54:11.816168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4850d0>]}
[0m13:54:11.846660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c092b20>]}
[0m13:54:11.847616 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:54:11.851039 [info ] [MainThread]: 
[0m13:54:11.852675 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:11.855692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:54:11.856718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:14.032574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:54:14.033988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:14.305778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c485b80>]}
[0m13:54:14.307585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:14.308525 [info ] [MainThread]: 
[0m13:54:14.313906 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m13:54:14.314717 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m13:54:14.315661 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m13:54:14.316492 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m13:54:14.317434 [info ] [Thread-1  ]: 1 of 10 START sql view model analytics.calendar_dates .......................... [RUN]
[0m13:54:14.318503 [info ] [Thread-2  ]: 2 of 10 START seed file analytics.0417_current ................................. [RUN]
[0m13:54:14.319664 [info ] [Thread-3  ]: 3 of 10 START seed file analytics.0417_history ................................. [RUN]
[0m13:54:14.320736 [info ] [Thread-4  ]: 4 of 10 START seed file analytics.cflt_prices .................................. [RUN]
[0m13:54:14.322235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m13:54:14.323719 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m13:54:14.325475 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m13:54:14.327110 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m13:54:14.328319 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m13:54:14.329770 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m13:54:14.330762 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m13:54:14.331804 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m13:54:14.346849 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m13:54:14.347957 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 13:54:14.347472 => 13:54:14.347480
[0m13:54:14.348842 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 13:54:14.348457 => 13:54:14.348461
[0m13:54:14.349722 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 13:54:14.349313 => 13:54:14.349317
[0m13:54:14.350750 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m13:54:14.351660 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m13:54:14.352739 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m13:54:14.353721 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 13:54:14.332471 => 13:54:14.353210
[0m13:54:14.425108 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m13:54:14.438594 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:54:14.507267 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m13:54:14.522425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:14.555769 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m13:54:14.575512 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:54:14.661538 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:54:15.177134 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cbfd2b3f-d34c-420c-885d-01dd3d74ef59&page=queryresults
[0m13:54:15.553854 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 13:54:14.441892 => 13:54:15.553460
[0m13:54:15.555149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c68ddc0>]}
[0m13:54:15.556221 [info ] [Thread-1  ]: 1 of 10 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m13:54:15.557551 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m13:54:18.111790 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m13:54:18.449933 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8aba482d-703c-475a-9469-63dc35386445&page=queryresults
[0m13:54:18.582554 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m13:54:18.722254 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m13:54:18.821617 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:20accce9-db29-4713-973f-18fa07786082&page=queryresults
[0m13:54:18.918960 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m13:54:18.925174 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 13:54:14.354244 => 13:54:18.924734
[0m13:54:18.926399 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c652f70>]}
[0m13:54:18.927235 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 4.60s]
[0m13:54:18.928254 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m13:54:18.929272 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m13:54:18.930056 [info ] [Thread-1  ]: 5 of 10 START sql view model analytics.current ................................. [RUN]
[0m13:54:18.931611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m13:54:18.932641 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m13:54:18.939216 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m13:54:18.941416 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 13:54:18.933213 => 13:54:18.941040
[0m13:54:18.942048 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m13:54:18.948660 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m13:54:18.950548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:18.951641 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m13:54:19.045301 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0d141079-ca97-43a0-bd47-3e329ee96d06&page=queryresults
[0m13:54:19.274041 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m13:54:19.280166 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 13:54:14.375650 => 13:54:19.279809
[0m13:54:19.281389 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c8dc0>]}
[0m13:54:19.282253 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1869[0m in 4.96s]
[0m13:54:19.283920 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m13:54:19.285261 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m13:54:19.286529 [info ] [Thread-2  ]: 6 of 10 START sql view model analytics.history ................................. [RUN]
[0m13:54:19.288210 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m13:54:19.289070 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m13:54:19.294868 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m13:54:19.296494 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 13:54:19.289507 => 13:54:19.296067
[0m13:54:19.297157 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m13:54:19.304119 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m13:54:19.305450 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:54:19.306299 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m13:54:19.358528 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m13:54:19.363739 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 13:54:14.411943 => 13:54:19.363293
[0m13:54:19.364963 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c60cbe0>]}
[0m13:54:19.365969 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 596[0m in 5.04s]
[0m13:54:19.367583 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m13:54:19.466449 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:811fecc5-fabb-4914-bfa9-665db0f08a56&page=queryresults
[0m13:54:19.783106 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 13:54:18.942787 => 13:54:19.782642
[0m13:54:19.784450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c559520>]}
[0m13:54:19.785574 [info ] [Thread-1  ]: 5 of 10 OK created sql view model analytics.current ............................ [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m13:54:19.786966 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m13:54:19.788041 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m13:54:19.788818 [info ] [Thread-3  ]: 7 of 10 START sql view model analytics.calendar_symbol_dates ................... [RUN]
[0m13:54:19.790053 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m13:54:19.790748 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m13:54:19.800293 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m13:54:19.803876 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:cdb77a23-dacc-46a3-aa10-e950c12c1df1&page=queryresults
[0m13:54:19.804671 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 13:54:19.791148 => 13:54:19.804280
[0m13:54:19.806120 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m13:54:19.813861 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m13:54:19.815914 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:54:19.816981 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, final as (
select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols 
) 
select * 
from final 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m13:54:20.144309 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 13:54:19.297688 => 13:54:20.143935
[0m13:54:20.145697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a64c0>]}
[0m13:54:20.146698 [info ] [Thread-2  ]: 6 of 10 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m13:54:20.147933 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m13:54:20.499313 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4878478e-1762-4407-93ba-2507629aa59d&page=queryresults
[0m13:54:20.835590 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 13:54:19.807386 => 13:54:20.835090
[0m13:54:20.836917 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c945760>]}
[0m13:54:20.838012 [info ] [Thread-3  ]: 7 of 10 OK created sql view model analytics.calendar_symbol_dates .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m13:54:20.839290 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m13:54:20.840582 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m13:54:20.841345 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m13:54:20.842236 [info ] [Thread-1  ]: 8 of 10 START sql view model analytics.current_equity_historical_earnings ...... [RUN]
[0m13:54:20.843441 [info ] [Thread-4  ]: 9 of 10 START sql view model analytics.current_option_historical_earnings ...... [RUN]
[0m13:54:20.845719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_equity_historical_earnings)
[0m13:54:20.846982 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now model.ccwj.current_option_historical_earnings)
[0m13:54:20.847752 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m13:54:20.848478 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m13:54:20.856430 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m13:54:20.863166 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m13:54:20.866031 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 13:54:20.857060 => 13:54:20.865545
[0m13:54:20.866816 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m13:54:20.867625 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 13:54:20.848946 => 13:54:20.867204
[0m13:54:20.874487 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m13:54:20.875295 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m13:54:20.882428 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m13:54:20.883334 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:54:20.884588 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.total as daily_options_value,
    cumulative_daily_totals.cum_total as options_quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m13:54:20.886732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:20.888574 [debug] [Thread-1  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_quantity,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m13:54:21.523511 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:73669ffa-1843-41f9-b36d-98572df9cf7c&page=queryresults
[0m13:54:21.524492 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:17ec65cc-bfc9-47dc-b3a3-2cf5ac01c01f&page=queryresults
[0m13:54:21.844912 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 13:54:20.875957 => 13:54:21.844513
[0m13:54:21.846479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54e9a0>]}
[0m13:54:21.847529 [info ] [Thread-1  ]: 8 of 10 OK created sql view model analytics.current_equity_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m13:54:21.850019 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m13:54:21.855574 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 13:54:20.868080 => 13:54:21.855108
[0m13:54:21.856871 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95cf40>]}
[0m13:54:21.857929 [info ] [Thread-4  ]: 9 of 10 OK created sql view model analytics.current_option_historical_earnings . [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m13:54:21.859116 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m13:54:21.860247 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:54:21.861342 [info ] [Thread-3  ]: 10 of 10 START sql view model analytics.current_holdings_historical_strategy_and_earnings  [RUN]
[0m13:54:21.863781 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_holdings_historical_strategy_and_earnings)
[0m13:54:21.865204 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:54:21.877603 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:54:21.880277 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (compile): 13:54:21.866068 => 13:54:21.879810
[0m13:54:21.881004 [debug] [Thread-3  ]: Began executing node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:54:21.887469 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:54:21.888694 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:54:21.889674 [debug] [Thread-3  ]: On model.ccwj.current_holdings_historical_strategy_and_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy_and_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy_and_earnings`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    current_equity_historical_earnings.equity_shares_quantity,
    current_equity_historical_earnings.historical_equity_holdings,
    current_option_historical_earnings.options_quantity,
    current_option_historical_earnings.amount,
    current_option_historical_earnings.daily_options_value,
    case 
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0) = 0 then 'No Position'
        when coalesce(equity_shares_quantity,0) = coalesce(options_quantity,0)*100 then 'Covered Call'
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0)*100 > 0 then 'Naked Calls'
        when coalesce(equity_shares_quantity,0) > 0 and coalesce(options_quantity,0)*100 = 0 then 'Buy and Hold'
        else 'Mixed'
    end as daily_strategy
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
 left join `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
    on current_equity_historical_earnings.day = calendar_symbol_dates.day 
        and current_equity_historical_earnings.symbol = calendar_symbol_dates.symbol 
left join `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
    on current_option_historical_earnings.day = calendar_symbol_dates.day
        and current_option_historical_earnings.symbol = calendar_symbol_dates.symbol 

where 1=1
   and calendar_symbol_dates.day BETWEEN '2024-01-01' and current_date()
   and calendar_symbol_dates.symbol = 'ASTS';


[0m13:54:22.488334 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d47b5958-78f9-4b04-9b56-1d4813667b5a&page=queryresults
[0m13:54:22.814721 [debug] [Thread-3  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (execute): 13:54:21.881628 => 13:54:22.813930
[0m13:54:22.817058 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb30ce1-67db-4fdf-a3d2-5886696530cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c96d790>]}
[0m13:54:22.818874 [info ] [Thread-3  ]: 10 of 10 OK created sql view model analytics.current_holdings_historical_strategy_and_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m13:54:22.820896 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:54:22.825515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:22.826714 [debug] [MainThread]: Connection 'model.ccwj.current_equity_historical_earnings' was properly closed.
[0m13:54:22.827524 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m13:54:22.828123 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy_and_earnings' was properly closed.
[0m13:54:22.828688 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m13:54:22.829404 [info ] [MainThread]: 
[0m13:54:22.830500 [info ] [MainThread]: Finished running 7 view models, 3 seeds in 0 hours 0 minutes and 10.98 seconds (10.98s).
[0m13:54:22.837030 [debug] [MainThread]: Command end result
[0m13:54:22.871222 [info ] [MainThread]: 
[0m13:54:22.873151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:22.874771 [info ] [MainThread]: 
[0m13:54:22.876089 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:54:22.881789 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.177989, "process_user_time": 8.43873, "process_kernel_time": 0.791019, "process_mem_max_rss": "147886080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:22.883148 [debug] [MainThread]: Command `cli build` succeeded at 13:54:22.882732 after 15.18 seconds
[0m13:54:22.884436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfab580>]}
[0m13:54:22.885675 [debug] [MainThread]: Flushing usage events
[0m13:55:30.679522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ad250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c80340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb0460>]}


============================== 13:55:30.687819 | fe0756e7-5e00-4d51-b1df-ac9c7dba0c21 ==============================
[0m13:55:30.687819 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:55:30.689001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:31.607005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3dc70>]}
[0m13:55:31.798705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b58790>]}
[0m13:55:31.800001 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:55:31.835807 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:55:31.863687 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:55:31.864859 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:55:31.866134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae62e0>]}
[0m13:55:34.436885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121920d0>]}
[0m13:55:34.463710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9f070>]}
[0m13:55:34.464673 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:55:34.465504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c28b50>]}
[0m13:55:34.469472 [info ] [MainThread]: 
[0m13:55:34.471496 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:34.473394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:55:34.474189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:36.147109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:55:36.148614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:36.425796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a9bb0>]}
[0m13:55:36.428495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:36.429457 [info ] [MainThread]: 
[0m13:55:36.433819 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_historical_earnings
[0m13:55:36.434820 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_option_historical_earnings ....... [RUN]
[0m13:55:36.436404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_option_historical_earnings)
[0m13:55:36.437214 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m13:55:36.456208 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m13:55:36.458309 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 13:55:36.437679 => 13:55:36.457718
[0m13:55:36.459392 [debug] [Thread-1  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m13:55:36.517374 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m13:55:36.518698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:36.519832 [debug] [Thread-1  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    amount,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.amount as daily_options_value,
    cumulative_daily_totals.cum_total as options_quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m13:55:37.195566 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:ee2a34a3-bdc5-4148-8984-4e820ac45084&page=queryresults
[0m13:55:37.542417 [debug] [Thread-1  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 13:55:36.459882 => 13:55:37.542037
[0m13:55:37.543673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe0756e7-5e00-4d51-b1df-ac9c7dba0c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112350df0>]}
[0m13:55:37.544775 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_option_historical_earnings .. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m13:55:37.546150 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m13:55:37.548990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:37.549619 [debug] [MainThread]: Connection 'model.ccwj.current_option_historical_earnings' was properly closed.
[0m13:55:37.550421 [info ] [MainThread]: 
[0m13:55:37.551169 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m13:55:37.552666 [debug] [MainThread]: Command end result
[0m13:55:37.577653 [info ] [MainThread]: 
[0m13:55:37.578553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:37.579435 [info ] [MainThread]: 
[0m13:55:37.580262 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:37.582594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0160866, "process_user_time": 7.858965, "process_kernel_time": 0.644892, "process_mem_max_rss": "136421376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:37.584267 [debug] [MainThread]: Command `cli run` succeeded at 13:55:37.583439 after 7.02 seconds
[0m13:55:37.585497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ad250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf56d0>]}
[0m13:55:37.586458 [debug] [MainThread]: Flushing usage events
[0m13:55:44.488303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052db2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb130>]}


============================== 13:55:44.497216 | 47bb694f-379e-4e0f-90fa-11ad1dd8af17 ==============================
[0m13:55:44.497216 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:55:44.498442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:55:45.359364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da1d90>]}
[0m13:55:45.533894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5bd00>]}
[0m13:55:45.535329 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:55:45.568511 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:55:45.662926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:45.663648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:45.677804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91f40>]}
[0m13:55:45.703940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9d100>]}
[0m13:55:45.705034 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:55:45.706606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9d4c0>]}
[0m13:55:45.710014 [info ] [MainThread]: 
[0m13:55:45.711566 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:45.713486 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:55:45.714407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:47.380186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:55:47.381255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:47.648091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d614c0>]}
[0m13:55:47.649792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:47.650782 [info ] [MainThread]: 
[0m13:55:47.656126 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:55:47.657528 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_strategy_and_earnings  [RUN]
[0m13:55:47.659070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_strategy_and_earnings)
[0m13:55:47.659901 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:55:47.688098 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:55:47.689671 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (compile): 13:55:47.660378 => 13:55:47.689161
[0m13:55:47.691017 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:55:47.748403 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m13:55:47.750156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:47.751161 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy_and_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy_and_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy_and_earnings`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    current_equity_historical_earnings.equity_shares_quantity,
    current_equity_historical_earnings.historical_equity_holdings,
    current_option_historical_earnings.options_quantity,
    current_option_historical_earnings.amount,
    current_option_historical_earnings.daily_options_value,
    case 
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0) = 0 then 'No Position'
        when coalesce(equity_shares_quantity,0) = coalesce(options_quantity,0)*100 then 'Covered Call'
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0)*100 > 0 then 'Naked Calls'
        when coalesce(equity_shares_quantity,0) > 0 and coalesce(options_quantity,0)*100 = 0 then 'Buy and Hold'
        else 'Mixed'
    end as daily_strategy
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
 left join `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
    on current_equity_historical_earnings.day = calendar_symbol_dates.day 
        and current_equity_historical_earnings.symbol = calendar_symbol_dates.symbol 
left join `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
    on current_option_historical_earnings.day = calendar_symbol_dates.day
        and current_option_historical_earnings.symbol = calendar_symbol_dates.symbol 

where 1=1
   and calendar_symbol_dates.day BETWEEN '2024-01-01' and current_date()
   and calendar_symbol_dates.symbol = 'ASTS';


[0m13:55:48.459815 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0e0ae8db-0a61-4df2-ba90-078fa8f4d259&page=queryresults
[0m13:55:48.812945 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (execute): 13:55:47.691678 => 13:55:48.812474
[0m13:55:48.814531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47bb694f-379e-4e0f-90fa-11ad1dd8af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080437c0>]}
[0m13:55:48.815808 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_strategy_and_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m13:55:48.817192 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m13:55:48.819807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:48.820394 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy_and_earnings' was properly closed.
[0m13:55:48.820975 [info ] [MainThread]: 
[0m13:55:48.821659 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m13:55:48.823230 [debug] [MainThread]: Command end result
[0m13:55:48.843471 [info ] [MainThread]: 
[0m13:55:48.844535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:48.845283 [info ] [MainThread]: 
[0m13:55:48.846039 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:48.849643 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.471663, "process_user_time": 5.101743, "process_kernel_time": 0.524887, "process_mem_max_rss": "128348160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:48.851309 [debug] [MainThread]: Command `cli run` succeeded at 13:55:48.850928 after 4.47 seconds
[0m13:55:48.852416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052db2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d103a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fefaf0>]}
[0m13:55:48.853544 [debug] [MainThread]: Flushing usage events
[0m11:08:17.916439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f51ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f546700>]}


============================== 11:08:17.923244 | 1be09be7-51e3-455a-9902-e2edbd3a1e76 ==============================
[0m11:08:17.923244 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:08:17.924327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:08:18.710828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f52c610>]}
[0m11:08:18.824007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103fe850>]}
[0m11:08:18.825577 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:08:18.847693 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:08:18.865623 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:08:18.866218 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m11:08:18.866823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11047a100>]}
[0m11:08:20.625000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a400d0>]}
[0m11:08:20.648438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d5790>]}
[0m11:08:20.649051 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:08:20.652001 [info ] [MainThread]: 
[0m11:08:20.653165 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:20.656305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:08:20.657091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:24.182076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:08:24.183459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:24.586979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a57f70>]}
[0m11:08:24.588393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:08:24.589140 [info ] [MainThread]: 
[0m11:08:24.594378 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m11:08:24.595273 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m11:08:24.595964 [info ] [Thread-1  ]: 1 of 30 START sql view model analytics.calendar_dates .......................... [RUN]
[0m11:08:24.596578 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m11:08:24.597248 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m11:08:24.597881 [info ] [Thread-2  ]: 2 of 30 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m11:08:24.599233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m11:08:24.600239 [info ] [Thread-3  ]: 3 of 30 START seed file analytics.0417_current ................................. [RUN]
[0m11:08:24.601684 [info ] [Thread-4  ]: 4 of 30 START seed file analytics.0417_history ................................. [RUN]
[0m11:08:24.603885 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m11:08:24.604805 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m11:08:24.606450 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m11:08:24.608104 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:08:24.608794 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m11:08:24.621240 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m11:08:24.622112 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m11:08:24.622860 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m11:08:24.628652 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m11:08:24.630263 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 11:08:24.629640 => 11:08:24.629647
[0m11:08:24.631353 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 11:08:24.630821 => 11:08:24.630825
[0m11:08:24.632528 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m11:08:24.633213 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 11:08:24.609404 => 11:08:24.632844
[0m11:08:24.633983 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m11:08:24.640209 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 11:08:24.623304 => 11:08:24.639748
[0m11:08:24.646294 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m11:08:24.666736 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m11:08:24.676728 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:08:24.745055 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:08:24.753904 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m11:08:24.828559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:24.830456 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m11:08:24.834271 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:08:25.413619 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m11:08:25.416163 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:08:25.526349 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c1d798bd-bb37-45e7-84a2-9e4291c55541&page=queryresults
[0m11:08:25.844524 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1e00b9c9-34af-4468-a77e-eecc2c0db3db&page=queryresults
[0m11:08:25.977832 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 11:08:24.679667 => 11:08:25.977512
[0m11:08:25.978819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a57ee0>]}
[0m11:08:25.979514 [info ] [Thread-1  ]: 1 of 30 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m11:08:25.980447 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m11:08:25.981045 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m11:08:25.981682 [info ] [Thread-1  ]: 5 of 30 START seed file analytics.cflt_prices .................................. [RUN]
[0m11:08:25.982535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m11:08:25.983027 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:08:25.983570 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:08:25.983309 => 11:08:25.983312
[0m11:08:25.983976 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m11:08:26.014587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:28.042645 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 11:08:24.709546 => 11:08:28.042115
[0m11:08:28.044192 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfd520>]}
[0m11:08:28.045198 [info ] [Thread-2  ]: 2 of 30 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.44s]
[0m11:08:28.046260 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m11:08:28.047510 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:08:28.048485 [info ] [Thread-2  ]: 6 of 30 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m11:08:28.049549 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m11:08:28.050149 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:08:28.064900 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:08:28.067435 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 11:08:28.050494 => 11:08:28.067048
[0m11:08:28.068106 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:08:28.088461 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:08:28.089431 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:08:28.090001 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:28.731641 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:08:28.754030 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m11:08:28.805858 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2c3e3f1b-3e94-4fdd-8f96-af9e49f988c2&page=queryresults
[0m11:08:29.194426 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:803513c4-1891-47ad-a1b7-ff6c7433c9d9&page=queryresults
[0m11:08:29.314095 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:45e5853d-10d9-4203-918d-d4868111b3ce&page=queryresults
[0m11:08:29.441770 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 11:08:28.068594 => 11:08:29.441341
[0m11:08:29.443741 [info ] [Thread-2  ]: 6 of 30 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.39s]
[0m11:08:29.445626 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:08:29.447696 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m11:08:29.448346 [info ] [Thread-2  ]: 7 of 30 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m11:08:29.449656 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m11:08:29.450287 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m11:08:29.454607 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m11:08:29.460546 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 11:08:29.450634 => 11:08:29.460113
[0m11:08:29.461068 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m11:08:29.471878 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m11:08:29.473449 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:08:29.474465 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m11:08:29.602710 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m11:08:29.606921 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 11:08:24.660197 => 11:08:29.606644
[0m11:08:29.607926 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b96b20>]}
[0m11:08:29.608608 [info ] [Thread-4  ]: 4 of 30 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1877[0m in 5.00s]
[0m11:08:29.609455 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m11:08:29.610568 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m11:08:29.611175 [info ] [Thread-4  ]: 8 of 30 START sql view model analytics.history ................................. [RUN]
[0m11:08:29.612238 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m11:08:29.612816 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m11:08:29.617494 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:08:29.618967 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 11:08:29.613123 => 11:08:29.618609
[0m11:08:29.619650 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m11:08:29.624224 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:08:29.625159 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:08:29.625811 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m11:08:29.637284 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:08:29.641227 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 11:08:24.634539 => 11:08:29.640804
[0m11:08:29.642850 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b6ba60>]}
[0m11:08:29.643707 [info ] [Thread-3  ]: 3 of 30 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 10[0m in 5.04s]
[0m11:08:29.644681 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m11:08:29.645348 [debug] [Thread-3  ]: Began running node model.ccwj.test
[0m11:08:29.646132 [info ] [Thread-3  ]: 9 of 30 START sql view model analytics.test .................................... [RUN]
[0m11:08:29.647267 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.test)
[0m11:08:29.647952 [debug] [Thread-3  ]: Began compiling node model.ccwj.test
[0m11:08:29.651939 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.test"
[0m11:08:29.654602 [debug] [Thread-3  ]: Timing info for model.ccwj.test (compile): 11:08:29.648266 => 11:08:29.654221
[0m11:08:29.655183 [debug] [Thread-3  ]: Began executing node model.ccwj.test
[0m11:08:29.662346 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.test"
[0m11:08:29.663797 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:08:29.664560 [debug] [Thread-3  ]: On model.ccwj.test: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.test"} */


  create or replace view `ccwj-dbt`.`analytics`.`test`
  OPTIONS()
  as select *
from `ccwj-dbt`.`analytics`.`0417_history`;


[0m11:08:29.734068 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:08:29.957220 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a95e70d4-fbff-47b9-8ad5-a12c9c63a814&page=queryresults
[0m11:08:30.012668 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:1d21de5c-15bc-43cb-ac48-b222e9119869&page=queryresults
[0m11:08:30.032773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:dd33e5d7-4508-49fe-9d09-cd20780839ac&page=queryresults
[0m11:08:30.053392 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c2c13926-973c-456a-a838-8954f91c60fe&page=queryresults
[0m11:08:30.284055 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 11:08:29.461395 => 11:08:30.283670
[0m11:08:30.285241 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f3d490>]}
[0m11:08:30.286097 [info ] [Thread-2  ]: 7 of 30 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m11:08:30.287001 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m11:08:30.287707 [debug] [Thread-2  ]: Began running node model.ccwj.current
[0m11:08:30.288548 [info ] [Thread-2  ]: 10 of 30 START sql view model analytics.current ................................ [RUN]
[0m11:08:30.289673 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now model.ccwj.current)
[0m11:08:30.290264 [debug] [Thread-2  ]: Began compiling node model.ccwj.current
[0m11:08:30.296713 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:08:30.298602 [debug] [Thread-2  ]: Timing info for model.ccwj.current (compile): 11:08:30.290619 => 11:08:30.298229
[0m11:08:30.299123 [debug] [Thread-2  ]: Began executing node model.ccwj.current
[0m11:08:30.304554 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:08:30.305560 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:08:30.306269 [debug] [Thread-2  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:08:30.375501 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 11:08:29.619975 => 11:08:30.375099
[0m11:08:30.377104 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f25c40>]}
[0m11:08:30.378318 [info ] [Thread-4  ]: 8 of 30 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:08:30.379376 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m11:08:30.380062 [debug] [Thread-4  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:08:30.380738 [info ] [Thread-4  ]: 11 of 30 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m11:08:30.381772 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m11:08:30.382373 [debug] [Thread-4  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:08:30.392787 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:08:30.395307 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:08:30.382724 => 11:08:30.394864
[0m11:08:30.395926 [debug] [Thread-4  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:08:30.400010 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:08:30.404292 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:08:30.406298 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:08:30.406958 [debug] [Thread-4  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m11:08:30.411155 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:08:25.984238 => 11:08:30.410876
[0m11:08:30.412221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a57ee0>]}
[0m11:08:30.413416 [info ] [Thread-1  ]: 5 of 30 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 609[0m in 4.43s]
[0m11:08:30.414629 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m11:08:30.415528 [debug] [Thread-1  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:08:30.416469 [info ] [Thread-1  ]: 12 of 30 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:08:30.417590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:08:30.418121 [debug] [Thread-1  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:08:30.423528 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:08:30.424504 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:08:30.418419 => 11:08:30.424220
[0m11:08:30.424957 [debug] [Thread-1  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:08:30.430046 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:08:30.433449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:30.434158 [debug] [Thread-1  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:08:30.486881 [debug] [Thread-3  ]: Timing info for model.ccwj.test (execute): 11:08:29.655952 => 11:08:30.486584
[0m11:08:30.488207 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e8f2e0>]}
[0m11:08:30.489076 [info ] [Thread-3  ]: 9 of 30 OK created sql view model analytics.test ............................... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m11:08:30.490167 [debug] [Thread-3  ]: Finished running node model.ccwj.test
[0m11:08:30.745512 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fd3a0065-95ec-471d-844a-94dfc29766fd&page=queryresults
[0m11:08:31.000480 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: symbol at [8:5]; reason: invalidQuery, location: query, message: Unrecognized name: symbol at [8:5]')
[0m11:08:31.211287 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:0a0525fd-62c2-4def-9370-4776c446419b&page=queryresults
[0m11:08:31.284338 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:25bb851b-1e1d-4e5c-9902-0c10cff09ef1&page=queryresults
[0m11:08:31.827242 [debug] [Thread-1  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:08:30.425237 => 11:08:31.826526
[0m11:08:31.829440 [info ] [Thread-1  ]: 12 of 30 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.41s]
[0m11:08:31.831334 [debug] [Thread-1  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:08:31.880915 [debug] [Thread-4  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:08:30.396302 => 11:08:31.880266
[0m11:08:31.882983 [info ] [Thread-4  ]: 11 of 30 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.50s]
[0m11:08:31.884389 [debug] [Thread-4  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:08:32.233566 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:de3ecfd9-3d6a-4456-a8e4-e0b7dcf1801f&page=queryresults
[0m11:08:32.513413 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:de3ecfd9-3d6a-4456-a8e4-e0b7dcf1801f&page=queryresults
[0m11:08:32.514929 [debug] [Thread-2  ]: Timing info for model.ccwj.current (execute): 11:08:30.299454 => 11:08:32.514338
[0m11:08:32.534143 [debug] [Thread-2  ]: Database Error in model current (models/groomed/current.sql)
  Unrecognized name: symbol at [8:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:08:32.535054 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be09be7-51e3-455a-9902-e2edbd3a1e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f5ec10>]}
[0m11:08:32.536116 [error] [Thread-2  ]: 10 of 30 ERROR creating sql view model analytics.current ....................... [[31mERROR[0m in 2.25s]
[0m11:08:32.537144 [debug] [Thread-2  ]: Finished running node model.ccwj.current
[0m11:08:32.538938 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m11:08:32.539496 [debug] [Thread-1  ]: Began running node model.ccwj.current_account_earnings
[0m11:08:32.540077 [debug] [Thread-4  ]: Began running node model.ccwj.current_equity_holdings
[0m11:08:32.540640 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_earnings
[0m11:08:32.541420 [info ] [Thread-3  ]: 13 of 30 SKIP relation analytics.calendar_symbol_dates ......................... [[33mSKIP[0m]
[0m11:08:32.542163 [info ] [Thread-1  ]: 14 of 30 SKIP relation analytics.current_account_earnings ...................... [[33mSKIP[0m]
[0m11:08:32.543013 [info ] [Thread-4  ]: 15 of 30 SKIP relation analytics.current_equity_holdings ....................... [[33mSKIP[0m]
[0m11:08:32.543752 [info ] [Thread-2  ]: 16 of 30 SKIP relation analytics.current_holdings_earnings ..................... [[33mSKIP[0m]
[0m11:08:32.544486 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m11:08:32.545215 [debug] [Thread-1  ]: Finished running node model.ccwj.current_account_earnings
[0m11:08:32.545928 [debug] [Thread-4  ]: Finished running node model.ccwj.current_equity_holdings
[0m11:08:32.546606 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_earnings
[0m11:08:32.547263 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_timeline
[0m11:08:32.548444 [debug] [Thread-1  ]: Began running node model.ccwj.current_option_holdings
[0m11:08:32.549414 [debug] [Thread-4  ]: Began running node model.ccwj.current_position_information
[0m11:08:32.550088 [debug] [Thread-2  ]: Began running node model.ccwj.daily_totals
[0m11:08:32.550734 [info ] [Thread-3  ]: 17 of 30 SKIP relation analytics.current_holdings_timeline ..................... [[33mSKIP[0m]
[0m11:08:32.551383 [info ] [Thread-1  ]: 18 of 30 SKIP relation analytics.current_option_holdings ....................... [[33mSKIP[0m]
[0m11:08:32.552360 [info ] [Thread-4  ]: 19 of 30 SKIP relation analytics.current_position_information .................. [[33mSKIP[0m]
[0m11:08:32.553619 [info ] [Thread-2  ]: 20 of 30 SKIP relation analytics.daily_totals .................................. [[33mSKIP[0m]
[0m11:08:32.554815 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_timeline
[0m11:08:32.555525 [debug] [Thread-1  ]: Finished running node model.ccwj.current_option_holdings
[0m11:08:32.556150 [debug] [Thread-4  ]: Finished running node model.ccwj.current_position_information
[0m11:08:32.556905 [debug] [Thread-2  ]: Finished running node model.ccwj.daily_totals
[0m11:08:32.557680 [debug] [Thread-3  ]: Began running node model.ccwj.overall_position_performance
[0m11:08:32.558336 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m11:08:32.559054 [debug] [Thread-4  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m11:08:32.559752 [debug] [Thread-2  ]: Began running node model.ccwj.current_option_historical_earnings
[0m11:08:32.560391 [info ] [Thread-3  ]: 21 of 30 SKIP relation analytics.overall_position_performance .................. [[33mSKIP[0m]
[0m11:08:32.561120 [info ] [Thread-1  ]: 22 of 30 SKIP relation analytics.positions ..................................... [[33mSKIP[0m]
[0m11:08:32.562086 [info ] [Thread-4  ]: 23 of 30 SKIP relation analytics.current_equity_historical_earnings ............ [[33mSKIP[0m]
[0m11:08:32.562696 [info ] [Thread-2  ]: 24 of 30 SKIP relation analytics.current_option_historical_earnings ............ [[33mSKIP[0m]
[0m11:08:32.563482 [debug] [Thread-3  ]: Finished running node model.ccwj.overall_position_performance
[0m11:08:32.564033 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m11:08:32.564572 [debug] [Thread-4  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m11:08:32.565414 [debug] [Thread-2  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m11:08:32.566383 [debug] [Thread-3  ]: Began running node model.ccwj.historical_equity_held
[0m11:08:32.567179 [debug] [Thread-1  ]: Began running node model.ccwj.historical_options_held
[0m11:08:32.567841 [debug] [Thread-4  ]: Began running node model.ccwj.current_holdings_strategy
[0m11:08:32.568673 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m11:08:32.569173 [info ] [Thread-3  ]: 25 of 30 SKIP relation analytics.historical_equity_held ........................ [[33mSKIP[0m]
[0m11:08:32.570043 [info ] [Thread-1  ]: 26 of 30 SKIP relation analytics.historical_options_held ....................... [[33mSKIP[0m]
[0m11:08:32.570772 [info ] [Thread-4  ]: 27 of 30 SKIP relation analytics.current_holdings_strategy ..................... [[33mSKIP[0m]
[0m11:08:32.571446 [info ] [Thread-2  ]: 28 of 30 SKIP relation analytics.current_holdings_historical_earnings .......... [[33mSKIP[0m]
[0m11:08:32.572108 [debug] [Thread-3  ]: Finished running node model.ccwj.historical_equity_held
[0m11:08:32.572688 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_options_held
[0m11:08:32.573291 [debug] [Thread-4  ]: Finished running node model.ccwj.current_holdings_strategy
[0m11:08:32.573800 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m11:08:32.574442 [debug] [Thread-3  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:08:32.575585 [debug] [Thread-4  ]: Began running node model.ccwj.historical_positions_held
[0m11:08:32.576400 [info ] [Thread-3  ]: 29 of 30 SKIP relation analytics.current_holdings_historical_strategy_and_earnings  [[33mSKIP[0m]
[0m11:08:32.576999 [info ] [Thread-4  ]: 30 of 30 SKIP relation analytics.historical_positions_held ..................... [[33mSKIP[0m]
[0m11:08:32.577671 [debug] [Thread-3  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:08:32.578189 [debug] [Thread-4  ]: Finished running node model.ccwj.historical_positions_held
[0m11:08:32.580815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:32.581290 [debug] [MainThread]: Connection 'test.ccwj.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:08:32.581688 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m11:08:32.582096 [debug] [MainThread]: Connection 'model.ccwj.test' was properly closed.
[0m11:08:32.582463 [debug] [MainThread]: Connection 'test.ccwj.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m11:08:32.582972 [info ] [MainThread]: 
[0m11:08:32.583625 [info ] [MainThread]: Finished running 23 view models, 1 table model, 3 tests, 3 seeds in 0 hours 0 minutes and 11.93 seconds (11.93s).
[0m11:08:32.587052 [debug] [MainThread]: Command end result
[0m11:08:32.651603 [info ] [MainThread]: 
[0m11:08:32.652241 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:08:32.652692 [info ] [MainThread]: 
[0m11:08:32.653144 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  Unrecognized name: symbol at [8:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:08:32.653621 [info ] [MainThread]: 
[0m11:08:32.654101 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=18 TOTAL=30
[0m11:08:32.664692 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.832458, "process_user_time": 5.991591, "process_kernel_time": 0.610947, "process_mem_max_rss": "151310336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:08:32.666303 [debug] [MainThread]: Command `cli build` failed at 11:08:32.665937 after 14.83 seconds
[0m11:08:32.667287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c4dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afaa60>]}
[0m11:08:32.668428 [debug] [MainThread]: Flushing usage events
[0m11:09:22.979382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f65550>]}


============================== 11:09:22.985539 | 12ef2418-b021-4e03-b703-c93d8a107236 ==============================
[0m11:09:22.985539 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:09:22.986595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:23.700722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f4d880>]}
[0m11:09:23.811066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e06c70>]}
[0m11:09:23.812673 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:09:23.835400 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:09:23.927161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:23.927644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:23.936814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11310c0d0>]}
[0m11:09:23.954960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d9ee0>]}
[0m11:09:23.955675 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:09:23.956225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d9b80>]}
[0m11:09:23.958687 [info ] [MainThread]: 
[0m11:09:23.959754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:23.961035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:09:23.961564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:25.586389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:09:25.587537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:25.982759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130fdca0>]}
[0m11:09:25.984114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:25.984750 [info ] [MainThread]: 
[0m11:09:25.988852 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m11:09:25.989599 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current .................................. [RUN]
[0m11:09:25.990607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current)
[0m11:09:25.991191 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m11:09:26.009680 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:09:26.011278 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 11:09:25.991518 => 11:09:26.010871
[0m11:09:26.011790 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m11:09:26.048358 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:09:26.049393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:26.050044 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:09:26.849644 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fe02a532-2148-44c1-b116-835547142bc9&page=queryresults
[0m11:09:27.189121 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: symbol at [8:5]; reason: invalidQuery, location: query, message: Unrecognized name: symbol at [8:5]')
[0m11:09:28.045480 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7652a5dd-870f-43b0-b269-167754badc92&page=queryresults
[0m11:09:28.326677 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7652a5dd-870f-43b0-b269-167754badc92&page=queryresults
[0m11:09:28.328513 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 11:09:26.012098 => 11:09:28.327766
[0m11:09:28.346987 [debug] [Thread-1  ]: Database Error in model current (models/groomed/current.sql)
  Unrecognized name: symbol at [8:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:09:28.347909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12ef2418-b021-4e03-b703-c93d8a107236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113181460>]}
[0m11:09:28.348865 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 2.36s]
[0m11:09:28.349812 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m11:09:28.352497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:28.353097 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m11:09:28.353728 [info ] [MainThread]: 
[0m11:09:28.354365 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m11:09:28.355526 [debug] [MainThread]: Command end result
[0m11:09:28.371456 [info ] [MainThread]: 
[0m11:09:28.372062 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:28.372677 [info ] [MainThread]: 
[0m11:09:28.373167 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  Unrecognized name: symbol at [8:5]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:09:28.373620 [info ] [MainThread]: 
[0m11:09:28.374124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:09:28.376623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4700723, "process_user_time": 3.413475, "process_kernel_time": 0.442409, "process_mem_max_rss": "130887680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:09:28.377521 [debug] [MainThread]: Command `cli run` failed at 11:09:28.377274 after 5.47 seconds
[0m11:09:28.378656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113010220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f4d880>]}
[0m11:09:28.379433 [debug] [MainThread]: Flushing usage events
[0m11:09:57.115253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b356a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce1c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce66b80>]}


============================== 11:09:57.121156 | 8ed0fc8d-cd54-428f-866c-fdcf4551fca5 ==============================
[0m11:09:57.121156 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:09:57.121930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:09:57.868899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce04b20>]}
[0m11:09:57.972067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d616f10>]}
[0m11:09:57.973389 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:09:58.000515 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:09:58.018098 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:09:58.018844 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m11:09:58.019422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddd5820>]}
[0m11:09:59.667886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3400d0>]}
[0m11:09:59.688345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddd05b0>]}
[0m11:09:59.688923 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:09:59.690969 [info ] [MainThread]: 
[0m11:09:59.692278 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:59.693641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:09:59.694450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:01.249811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:10:01.250698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:01.685770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e340d90>]}
[0m11:10:01.687709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:01.688783 [info ] [MainThread]: 
[0m11:10:01.692381 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:10:01.693181 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m11:10:01.694366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:10:01.695164 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:10:01.695925 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:10:01.695584 => 11:10:01.695589
[0m11:10:01.696550 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:10:01.730698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:05.495222 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:10:05.780870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8f621870-f81d-4c86-93d5-04aeb6d72cd2&page=queryresults
[0m11:10:06.163143 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:10:06.180515 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:10:01.696892 => 11:10:06.180225
[0m11:10:06.181439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e4d30>]}
[0m11:10:06.182062 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.49s]
[0m11:10:06.183034 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:10:06.184327 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m11:10:06.185205 [info ] [Thread-3  ]: 2 of 2 START sql view model analytics.current .................................. [RUN]
[0m11:10:06.186581 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m11:10:06.187204 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m11:10:06.197653 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:10:06.198552 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 11:10:06.187693 => 11:10:06.198294
[0m11:10:06.198975 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m11:10:06.229724 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:10:06.230662 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:10:06.231501 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as swith fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:10:06.462319 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2578a74a-9c75-49c5-a11b-211d3ff5dc20&page=queryresults
[0m11:10:06.463642 [debug] [Thread-3  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "swith" at [6:6]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "swith" at [6:6]')
[0m11:10:07.365837 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5845396a-4125-4eeb-b35b-07810d35262a&page=queryresults
[0m11:10:07.369007 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5845396a-4125-4eeb-b35b-07810d35262a&page=queryresults
[0m11:10:07.370372 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 11:10:06.199246 => 11:10:07.369829
[0m11:10:07.389008 [debug] [Thread-3  ]: Database Error in model current (models/groomed/current.sql)
  Syntax error: Unexpected identifier "swith" at [6:6]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:10:07.389862 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed0fc8d-cd54-428f-866c-fdcf4551fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4947f0>]}
[0m11:10:07.391111 [error] [Thread-3  ]: 2 of 2 ERROR creating sql view model analytics.current ......................... [[31mERROR[0m in 1.20s]
[0m11:10:07.392832 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m11:10:07.397257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:07.398155 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:10:07.398673 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m11:10:07.399219 [info ] [MainThread]: 
[0m11:10:07.399977 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m11:10:07.401852 [debug] [MainThread]: Command end result
[0m11:10:07.422276 [info ] [MainThread]: 
[0m11:10:07.423095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:10:07.423914 [info ] [MainThread]: 
[0m11:10:07.425053 [error] [MainThread]:   Database Error in model current (models/groomed/current.sql)
  Syntax error: Unexpected identifier "swith" at [6:6]
  compiled Code at target/run/ccwj/models/groomed/current.sql
[0m11:10:07.425800 [info ] [MainThread]: 
[0m11:10:07.426532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:10:07.430744 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 10.388371, "process_user_time": 5.066713, "process_kernel_time": 0.471937, "process_mem_max_rss": "139374592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:10:07.431819 [debug] [MainThread]: Command `cli build` failed at 11:10:07.431546 after 10.39 seconds
[0m11:10:07.432650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b356a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd93250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd2b850>]}
[0m11:10:07.433564 [debug] [MainThread]: Flushing usage events
[0m11:10:26.148931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d61040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dab7f0>]}


============================== 11:10:26.154736 | 12026158-b462-497c-90cb-375471785eb4 ==============================
[0m11:10:26.154736 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:10:26.155537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:10:27.035067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d61280>]}
[0m11:10:27.146899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf16a0>]}
[0m11:10:27.148607 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:10:27.170807 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:10:27.189768 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:10:27.190397 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m11:10:27.191010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d94310>]}
[0m11:10:28.875541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082850d0>]}
[0m11:10:28.895777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e99f40>]}
[0m11:10:28.896636 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:10:28.899017 [info ] [MainThread]: 
[0m11:10:28.900199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:10:28.901427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:10:28.902173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:30.801217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:10:30.808718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:31.187008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082856d0>]}
[0m11:10:31.188174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:31.188705 [info ] [MainThread]: 
[0m11:10:31.192062 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_current
[0m11:10:31.192767 [info ] [Thread-1  ]: 1 of 2 START seed file analytics.0417_current .................................. [RUN]
[0m11:10:31.193696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_current)
[0m11:10:31.194260 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_current
[0m11:10:31.194862 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (compile): 11:10:31.194575 => 11:10:31.194578
[0m11:10:31.195300 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_current
[0m11:10:31.233558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:34.872230 [debug] [Thread-1  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:10:35.130629 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fab728f9-b6ca-476b-85a4-279f1588f181&page=queryresults
[0m11:10:35.530344 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:10:35.549016 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_current (execute): 11:10:31.195575 => 11:10:35.548675
[0m11:10:35.550027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842bd60>]}
[0m11:10:35.550671 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.36s]
[0m11:10:35.551372 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_current
[0m11:10:35.552260 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m11:10:35.552954 [info ] [Thread-3  ]: 2 of 2 START sql view model analytics.current .................................. [RUN]
[0m11:10:35.553858 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.current'
[0m11:10:35.554310 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m11:10:35.564669 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:10:35.565658 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 11:10:35.554581 => 11:10:35.565355
[0m11:10:35.566091 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m11:10:35.592873 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:10:35.594140 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:10:35.594969 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:10:36.133789 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:a2b5e6ea-bdc7-4e4c-9960-900af354b6e6&page=queryresults
[0m11:10:36.431528 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 11:10:35.566356 => 11:10:36.431193
[0m11:10:36.432671 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12026158-b462-497c-90cb-375471785eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c6e20>]}
[0m11:10:36.433488 [info ] [Thread-3  ]: 2 of 2 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m11:10:36.434343 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m11:10:36.437133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:36.437886 [debug] [MainThread]: Connection 'seed.ccwj.0417_current' was properly closed.
[0m11:10:36.438400 [debug] [MainThread]: Connection 'model.ccwj.current' was properly closed.
[0m11:10:36.438949 [info ] [MainThread]: 
[0m11:10:36.440014 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m11:10:36.441629 [debug] [MainThread]: Command end result
[0m11:10:36.458962 [info ] [MainThread]: 
[0m11:10:36.459615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:36.460158 [info ] [MainThread]: 
[0m11:10:36.460779 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:10:36.464361 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.40017, "process_user_time": 5.24502, "process_kernel_time": 0.519116, "process_mem_max_rss": "137936896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:10:36.465474 [debug] [MainThread]: Command `cli build` succeeded at 11:10:36.465244 after 10.40 seconds
[0m11:10:36.466143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7f3a0>]}
[0m11:10:36.466828 [debug] [MainThread]: Flushing usage events
[0m11:10:44.340634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23e20>]}


============================== 11:10:44.346053 | 73f19a25-588b-49bb-8fec-a97a9598d877 ==============================
[0m11:10:44.346053 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:10:44.346994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:10:44.948356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107797700>]}
[0m11:10:45.056125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b6160>]}
[0m11:10:45.057147 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:10:45.081939 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:10:45.141392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:45.141962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:45.151903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd7fd0>]}
[0m11:10:45.171821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9df70>]}
[0m11:10:45.172587 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:10:45.176022 [info ] [MainThread]: 
[0m11:10:45.177499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:10:45.180259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:10:45.180944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:46.426703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:10:46.427781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:46.743999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d8c70>]}
[0m11:10:46.745420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:46.746092 [info ] [MainThread]: 
[0m11:10:46.749218 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m11:10:46.750754 [debug] [Thread-2  ]: Began running node model.ccwj.my_first_dbt_model
[0m11:10:46.751361 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_current
[0m11:10:46.752021 [info ] [Thread-2  ]: 2 of 30 START sql table model analytics.my_first_dbt_model ..................... [RUN]
[0m11:10:46.754414 [debug] [Thread-4  ]: Began running node seed.ccwj.0417_history
[0m11:10:46.755067 [info ] [Thread-3  ]: 3 of 30 START seed file analytics.0417_current ................................. [RUN]
[0m11:10:46.757270 [info ] [Thread-1  ]: 1 of 30 START sql view model analytics.calendar_dates .......................... [RUN]
[0m11:10:46.758588 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.my_first_dbt_model'
[0m11:10:46.759411 [info ] [Thread-4  ]: 4 of 30 START seed file analytics.0417_history ................................. [RUN]
[0m11:10:46.760691 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m11:10:46.761682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m11:10:46.762263 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_first_dbt_model
[0m11:10:46.763164 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m11:10:46.763785 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_current
[0m11:10:46.764665 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m11:10:46.777223 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_first_dbt_model"
[0m11:10:46.777808 [debug] [Thread-4  ]: Began compiling node seed.ccwj.0417_history
[0m11:10:46.778479 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (compile): 11:10:46.778177 => 11:10:46.778181
[0m11:10:46.781090 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m11:10:46.781994 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (compile): 11:10:46.781686 => 11:10:46.781692
[0m11:10:46.782679 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_current
[0m11:10:46.783418 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (compile): 11:10:46.765333 => 11:10:46.783109
[0m11:10:46.784066 [debug] [Thread-4  ]: Began executing node seed.ccwj.0417_history
[0m11:10:46.801727 [debug] [Thread-2  ]: Began executing node model.ccwj.my_first_dbt_model
[0m11:10:46.802492 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 11:10:46.778798 => 11:10:46.802166
[0m11:10:46.828667 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:10:46.838107 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:10:46.844399 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m11:10:46.957919 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m11:10:46.959094 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:10:46.961660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:46.962689 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m11:10:47.217393 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_first_dbt_model"
[0m11:10:47.228289 [debug] [Thread-2  ]: On model.ccwj.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_first_dbt_model"} */

  
    

    create or replace table `ccwj-dbt`.`analytics`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m11:10:47.344223 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9eecc596-d139-4a7a-bc39-0c7432d577e1&page=queryresults
[0m11:10:47.584806 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8748100f-3be4-4552-bf1e-92753768a302&page=queryresults
[0m11:10:47.700049 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 11:10:46.907425 => 11:10:47.699785
[0m11:10:47.701284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee7d90>]}
[0m11:10:47.702148 [info ] [Thread-1  ]: 1 of 30 OK created sql view model analytics.calendar_dates ..................... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:10:47.703639 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m11:10:47.705005 [debug] [Thread-1  ]: Began running node seed.ccwj.cflt_prices
[0m11:10:47.705761 [info ] [Thread-1  ]: 5 of 30 START seed file analytics.cflt_prices .................................. [RUN]
[0m11:10:47.707084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now seed.ccwj.cflt_prices)
[0m11:10:47.707621 [debug] [Thread-1  ]: Began compiling node seed.ccwj.cflt_prices
[0m11:10:47.708378 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (compile): 11:10:47.707924 => 11:10:47.707927
[0m11:10:47.709193 [debug] [Thread-1  ]: Began executing node seed.ccwj.cflt_prices
[0m11:10:47.736970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:49.704334 [debug] [Thread-2  ]: Timing info for model.ccwj.my_first_dbt_model (execute): 11:10:46.820744 => 11:10:49.703932
[0m11:10:49.705682 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d242e0>]}
[0m11:10:49.706680 [info ] [Thread-2  ]: 2 of 30 OK created sql table model analytics.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.95s]
[0m11:10:49.707629 [debug] [Thread-2  ]: Finished running node model.ccwj.my_first_dbt_model
[0m11:10:49.708511 [debug] [Thread-2  ]: Began running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:10:49.709108 [info ] [Thread-2  ]: 6 of 30 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m11:10:49.710516 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_first_dbt_model, now test.ccwj.unique_my_first_dbt_model_id.16e066b321)
[0m11:10:49.711326 [debug] [Thread-2  ]: Began compiling node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:10:49.726802 [debug] [Thread-2  ]: Writing injected SQL for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:10:49.728111 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (compile): 11:10:49.711830 => 11:10:49.727732
[0m11:10:49.728679 [debug] [Thread-2  ]: Began executing node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:10:49.751201 [debug] [Thread-2  ]: Writing runtime sql for node "test.ccwj.unique_my_first_dbt_model_id.16e066b321"
[0m11:10:49.752195 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:49.752751 [debug] [Thread-2  ]: On test.ccwj.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:50.387891 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c742b8d8-666f-4094-b8d5-a7680dca8b6e&page=queryresults
[0m11:10:50.712099 [debug] [Thread-4  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m11:10:50.963606 [debug] [Thread-2  ]: Timing info for test.ccwj.unique_my_first_dbt_model_id.16e066b321 (execute): 11:10:49.729022 => 11:10:50.963094
[0m11:10:50.965047 [info ] [Thread-2  ]: 6 of 30 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.26s]
[0m11:10:50.966102 [debug] [Thread-2  ]: Finished running node test.ccwj.unique_my_first_dbt_model_id.16e066b321
[0m11:10:50.967256 [debug] [Thread-2  ]: Began running node model.ccwj.my_second_dbt_model
[0m11:10:50.967968 [info ] [Thread-2  ]: 7 of 30 START sql view model analytics.my_second_dbt_model ..................... [RUN]
[0m11:10:50.969256 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_first_dbt_model_id.16e066b321, now model.ccwj.my_second_dbt_model)
[0m11:10:50.969898 [debug] [Thread-2  ]: Began compiling node model.ccwj.my_second_dbt_model
[0m11:10:50.974213 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.my_second_dbt_model"
[0m11:10:50.975394 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (compile): 11:10:50.970243 => 11:10:50.975050
[0m11:10:50.975928 [debug] [Thread-2  ]: Began executing node model.ccwj.my_second_dbt_model
[0m11:10:50.983810 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.my_second_dbt_model"
[0m11:10:50.984900 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:50.985695 [debug] [Thread-2  ]: On model.ccwj.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.my_second_dbt_model"} */


  create or replace view `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `ccwj-dbt`.`analytics`.`my_first_dbt_model`
where id = 1;


[0m11:10:50.989943 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:25c10121-99a1-4799-af0f-1fa7ee03bf6b&page=queryresults
[0m11:10:51.197898 [debug] [Thread-1  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m11:10:51.315563 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m11:10:51.319228 [debug] [Thread-4  ]: Timing info for seed.ccwj.0417_history (execute): 11:10:46.810945 => 11:10:51.318844
[0m11:10:51.320097 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd2ee0>]}
[0m11:10:51.320768 [info ] [Thread-4  ]: 4 of 30 OK loaded seed file analytics.0417_history ............................. [[32mINSERT 1877[0m in 4.56s]
[0m11:10:51.322101 [debug] [Thread-4  ]: Finished running node seed.ccwj.0417_history
[0m11:10:51.323074 [debug] [Thread-4  ]: Began running node model.ccwj.history
[0m11:10:51.323638 [info ] [Thread-4  ]: 8 of 30 START sql view model analytics.history ................................. [RUN]
[0m11:10:51.324708 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.history)
[0m11:10:51.325193 [debug] [Thread-4  ]: Began compiling node model.ccwj.history
[0m11:10:51.329815 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.history"
[0m11:10:51.330959 [debug] [Thread-4  ]: Timing info for model.ccwj.history (compile): 11:10:51.325470 => 11:10:51.330594
[0m11:10:51.331950 [debug] [Thread-4  ]: Began executing node model.ccwj.history
[0m11:10:51.339007 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.history"
[0m11:10:51.340315 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:51.341035 [debug] [Thread-4  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m11:10:51.489161 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f4bfda16-b9ee-4c72-8576-8382244b4292&page=queryresults
[0m11:10:51.516736 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:21b4d40f-34a5-470c-b3d9-bb9e280b5d9f&page=queryresults
[0m11:10:51.613903 [debug] [Thread-3  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m11:10:51.801695 [debug] [Thread-2  ]: Timing info for model.ccwj.my_second_dbt_model (execute): 11:10:50.976237 => 11:10:51.801236
[0m11:10:51.803130 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4d5e0>]}
[0m11:10:51.804064 [info ] [Thread-2  ]: 7 of 30 OK created sql view model analytics.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m11:10:51.805087 [debug] [Thread-2  ]: Finished running node model.ccwj.my_second_dbt_model
[0m11:10:51.805896 [debug] [Thread-2  ]: Began running node model.ccwj.test
[0m11:10:51.806928 [info ] [Thread-2  ]: 9 of 30 START sql view model analytics.test .................................... [RUN]
[0m11:10:51.808007 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.my_second_dbt_model, now model.ccwj.test)
[0m11:10:51.808606 [debug] [Thread-2  ]: Began compiling node model.ccwj.test
[0m11:10:51.813037 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.test"
[0m11:10:51.814234 [debug] [Thread-2  ]: Timing info for model.ccwj.test (compile): 11:10:51.808952 => 11:10:51.813817
[0m11:10:51.814891 [debug] [Thread-2  ]: Began executing node model.ccwj.test
[0m11:10:51.819644 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.test"
[0m11:10:51.821432 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:51.822274 [debug] [Thread-2  ]: On model.ccwj.test: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.test"} */


  create or replace view `ccwj-dbt`.`analytics`.`test`
  OPTIONS()
  as select *
from `ccwj-dbt`.`analytics`.`0417_history`;


[0m11:10:51.851831 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m11:10:51.853988 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:bc8e8f4f-769b-40ea-bea5-726c2d8fc3a7&page=queryresults
[0m11:10:51.859366 [debug] [Thread-1  ]: Timing info for seed.ccwj.cflt_prices (execute): 11:10:47.709518 => 11:10:51.859088
[0m11:10:51.860889 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c44f10>]}
[0m11:10:51.861883 [info ] [Thread-1  ]: 5 of 30 OK loaded seed file analytics.cflt_prices .............................. [[32mINSERT 609[0m in 4.15s]
[0m11:10:51.862924 [debug] [Thread-1  ]: Finished running node seed.ccwj.cflt_prices
[0m11:10:51.863549 [debug] [Thread-1  ]: Began running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:51.864239 [info ] [Thread-1  ]: 10 of 30 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m11:10:51.865307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ccwj.cflt_prices, now test.ccwj.not_null_my_second_dbt_model_id.151b76d778)
[0m11:10:51.866107 [debug] [Thread-1  ]: Began compiling node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:51.878398 [debug] [Thread-1  ]: Writing injected SQL for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:10:51.879688 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:10:51.866410 => 11:10:51.879393
[0m11:10:51.880157 [debug] [Thread-1  ]: Began executing node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:51.884693 [debug] [Thread-1  ]: Writing runtime sql for node "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"
[0m11:10:51.885607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:51.886159 [debug] [Thread-1  ]: On test.ccwj.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m11:10:51.904321 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:b1717a03-01ee-475e-9efb-c58174297508&page=queryresults
[0m11:10:52.172505 [debug] [Thread-4  ]: Timing info for model.ccwj.history (execute): 11:10:51.332600 => 11:10:52.172221
[0m11:10:52.173756 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd76d0>]}
[0m11:10:52.174623 [info ] [Thread-4  ]: 8 of 30 OK created sql view model analytics.history ............................ [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m11:10:52.175638 [debug] [Thread-4  ]: Finished running node model.ccwj.history
[0m11:10:52.176578 [debug] [Thread-4  ]: Began running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:52.177145 [info ] [Thread-4  ]: 11 of 30 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:10:52.178140 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.history, now test.ccwj.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:10:52.178625 [debug] [Thread-4  ]: Began compiling node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:52.185462 [debug] [Thread-4  ]: Writing injected SQL for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:10:52.186528 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:10:52.178909 => 11:10:52.186221
[0m11:10:52.186973 [debug] [Thread-4  ]: Began executing node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:52.190979 [debug] [Thread-4  ]: Writing runtime sql for node "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:10:52.192012 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:52.192643 [debug] [Thread-4  ]: On test.ccwj.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "test.ccwj.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `ccwj-dbt`.`analytics`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:52.213458 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m11:10:52.217110 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_current (execute): 11:10:46.784514 => 11:10:52.216852
[0m11:10:52.218278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c89700>]}
[0m11:10:52.218949 [info ] [Thread-3  ]: 3 of 30 OK loaded seed file analytics.0417_current ............................. [[32mINSERT 9[0m in 5.46s]
[0m11:10:52.219784 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_current
[0m11:10:52.220711 [debug] [Thread-3  ]: Began running node model.ccwj.current
[0m11:10:52.221439 [info ] [Thread-3  ]: 12 of 30 START sql view model analytics.current ................................ [RUN]
[0m11:10:52.222839 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.current)
[0m11:10:52.223719 [debug] [Thread-3  ]: Began compiling node model.ccwj.current
[0m11:10:52.229403 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current"
[0m11:10:52.230781 [debug] [Thread-3  ]: Timing info for model.ccwj.current (compile): 11:10:52.224439 => 11:10:52.230334
[0m11:10:52.231722 [debug] [Thread-3  ]: Began executing node model.ccwj.current
[0m11:10:52.239793 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current"
[0m11:10:52.241256 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:10:52.242788 [debug] [Thread-3  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m11:10:52.315948 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:204f6045-efbf-4ad4-8950-89a802b44035&page=queryresults
[0m11:10:52.522953 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa8e7ad3-51d5-4327-bdbb-817ec1929296&page=queryresults
[0m11:10:52.647070 [debug] [Thread-2  ]: Timing info for model.ccwj.test (execute): 11:10:51.815224 => 11:10:52.646636
[0m11:10:52.648711 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9be20>]}
[0m11:10:52.649859 [info ] [Thread-2  ]: 9 of 30 OK created sql view model analytics.test ............................... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m11:10:52.651036 [debug] [Thread-2  ]: Finished running node model.ccwj.test
[0m11:10:52.681163 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:655f3f47-1aee-4157-a619-8296ddeb7189&page=queryresults
[0m11:10:52.896474 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4db6a44a-8e7e-4915-a8ce-70df8443a08e&page=queryresults
[0m11:10:52.991179 [debug] [Thread-3  ]: Timing info for model.ccwj.current (execute): 11:10:52.232288 => 11:10:52.990806
[0m11:10:52.992579 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108051fa0>]}
[0m11:10:52.993606 [info ] [Thread-3  ]: 12 of 30 OK created sql view model analytics.current ........................... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:10:52.994789 [debug] [Thread-3  ]: Finished running node model.ccwj.current
[0m11:10:52.996315 [debug] [Thread-2  ]: Began running node model.ccwj.calendar_symbol_dates
[0m11:10:52.996931 [debug] [Thread-3  ]: Began running node model.ccwj.current_account_earnings
[0m11:10:52.997679 [info ] [Thread-2  ]: 13 of 30 START sql view model analytics.calendar_symbol_dates .................. [RUN]
[0m11:10:52.998400 [info ] [Thread-3  ]: 14 of 30 START sql view model analytics.current_account_earnings ............... [RUN]
[0m11:10:52.999654 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.test, now model.ccwj.calendar_symbol_dates)
[0m11:10:53.000694 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.current_account_earnings)
[0m11:10:53.001284 [debug] [Thread-2  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m11:10:53.001805 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_account_earnings
[0m11:10:53.008765 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_account_earnings"
[0m11:10:53.013491 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m11:10:53.015694 [debug] [Thread-3  ]: Timing info for model.ccwj.current_account_earnings (compile): 11:10:53.005156 => 11:10:53.015153
[0m11:10:53.016532 [debug] [Thread-3  ]: Began executing node model.ccwj.current_account_earnings
[0m11:10:53.095700 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 11:10:53.002143 => 11:10:53.095140
[0m11:10:53.096843 [debug] [Thread-2  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m11:10:53.107232 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m11:10:53.117191 [debug] [Thread-1  ]: Timing info for test.ccwj.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:10:51.880436 => 11:10:53.116762
[0m11:10:53.117872 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:53.121688 [info ] [Thread-1  ]: 10 of 30 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 1.26s]
[0m11:10:53.135060 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_account_earnings"
[0m11:10:53.136043 [debug] [Thread-2  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, final as (
select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols 
) 
select * 
from final 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m11:10:53.137004 [debug] [Thread-1  ]: Finished running node test.ccwj.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:53.139819 [debug] [Thread-1  ]: Began running node model.ccwj.current_equity_holdings
[0m11:10:53.140524 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:10:53.142106 [info ] [Thread-1  ]: 15 of 30 START sql view model analytics.current_equity_holdings ................ [RUN]
[0m11:10:53.143435 [debug] [Thread-3  ]: On model.ccwj.current_account_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_account_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_account_earnings`
  OPTIONS()
  as select 
    *
from `ccwj-dbt`.`analytics`.`current`
where symbol like 'Account%';


[0m11:10:53.144777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ccwj.not_null_my_second_dbt_model_id.151b76d778, now model.ccwj.current_equity_holdings)
[0m11:10:53.147107 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_equity_holdings
[0m11:10:53.151804 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_equity_holdings"
[0m11:10:53.154964 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_holdings (compile): 11:10:53.147706 => 11:10:53.154540
[0m11:10:53.155713 [debug] [Thread-1  ]: Began executing node model.ccwj.current_equity_holdings
[0m11:10:53.160937 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_equity_holdings"
[0m11:10:53.162016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:53.162711 [debug] [Thread-1  ]: On model.ccwj.current_equity_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   cast(quantity as int) as equity_quantity,
   price as equity_price,
   market_value as equity_market_value,
   cost_basis as equity_cost_basis,
   gain_or_loss_dollar as equity_gain_or_loss_dollar,
   security_type,
   margin_requirement as equity_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Equity';


[0m11:10:53.540777 [debug] [Thread-4  ]: Timing info for test.ccwj.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:10:52.187250 => 11:10:53.540081
[0m11:10:53.543014 [info ] [Thread-4  ]: 11 of 30 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.36s]
[0m11:10:53.544633 [debug] [Thread-4  ]: Finished running node test.ccwj.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:53.545665 [debug] [Thread-4  ]: Began running node model.ccwj.current_holdings_earnings
[0m11:10:53.546699 [info ] [Thread-4  ]: 16 of 30 START sql view model analytics.current_holdings_earnings .............. [RUN]
[0m11:10:53.548010 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ccwj.unique_my_second_dbt_model_id.57a0f8c493, now model.ccwj.current_holdings_earnings)
[0m11:10:53.548903 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_holdings_earnings
[0m11:10:53.554623 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_holdings_earnings"
[0m11:10:53.558192 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_earnings (compile): 11:10:53.549620 => 11:10:53.557763
[0m11:10:53.558886 [debug] [Thread-4  ]: Began executing node model.ccwj.current_holdings_earnings
[0m11:10:53.564132 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_holdings_earnings"
[0m11:10:53.565498 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:53.566382 [debug] [Thread-4  ]: On model.ccwj.current_holdings_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2
)
, holdings_earnings_current_value as (
select 
   current_holdings.symbol,
   c.security_type,
   sum(market_value) as current_market_value
from current_holdings
   join `ccwj-dbt`.`analytics`.`current` as c using (symbol)
group by 1,2
)
, final as (
select 
   symbol,
   security_type,
   gain_or_loss,
from holdings_earnings_historical 
UNION ALL 
select 
   symbol,
   security_type,
   current_market_value,
from holdings_earnings_current_value
)
select 
   symbol,
   security_type,
   sum(gain_or_loss) as current_position_overall_gain_or_loss 
from final 
group by 1,2;


[0m11:10:53.703741 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:56fc97bf-927b-42c5-b84e-399768a65df2&page=queryresults
[0m11:10:53.723072 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c9e067c9-4fcc-49bb-bf34-24551fa4a871&page=queryresults
[0m11:10:53.727541 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aaab804a-129b-4bba-ba9c-a7824346491e&page=queryresults
[0m11:10:54.037302 [debug] [Thread-1  ]: Timing info for model.ccwj.current_equity_holdings (execute): 11:10:53.156118 => 11:10:54.037035
[0m11:10:54.038656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbea00>]}
[0m11:10:54.040323 [info ] [Thread-1  ]: 15 of 30 OK created sql view model analytics.current_equity_holdings ........... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:10:54.041344 [debug] [Thread-1  ]: Finished running node model.ccwj.current_equity_holdings
[0m11:10:54.042338 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_timeline
[0m11:10:54.043257 [info ] [Thread-1  ]: 17 of 30 START sql view model analytics.current_holdings_timeline .............. [RUN]
[0m11:10:54.044565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current_equity_holdings, now model.ccwj.current_holdings_timeline)
[0m11:10:54.045306 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_timeline
[0m11:10:54.062723 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_timeline"
[0m11:10:54.069091 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (compile): 11:10:54.045728 => 11:10:54.068561
[0m11:10:54.069699 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_timeline
[0m11:10:54.087168 [debug] [Thread-2  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 11:10:53.099642 => 11:10:54.086856
[0m11:10:54.088591 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108099bb0>]}
[0m11:10:54.093103 [info ] [Thread-2  ]: 13 of 30 OK created sql view model analytics.calendar_symbol_dates ............. [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m11:10:54.094018 [debug] [Thread-2  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m11:10:54.094637 [debug] [Thread-2  ]: Began running node model.ccwj.current_option_holdings
[0m11:10:54.095263 [info ] [Thread-2  ]: 18 of 30 START sql view model analytics.current_option_holdings ................ [RUN]
[0m11:10:54.099520 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_symbol_dates, now model.ccwj.current_option_holdings)
[0m11:10:54.100849 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_timeline"
[0m11:10:54.102642 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_option_holdings
[0m11:10:54.104170 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:76bea994-987a-434b-9e52-8f40e770d586&page=queryresults
[0m11:10:54.108272 [debug] [Thread-3  ]: Timing info for model.ccwj.current_account_earnings (execute): 11:10:53.017006 => 11:10:54.107979
[0m11:10:54.112491 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_option_holdings"
[0m11:10:54.114462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:54.115992 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd7400>]}
[0m11:10:54.117365 [debug] [Thread-1  ]: On model.ccwj.current_holdings_timeline: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_timeline"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_timeline`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   min(case when history.security_type = 'Equity' then date end) as first_stock_purchase_date,
   min(case when history.security_type = 'Option' then date end) as first_option_purchase_date,
   max(case when history.security_type = 'Equity' then date end) as last_stock_purchase_date,
   max(case when history.security_type = 'Option' then date end) as last_option_purchase_date,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1
)

, final as (
select 
   holdings_strategy.*,
   least(first_stock_purchase_date,first_option_purchase_date) as first_holdings_purchase_date
from holdings_strategy
)
select *
from final;


[0m11:10:54.119123 [info ] [Thread-3  ]: 14 of 30 OK created sql view model analytics.current_account_earnings .......... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m11:10:54.120573 [debug] [Thread-2  ]: Timing info for model.ccwj.current_option_holdings (compile): 11:10:54.108872 => 11:10:54.120011
[0m11:10:54.123002 [debug] [Thread-3  ]: Finished running node model.ccwj.current_account_earnings
[0m11:10:54.123576 [debug] [Thread-2  ]: Began executing node model.ccwj.current_option_holdings
[0m11:10:54.124575 [debug] [Thread-3  ]: Began running node model.ccwj.current_position_information
[0m11:10:54.130101 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_option_holdings"
[0m11:10:54.131592 [info ] [Thread-3  ]: 19 of 30 START sql view model analytics.current_position_information ........... [RUN]
[0m11:10:54.133642 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current_account_earnings, now model.ccwj.current_position_information)
[0m11:10:54.134830 [debug] [Thread-3  ]: Began compiling node model.ccwj.current_position_information
[0m11:10:54.135455 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:54.139367 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.current_position_information"
[0m11:10:54.140145 [debug] [Thread-2  ]: On model.ccwj.current_option_holdings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_holdings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_holdings`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   cast(quantity as int) as option_quantity,
   price as option_price,
   market_value as option_market_value,
   cost_basis as option_cost_basis,
   gain_or_loss_dollar as option_gain_or_loss_dollar,
   security_type,
   margin_requirement as option_margin_requirement,
from `ccwj-dbt`.`analytics`.`current`
where security_type = 'Option';


[0m11:10:54.144561 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (compile): 11:10:54.135738 => 11:10:54.143525
[0m11:10:54.145215 [debug] [Thread-3  ]: Began executing node model.ccwj.current_position_information
[0m11:10:54.150843 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.current_position_information"
[0m11:10:54.151968 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:10:54.152716 [debug] [Thread-3  ]: On model.ccwj.current_position_information: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_position_information"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_position_information`
  OPTIONS()
  as select 
   symbol,
   trade_symbol,
   option_security_type,
   quantity,
   price,
   market_value,
   cost_basis,
   gain_or_loss_dollar,
   security_type,
   margin_requirement,
   
from `ccwj-dbt`.`analytics`.`current`;


[0m11:10:54.450964 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_earnings (execute): 11:10:53.559275 => 11:10:54.450586
[0m11:10:54.452400 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff1b80>]}
[0m11:10:54.453391 [info ] [Thread-4  ]: 16 of 30 OK created sql view model analytics.current_holdings_earnings ......... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:10:54.454770 [debug] [Thread-4  ]: Finished running node model.ccwj.current_holdings_earnings
[0m11:10:54.455462 [debug] [Thread-4  ]: Began running node model.ccwj.daily_totals
[0m11:10:54.456187 [info ] [Thread-4  ]: 20 of 30 START sql view model analytics.daily_totals ........................... [RUN]
[0m11:10:54.457238 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current_holdings_earnings, now model.ccwj.daily_totals)
[0m11:10:54.457833 [debug] [Thread-4  ]: Began compiling node model.ccwj.daily_totals
[0m11:10:54.463568 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.daily_totals"
[0m11:10:54.466427 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (compile): 11:10:54.458178 => 11:10:54.466010
[0m11:10:54.467009 [debug] [Thread-4  ]: Began executing node model.ccwj.daily_totals
[0m11:10:54.473138 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.daily_totals"
[0m11:10:54.474180 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:54.475230 [debug] [Thread-4  ]: On model.ccwj.daily_totals: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.daily_totals"} */


  create or replace view `ccwj-dbt`.`analytics`.`daily_totals`
  OPTIONS()
  as with current_value as (
select 
   distinct symbol,
   calendar_dates.day as date,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join `ccwj-dbt`.`analytics`.`current`
group by 1,2,3
)
, historical_value as (
select 
   symbol,
   date(date) as date,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
    join `ccwj-dbt`.`analytics`.`cflt_prices` using (date,symbol)
group by 1,2,3
)
, all_symbols as (
select distinct symbol 
from `ccwj-dbt`.`analytics`.`current`
UNION DISTINCT 
select distinct symbol 
from `ccwj-dbt`.`analytics`.`history`
)
, daily_dates as (
select 
    distinct calendar_dates.day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols
where day <= current_date()
)
, daily_historical_gain_or_loss as (
select 
    daily_dates.day,
    daily_dates.symbol,
    security_type,
    round(sum(amount),2) as gain_or_loss,
from daily_dates 
    join historical_value 
        on historical_value.symbol = daily_dates.symbol
            and historical_value.date <= daily_dates.day 
group by 1,2,3
)
, final as (
select 
    daily_historical_gain_or_loss.day,
    daily_historical_gain_or_loss.symbol,
    daily_historical_gain_or_loss.security_type,
    sum(daily_historical_gain_or_loss.gain_or_loss) + sum(current_value.amount) as total_gain_or_loss
from daily_historical_gain_or_loss
    left join current_value 
        on current_value.symbol = daily_historical_gain_or_loss.symbol
            and current_value.security_type = daily_historical_gain_or_loss.security_type
            and date(current_value.date) = date(daily_historical_gain_or_loss.day)
group by 1,2,3
)
select * 
from final 
order by 1 desc;


[0m11:10:54.546269 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7d843e01-c634-4d10-b00e-bb376d8b9236&page=queryresults
[0m11:10:54.608415 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:efd34a19-e22f-443c-96ee-16fde968b0e3&page=queryresults
[0m11:10:54.702040 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:164b8eeb-d258-493a-a2d4-83f777186fb6&page=queryresults
[0m11:10:54.858401 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_timeline (execute): 11:10:54.070037 => 11:10:54.857938
[0m11:10:54.860005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c44ee0>]}
[0m11:10:54.861161 [info ] [Thread-1  ]: 17 of 30 OK created sql view model analytics.current_holdings_timeline ......... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m11:10:54.862754 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_timeline
[0m11:10:54.863703 [debug] [Thread-1  ]: Began running node model.ccwj.overall_position_performance
[0m11:10:54.864709 [info ] [Thread-1  ]: 21 of 30 START sql view model analytics.overall_position_performance ........... [RUN]
[0m11:10:54.865977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current_holdings_timeline, now model.ccwj.overall_position_performance)
[0m11:10:54.866587 [debug] [Thread-1  ]: Began compiling node model.ccwj.overall_position_performance
[0m11:10:54.871464 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.overall_position_performance"
[0m11:10:54.874394 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (compile): 11:10:54.866936 => 11:10:54.873997
[0m11:10:54.875568 [debug] [Thread-1  ]: Began executing node model.ccwj.overall_position_performance
[0m11:10:54.880553 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.overall_position_performance"
[0m11:10:54.881970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:54.882944 [debug] [Thread-1  ]: On model.ccwj.overall_position_performance: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.overall_position_performance"} */


  create or replace view `ccwj-dbt`.`analytics`.`overall_position_performance`
  OPTIONS()
  as with combined as (
select 
   symbol,
   security_type,
   sum(market_value) as amount 
from `ccwj-dbt`.`analytics`.`current`
group by 1,2
UNION ALL 
select 
   symbol,
   security_type,
   sum(amount) as amount 
from `ccwj-dbt`.`analytics`.`history`
group by 1,2
)


select 
   symbol,
   sum(case when security_type = 'Equity' then amount end) as gain_or_loss_stock,
   sum(case when security_type = 'Option' then amount end) as gain_or_loss_option,
   sum(case when security_type in ('Option','Equity') then amount end) as gain_or_loss_stock_and_option,
from combined 
group by 1;


[0m11:10:54.945335 [debug] [Thread-3  ]: Timing info for model.ccwj.current_position_information (execute): 11:10:54.145697 => 11:10:54.944674
[0m11:10:54.946794 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800aee0>]}
[0m11:10:54.947733 [info ] [Thread-3  ]: 19 of 30 OK created sql view model analytics.current_position_information ...... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m11:10:54.949087 [debug] [Thread-3  ]: Finished running node model.ccwj.current_position_information
[0m11:10:54.949916 [debug] [Thread-3  ]: Began running node model.ccwj.positions
[0m11:10:54.951167 [info ] [Thread-3  ]: 22 of 30 START sql view model analytics.positions .............................. [RUN]
[0m11:10:54.952342 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.current_position_information, now model.ccwj.positions)
[0m11:10:54.953064 [debug] [Thread-3  ]: Began compiling node model.ccwj.positions
[0m11:10:54.958169 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.positions"
[0m11:10:54.959416 [debug] [Thread-3  ]: Timing info for model.ccwj.positions (compile): 11:10:54.953413 => 11:10:54.959078
[0m11:10:54.959958 [debug] [Thread-3  ]: Began executing node model.ccwj.positions
[0m11:10:54.964802 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.positions"
[0m11:10:54.965926 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:10:54.966797 [debug] [Thread-3  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_bases,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m11:10:55.023361 [debug] [Thread-2  ]: Timing info for model.ccwj.current_option_holdings (execute): 11:10:54.125395 => 11:10:55.023023
[0m11:10:55.024635 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2d850>]}
[0m11:10:55.025460 [info ] [Thread-2  ]: 18 of 30 OK created sql view model analytics.current_option_holdings ........... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m11:10:55.026293 [debug] [Thread-2  ]: Finished running node model.ccwj.current_option_holdings
[0m11:10:55.026945 [debug] [Thread-2  ]: Began running node model.ccwj.current_equity_historical_earnings
[0m11:10:55.027955 [info ] [Thread-2  ]: 23 of 30 START sql view model analytics.current_equity_historical_earnings ..... [RUN]
[0m11:10:55.028992 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.current_option_holdings, now model.ccwj.current_equity_historical_earnings)
[0m11:10:55.029562 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_equity_historical_earnings
[0m11:10:55.034714 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_equity_historical_earnings"
[0m11:10:55.037046 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (compile): 11:10:55.029890 => 11:10:55.036658
[0m11:10:55.037655 [debug] [Thread-2  ]: Began executing node model.ccwj.current_equity_historical_earnings
[0m11:10:55.043938 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_equity_historical_earnings"
[0m11:10:55.045636 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:55.046746 [debug] [Thread-2  ]: On model.ccwj.current_equity_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_equity_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, holdings_earnings_historical as (
select 
   date,
   current_holdings.symbol,
   history.security_type,
   sum(amount) as gain_or_loss,
from current_holdings 
   join `ccwj-dbt`.`analytics`.`history` 
      on current_holdings.symbol = history.symbol
group by 1,2,3
)
, running_earnings_historical as (
select 
   date,
   symbol,
   security_type,
   gain_or_loss,
   sum(gain_or_loss) over (partition by symbol,security_type order by date asc) as running_earnings_historical
from holdings_earnings_historical
where 1=1
   and security_type = 'Equity'
)
, daily_holdings_value as (
select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    coalesce(lead(date) over (partition by symbol, option_security_type order by date)-1,current_date()) as next_equity_date,
    action,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
from `ccwj-dbt`.`analytics`.`history`
where action in ('Buy','Sell')
order by date
)
, final as (
select 
   calendar_symbol_dates.day,
   calendar_symbol_dates.symbol,
   daily_holdings_value.stock_action_quantity,
   running_earnings_historical.gain_or_loss,
   sum(running_earnings_historical.gain_or_loss) over (partition by calendar_symbol_dates.symbol order by calendar_symbol_dates.day asc) as running_earnings_historical,
   cflt_prices.close as closing_price
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates` 
   left join running_earnings_historical
      on running_earnings_historical.date = calendar_symbol_dates.day 
         and running_earnings_historical.symbol = calendar_symbol_dates.symbol 
   left join daily_holdings_value 
      on daily_holdings_value.symbol = calendar_symbol_dates.symbol 
         and daily_holdings_value.date <= calendar_symbol_dates.day 
         and daily_holdings_value.next_equity_date >= calendar_symbol_dates.day 
   left join `ccwj-dbt`.`analytics`.`cflt_prices`
      on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
         and date(cflt_prices.date) = date(calendar_symbol_dates.day)
where 1=1
)
select 
   day,
   symbol,
   running_earnings_historical,
   stock_action_quantity as equity_shares_quantity,
   stock_action_quantity*closing_price as daily_holdings_value,
   round(running_earnings_historical+(stock_action_quantity*closing_price),2) as historical_equity_holdings
from final 
where 1=1
   and day BETWEEN '2022-01-01' and current_date()
   and closing_price is not null 
order by day desc;


[0m11:10:55.048783 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:3198821e-e1cf-41ff-8827-b94851c9c218&page=queryresults
[0m11:10:55.360801 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:76753784-669d-40e8-b3a5-43e143d04ef9&page=queryresults
[0m11:10:55.392667 [debug] [Thread-4  ]: Timing info for model.ccwj.daily_totals (execute): 11:10:54.467326 => 11:10:55.392218
[0m11:10:55.393984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108094ee0>]}
[0m11:10:55.394950 [info ] [Thread-4  ]: 20 of 30 OK created sql view model analytics.daily_totals ...................... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:10:55.396274 [debug] [Thread-4  ]: Finished running node model.ccwj.daily_totals
[0m11:10:55.397020 [debug] [Thread-4  ]: Began running node model.ccwj.current_option_historical_earnings
[0m11:10:55.397854 [info ] [Thread-4  ]: 24 of 30 START sql view model analytics.current_option_historical_earnings ..... [RUN]
[0m11:10:55.399032 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.daily_totals, now model.ccwj.current_option_historical_earnings)
[0m11:10:55.399668 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_option_historical_earnings
[0m11:10:55.404586 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_option_historical_earnings"
[0m11:10:55.405787 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (compile): 11:10:55.400028 => 11:10:55.405398
[0m11:10:55.406401 [debug] [Thread-4  ]: Began executing node model.ccwj.current_option_historical_earnings
[0m11:10:55.411048 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_option_historical_earnings"
[0m11:10:55.412037 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:55.412765 [debug] [Thread-4  ]: On model.ccwj.current_option_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_option_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    amount,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.amount as daily_options_value,
    cumulative_daily_totals.cum_total as options_quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final;


[0m11:10:55.467460 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2b852f54-221f-47a3-83d3-f7ec039556cf&page=queryresults
[0m11:10:55.598093 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:436274de-7e62-427d-b2a7-9d3320e5f3cc&page=queryresults
[0m11:10:55.707150 [debug] [Thread-1  ]: Timing info for model.ccwj.overall_position_performance (execute): 11:10:54.876009 => 11:10:55.706776
[0m11:10:55.708624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb9460>]}
[0m11:10:55.709673 [info ] [Thread-1  ]: 21 of 30 OK created sql view model analytics.overall_position_performance ...... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m11:10:55.710662 [debug] [Thread-1  ]: Finished running node model.ccwj.overall_position_performance
[0m11:10:55.711357 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m11:10:55.712128 [info ] [Thread-1  ]: 25 of 30 START sql view model analytics.historical_equity_held ................. [RUN]
[0m11:10:55.713557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.overall_position_performance, now model.ccwj.historical_equity_held)
[0m11:10:55.714245 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m11:10:55.720047 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m11:10:55.723826 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 11:10:55.714701 => 11:10:55.723371
[0m11:10:55.724522 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m11:10:55.729807 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m11:10:55.730840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:55.731628 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m11:10:55.746060 [debug] [Thread-3  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: cost_bases; Did you mean cost_basis? at [12:5]; reason: invalidQuery, location: query, message: Unrecognized name: cost_bases; Did you mean cost_basis? at [12:5]')
[0m11:10:55.848074 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aab2f9b3-08aa-40e6-87c9-d274e6c2feee&page=queryresults
[0m11:10:55.914674 [debug] [Thread-2  ]: Timing info for model.ccwj.current_equity_historical_earnings (execute): 11:10:55.038032 => 11:10:55.914298
[0m11:10:55.916195 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec850>]}
[0m11:10:55.917291 [info ] [Thread-2  ]: 23 of 30 OK created sql view model analytics.current_equity_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:10:55.918382 [debug] [Thread-2  ]: Finished running node model.ccwj.current_equity_historical_earnings
[0m11:10:55.919126 [debug] [Thread-2  ]: Began running node model.ccwj.historical_options_held
[0m11:10:55.919916 [info ] [Thread-2  ]: 26 of 30 START sql view model analytics.historical_options_held ................ [RUN]
[0m11:10:55.921008 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.current_equity_historical_earnings, now model.ccwj.historical_options_held)
[0m11:10:55.921632 [debug] [Thread-2  ]: Began compiling node model.ccwj.historical_options_held
[0m11:10:55.926662 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.historical_options_held"
[0m11:10:55.930111 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_options_held (compile): 11:10:55.921985 => 11:10:55.929667
[0m11:10:55.930752 [debug] [Thread-2  ]: Began executing node model.ccwj.historical_options_held
[0m11:10:55.939733 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.historical_options_held"
[0m11:10:55.941003 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:55.941821 [debug] [Thread-2  ]: On model.ccwj.historical_options_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_options_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_options_held`
  OPTIONS()
  as with option_history as (
select 
    date,
    coalesce(lead(date) over (partition by symbol order by date asc)-1,current_date()) as next_option_date,
    action,
    symbol,
    security_type,
    trade_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end as quantity,
    amount,
    row_number() over (partition by symbol,trade_type order by date asc) as order_number,
    sum(case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then quantity*-1 
        else quantity
    end) over (partition by symbol,trade_type order by date asc) as cumulative_sum,
from `ccwj-dbt`.`analytics`.`history`
where 1=1
    and symbol = 'CFLT'
    and action in ('Sell to Open','Sell to Close','Buy to Open','Buy to Close','Expired','Assigned')
order by date desc 
)
, daily_totals as (
select 
    date,
    symbol,
    sum(quantity) as total,
    sum(amount) as amount,
from option_history 
group by 1,2
)
, cumulative_daily_totals as (
select 
    date,
    symbol,
    coalesce(lead(date) over (partition by symbol order by date)-1,current_date()) as next_option_date,
    total,
    sum(total) over (partition by symbol order by date asc) as cum_total,
    sum(amount) over (partition by symbol order by date asc) as cum_amount,
from daily_totals

)
, final as (
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    cumulative_daily_totals.cum_total as quantity,
    cumulative_daily_totals.cum_amount as amount,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    join cumulative_daily_totals 
        on cumulative_daily_totals.symbol = calendar_symbol_dates.symbol
            and date(cumulative_daily_totals.date) <= date(calendar_symbol_dates.day)
            and date(cumulative_daily_totals.next_option_date) >= date(calendar_symbol_dates.day)
where calendar_symbol_dates.day <= current_date()
order by calendar_symbol_dates.day desc 
)
select *
from final  
order by day desc 
limit 100;


[0m11:10:56.266771 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c776faa0-c6a1-4403-80ae-421e4e5ef8fb&page=queryresults
[0m11:10:56.369032 [debug] [Thread-4  ]: Timing info for model.ccwj.current_option_historical_earnings (execute): 11:10:55.406731 => 11:10:56.368657
[0m11:10:56.370304 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108094ee0>]}
[0m11:10:56.371309 [info ] [Thread-4  ]: 24 of 30 OK created sql view model analytics.current_option_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m11:10:56.372523 [debug] [Thread-4  ]: Finished running node model.ccwj.current_option_historical_earnings
[0m11:10:56.373295 [debug] [Thread-4  ]: Began running node model.ccwj.current_holdings_strategy
[0m11:10:56.374203 [info ] [Thread-4  ]: 27 of 30 START sql view model analytics.current_holdings_strategy .............. [RUN]
[0m11:10:56.375532 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ccwj.current_option_historical_earnings, now model.ccwj.current_holdings_strategy)
[0m11:10:56.376232 [debug] [Thread-4  ]: Began compiling node model.ccwj.current_holdings_strategy
[0m11:10:56.381160 [debug] [Thread-4  ]: Writing injected SQL for node "model.ccwj.current_holdings_strategy"
[0m11:10:56.382407 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_strategy (compile): 11:10:56.376608 => 11:10:56.382078
[0m11:10:56.382935 [debug] [Thread-4  ]: Began executing node model.ccwj.current_holdings_strategy
[0m11:10:56.387854 [debug] [Thread-4  ]: Writing runtime sql for node "model.ccwj.current_holdings_strategy"
[0m11:10:56.389379 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:10:56.390222 [debug] [Thread-4  ]: On model.ccwj.current_holdings_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
where symbol not in ('Cash','Account')
)
, holdings_strategy as (
select 
   current_holdings.symbol,
   coalesce(current_option_holdings.option_quantity,0) as option_quantity,
   coalesce(current_equity_holdings.equity_quantity,0) as equity_quantity,
   case 
      when current_option_holdings.option_quantity*-100 = current_equity_holdings.equity_quantity then 'Covered Call'
      when current_option_holdings.option_quantity is null and current_equity_holdings.equity_quantity is not null then 'Buy and Hold'
      else 'Other'
   end as strategy 
from current_holdings 
   left join `ccwj-dbt`.`analytics`.`current_equity_holdings` 
      on current_holdings.symbol = current_equity_holdings.symbol
   left join `ccwj-dbt`.`analytics`.`current_option_holdings` 
      on current_holdings.symbol = current_option_holdings.symbol

)

select *
from holdings_strategy;


[0m11:10:56.542462 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5b3b3f69-7300-481d-a9a8-1efae20dbeba&page=queryresults
[0m11:10:56.563696 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9bb0c9d-f802-44e3-b4a5-c99431646699&page=queryresults
[0m11:10:56.806507 [debug] [Thread-2  ]: Timing info for model.ccwj.historical_options_held (execute): 11:10:55.931097 => 11:10:56.806135
[0m11:10:56.807793 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b5b20>]}
[0m11:10:56.808783 [info ] [Thread-2  ]: 26 of 30 OK created sql view model analytics.historical_options_held ........... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:10:56.812692 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 11:10:55.724983 => 11:10:56.812296
[0m11:10:56.813689 [debug] [Thread-2  ]: Finished running node model.ccwj.historical_options_held
[0m11:10:56.814909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108004220>]}
[0m11:10:56.815587 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_earnings
[0m11:10:56.816450 [info ] [Thread-1  ]: 25 of 30 OK created sql view model analytics.historical_equity_held ............ [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m11:10:56.817143 [info ] [Thread-2  ]: 28 of 30 START sql view model analytics.current_holdings_historical_earnings ... [RUN]
[0m11:10:56.818060 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m11:10:56.818970 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ccwj.historical_options_held, now model.ccwj.current_holdings_historical_earnings)
[0m11:10:56.819571 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:10:56.820280 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_earnings
[0m11:10:56.820926 [info ] [Thread-1  ]: 29 of 30 START sql view model analytics.current_holdings_historical_strategy_and_earnings  [RUN]
[0m11:10:56.825982 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_earnings"
[0m11:10:56.827773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.historical_equity_held, now model.ccwj.current_holdings_historical_strategy_and_earnings)
[0m11:10:56.828818 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:10:56.834118 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m11:10:56.835421 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (compile): 11:10:56.821490 => 11:10:56.834835
[0m11:10:56.836061 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_earnings
[0m11:10:56.841127 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_earnings"
[0m11:10:56.842254 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (compile): 11:10:56.829172 => 11:10:56.841791
[0m11:10:56.843076 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:10:56.843941 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:10:56.847162 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_earnings`
  OPTIONS()
  as with combined as (
select 
    'Equity' as security_type,
    current_equity_historical_earnings.day,
    current_equity_historical_earnings.symbol,
    current_equity_historical_earnings.equity_shares_quantity as security_quantity,
    current_equity_historical_earnings.historical_equity_holdings as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
UNION ALL 
select 
    'Options' as security_type,
    current_option_historical_earnings.day,
    current_option_historical_earnings.symbol,
    current_option_historical_earnings.options_quantity as security_quantity,
    current_option_historical_earnings.amount as daily_earnings,

from `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
)
select *
from combined 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m11:10:56.855277 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy_and_earnings"
[0m11:10:56.856840 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:95539429-377d-4c54-a715-3d6e05d5848b&page=queryresults
[0m11:10:56.860107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:56.862730 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy_and_earnings: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy_and_earnings"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy_and_earnings`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    current_equity_historical_earnings.equity_shares_quantity,
    current_equity_historical_earnings.historical_equity_holdings,
    current_option_historical_earnings.options_quantity,
    current_option_historical_earnings.amount,
    current_option_historical_earnings.daily_options_value,
    case 
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0) = 0 then 'No Position'
        when coalesce(equity_shares_quantity,0) = coalesce(options_quantity,0)*100 then 'Covered Call'
        when coalesce(equity_shares_quantity,0) = 0 and coalesce(options_quantity,0)*100 > 0 then 'Naked Calls'
        when coalesce(equity_shares_quantity,0) > 0 and coalesce(options_quantity,0)*100 = 0 then 'Buy and Hold'
        else 'Mixed'
    end as daily_strategy
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
 left join `ccwj-dbt`.`analytics`.`current_equity_historical_earnings`
    on current_equity_historical_earnings.day = calendar_symbol_dates.day 
        and current_equity_historical_earnings.symbol = calendar_symbol_dates.symbol 
left join `ccwj-dbt`.`analytics`.`current_option_historical_earnings`
    on current_option_historical_earnings.day = calendar_symbol_dates.day
        and current_option_historical_earnings.symbol = calendar_symbol_dates.symbol 

where 1=1
   and calendar_symbol_dates.day BETWEEN '2024-01-01' and current_date()
   and calendar_symbol_dates.symbol = 'ASTS';


[0m11:10:56.867224 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f9bb0c9d-f802-44e3-b4a5-c99431646699&page=queryresults
[0m11:10:56.868835 [debug] [Thread-3  ]: Timing info for model.ccwj.positions (execute): 11:10:54.960279 => 11:10:56.868448
[0m11:10:56.886075 [debug] [Thread-3  ]: Database Error in model positions (models/core/positions.sql)
  Unrecognized name: cost_bases; Did you mean cost_basis? at [12:5]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m11:10:56.886861 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10816a7f0>]}
[0m11:10:56.888053 [error] [Thread-3  ]: 22 of 30 ERROR creating sql view model analytics.positions ..................... [[31mERROR[0m in 1.93s]
[0m11:10:56.889446 [debug] [Thread-3  ]: Finished running node model.ccwj.positions
[0m11:10:56.890187 [debug] [Thread-3  ]: Began running node model.ccwj.historical_positions_held
[0m11:10:56.890977 [info ] [Thread-3  ]: 30 of 30 START sql view model analytics.historical_positions_held .............. [RUN]
[0m11:10:56.892249 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ccwj.positions, now model.ccwj.historical_positions_held)
[0m11:10:56.892981 [debug] [Thread-3  ]: Began compiling node model.ccwj.historical_positions_held
[0m11:10:56.899886 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.historical_positions_held"
[0m11:10:56.901612 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (compile): 11:10:56.893438 => 11:10:56.901190
[0m11:10:56.902154 [debug] [Thread-3  ]: Began executing node model.ccwj.historical_positions_held
[0m11:10:56.906822 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.historical_positions_held"
[0m11:10:56.907761 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:10:56.908399 [debug] [Thread-3  ]: On model.ccwj.historical_positions_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_positions_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_positions_held`
  OPTIONS()
  as select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Options' as equity_type,
    historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)
UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Stock' as equity_type,
    historical_equity_held.total_gain_or_loss as total,

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day)

UNION ALL 
select 
    calendar_symbol_dates.day,
    calendar_symbol_dates.symbol,
    'Total' as equity_type,
    historical_equity_held.total_gain_or_loss + historical_options_held.amount as total,
    

from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join `ccwj-dbt`.`analytics`.`historical_options_held` using (symbol,day)
    left join `ccwj-dbt`.`analytics`.`historical_equity_held` using (symbol,day);


[0m11:10:57.179788 [debug] [Thread-4  ]: Timing info for model.ccwj.current_holdings_strategy (execute): 11:10:56.383261 => 11:10:57.179416
[0m11:10:57.181111 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108094e80>]}
[0m11:10:57.392547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7c23d0d3-ed57-41cb-8214-acdc67d66d5b&page=queryresults
[0m11:10:57.515463 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:4a46d1c1-ff92-433e-a634-297700324b5f&page=queryresults
[0m11:10:57.528488 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:8c26efe2-556a-40e5-85cc-056c7b846ad4&page=queryresults
[0m11:10:57.651288 [info ] [Thread-4  ]: 27 of 30 OK created sql view model analytics.current_holdings_strategy ......... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m11:10:57.652772 [debug] [Thread-4  ]: Finished running node model.ccwj.current_holdings_strategy
[0m11:10:57.874726 [debug] [Thread-3  ]: Timing info for model.ccwj.historical_positions_held (execute): 11:10:56.902464 => 11:10:57.874348
[0m11:10:57.876273 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108159520>]}
[0m11:10:57.877269 [info ] [Thread-3  ]: 30 of 30 OK created sql view model analytics.historical_positions_held ......... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m11:10:57.878333 [debug] [Thread-3  ]: Finished running node model.ccwj.historical_positions_held
[0m11:10:57.939420 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy_and_earnings (execute): 11:10:56.844493 => 11:10:57.939025
[0m11:10:57.941594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108004220>]}
[0m11:10:57.943777 [info ] [Thread-1  ]: 29 of 30 OK created sql view model analytics.current_holdings_historical_strategy_and_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m11:10:57.945234 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy_and_earnings
[0m11:10:58.100736 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_earnings (execute): 11:10:56.836399 => 11:10:58.100455
[0m11:10:58.102324 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73f19a25-588b-49bb-8fec-a97a9598d877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f20550>]}
[0m11:10:58.103373 [info ] [Thread-2  ]: 28 of 30 OK created sql view model analytics.current_holdings_historical_earnings  [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m11:10:58.104472 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_earnings
[0m11:10:58.107073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:58.107582 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy_and_earnings' was properly closed.
[0m11:10:58.108087 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_earnings' was properly closed.
[0m11:10:58.108579 [debug] [MainThread]: Connection 'model.ccwj.historical_positions_held' was properly closed.
[0m11:10:58.108944 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_strategy' was properly closed.
[0m11:10:58.109441 [info ] [MainThread]: 
[0m11:10:58.109891 [info ] [MainThread]: Finished running 23 view models, 1 table model, 3 tests, 3 seeds in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m11:10:58.116710 [debug] [MainThread]: Command end result
[0m11:10:58.133623 [info ] [MainThread]: 
[0m11:10:58.134541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:10:58.135181 [info ] [MainThread]: 
[0m11:10:58.135806 [error] [MainThread]:   Database Error in model positions (models/core/positions.sql)
  Unrecognized name: cost_bases; Did you mean cost_basis? at [12:5]
  compiled Code at target/run/ccwj/models/core/positions.sql
[0m11:10:58.136872 [info ] [MainThread]: 
[0m11:10:58.137945 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 TOTAL=30
[0m11:10:58.141036 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 13.874573, "process_user_time": 5.202478, "process_kernel_time": 0.549471, "process_mem_max_rss": "151670784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:10:58.142240 [debug] [MainThread]: Command `cli build` failed at 11:10:58.141891 after 13.88 seconds
[0m11:10:58.143175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ace160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef2b0>]}
[0m11:10:58.144248 [debug] [MainThread]: Flushing usage events
[0m11:11:22.307955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a57a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112565f70>]}


============================== 11:11:22.313356 | bf267d19-a09e-443d-8361-8168a6bc730f ==============================
[0m11:11:22.313356 [info ] [MainThread]: Running with dbt=1.7.12
[0m11:11:22.314101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:11:22.908946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251ce80>]}
[0m11:11:23.018778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134061f0>]}
[0m11:11:23.019809 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:11:23.041444 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m11:11:23.061457 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:11:23.062318 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m11:11:23.063271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bd460>]}
[0m11:11:24.695847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3f0d0>]}
[0m11:11:24.713967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bd460>]}
[0m11:11:24.714708 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m11:11:24.715145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113883640>]}
[0m11:11:24.716786 [info ] [MainThread]: 
[0m11:11:24.718073 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:11:24.719672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m11:11:24.720208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:25.977771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m11:11:25.978802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:26.243844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a89b80>]}
[0m11:11:26.245220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:26.245786 [info ] [MainThread]: 
[0m11:11:26.248934 [debug] [Thread-1  ]: Began running node model.ccwj.positions
[0m11:11:26.249780 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.positions ................................ [RUN]
[0m11:11:26.250789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.positions)
[0m11:11:26.251426 [debug] [Thread-1  ]: Began compiling node model.ccwj.positions
[0m11:11:26.263165 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.positions"
[0m11:11:26.264224 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (compile): 11:11:26.251921 => 11:11:26.263921
[0m11:11:26.264838 [debug] [Thread-1  ]: Began executing node model.ccwj.positions
[0m11:11:26.301631 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.positions"
[0m11:11:26.302561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:26.303163 [debug] [Thread-1  ]: On model.ccwj.positions: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.positions"} */


  create or replace view `ccwj-dbt`.`analytics`.`positions`
  OPTIONS()
  as with active_positions as (
select 
    symbol,
    description,
    quantity,
    day_change_dollar,
    cost_basis,
    
from `ccwj-dbt`.`analytics`.`current`

)

, history as (
select 
    history.*
from `ccwj-dbt`.`analytics`.`history`
    left join `ccwj-dbt`.`analytics`.`current` as c 
        on c.trade_symbol = history.trade_symbol
where c.trade_symbol is null 
)
select 
*
from active_positions;


[0m11:11:26.992210 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c4d3cbc1-ee75-40cb-9370-ca527220b652&page=queryresults
[0m11:11:27.385758 [debug] [Thread-1  ]: Timing info for model.ccwj.positions (execute): 11:11:26.265163 => 11:11:27.385476
[0m11:11:27.386727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf267d19-a09e-443d-8361-8168a6bc730f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c00b20>]}
[0m11:11:27.387431 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.positions ........................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m11:11:27.388272 [debug] [Thread-1  ]: Finished running node model.ccwj.positions
[0m11:11:27.390940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:27.391404 [debug] [MainThread]: Connection 'model.ccwj.positions' was properly closed.
[0m11:11:27.391989 [info ] [MainThread]: 
[0m11:11:27.392905 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m11:11:27.394382 [debug] [MainThread]: Command end result
[0m11:11:27.419522 [info ] [MainThread]: 
[0m11:11:27.420217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:27.420714 [info ] [MainThread]: 
[0m11:11:27.421577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:27.423910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.189789, "process_user_time": 4.974379, "process_kernel_time": 0.394359, "process_mem_max_rss": "137076736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:11:27.425187 [debug] [MainThread]: Command `cli run` succeeded at 11:11:27.424852 after 5.19 seconds
[0m11:11:27.426084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a57a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11338da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113883e50>]}
[0m11:11:27.427005 [debug] [MainThread]: Flushing usage events
[0m12:37:18.425296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d008a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eacd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb177f0>]}


============================== 12:37:18.430295 | 5b950e87-9087-4704-8eac-1e2c7429d536 ==============================
[0m12:37:18.430295 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:37:18.431459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:19.079707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab46a0>]}
[0m12:37:19.193394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ff940>]}
[0m12:37:19.194887 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:37:19.216743 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m12:37:19.235289 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:37:19.236007 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m12:37:19.236685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa4b5e0>]}
[0m12:37:21.017513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fff10d0>]}
[0m12:37:21.041137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9392b0>]}
[0m12:37:21.042013 [info ] [MainThread]: Found 24 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:37:21.044286 [info ] [MainThread]: 
[0m12:37:21.045412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:37:21.047343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:37:21.048354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:22.413033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:37:22.414067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:22.713921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fff1e80>]}
[0m12:37:22.715264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:22.715891 [info ] [MainThread]: 
[0m12:37:22.720454 [debug] [Thread-1  ]: Began running node model.ccwj.calendar_dates
[0m12:37:22.721195 [info ] [Thread-1  ]: 1 of 8 START sql view model analytics.calendar_dates ........................... [RUN]
[0m12:37:22.721904 [debug] [Thread-2  ]: Began running node seed.ccwj.0417_current
[0m12:37:22.722946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.calendar_dates)
[0m12:37:22.723470 [debug] [Thread-3  ]: Began running node seed.ccwj.0417_history
[0m12:37:22.724144 [info ] [Thread-2  ]: 2 of 8 START seed file analytics.0417_current .................................. [RUN]
[0m12:37:22.724819 [debug] [Thread-4  ]: Began running node seed.ccwj.cflt_prices
[0m12:37:22.725351 [debug] [Thread-1  ]: Began compiling node model.ccwj.calendar_dates
[0m12:37:22.726046 [info ] [Thread-3  ]: 3 of 8 START seed file analytics.0417_history .................................. [RUN]
[0m12:37:22.727394 [debug] [Thread-2  ]: Acquiring new bigquery connection 'seed.ccwj.0417_current'
[0m12:37:22.728146 [info ] [Thread-4  ]: 4 of 8 START seed file analytics.cflt_prices ................................... [RUN]
[0m12:37:22.738484 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.calendar_dates"
[0m12:37:22.740132 [debug] [Thread-3  ]: Acquiring new bigquery connection 'seed.ccwj.0417_history'
[0m12:37:22.740802 [debug] [Thread-2  ]: Began compiling node seed.ccwj.0417_current
[0m12:37:22.741847 [debug] [Thread-4  ]: Acquiring new bigquery connection 'seed.ccwj.cflt_prices'
[0m12:37:22.742580 [debug] [Thread-3  ]: Began compiling node seed.ccwj.0417_history
[0m12:37:22.743608 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (compile): 12:37:22.743116 => 12:37:22.743122
[0m12:37:22.744291 [debug] [Thread-4  ]: Began compiling node seed.ccwj.cflt_prices
[0m12:37:22.745141 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (compile): 12:37:22.744760 => 12:37:22.744765
[0m12:37:22.745801 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (compile): 12:37:22.728561 => 12:37:22.745484
[0m12:37:22.746390 [debug] [Thread-2  ]: Began executing node seed.ccwj.0417_current
[0m12:37:22.747002 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (compile): 12:37:22.746734 => 12:37:22.746737
[0m12:37:22.747515 [debug] [Thread-3  ]: Began executing node seed.ccwj.0417_history
[0m12:37:22.748209 [debug] [Thread-1  ]: Began executing node model.ccwj.calendar_dates
[0m12:37:22.779178 [debug] [Thread-4  ]: Began executing node seed.ccwj.cflt_prices
[0m12:37:22.782905 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:37:22.841580 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.calendar_dates"
[0m12:37:22.888947 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:37:22.903855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:22.911786 [debug] [Thread-1  ]: On model.ccwj.calendar_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_dates`
  OPTIONS()
  as SELECT day
FROM UNNEST(
    GENERATE_DATE_ARRAY(DATE('2020-01-01'), date_add(current_date(),INTERVAL 90 DAY), INTERVAL 1 DAY)
) AS day;


[0m12:37:22.932383 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:37:23.357779 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:24118dca-c23d-4edf-b4b6-d93b8cede3ab&page=queryresults
[0m12:37:23.724961 [debug] [Thread-1  ]: Timing info for model.ccwj.calendar_dates (execute): 12:37:22.792422 => 12:37:23.724593
[0m12:37:23.726028 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a4f70>]}
[0m12:37:23.726835 [info ] [Thread-1  ]: 1 of 8 OK created sql view model analytics.calendar_dates ...................... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m12:37:23.727710 [debug] [Thread-1  ]: Finished running node model.ccwj.calendar_dates
[0m12:37:26.461922 [debug] [Thread-4  ]: On seed.ccwj.cflt_prices: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.cflt_prices"} */

    alter table `ccwj-dbt`.`analytics`.`cflt_prices` set OPTIONS()
  
[0m12:37:26.527301 [debug] [Thread-2  ]: On seed.ccwj.0417_current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_current"} */

    alter table `ccwj-dbt`.`analytics`.`0417_current` set OPTIONS()
  
[0m12:37:26.575938 [debug] [Thread-3  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:37:26.766853 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:fc30c2b6-93a2-4a29-a93b-f0daafde6a73&page=queryresults
[0m12:37:26.839357 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:21fe86c5-3a4a-40b8-9268-76893c538dd9&page=queryresults
[0m12:37:26.860703 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:324196e0-b355-48e8-9f3e-a2f2ee94cab9&page=queryresults
[0m12:37:27.126946 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.ccwj.cflt_prices"
[0m12:37:27.133521 [debug] [Thread-4  ]: Timing info for seed.ccwj.cflt_prices (execute): 12:37:22.847228 => 12:37:27.133150
[0m12:37:27.134677 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d9d90>]}
[0m12:37:27.135403 [info ] [Thread-4  ]: 4 of 8 OK loaded seed file analytics.cflt_prices ............................... [[32mINSERT 609[0m in 4.39s]
[0m12:37:27.136253 [debug] [Thread-4  ]: Finished running node seed.ccwj.cflt_prices
[0m12:37:27.159164 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ccwj.0417_current"
[0m12:37:27.165902 [debug] [Thread-2  ]: Timing info for seed.ccwj.0417_current (execute): 12:37:22.748549 => 12:37:27.165333
[0m12:37:27.167327 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101410d0>]}
[0m12:37:27.168240 [info ] [Thread-2  ]: 2 of 8 OK loaded seed file analytics.0417_current .............................. [[32mINSERT 9[0m in 4.44s]
[0m12:37:27.169386 [debug] [Thread-2  ]: Finished running node seed.ccwj.0417_current
[0m12:37:27.170484 [debug] [Thread-1  ]: Began running node model.ccwj.current
[0m12:37:27.171475 [info ] [Thread-1  ]: 5 of 8 START sql view model analytics.current .................................. [RUN]
[0m12:37:27.172890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.calendar_dates, now model.ccwj.current)
[0m12:37:27.173897 [debug] [Thread-1  ]: Began compiling node model.ccwj.current
[0m12:37:27.179464 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current"
[0m12:37:27.184301 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:37:27.185591 [debug] [Thread-1  ]: Timing info for model.ccwj.current (compile): 12:37:27.174481 => 12:37:27.185024
[0m12:37:27.186743 [debug] [Thread-1  ]: Began executing node model.ccwj.current
[0m12:37:27.195801 [debug] [Thread-3  ]: Timing info for seed.ccwj.0417_history (execute): 12:37:22.783373 => 12:37:27.195471
[0m12:37:27.196634 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current"
[0m12:37:27.197719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137430>]}
[0m12:37:27.198833 [info ] [Thread-3  ]: 3 of 8 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1877[0m in 4.46s]
[0m12:37:27.199980 [debug] [Thread-3  ]: Finished running node seed.ccwj.0417_history
[0m12:37:27.200882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:27.201497 [debug] [Thread-2  ]: Began running node model.ccwj.history
[0m12:37:27.202175 [debug] [Thread-1  ]: On model.ccwj.current: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current"} */


  create or replace view `ccwj-dbt`.`analytics`.`current`
  OPTIONS()
  as with fix as (
select 
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    Description,
    Quantity,
    Price,
    price_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(price_change_dollar as  string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '($', ''))
       when cast(price_change_dollar as  string) LIKE '$%' THEN REPLACE(REPLACE(cast(price_change_dollar as  string), ')', ''), '$', '')
       else cast(price_change_dollar as  string)
    end, r'\$|,', '') as FLOAT64) as price_change_dollar,
   CAST(REGEXP_REPLACE(case 
       when cast(market_value as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(market_value as string), ')', ''), '($', ''))
       when cast(market_value as string) LIKE '$%' THEN REPLACE(REPLACE(cast(market_value as string), ')', ''), '$', '')
       else cast(market_value as string)
    end, r'\$|,', '') as FLOAT64) as market_value,
    day_change_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(day_change_dollar as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '($', ''))
       when cast(day_change_dollar as string) LIKE '$%' THEN REPLACE(REPLACE(cast(day_change_dollar as string), ')', ''), '$', '')
       else cast(day_change_dollar as string)
    end, r'\$|,', '') as FLOAT64) as day_change_dollar,
    CAST(REGEXP_REPLACE(case 
       when cast(cost_bases as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '($', ''))
       when cast(cost_bases as string) LIKE '$%' THEN REPLACE(REPLACE(cast(cost_bases as string), ')', ''), '$', '')
       else cast(cost_bases as string)
    end, r'\$|,', '') as FLOAT64) as cost_basis,
    gain_or_loss_percent,
    CAST(REGEXP_REPLACE(case 
       when cast(gain_or_loss_dollat as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '($', ''))
       when cast(gain_or_loss_dollat as string) LIKE '$%' THEN REPLACE(REPLACE(cast(gain_or_loss_dollat as string), ')', ''), '$', '')
       else cast(gain_or_loss_dollat as string)
    end, r'\$|,', '') as FLOAT64) as gain_or_loss_dollar,
    rating,
    divident_reinvestment,
    is_capital_gain,
    percent_of_account,
    expiration_date,
    cost_per_share,
    last_earnings_date,
    dividend_yield,
    last_dividend,
    ex_dividend_date,
    pe_ratio,
    annual_week_low,
    annual_week_high,
    volume,
    intrinsic_value,
    in_the_money,
    security_type,
    margin_requirement,
    
from `ccwj-dbt`.`analytics`.`0417_current`
)
select 
    *
from fix 
where symbol not in ('Cash & Cash Investments','Account Total');


[0m12:37:27.202862 [info ] [Thread-2  ]: 6 of 8 START sql view model analytics.history .................................. [RUN]
[0m12:37:27.205617 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_current, now model.ccwj.history)
[0m12:37:27.206513 [debug] [Thread-2  ]: Began compiling node model.ccwj.history
[0m12:37:27.212711 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:37:27.214307 [debug] [Thread-2  ]: Timing info for model.ccwj.history (compile): 12:37:27.207863 => 12:37:27.213846
[0m12:37:27.214899 [debug] [Thread-2  ]: Began executing node model.ccwj.history
[0m12:37:27.220916 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:37:27.221851 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:37:27.222447 [debug] [Thread-2  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m12:37:27.671331 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:aa4e15bf-6406-4c4d-9fde-f4ccdfd7d150&page=queryresults
[0m12:37:27.729093 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:e7a7305e-3228-47fd-9717-341b1924bbd4&page=queryresults
[0m12:37:28.251811 [debug] [Thread-1  ]: Timing info for model.ccwj.current (execute): 12:37:27.187260 => 12:37:28.251356
[0m12:37:28.253315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110137430>]}
[0m12:37:28.254257 [info ] [Thread-1  ]: 5 of 8 OK created sql view model analytics.current ............................. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m12:37:28.255490 [debug] [Thread-1  ]: Finished running node model.ccwj.current
[0m12:37:28.256607 [debug] [Thread-3  ]: Began running node model.ccwj.calendar_symbol_dates
[0m12:37:28.257483 [info ] [Thread-3  ]: 7 of 8 START sql view model analytics.calendar_symbol_dates .................... [RUN]
[0m12:37:28.258857 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.ccwj.0417_history, now model.ccwj.calendar_symbol_dates)
[0m12:37:28.259785 [debug] [Thread-3  ]: Began compiling node model.ccwj.calendar_symbol_dates
[0m12:37:28.268912 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.calendar_symbol_dates"
[0m12:37:28.272236 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (compile): 12:37:28.260221 => 12:37:28.271818
[0m12:37:28.272865 [debug] [Thread-3  ]: Began executing node model.ccwj.calendar_symbol_dates
[0m12:37:28.278107 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.calendar_symbol_dates"
[0m12:37:28.279226 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:37:28.279931 [debug] [Thread-3  ]: On model.ccwj.calendar_symbol_dates: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.calendar_symbol_dates"} */


  create or replace view `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
  OPTIONS()
  as with all_symbols as (
select distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, final as (
select 
    cast(calendar_dates.day as date) as day,
    all_symbols.symbol
from `ccwj-dbt`.`analytics`.`calendar_dates`
    cross join all_symbols 
) 
select * 
from final 
where EXTRACT(DAYOFWEEK from day) in (2,3,4,5,6);


[0m12:37:28.326217 [debug] [Thread-2  ]: Timing info for model.ccwj.history (execute): 12:37:27.215222 => 12:37:28.325820
[0m12:37:28.327375 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110485fa0>]}
[0m12:37:28.328235 [info ] [Thread-2  ]: 6 of 8 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m12:37:28.329012 [debug] [Thread-2  ]: Finished running node model.ccwj.history
[0m12:37:28.810940 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:9d9e1fcc-d755-4d7d-ad0c-a95ae3f3299f&page=queryresults
[0m12:37:29.128045 [debug] [Thread-3  ]: Timing info for model.ccwj.calendar_symbol_dates (execute): 12:37:28.273223 => 12:37:29.127658
[0m12:37:29.129638 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a3730>]}
[0m12:37:29.130691 [info ] [Thread-3  ]: 7 of 8 OK created sql view model analytics.calendar_symbol_dates ............... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m12:37:29.131760 [debug] [Thread-3  ]: Finished running node model.ccwj.calendar_symbol_dates
[0m12:37:29.132914 [debug] [Thread-1  ]: Began running node model.ccwj.historical_equity_held
[0m12:37:29.133688 [info ] [Thread-1  ]: 8 of 8 START sql view model analytics.historical_equity_held ................... [RUN]
[0m12:37:29.134757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ccwj.current, now model.ccwj.historical_equity_held)
[0m12:37:29.135381 [debug] [Thread-1  ]: Began compiling node model.ccwj.historical_equity_held
[0m12:37:29.141320 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.historical_equity_held"
[0m12:37:29.144818 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (compile): 12:37:29.135748 => 12:37:29.144375
[0m12:37:29.145446 [debug] [Thread-1  ]: Began executing node model.ccwj.historical_equity_held
[0m12:37:29.150347 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.historical_equity_held"
[0m12:37:29.151355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:29.152195 [debug] [Thread-1  ]: On model.ccwj.historical_equity_held: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.historical_equity_held"} */


  create or replace view `ccwj-dbt`.`analytics`.`historical_equity_held`
  OPTIONS()
  as with ordering as (

select 
    symbol,
    row_number() over (partition by symbol,action,option_security_type order by date) as stock_action_order,
    date,
    lead(date) over (partition by symbol, option_security_type order by date)-1 as next_equity_date,
    action,
    option_security_type,
    case when action = 'Sell' then quantity*-1 else quantity end as quantity,
    amount,
    sum(case when action = 'Sell' then quantity*-1 else quantity end) over (partition by symbol,option_security_type order by date) as stock_action_quantity,
    sum(amount) over (partition by symbol,option_security_type order by date) as stock_action_amount,
from `ccwj-dbt`.`analytics`.`history`
where symbol = 'CFLT'
    and action in ('Buy','Sell')
order by date
)
, stock_activity as (
select 
    symbol,
    stock_action_order,
    date,
    case 
        when next_equity_date is null and action = 'Buy' then current_date()
        else next_equity_date
    end as next_equity_date,
    action,
    option_security_type,
    stock_action_quantity,
    stock_action_amount
from ordering 
)
, final as (
select 
    calendar_symbol_dates.day,
    stock_activity.symbol,
    stock_activity.stock_action_quantity,
    stock_activity.stock_action_amount,
    cflt_prices.close,
    cflt_prices.close*stock_activity.stock_action_quantity as equity_value,
from `ccwj-dbt`.`analytics`.`calendar_symbol_dates`
    left join stock_activity
        on stock_activity.date <= calendar_symbol_dates.day 
            and stock_activity.next_equity_date >= calendar_symbol_dates.day 
            and stock_activity.symbol = calendar_symbol_dates.symbol
    left join `ccwj-dbt`.`analytics`.`cflt_prices`
        on lower(cflt_prices.symbol) = lower(calendar_symbol_dates.symbol)
            and date(cflt_prices.date) = date(calendar_symbol_dates.day )
where 1=1
    and calendar_symbol_dates.symbol = 'CFLT'
    and calendar_symbol_dates.day < current_date 
order by calendar_symbol_dates.day desc 
)
select 
    *,
    round(stock_action_amount + equity_value,2) as total_gain_or_loss 
from final
where close is not null;


[0m12:37:29.706640 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7a739dfd-8e81-41dd-9532-4a48b9b4c07a&page=queryresults
[0m12:37:30.266791 [debug] [Thread-1  ]: Timing info for model.ccwj.historical_equity_held (execute): 12:37:29.145805 => 12:37:30.266188
[0m12:37:30.268338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b950e87-9087-4704-8eac-1e2c7429d536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110482b20>]}
[0m12:37:30.269330 [info ] [Thread-1  ]: 8 of 8 OK created sql view model analytics.historical_equity_held .............. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m12:37:30.270518 [debug] [Thread-1  ]: Finished running node model.ccwj.historical_equity_held
[0m12:37:30.273159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:30.273711 [debug] [MainThread]: Connection 'model.ccwj.historical_equity_held' was properly closed.
[0m12:37:30.274170 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:37:30.274622 [debug] [MainThread]: Connection 'model.ccwj.calendar_symbol_dates' was properly closed.
[0m12:37:30.275081 [debug] [MainThread]: Connection 'seed.ccwj.cflt_prices' was properly closed.
[0m12:37:30.275608 [info ] [MainThread]: 
[0m12:37:30.276238 [info ] [MainThread]: Finished running 5 view models, 3 seeds in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m12:37:30.278712 [debug] [MainThread]: Command end result
[0m12:37:30.299587 [info ] [MainThread]: 
[0m12:37:30.300289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:30.300977 [info ] [MainThread]: 
[0m12:37:30.301694 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:37:30.305012 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.95391, "process_user_time": 5.602725, "process_kernel_time": 0.452357, "process_mem_max_rss": "146067456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:37:30.306071 [debug] [MainThread]: Command `cli build` succeeded at 12:37:30.305850 after 11.96 seconds
[0m12:37:30.306658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d008a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe51ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab46a0>]}
[0m12:37:30.307189 [debug] [MainThread]: Flushing usage events
[0m12:18:27.994235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b8eb0>]}


============================== 12:18:28.000595 | e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9 ==============================
[0m12:18:28.000595 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:18:28.001481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:28.596439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110057bb0>]}
[0m12:18:28.728027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea0070>]}
[0m12:18:28.729273 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:18:28.752605 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m12:18:28.771108 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:18:28.772061 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m12:18:28.773180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecc340>]}
[0m12:18:30.470543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115900d0>]}
[0m12:18:30.495175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11110b4c0>]}
[0m12:18:30.495958 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:18:30.497999 [info ] [MainThread]: 
[0m12:18:30.499018 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:30.500412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:18:30.500965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:32.111400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:18:32.112474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:32.421594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a7b50>]}
[0m12:18:32.423079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:32.423664 [info ] [MainThread]: 
[0m12:18:32.428384 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_history
[0m12:18:32.429261 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m12:18:32.430321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_history)
[0m12:18:32.430918 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_history
[0m12:18:32.431593 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (compile): 12:18:32.431275 => 12:18:32.431279
[0m12:18:32.432093 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_history
[0m12:18:32.549455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:36.304692 [debug] [Thread-1  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:18:36.557960 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:c4e5e44a-4e3b-4550-b168-8c7feff0a490&page=queryresults
[0m12:18:36.890497 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:18:36.913034 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (execute): 12:18:32.432402 => 12:18:36.912753
[0m12:18:36.914027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111740f70>]}
[0m12:18:36.914823 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1877[0m in 4.48s]
[0m12:18:36.915666 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_history
[0m12:18:36.916816 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m12:18:36.917577 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.history .................................. [RUN]
[0m12:18:36.919087 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m12:18:36.919706 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m12:18:36.929665 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:18:36.931151 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 12:18:36.920145 => 12:18:36.930723
[0m12:18:36.931675 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m12:18:36.956607 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:18:36.957665 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:18:36.958735 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m12:18:37.465560 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:5e0fef35-af53-4f81-9cd6-d7f28c649dba&page=queryresults
[0m12:18:38.039082 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 12:18:36.931984 => 12:18:38.038680
[0m12:18:38.040343 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111959970>]}
[0m12:18:38.041491 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m12:18:38.042472 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m12:18:38.043609 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m12:18:38.044408 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m12:18:38.045770 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_holdings_historical_strategy'
[0m12:18:38.046449 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m12:18:38.051428 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m12:18:38.054106 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 12:18:38.046841 => 12:18:38.053692
[0m12:18:38.054732 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m12:18:38.061345 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m12:18:38.062497 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:18:38.063225 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    sum(amount) over (partition by trade_symbol order by date) as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
where symbol in ('JXN')
order by trade_symbol,date asc
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final;


[0m12:18:38.698767 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d423ee19-3e65-46f9-b611-6b7f9bde5fef&page=queryresults
[0m12:18:39.056614 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 12:18:38.055083 => 12:18:39.056291
[0m12:18:39.057738 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1a24ca0-4a03-45cc-a00d-246ce3e5a6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111754250>]}
[0m12:18:39.058630 [info ] [Thread-2  ]: 3 of 3 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:18:39.059614 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m12:18:39.061924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:39.062378 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:18:39.062769 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:18:39.063155 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m12:18:39.063632 [info ] [MainThread]: 
[0m12:18:39.064132 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m12:18:39.065724 [debug] [MainThread]: Command end result
[0m12:18:39.081721 [info ] [MainThread]: 
[0m12:18:39.082561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:39.083237 [info ] [MainThread]: 
[0m12:18:39.084107 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:18:39.087600 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.174131, "process_user_time": 5.272532, "process_kernel_time": 0.406574, "process_mem_max_rss": "139386880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:39.088447 [debug] [MainThread]: Command `cli build` succeeded at 12:18:39.088258 after 11.18 seconds
[0m12:18:39.089019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111644970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecc0a0>]}
[0m12:18:39.089538 [debug] [MainThread]: Flushing usage events
[0m12:18:48.617238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b969580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b3eb0>]}


============================== 12:18:48.622465 | b31a9fa9-2ade-41ed-b407-2676e2ee3ee8 ==============================
[0m12:18:48.622465 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:18:48.623436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:49.213620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b969310>]}
[0m12:18:49.322736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c79ea00>]}
[0m12:18:49.323781 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:18:49.346292 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m12:18:49.408071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:49.408566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:49.418283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb600d0>]}
[0m12:18:49.438468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c970970>]}
[0m12:18:49.439383 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:18:49.442203 [info ] [MainThread]: 
[0m12:18:49.443526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:49.445129 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:18:49.446143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:51.094846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:18:51.095758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:51.409736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c941d90>]}
[0m12:18:51.411081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:51.411657 [info ] [MainThread]: 
[0m12:18:51.414852 [debug] [Thread-1  ]: Began running node seed.ccwj.0417_history
[0m12:18:51.415555 [info ] [Thread-1  ]: 1 of 3 START seed file analytics.0417_history .................................. [RUN]
[0m12:18:51.416772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now seed.ccwj.0417_history)
[0m12:18:51.417382 [debug] [Thread-1  ]: Began compiling node seed.ccwj.0417_history
[0m12:18:51.418102 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (compile): 12:18:51.417766 => 12:18:51.417771
[0m12:18:51.418767 [debug] [Thread-1  ]: Began executing node seed.ccwj.0417_history
[0m12:18:51.549452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:55.360853 [debug] [Thread-1  ]: On seed.ccwj.0417_history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "seed.ccwj.0417_history"} */

    alter table `ccwj-dbt`.`analytics`.`0417_history` set OPTIONS()
  
[0m12:18:55.658926 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6d0aba88-a8a3-40ef-9d94-fc7332369363&page=queryresults
[0m12:18:56.043909 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ccwj.0417_history"
[0m12:18:56.064195 [debug] [Thread-1  ]: Timing info for seed.ccwj.0417_history (execute): 12:18:51.419398 => 12:18:56.063752
[0m12:18:56.065686 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cca6d30>]}
[0m12:18:56.066471 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file analytics.0417_history .............................. [[32mINSERT 1877[0m in 4.65s]
[0m12:18:56.067526 [debug] [Thread-1  ]: Finished running node seed.ccwj.0417_history
[0m12:18:56.069340 [debug] [Thread-3  ]: Began running node model.ccwj.history
[0m12:18:56.070832 [info ] [Thread-3  ]: 2 of 3 START sql view model analytics.history .................................. [RUN]
[0m12:18:56.072994 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ccwj.history'
[0m12:18:56.073814 [debug] [Thread-3  ]: Began compiling node model.ccwj.history
[0m12:18:56.085612 [debug] [Thread-3  ]: Writing injected SQL for node "model.ccwj.history"
[0m12:18:56.086710 [debug] [Thread-3  ]: Timing info for model.ccwj.history (compile): 12:18:56.074269 => 12:18:56.086348
[0m12:18:56.087264 [debug] [Thread-3  ]: Began executing node model.ccwj.history
[0m12:18:56.116647 [debug] [Thread-3  ]: Writing runtime sql for node "model.ccwj.history"
[0m12:18:56.118028 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:18:56.118854 [debug] [Thread-3  ]: On model.ccwj.history: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.history"} */


  create or replace view `ccwj-dbt`.`analytics`.`history`
  OPTIONS()
  as with fix as (
select 
    date as old_date,
    cast(coalesce(SAFE.PARSE_DATE('%m/%d/%y',split(date," ")[0]),SAFE.PARSE_DATE('%m/%d/%Y',split(date," ")[0]))as date) as date,
    action,
    
    symbol as trade_symbol,
    split(symbol," ")[0] as symbol,
    split(symbol," ")[SAFE_OFFSET(1)] as option_expiration_date,
    split(symbol," ")[SAFE_OFFSET(2)] as option_expiration_price,
    split(symbol," ")[SAFE_OFFSET(3)] as option_security_type,
    case 
        when action in ('Buy','Sell') then 'Equity'
        when split(symbol," ")[SAFE_OFFSET(3)]  = 'C' then 'Option'
    end as security_type,
    case 
        when action in ('Assigned','Expired','Buy to Close','Sell to Close') then 'Close' 
        else 'Open'
    end as trade_type,
    quantity,
    price,
    fees_and_comm,
    amount as amount_old,
    CAST(REGEXP_REPLACE(case 
       when cast(amount as string) LIKE '($%)' THEN CONCAT('-', REPLACE(REPLACE(cast(amount as string), ')', ''), '($', ''))
       when cast(amount as string) LIKE '$%' THEN REPLACE(REPLACE(cast(amount as string), ')', ''), '$', '')
       when action in ('Expired','Assigned','Journal') then '0'
       else cast(amount as string)
    end, r'\$|,', '') as FLOAT64) as amount
from `ccwj-dbt`.`analytics`.`0417_history`
)
select 
    *
from fix 
where symbol in ('CFLT','ONON','JXN','ASTS')
order by date desc;


[0m12:18:56.627496 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:f5e9dfdd-fc22-4e64-9c1e-d98f12f06d03&page=queryresults
[0m12:18:57.047477 [debug] [Thread-3  ]: Timing info for model.ccwj.history (execute): 12:18:56.087641 => 12:18:57.046617
[0m12:18:57.050325 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceabf40>]}
[0m12:18:57.052029 [info ] [Thread-3  ]: 2 of 3 OK created sql view model analytics.history ............................. [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m12:18:57.053996 [debug] [Thread-3  ]: Finished running node model.ccwj.history
[0m12:18:57.056161 [debug] [Thread-2  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m12:18:57.057735 [info ] [Thread-2  ]: 3 of 3 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m12:18:57.060166 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ccwj.current_holdings_historical_strategy'
[0m12:18:57.062270 [debug] [Thread-2  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m12:18:57.071988 [debug] [Thread-2  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m12:18:57.074079 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 12:18:57.063094 => 12:18:57.073290
[0m12:18:57.075619 [debug] [Thread-2  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m12:18:57.097230 [debug] [Thread-2  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m12:18:57.099561 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:18:57.101199 [debug] [Thread-2  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    sum(amount) over (partition by trade_symbol order by date) as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
where symbol in ('JXN')
order by trade_symbol,date asc
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final;


[0m12:18:57.941027 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:d2f6253a-1775-45f3-9bf7-f9bf8bd0590d&page=queryresults
[0m12:18:58.323418 [debug] [Thread-2  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 12:18:57.076751 => 12:18:58.322982
[0m12:18:58.324818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31a9fa9-2ade-41ed-b407-2676e2ee3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cee8f40>]}
[0m12:18:58.325782 [info ] [Thread-2  ]: 3 of 3 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m12:18:58.326823 [debug] [Thread-2  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m12:18:58.329370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:58.329923 [debug] [MainThread]: Connection 'seed.ccwj.0417_history' was properly closed.
[0m12:18:58.330382 [debug] [MainThread]: Connection 'model.ccwj.history' was properly closed.
[0m12:18:58.330829 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m12:18:58.331360 [info ] [MainThread]: 
[0m12:18:58.331915 [info ] [MainThread]: Finished running 1 seed, 2 view models in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m12:18:58.333807 [debug] [MainThread]: Command end result
[0m12:18:58.355195 [info ] [MainThread]: 
[0m12:18:58.355867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:58.356562 [info ] [MainThread]: 
[0m12:18:58.357399 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:18:58.359775 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.767694, "process_user_time": 3.75256, "process_kernel_time": 0.369251, "process_mem_max_rss": "132349952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:58.361053 [debug] [MainThread]: Command `cli build` succeeded at 12:18:58.360687 after 9.77 seconds
[0m12:18:58.361899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb4ea60>]}
[0m12:18:58.362958 [debug] [MainThread]: Flushing usage events
[0m12:21:03.027500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc10a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6a1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6ebf70>]}


============================== 12:21:03.035303 | fbae8d80-362e-4ce2-a39c-1ed1e4577618 ==============================
[0m12:21:03.035303 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:21:03.036477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'debug': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:21:03.813415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6a1e80>]}
[0m12:21:03.923102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110542ac0>]}
[0m12:21:03.924454 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:21:03.947973 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m12:21:03.966655 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:21:03.967498 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m12:21:03.968200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a8cd0>]}
[0m12:21:05.696307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c21f10>]}
[0m12:21:05.717636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dbfa0>]}
[0m12:21:05.718401 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:21:05.719423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a38b0>]}
[0m12:21:05.722372 [info ] [MainThread]: 
[0m12:21:05.723590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:05.725303 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:21:05.726096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:07.386286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:21:07.387262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:07.675195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bd1cd0>]}
[0m12:21:07.676504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:07.677326 [info ] [MainThread]: 
[0m12:21:07.681829 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m12:21:07.682607 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m12:21:07.683889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_strategy)
[0m12:21:07.684547 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m12:21:07.698271 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m12:21:07.699590 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 12:21:07.685096 => 12:21:07.699170
[0m12:21:07.700360 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m12:21:07.753131 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m12:21:07.754338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:07.755103 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    sum(amount) over (partition by trade_symbol order by date) as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final;


[0m12:21:08.453831 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:6b326423-38c3-4db8-ad48-ee88296fcb20&page=queryresults
[0m12:21:08.781998 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 12:21:07.700691 => 12:21:08.781705
[0m12:21:08.783154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbae8d80-362e-4ce2-a39c-1ed1e4577618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfa250>]}
[0m12:21:08.783953 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m12:21:08.784825 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m12:21:08.786929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:08.787355 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m12:21:08.787768 [info ] [MainThread]: 
[0m12:21:08.788210 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m12:21:08.789133 [debug] [MainThread]: Command end result
[0m12:21:08.812831 [info ] [MainThread]: 
[0m12:21:08.813423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:08.813879 [info ] [MainThread]: 
[0m12:21:08.814446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:08.817631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8758464, "process_user_time": 5.44507, "process_kernel_time": 0.512651, "process_mem_max_rss": "137195520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:08.818452 [debug] [MainThread]: Command `cli run` succeeded at 12:21:08.818260 after 5.88 seconds
[0m12:21:08.819332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc10a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dbfa0>]}
[0m12:21:08.820350 [debug] [MainThread]: Flushing usage events
[0m12:56:20.385429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e57130>]}


============================== 12:56:20.391811 | 4c4f8fcc-7224-4294-aec3-b9769533fee4 ==============================
[0m12:56:20.391811 [info ] [MainThread]: Running with dbt=1.7.12
[0m12:56:20.392605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:21.192997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c88eb0>]}
[0m12:56:21.303154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c17dc0>]}
[0m12:56:21.304669 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m12:56:21.326181 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m12:56:21.345863 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:56:21.346717 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m12:56:21.347548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c613d0>]}
[0m12:56:23.036611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b7f40>]}
[0m12:56:23.056575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f692b0>]}
[0m12:56:23.057265 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m12:56:23.057865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b9520>]}
[0m12:56:23.061025 [info ] [MainThread]: 
[0m12:56:23.062126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:23.064851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m12:56:23.065491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:25.004410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m12:56:25.005420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:25.316344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ad790>]}
[0m12:56:25.317773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:25.318675 [info ] [MainThread]: 
[0m12:56:25.323200 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m12:56:25.323996 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m12:56:25.325025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_strategy)
[0m12:56:25.325651 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m12:56:25.337657 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m12:56:25.339415 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 12:56:25.325998 => 12:56:25.338960
[0m12:56:25.339992 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m12:56:25.378064 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m12:56:25.379033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:56:25.379634 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    sum(amount) over (partition by trade_symbol order by date) as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
    join current_holdings using (symbol)
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final;


[0m12:56:25.913751 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:2c729284-1e9c-435f-ac1d-34a30f2274ab&page=queryresults
[0m12:56:26.272976 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 12:56:25.340319 => 12:56:26.272695
[0m12:56:26.273986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4f8fcc-7224-4294-aec3-b9769533fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a19a0>]}
[0m12:56:26.274786 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m12:56:26.275712 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m12:56:26.278024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:26.278571 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m12:56:26.279058 [info ] [MainThread]: 
[0m12:56:26.279598 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m12:56:26.280636 [debug] [MainThread]: Command end result
[0m12:56:26.303418 [info ] [MainThread]: 
[0m12:56:26.304218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:26.305151 [info ] [MainThread]: 
[0m12:56:26.305978 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:26.309521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.998364, "process_user_time": 5.075498, "process_kernel_time": 0.499927, "process_mem_max_rss": "136855552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:56:26.310618 [debug] [MainThread]: Command `cli run` succeeded at 12:56:26.310354 after 6.00 seconds
[0m12:56:26.311217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d54bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c88eb0>]}
[0m12:56:26.311730 [debug] [MainThread]: Flushing usage events
[0m13:01:05.583219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eabda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eae5550>]}


============================== 13:01:05.588576 | a0f492bb-81da-4d01-ad7b-93ce26af015f ==============================
[0m13:01:05.588576 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:01:05.589684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:06.194749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eacf1f0>]}
[0m13:01:06.305958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f948550>]}
[0m13:01:06.306873 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:01:06.329306 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:01:06.349885 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:01:06.351236 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:01:06.351904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa3b910>]}
[0m13:01:08.049726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110045dc0>]}
[0m13:01:08.072429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8b6460>]}
[0m13:01:08.073095 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:01:08.073631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe48310>]}
[0m13:01:08.075700 [info ] [MainThread]: 
[0m13:01:08.076909 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:08.078132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:01:08.078789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:09.425606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:01:09.426735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:09.731018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fff5ee0>]}
[0m13:01:09.732402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:09.733353 [info ] [MainThread]: 
[0m13:01:09.737778 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m13:01:09.738558 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m13:01:09.739697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_strategy)
[0m13:01:09.740596 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m13:01:09.752692 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m13:01:09.754131 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 13:01:09.741032 => 13:01:09.753793
[0m13:01:09.754644 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m13:01:09.795451 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m13:01:09.796457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:09.797165 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    sum(amount) over (partition by trade_symbol order by date) as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
    join current_holdings using (symbol)
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    amount,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final 
where symbol = 'CFLT';


[0m13:01:10.431825 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:65ed2dac-0e24-4c8f-be79-0b7808d7d41d&page=queryresults
[0m13:01:10.765145 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 13:01:09.754946 => 13:01:10.764835
[0m13:01:10.766279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f492bb-81da-4d01-ad7b-93ce26af015f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110116490>]}
[0m13:01:10.767108 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:01:10.768169 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m13:01:10.770199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:10.770617 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m13:01:10.771039 [info ] [MainThread]: 
[0m13:01:10.771545 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m13:01:10.772673 [debug] [MainThread]: Command end result
[0m13:01:10.794668 [info ] [MainThread]: 
[0m13:01:10.795465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:10.796037 [info ] [MainThread]: 
[0m13:01:10.796623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:10.799045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.292933, "process_user_time": 5.08845, "process_kernel_time": 0.422971, "process_mem_max_rss": "137388032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:10.799822 [debug] [MainThread]: Command `cli run` succeeded at 13:01:10.799642 after 5.29 seconds
[0m13:01:10.800467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc7eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8b6460>]}
[0m13:01:10.801022 [debug] [MainThread]: Flushing usage events
[0m13:01:16.108787 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:23:23.771616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102da0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104865550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aef70>]}


============================== 13:23:23.777123 | d82488d0-a654-4f30-9a81-8aa4c87859d2 ==============================
[0m13:23:23.777123 [info ] [MainThread]: Running with dbt=1.7.12
[0m13:23:23.778320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cameronsmith/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/cameronsmith/dbt/ccwj/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:23:24.575696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048771c0>]}
[0m13:23:24.722600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581e250>]}
[0m13:23:24.724335 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:23:24.754427 [debug] [MainThread]: checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, vars: {}, profile: , target: dev, version: 1.7.12
[0m13:23:24.776418 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:23:24.777491 [debug] [MainThread]: previous checksum: a427c19f51b78ccd38011c8add8ea1d2fe11791fef384f6369691c999d93f765, current checksum: fa6823f8c585472225a314a12a364bc70861436aed1c3e1f496a6b09c5e31653
[0m13:23:24.778436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057067c0>]}
[0m13:23:26.821102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d85fd0>]}
[0m13:23:26.849168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599fee0>]}
[0m13:23:26.850185 [info ] [MainThread]: Found 27 models, 3 seeds, 3 tests, 0 sources, 0 exposures, 0 metrics, 447 macros, 0 groups, 0 semantic models
[0m13:23:26.850803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594c970>]}
[0m13:23:26.854429 [info ] [MainThread]: 
[0m13:23:26.855652 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:26.857567 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_ccwj-dbt'
[0m13:23:26.858269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:28.370863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ccwj-dbt, now list_ccwj-dbt_analytics)
[0m13:23:28.372037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:28.676469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d856d0>]}
[0m13:23:28.695842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:28.715533 [info ] [MainThread]: 
[0m13:23:28.741823 [debug] [Thread-1  ]: Began running node model.ccwj.current_holdings_historical_strategy
[0m13:23:28.759952 [info ] [Thread-1  ]: 1 of 1 START sql view model analytics.current_holdings_historical_strategy ..... [RUN]
[0m13:23:28.761632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_ccwj-dbt_analytics, now model.ccwj.current_holdings_historical_strategy)
[0m13:23:28.762412 [debug] [Thread-1  ]: Began compiling node model.ccwj.current_holdings_historical_strategy
[0m13:23:28.778546 [debug] [Thread-1  ]: Writing injected SQL for node "model.ccwj.current_holdings_historical_strategy"
[0m13:23:28.781707 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (compile): 13:23:28.762904 => 13:23:28.780970
[0m13:23:28.782804 [debug] [Thread-1  ]: Began executing node model.ccwj.current_holdings_historical_strategy
[0m13:23:28.828878 [debug] [Thread-1  ]: Writing runtime sql for node "model.ccwj.current_holdings_historical_strategy"
[0m13:23:28.830564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:28.831840 [debug] [Thread-1  ]: On model.ccwj.current_holdings_historical_strategy: /* {"app": "dbt", "dbt_version": "1.7.12", "profile_name": "ccwj", "target_name": "dev", "node_id": "model.ccwj.current_holdings_historical_strategy"} */


  create or replace view `ccwj-dbt`.`analytics`.`current_holdings_historical_strategy`
  OPTIONS()
  as with current_holdings as (
select 
   distinct symbol
from `ccwj-dbt`.`analytics`.`current`
)
, adding_quantities as (
select 
    date,
    action,
    symbol,
    security_type,
    trade_type,
    trade_symbol,
    quantity,
    amount,
    row_number() over (partition by trade_symbol order by date) as trade_order,
    case when security_type = 'Equity' then amount else sum(amount) over (partition by trade_symbol order by date) end as trade_outcome,
    coalesce(sum(case when action = 'Buy' then quantity when action = 'Sell' then -quantity end) over (partition by symbol order by date,security_type asc),0) as quantity_at_trade_date
from `ccwj-dbt`.`analytics`.`history` 
    join current_holdings using (symbol)
)
, final as (
select 
    symbol,
    security_type,
    trade_symbol,
    action,
    trade_order,
    amount,
    trade_outcome,
    quantity,
    quantity_at_trade_date,
    case 
        when security_type = 'Equity' then 'Equity'
        when security_type = 'Option' 
            and quantity*100 <= quantity_at_trade_date then 'Covered Call'
        when security_type = 'Option'
            and quantity_at_trade_date = 0 then 'Naked Options'
        else 'Other'
    end as trading_strategy
from adding_quantities
where not (security_type = 'Option' and trade_order = 1)
)
select * from final;


[0m13:23:29.539043 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=ccwj-dbt&j=bq:US:7295fdbb-5764-43d8-b034-e30d1ef565eb&page=queryresults
[0m13:23:29.936650 [debug] [Thread-1  ]: Timing info for model.ccwj.current_holdings_historical_strategy (execute): 13:23:28.783355 => 13:23:29.936302
[0m13:23:29.937774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd82488d0-a654-4f30-9a81-8aa4c87859d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f53fa0>]}
[0m13:23:29.938998 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analytics.current_holdings_historical_strategy  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m13:23:29.939992 [debug] [Thread-1  ]: Finished running node model.ccwj.current_holdings_historical_strategy
[0m13:23:29.942489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:29.942990 [debug] [MainThread]: Connection 'model.ccwj.current_holdings_historical_strategy' was properly closed.
[0m13:23:29.943453 [info ] [MainThread]: 
[0m13:23:29.943940 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m13:23:29.945048 [debug] [MainThread]: Command end result
[0m13:23:29.973961 [info ] [MainThread]: 
[0m13:23:29.974598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:29.975122 [info ] [MainThread]: 
[0m13:23:29.975899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:29.979648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.302116, "process_user_time": 5.824668, "process_kernel_time": 0.548902, "process_mem_max_rss": "136704000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:23:29.981520 [debug] [MainThread]: Command `cli run` succeeded at 13:23:29.981041 after 6.30 seconds
[0m13:23:29.982608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102da0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599fee0>]}
[0m13:23:29.983296 [debug] [MainThread]: Flushing usage events
